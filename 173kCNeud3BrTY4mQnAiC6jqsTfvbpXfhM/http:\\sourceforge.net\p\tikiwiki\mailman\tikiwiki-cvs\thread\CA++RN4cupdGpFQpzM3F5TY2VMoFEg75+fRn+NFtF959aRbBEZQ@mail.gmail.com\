http://sourceforge.net/p/tikiwiki/mailman/tikiwiki-cvs/thread/CA++RN4cupdGpFQpzM3F5TY2VMoFEg75+fRn+NFtF959aRbBEZQ@mail.gmail.com/
HTTP/1.1 200 OK
Server: nginx
Date: Thu, 24 Jul 2014 08:30:58 GMT
Content-Type: text/html; charset=utf-8
Connection: close
Pragma: no-cache
Cache-Control: no-cache
Set-Cookie: site-notification=53bebddb0223ecc110f9ae00-1-False; Max-Age=31536000; Path=/; expires=Fri, 24-Jul-2015 08:30:48 GMT
Set-cookie: _session_id=d23d0c6ed3e9cde99beccdfcf169b93e740849ddf5e80ada6e9370ad55c520b5d0b724a9a4668197; Path=/
Content-Length: 3708424
X-Frame-Options: SAMEORIGIN

<!DOCTYPE html>
<!-- Server: sfn-web-18 -->


  












<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]>--> <html lang="en" class="no-js"> <!--<![endif]-->
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type"/>
    <title>Tiki Wiki CMS Groupware / Mailing Lists</title>
    
<meta id="webtracker" name="webtracker" content='{&#34;event_id&#34;: &#34;d07bdfce-130c-11e4-9a8e-0200ac1d2944&#34;, &#34;project&#34;: &#34;tikiwiki&#34;, &#34;action_type&#34;: &#34;mailman&#34;}' />

<script src="http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/js/sftheme/modernizr.custom.90514.js"></script>

<script src="http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/js/sftheme/jquery-1.8.0.min.js"></script>

<script src="http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/js/sftheme/header.js"></script>
<!--[if lt IE 7 ]>
  <script src="http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/js/sftheme/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg'); //fix any <img> or .png_bg background-images </script>
<![endif]-->
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular' rel='stylesheet' type='text/css'>
<style type="text/css">
    @font-face {
        font-family: "Pictos";
        src: url('http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/css/fonts/sftheme/pictos-web.eot');
        src: local("☺"), url('http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/css/fonts/sftheme/pictos-web.woff') format('woff'), url('http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/css/fonts/sftheme/pictos-web.ttf') format('truetype'), url('http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/css/fonts/sftheme/pictos-web.svg') format('svg');
    }
</style>
    <script type="text/javascript">
            /*jslint onevar: false, nomen: false, evil: true, css: true, plusplus: false, white: false, forin: true, on: true, immed: false */
            /*global confirm, alert, unescape, window, jQuery, $, net, COMSCORE */
    </script>
    
      <!-- ew:head_css -->

    
      <link rel="stylesheet"
                type="text/css"
                href="http://a.fsdn.com/allura/nf/1405697385/_ew_/_slim/css?href=tool%2Fmailman%2Fcss%2Fmailman.css%3Ballura%2Fcss%2Fforge%2Fhilite.css"
                >
    
      <link rel="stylesheet"
                type="text/css"
                href="/nf/tool_icon_css?1405697385"
                >
    
      <link rel="stylesheet"
                type="text/css"
                href="http://a.fsdn.com/allura/nf/1405697385/_ew_/theme/sftheme/css/forge.css"
                >
    
      
<!-- /ew:head_css -->

    
    
    
      <!-- ew:head_js -->

    
      
<!-- /ew:head_js -->

    
    

    
      <style type="text/css">
        #page-body.project---init-- #top_nav { display: none; }
#page-body.project---init-- #nav_menu_holder { display: none; margin-bottom: 0; }
#page-body.project---init-- #content_base {margin-top: 0; }
      </style>
    
    
      <style>.XuGzkuNriFOGcgJROBJHkHlhA { display:none }</style>

    
    
    
    


<script type="text/javascript">
    var _gaq = _gaq || [];

    function _add_tracking(prefix, tracking_id, send_user) {
        _gaq.push([prefix+'._setAccount', tracking_id]);
        _gaq.push([prefix+'._setCustomVar', 1, 'Page Type', 'mailman', 3]);_gaq.push([prefix+'._trackPageview']);
    }
      _add_tracking('sfnt1', 'UA-32013-6', true);
      _add_tracking('sfnt2', 'UA-36130941-1', true);
    

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' === document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
  </head>

  <body id="forge">
    <h2 class="hidden">
        <span style="color:red">Error:</span> CSS did not load.<br>
        This may happen on the first request due to CSS mimetype issues.
        Try clearing your browser cache and refreshing.
        <hr>
    </h2>
    
    
      <!-- ew:body_top_js -->

    
      
<!-- /ew:body_top_js -->

    
    
    
<header id="site-header">
    <div class="wrapper">
        <a href="/" class="logo">
            <span>SourceForge</span>
        </a>
        
        <form method="get" action="/directory/">
            <input type="text" id="words" name="q" placeholder="Search">
        </form>
        
        <!--Switch to {language}-->
        <nav id="nav-site">
            <a href="/directory/" title="Browse our software.">Browse</a>
            <a href="/directory/enterprise" title="Browse our Enterprise software.">Enterprise</a>
            <a href="/blog/" title="Read the latest news from the SF HQ.">Blog</a>
            <a href="/support" title="Contact us for help and feedback.">Help</a>
            <a href="/jobs?source=header" title="Search 80k+ tech jobs." class="featured-link">Jobs</a>
        </nav>
        <nav id="nav-account">
            
              <div class="logged_out">
                <a href="/account/login.php">Log In</a>
                <span>or</span>
                <a href="https://sourceforge.net/user/registration/">Join</a>
              </div>
            
        </nav>
        
    </div>
</header>
<header id="site-sec-header">
    <div class="wrapper">
        <nav id="nav-hubs">
            <h4>Solution Centers</h4>
            <a href="http://ibmsmartercommerce.sourceforge.net/">Smarter Commerce</a>
            <a href="http://goparallel.sourceforge.net/">Go Parallel</a>
            <a href="http://html5center.sourceforge.net/">HTML5</a>
            <a href="http://ibmsmarteritservices.sourceforge.net/">Smarter IT</a>
        </nav>
        <nav id="nav-collateral">
            <a href="http://library.slashdotmedia.com/?source=sfnet_header">Resources</a>
            
            <a href="">Newsletters</a>
            
        </nav>
    </div>
</header>
    
    
    
    
        <div id="site-notification">
            <section class="site-message info" data-notification-id="53bebddb0223ecc110f9ae00">
                <p>Work at SourceForge, help us to make it a better place! We have an immediate need for a <a href="http://www.dice.com/common/seeker/docs/dice_jobs.jsp#job53">Support Technician</a> in our San Francisco or Denver office.</p>
                <a href="" class="btn btn-close">Close</a>
            </section>
        </div>
    
    
    <section id="page-body" class=" neighborhood-Projects project-tikiwiki mountpoint-mailman">
	  <div id="nav_menu_holder">
            
            



    
    
    
    
        
    
    <div id="sf_pg_mailarchive_leader" class="ad">
    <iframe height="90" width="728"
        src="/static/ads/iframe_ad.html?position=sf_pg_mailarchive_leader&amp;ad=%2F%2Fad.doubleclick.net%2FN4140%2Fadj%2Fostg.sourceforge%2Fsf_pg_mailarchive_leader%3Bsz%3D728x90%3Blogged_in%3D0%3Btile%3D1%3Bu%3De%253Ad07bdfce-130c-11e4-9a8e-0200ac1d2944%3Bord%3D8916128510640831%3F&amp;class="
        seamless frameborder="0" scrolling="no"></iframe>
    <noscript><a href="//ad.doubleclick.net/N4140/jump/ostg.sourceforge/sf_pg_mailarchive_leader;sz=728x90;logged_in=0;tile=1;u=e%3Ad07bdfce-130c-11e4-9a8e-0200ac1d2944;ord=8916128510640831?"><img src="//ad.doubleclick.net/N4140/ad/ostg.sourceforge/sf_pg_mailarchive_leader;sz=728x90;logged_in=0;tile=1;u=e%3Ad07bdfce-130c-11e4-9a8e-0200ac1d2944;ord=8916128510640831?" width="728" height="90" /></a></noscript>
    </div>
    
    <nav id="breadcrumbs">
        <ul>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a itemprop="url" href="/">Home</a></li>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a itemprop="url" href="/directory">Browse</a></li>
            
            
                
            
            
            
                <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a itemprop="url" href="/p/">Projects</a></li>
                
            
            
                <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a itemprop="url" href="/p/tikiwiki/">Tiki Wiki CMS Groupware</a></li>
                
            
            
                <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">Mailing Lists</li>
                
            
        </ul>
    </nav>
    
    
  
    
    
  
  
    
      <img src="/p/tikiwiki//icon?2013-06-13 00:04:33+00:00" class="project_icon" alt="Project Logo">
    
    <h1 class="project_title">
        <a href="/p/tikiwiki/" class="project_link">Tiki Wiki CMS Groupware</a>
    </h1>
    
    
    
    <h2 class="project_summary with-icon">
        The Free and Open Source Web App with the most built-in features
    </h2>
    
    <div class="brought-by with-icon">
        Brought to you by:
        
        
            
                <a href="/u/changi67/">changi67</a>,
            
            
                <a href="/u/chibaguy/">chibaguy</a>,
            
            
                <a href="/u/jonnybradley/">jonnybradley</a>,
            
            
                <a href="/u/jyhem/">jyhem</a>,
            
            and <a href="/p/tikiwiki/_members/">13 others</a>
            </div>
    

            
      </div>
      <div id="top_nav" class="">
        
        
<ul class="dropdown">
  
    <li class="">
        <a href="/projects/tikiwiki/" class="ui-icon-tool-summary-32">
            Summary
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/projects/tikiwiki/files/" class="ui-icon-tool-files-32">
            Files
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/projects/tikiwiki/reviews" class="ui-icon-tool-reviews-32">
            Reviews
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/projects/tikiwiki/support" class="ui-icon-tool-support-32">
            Support
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/p/tikiwiki/wiki/" class="ui-icon-tool-wiki-32">
            Wiki
        </a>
        
        
    </li>
	
    <li class="selected">
        <a href="/p/tikiwiki/mailman/" class="ui-icon-tool-mailman-32">
            Mailing Lists
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/p/tikiwiki/_list/tickets" class="ui-icon-tool-tickets-32">
            Tickets ▾
        </a>
        
        
            <ul>
                
                    <li class=""><a href="/p/tikiwiki/feature-requests/">Feature Requests</a></li>
                
                    <li class=""><a href="/p/tikiwiki/patches/">Patches</a></li>
                
                    <li class=""><a href="/p/tikiwiki/support-requests/">Support Requests</a></li>
                
                    <li class=""><a href="/p/tikiwiki/bugs/">Bugs</a></li>
                
            </ul>
        
    </li>
	
    <li class="">
        <a href="/p/tikiwiki/news/" class="ui-icon-tool-blog-32">
            News
        </a>
        
        
    </li>
	
    <li class="">
        <a href="/p/tikiwiki/code/" class="ui-icon-tool-svn-32">
            SVN-Code
        </a>
        
        
    </li>
	
</ul>

        
      </div>
      <div id="content_base">
      
			  
			    
          


<div id="sidebar">
  
    <form id="search" method="GET" action="/p/tikiwiki/mailman/search/">
      <input name="q" type="text" title="Search Mailing Lists" placeholder="Search Mailing Lists">
    </form>
  
    
    
      
        
    
      <ul class="sidebarmenu">
      
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-artwork/"><span>tikiwiki-artwork</span></a>
    </li>
  
      
        
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-cvs/"><span>tikiwiki-cvs</span></a>
    </li>
  
      
        
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-deutsch/"><span>tikiwiki-deutsch</span></a>
    </li>
  
      
        
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-devel/"><span>tikiwiki-devel</span></a>
    </li>
  
      
        
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-pt-br/"><span>tikiwiki-pt-br</span></a>
    </li>
  
      
        
    
    <li>
      <a href="/p/tikiwiki/mailman/tikiwiki-users/"><span>tikiwiki-users</span></a>
    </li>
  
      
    
    
      </ul>
      
    
    
</div>
          
          
			  
			  
          
        
        <div class="grid-20 pad">
          <h2 class="dark title">tikiwiki-cvs
            <!-- actions -->
            <small>
            
            </small>
            <!-- /actions -->
          </h2>
		
          <div>
            
            
  
<div class="thread-message" style="margin-left: 0px">
  

<table id="msg29057419">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29057419/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40494] branches/9.x</a></b></div>
      
      <small>From: &lt;jyhem@us...&gt; - 2012-03-29 17:14:33</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40494
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40494&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40494&amp;view=rev</a>
Author:   jyhem
Date:     2012-03-29 17:14:23 +0000 (Thu, 29 Mar 2012)
Log Message:
-----------
Improve styling and center stuff inside cells

Modified Paths:
--------------
    branches/9.x/lib/wiki-plugins/wikiplugin_convene.php
    branches/9.x/styles/layout/layout.css

Modified: branches/9.x/lib/wiki-plugins/wikiplugin_convene.php
===================================================================
--- branches/9.x/lib/wiki-plugins/wikiplugin_convene.php	2012-03-29 16:39:06 UTC (rev 40493)
+++ branches/9.x/lib/wiki-plugins/wikiplugin_convene.php	2012-03-29 17:14:23 UTC (rev 40494)
@@ -129,7 +129,7 @@
 		}
 	}
 	$result .= &#34;
-		&lt;tr&gt;
+		&lt;tr class=&#39;conveneHeaderRow&#39;&gt;
 			&lt;td&gt;&lt;/td&gt;
 			$dateHeader
 		&lt;/tr&gt;&#34;;
@@ -139,7 +139,7 @@
 	//start user list and votes 
 	$userList = &#34;&#34;;
 	foreach ($rows as $user =&gt; $row) {
-		$userList .= &#34;&lt;tr class=&#39;conveneUserVotes$i&#39;&gt;&#34;;
+		$userList .= &#34;&lt;tr class=&#39;conveneVotes conveneUserVotes$i&#39;&gt;&#34;;
 		$userList .= &#34;&lt;td&gt;&#34;. ($tiki_p_edit == &#39;y&#39; ? &#34;&lt;button class=&#39;conveneUpdateUser$i icon ui-widget-header ui-corner-all&#39;&gt;&lt;img src=&#39;img/icons/pencil.png&#39; title=&#39;&#34; . tr(&#34;Edit User/Save changes&#34;) . &#34;&#39; /&gt;&lt;/button&gt;&lt;button data-user=&#39;$user&#39; title=&#39;&#34; . tr(&#34;Delete User&#34;) . &#34;&#39; class=&#39;conveneDeleteUser$i icon ui-widget-header ui-corner-all&#39;&gt;&lt;img src=&#39;img/icons/delete.png&#39;/&gt;&lt;/button&gt; &#34; : &#34;&#34;) . $user . &#34;&lt;/td&gt;&#34;;
 		foreach ($row as $stamp =&gt; $vote) {
 			if ($vote == 1) {
@@ -161,7 +161,7 @@
 	
 	
 	//start add new user and votes
-	$result .= &#34;&lt;tr&gt;&#34;;
+	$result .= &#34;&lt;tr class=&#39;conveneFooterRow&#39;&gt;&#34;;
 
 
 	$result .= &#34;&lt;td&gt;&#34;.(

Modified: branches/9.x/styles/layout/layout.css
===================================================================
--- branches/9.x/styles/layout/layout.css	2012-03-29 16:39:06 UTC (rev 40493)
+++ branches/9.x/styles/layout/layout.css	2012-03-29 17:14:23 UTC (rev 40494)
@@ -1070,6 +1070,17 @@
 }
 
 /* wikiplugin_convene */
+
+.conveneHeaderRow td {
+	text-align: center; 
+}
+
+.conveneVotes td,
+.conveneFooterRow td,
+.conveneHeaderRow td {
+	vertical-align: middle;
+}
+
 .convene-ok {    
 	background-color: #D1F3D1 !important;
 	background-image: none !important;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29058860">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29058860/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40540] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-03-29 21:38:24</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40540
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40540&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40540&amp;view=rev</a>
Author:   robertplummer
Date:     2012-03-29 21:38:18 +0000 (Thu, 29 Mar 2012)
Log Message:
-----------
[FIX] Finally making some progress in reading all the codemirror files at load time.  This is both a fix and a feature, codemirror &#39;s modes are just too hard to manage because of how many, this caches once and reads then from cache

Modified Paths:
--------------
    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
    branches/9.x/tiki-setup.php

Added Paths:
-----------
    branches/9.x/lib/codemirror_tiki/tiki_codemirror.php

Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
===================================================================
--- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-03-29 21:35:06 UTC (rev 40539)
+++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-03-29 21:38:18 UTC (rev 40540)
@@ -119,43 +119,33 @@
 				} else {
 					if (!modeDef.modeSpec) return;
 					if (!modeDef.mime) return;
-					var modeLoc = modeLocs[modeDef.modeSpec];
-					if (!modeLoc) return;
-					
-					if (modeLoc.css) {
-						jQuery(&#39;head&#39;).append(&#39;&lt;link rel=&#34;stylesheet&#34; class=&#34;tiki-codemirror-style&#34; href=&#34;&#39; + modeLoc.css + &#39;&#34; /&gt;&#39;);
-					}
-					
-					if (modeLoc.js) {
-						jQuery.getScript(modeLoc.js, function(e) {
-							o.addClass(&#39;CodeMirrorHide&#39;);
-							var scrollTop = o.scrollTop(),
-							textareaHeight = o.innerHeight();
 
-							syntaxHighlighter.remove(textarea);
+					o.addClass(&#39;CodeMirrorHide&#39;);
+					var scrollTop = o.scrollTop(),
+					textareaHeight = o.innerHeight();
 
-							var editor = syntaxHighlighter.ready(textarea, settings, modeDef, mode),
-							editorWindow = jQuery(editor.getWrapperElement()).find(&#39;.CodeMirror-scroll&#39;).andSelf(),
-							scroller = jQuery(editor.getScrollerElement());
-							scroller.scrollTop(scrollTop * (scroller.innerHeight() / textareaHeight))
+					syntaxHighlighter.remove(textarea);
 
-							o.removeClass(&#39;CodeMirrorHide&#39;);
+					var editor = syntaxHighlighter.ready(textarea, settings, modeDef, mode),
+					editorWindow = jQuery(editor.getWrapperElement()).find(&#39;.CodeMirror-scroll&#39;).andSelf(),
+					scroller = jQuery(editor.getScrollerElement());
+					scroller.scrollTop(scrollTop * (scroller.innerHeight() / textareaHeight))
 
-							settings.parent.modal();
+					o.removeClass(&#39;CodeMirrorHide&#39;);
 
-							editorWindow.find(&#39;div:first&#39;)
-								.css(&#39;width&#39;, &#39;auto&#39;)
-								.css(&#39;height&#39;, &#39;auto&#39;);
-							
-							if (settings.readOnly) {
-								editorWindow
-									.css(&#39;height&#39;, &#39;auto&#39;)
-									.css(&#39;overflow&#39;, &#39;visible&#39;);
-							}
-							
-							o.trigger(&#39;syntaxHighlighterLoaded&#39;);
-						});
+					settings.parent.modal();
+
+					editorWindow.find(&#39;div:first&#39;)
+						.css(&#39;width&#39;, &#39;auto&#39;)
+						.css(&#39;height&#39;, &#39;auto&#39;);
+
+					if (settings.readOnly) {
+						editorWindow
+							.css(&#39;height&#39;, &#39;auto&#39;)
+							.css(&#39;overflow&#39;, &#39;visible&#39;);
 					}
+
+					o.trigger(&#39;syntaxHighlighterLoaded&#39;);
 				}
 			}, true);
 		});
@@ -179,10 +169,14 @@
 			modeSpec: &#34;clike&#34;,
 			mime: &#34;text/x-csharp&#34;
 		},
-		&#34;java&#34;: {
-			modeSpec: &#34;clike&#34;,
-			mime: &#34;text/x-java&#34;
+		&#34;clojure&#34;: {
+			modeSpec: &#34;clojure&#34;,
+			mime: &#34;text/x-clojure&#34;
 		},
+		&#34;coffeescript&#34;: {
+			modeSpec: &#34;coffeescript&#34;,
+			mime: &#34;text/x-coffeescript&#34;
+		},
 		&#34;css&#34;: {
 			modeSpec: &#34;css&#34;,
 			mime: &#34;text/css&#34;
@@ -191,6 +185,10 @@
 			modeSpec: &#34;diff&#34;,
 			mime: &#34;text/x-diff&#34;
 		},
+		&#34;ecl&#34;: {
+			modeSpec: &#34;ecl&#34;,
+			mime: &#34;text/x-ecl&#34;
+		},
 		&#34;haskell&#34;: {
 			modeSpec: &#34;haskell&#34;,
 			mime: &#34;text/x-haskell&#34;
@@ -199,6 +197,10 @@
 			modeSpec: &#34;htmlmixed&#34;,
 			mime: &#34;text/html&#34;
 		},
+		&#34;java&#34;: {
+			modeSpec: &#34;clike&#34;,
+			mime: &#34;text/x-java&#34;
+		},
 		&#34;javascript&#34;: {
 			modeSpec: &#34;javascript&#34;,
 			mime: &#34;text/javascript&#34;

Added: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
===================================================================
--- branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	                        (rev 0)
+++ branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-03-29 21:38:18 UTC (rev 40540)
@@ -0,0 +1,36 @@
+&lt;?php
+// (c) Copyright 2002-2012 by authors of the Tiki Wiki CMS Groupware Project
+// 
+// All Rights Reserved. See copyright.txt for details and a complete list of authors.
+// Licensed under the GNU LESSER GENERAL PUBLIC LICENSE. See license.txt for details.
+// $Id$
+
+function codemirrorModes()
+{
+	$js = &#39;&#39;;
+	$css = &#39;&#39;;
+
+	if (TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_js&#34;) == false || TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_css&#34;) == false) {
+		foreach(glob(&#39;lib/codemirror/mode/*&#39;, GLOB_ONLYDIR) as $dir) {
+			foreach(glob($dir.&#39;/*.js&#39;) as $jsFile) {
+				$js .= @file_get_contents($jsFile);
+			}
+			foreach(glob($dir.&#39;/*.css&#39;) as $cssFile) {
+				$css .= @file_get_contents($cssFile);
+			}
+		}
+
+		$js .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.js&#34;);
+		$css .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.css&#34;);
+
+		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_js&#34;, $js);
+		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_css&#34;, $css);
+	} else {
+		$js = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_js&#34;);
+		$css = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_css&#34;);
+	}
+
+	TikiLib::lib(&#34;header&#34;)
+		-&gt;add_js($js)
+		-&gt;add_css($css);
+}
\ No newline at end of file


Property changes on: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
___________________________________________________________________
Added: svn:keywords
   + Id

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-03-29 21:35:06 UTC (rev 40539)
+++ branches/9.x/tiki-setup.php	2012-03-29 21:38:18 UTC (rev 40540)
@@ -242,6 +242,9 @@
 		//add tiki stuff
 		$headerlib-&gt;add_cssfile(&#39;lib/codemirror_tiki/codemirror_tiki.css&#39;);
 		$headerlib-&gt;add_jsfile(&#39;lib/codemirror_tiki/codemirror_tiki.js&#39;);
+
+		require_once(&#34;lib/codemirror_tiki/tiki_codemirror.php&#34;);
+		codemirrorModes();
 	}
 	
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29059492">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29059492/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40545] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-03-30 00:03:44</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40545
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40545&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40545&amp;view=rev</a>
Author:   robertplummer
Date:     2012-03-30 00:03:36 +0000 (Fri, 30 Mar 2012)
Log Message:
-----------
[ENH] Added minify support, needed for 9

Modified Paths:
--------------
    branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
    branches/9.x/tiki-setup.php

Modified: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
===================================================================
--- branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-03-29 21:59:49 UTC (rev 40544)
+++ branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-03-30 00:03:36 UTC (rev 40545)
@@ -5,12 +5,12 @@
 // Licensed under the GNU LESSER GENERAL PUBLIC LICENSE. See license.txt for details.
 // $Id$
 
-function codemirrorModes()
+function codemirrorModes($minify = true)
 {
 	$js = &#39;&#39;;
 	$css = &#39;&#39;;
 
-	if (TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_js&#34;) == false || TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_css&#34;) == false) {
+	if (TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;)) == false || TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;)) == false) {
 		foreach(glob(&#39;lib/codemirror/mode/*&#39;, GLOB_ONLYDIR) as $dir) {
 			foreach(glob($dir.&#39;/*.js&#39;) as $jsFile) {
 				$js .= @file_get_contents($jsFile);
@@ -23,11 +23,19 @@
 		$js .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.js&#34;);
 		$css .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.css&#34;);
 
-		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_js&#34;, $js);
-		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_css&#34;, $css);
+		if ($minify) {
+			require_once(&#34;lib/minify/JSMin.php&#34;);
+			$js = JSMin::minify($js);
+
+			require_once(&#39;lib/pear/Minify/CSS/Compressor.php&#39;);
+			$css = Minify_CSS_Compressor::process($css);
+		}
+
+		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;), $js);
+		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;), $css);
 	} else {
-		$js = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_js&#34;);
-		$css = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_css&#34;);
+		$js = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;));
+		$css = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;));
 	}
 
 	TikiLib::lib(&#34;header&#34;)

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-03-29 21:59:49 UTC (rev 40544)
+++ branches/9.x/tiki-setup.php	2012-03-30 00:03:36 UTC (rev 40545)
@@ -244,7 +244,7 @@
 		$headerlib-&gt;add_jsfile(&#39;lib/codemirror_tiki/codemirror_tiki.js&#39;);
 
 		require_once(&#34;lib/codemirror_tiki/tiki_codemirror.php&#34;);
-		codemirrorModes();
+		codemirrorModes($prefs[&#39;tiki_minify_javascript&#39;] === &#39;y&#39;);
 	}
 	
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29065254">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29065254/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40562] branches/9.x</a></b></div>
      
      <small>From: &lt;sampaioprimo@us...&gt; - 2012-03-31 02:26:26</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40562
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40562&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40562&amp;view=rev</a>
Author:   sampaioprimo
Date:     2012-03-31 02:26:19 +0000 (Sat, 31 Mar 2012)
Log Message:
-----------
daily reports: call tr() on whole sentences instead of several tr() calls for different parts of the same sentence

Modified Paths:
--------------
    branches/9.x/lib/core/Reports/Send/EmailBuilder/FileGalleryChanged.php
    branches/9.x/lib/core/Reports/Send/EmailBuilder/ForumPostThread.php
    branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiFileAttached.php
    branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiPageChanged.php
    branches/9.x/lib/core/Reports/Send/EmailBuilder.php
    branches/9.x/lib/core/Reports/Send.php
    branches/9.x/lib/test/core/Reports/fixtures/email_body.txt
    branches/9.x/templates/mail/report.tpl

Modified: branches/9.x/lib/core/Reports/Send/EmailBuilder/FileGalleryChanged.php
===================================================================
--- branches/9.x/lib/core/Reports/Send/EmailBuilder/FileGalleryChanged.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send/EmailBuilder/FileGalleryChanged.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -19,11 +19,21 @@
 		global $base_url;
 		
 	 	if (empty($change[&#39;data&#39;][&#39;action&#39;])) {
-			$output = &#34;&lt;u&gt;&#34;.$change[&#39;data&#39;][&#39;user&#39;].&#34;&lt;/u&gt; &#34;.tra(&#34;edited the file gallery&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId=&#34;.$change[&#39;data&#39;][&#39;galleryId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;galleryName&#39;].&#34;&lt;/a&gt;&#34;;
+	 		$output = tr(&#39;%0 edited the file gallery %1.&#39;,
+	 			&#34;&lt;u&gt;{$change[&#39;data&#39;][&#39;user&#39;]}&lt;/u&gt;&#34;,
+	 			&#34;&lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId={$change[&#39;data&#39;][&#39;galleryId&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;galleryName&#39;]}&lt;/a&gt;&#34;
+	 		);
 		} elseif ($change[&#39;data&#39;][&#39;action&#39;] == &#34;upload file&#34;) {
-			$output = &#34;&lt;u&gt;&#34;.$change[&#39;data&#39;][&#39;user&#39;].&#34;&lt;/u&gt; &#34;.tra(&#34;uploaded the file&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-download_file.php?fileId=&#34;.$change[&#39;data&#39;][&#39;fileId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;fileName&#39;].&#34;&lt;/a&gt; &#34;.tra(&#34;onto&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId=&#34;.$change[&#39;data&#39;][&#39;galleryId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;galleryName&#39;].&#34;&lt;/a&gt;.&#34;;
+			$output = tr(&#39;%0 uploaded the file %1.&#39;,
+				&#34;&lt;u&gt;{$change[&#39;data&#39;][&#39;user&#39;]}&lt;/u&gt;&#34;,
+				&#34;&lt;a href=\&#34;{$base_url}tiki-download_file.php?fileId=&#34;.$change[&#39;data&#39;][&#39;fileId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;fileName&#39;].&#34;&lt;/a&gt; &#34;.tra(&#34;onto&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId={$change[&#39;data&#39;][&#39;galleryId&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;galleryName&#39;]}&lt;/a&gt;&#34;
+			);
 		} elseif ($change[&#39;data&#39;][&#39;action&#39;] == &#34;remove file&#34;) {
-			$output = &#34;&lt;u&gt;&#34;.$change[&#39;data&#39;][&#39;user&#39;].&#34;&lt;/u&gt; &#34;.tra(&#34;removed the file&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-download_file.php?fileId=&#34;.$change[&#39;data&#39;][&#39;fileId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;fileName&#39;].&#34;&lt;/a&gt; &#34;.tra(&#34;from&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId=&#34;.$change[&#39;data&#39;][&#39;galleryId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;galleryName&#39;].&#34;&lt;/a&gt;.&#34;;
+			$output = tr(&#39;%0 removed the file %1 from %2.&#39;,
+				&#34;&lt;u&gt;{$change[&#39;data&#39;][&#39;user&#39;]}&lt;/u&gt;&#34;,
+				&#34;&lt;a href=\&#34;{$base_url}tiki-download_file.php?fileId={$change[&#39;data&#39;][&#39;fileId&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;fileName&#39;]}&lt;/a&gt;&#34;,
+				&#34;&lt;a href=\&#34;{$base_url}tiki-list_file_gallery.php?galleryId={$change[&#39;data&#39;][&#39;galleryId&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;galleryName&#39;]}&lt;/a&gt;&#34;
+			);
 		}
 		
 		return $output;

Modified: branches/9.x/lib/core/Reports/Send/EmailBuilder/ForumPostThread.php
===================================================================
--- branches/9.x/lib/core/Reports/Send/EmailBuilder/ForumPostThread.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send/EmailBuilder/ForumPostThread.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -11,7 +11,7 @@
 class Reports_Send_EmailBuilder_ForumPostThread extends Reports_Send_EmailBuilder_Abstract {
 	public function getTitle()
 	{
-		return tr(&#39;New posts in foruns:&#39;);
+		return tr(&#39;New replies in foruns topics:&#39;);
 	}
 	
 	public function getOutput(array $change)
@@ -21,7 +21,11 @@
 		$commentslib = TikiLib::lib(&#39;comments&#39;);
 		$parent_topic = $commentslib-&gt;get_comment($change[&#39;data&#39;][&#39;topicId&#39;]);
 		
-		$output = &#34;&lt;u&gt;&#34;.$change[&#39;data&#39;][&#39;user&#39;].&#34;&lt;/u&gt; &lt;a href=\&#34;{$base_url}tiki-view_forum_thread.php?forumId=&#34;.$change[&#39;data&#39;][&#39;forumId&#39;].&#34;&amp;comments_parentId=&#34;.$change[&#39;data&#39;][&#39;topicId&#39;].&#34;#threadId&#34;.$change[&#39;data&#39;][&#39;threadId&#39;].&#34;\&#34;&gt;&#34;.tra(&#34;replied&#34;).&#34;&lt;/a&gt; &#34;.tra(&#34;to the topic&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-view_forum_thread.php?comments_parentId=&#34;.$change[&#39;data&#39;][&#39;topicId&#39;].&#34;&amp;forumId=&#34;.$change[&#39;data&#39;][&#39;forumId&#39;].&#34;\&#34;&gt;&#34;.$parent_topic[&#39;title&#39;].&#34;&lt;/a&gt;.&#34;;
+		$output = tr(&#39;%0 &lt;a href=%1&gt;replied&lt;/a&gt; to the topic %2.&#39;,
+			&#34;&lt;u&gt;{$change[&#39;data&#39;][&#39;user&#39;]}&lt;/u&gt;&#34;,
+			&#34;\&#34;{$base_url}tiki-view_forum_thread.php?forumId={$change[&#39;data&#39;][&#39;forumId&#39;]}&amp;comments_parentId={$change[&#39;data&#39;][&#39;topicId&#39;]}#threadId{$change[&#39;data&#39;][&#39;threadId&#39;]}\&#34;&#34;,
+			&#34;&lt;a href=\&#34;{$base_url}tiki-view_forum_thread.php?comments_parentId={$change[&#39;data&#39;][&#39;topicId&#39;]}&amp;forumId={$change[&#39;data&#39;][&#39;forumId&#39;]}\&#34;&gt;{$parent_topic[&#39;title&#39;]}&lt;/a&gt;&#34;
+		);
 				
 		return $output;
 	}

Modified: branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiFileAttached.php
===================================================================
--- branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiFileAttached.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiFileAttached.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -18,7 +18,11 @@
 	{
 		global $base_url;
 
-		$output = &#34;&lt;u&gt;&#34;.$change[&#39;user&#39;].&#34;&lt;/u&gt; &#34;.tra(&#39;uploaded the file&#39;) . &#34; &lt;a href=\&#34;{$base_url}tiki-download_wiki_attachment.php?attId=&#34;.$change[&#39;data&#39;][&#39;attId&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;filename&#39;].&#34;&lt;/a&gt; &#34;.tra(&#34;onto&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-index.php?page=&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;&lt;/a&gt;.&#34;;
+		$output = tr(&#39;%0 uploaded the file %1 onto %2&#39;,
+			&#34;&lt;u&gt;{$change[&#39;user&#39;]}&lt;/u&gt;&#34;,
+			&#34;&lt;a href=\&#34;{$base_url}tiki-download_wiki_attachment.php?attId={$change[&#39;data&#39;][&#39;attId&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;filename&#39;]}&lt;/a&gt;&#34;,
+			&#34;&lt;a href=\&#34;{$base_url}tiki-index.php?page={$change[&#39;data&#39;][&#39;pageName&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;pageName&#39;]}&lt;/a&gt;.&#34;
+		);
 				
 		return $output;
 	}

Modified: branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiPageChanged.php
===================================================================
--- branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiPageChanged.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send/EmailBuilder/WikiPageChanged.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -18,7 +18,14 @@
 	{
 		global $base_url;
 		
-		$output = &#34;&lt;u&gt;&#34;.$change[&#39;data&#39;][&#39;editUser&#39;].&#34;&lt;/u&gt; &#34;.tra(&#34;edited the wikipage&#34;).&#34; &lt;a href=\&#34;{$base_url}tiki-index.php?page=&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;\&#34;&gt;&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;&lt;/a&gt; (&lt;a href=\&#34;{$base_url}tiki-pagehistory.php?page=&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=&#34;.($change[&#39;data&#39;][&#39;oldVer&#39;]+1).&#34;&amp;oldver=&#34;.$change[&#39;data&#39;][&#39;oldVer&#39;].&#34;\&#34;&gt;&#34;.tra(&#34;this history&#34;).&#34;&lt;/a&gt;, &lt;a href=\&#34;{$base_url}tiki-pagehistory.php?page=&#34;.$change[&#39;data&#39;][&#39;pageName&#39;].&#34;&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver=&#34;.$change[&#39;data&#39;][&#39;oldVer&#39;].&#34;\&#34;&gt;&#34;.tra(&#34;all history&#34;).&#34;&lt;/a&gt;)&#34;;
+		$newVersion = $change[&#39;data&#39;][&#39;oldVer&#39;] + 1;
+		
+		$output = tr(&#34;%0 edited the wikipage %1 (&lt;a href=%2&gt;this history&lt;/a&gt;, &lt;a href=%3&gt;all history&lt;/a&gt;)&#34;,
+			&#34;&lt;u&gt;{$change[&#39;data&#39;][&#39;editUser&#39;]}&lt;/u&gt;&#34;,
+			&#34;&lt;a href=\&#34;{$base_url}tiki-index.php?page={$change[&#39;data&#39;][&#39;pageName&#39;]}\&#34;&gt;{$change[&#39;data&#39;][&#39;pageName&#39;]}&lt;/a&gt;&#34;,
+			&#34;\&#34;{$base_url}tiki-pagehistory.php?page={$change[&#39;data&#39;][&#39;pageName&#39;]}&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=$newVersion&amp;oldver={$change[&#39;data&#39;][&#39;oldVer&#39;]}\&#34;&#34;,
+			&#34;\&#34;{$base_url}tiki-pagehistory.php?page={$change[&#39;data&#39;][&#39;pageName&#39;]}&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver={$change[&#39;data&#39;][&#39;oldVer&#39;]}\&#34;&#34;
+		);
 				
 		return $output;
 	}

Modified: branches/9.x/lib/core/Reports/Send/EmailBuilder.php
===================================================================
--- branches/9.x/lib/core/Reports/Send/EmailBuilder.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send/EmailBuilder.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -104,17 +104,15 @@
 		foreach ($change_array as $eventName =&gt; $changes) {
 			$eventObject = $this-&gt;factory-&gt;build($changes[0][&#39;event&#39;]);
 
-			$body .= &#39;&lt;b&gt;&#39; . $eventObject-&gt;getTitle() . &#39;&lt;/b&gt;&lt;br /&gt;&#39;;
+			$body .= &#39;&lt;b&gt;&#39; . $eventObject-&gt;getTitle() . &#34;&lt;/b&gt;&lt;br /&gt;\n&#34;;
 			
 			foreach ($changes as $key =&gt; $change) {
 				if ($report_preferences[&#39;view&#39;]==&#34;short&#34; AND $key&gt;0) {
 					$morechanges++;
 				} elseif ($report_preferences[&#39;view&#39;]==&#34;detailed&#34; OR $key==0) {
 					if ($morechanges &gt; 0) {
-						$body .= &#34;   &#34;.tra(&#34;and&#34;).&#34; &#34;.$morechanges.&#34; &#34;.tra(&#34;more changes of the same type...&#34;).&#34;&lt;br&gt;&#34;;
+						$body .= &#34;   &#34; . tr(&#39;and %0 more changes of the same type.&#39;, $morechanges) . &#34;&lt;br&gt;\n&#34;;
 						$morechanges = 0;
-						if ($report_preferences[&#39;type&#39;]==&#39;plain&#39;)
-							$body .= &#34;\r\n&#34;;
 					}
 	
 					if ($report_preferences[&#39;type&#39;] == &#39;plain&#39;) {
@@ -131,10 +129,7 @@
 					
 					$body .= $eventObject-&gt;getOutput($change);
 					
-					$body .= &#34;&lt;br&gt;&#34;;
-					if ($report_preferences[&#39;type&#39;]==&#39;plain&#39;) {
-						$body .= &#34;\r\n&#34;;
-					}
+					$body .= &#34;&lt;br&gt;\n&#34;;
 				}
 			}
 		}

Modified: branches/9.x/lib/core/Reports/Send.php
===================================================================
--- branches/9.x/lib/core/Reports/Send.php	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/core/Reports/Send.php	2012-03-31 02:26:19 UTC (rev 40562)
@@ -46,7 +46,7 @@
 		if ($reportPreferences[&#39;type&#39;] == &#39;plain&#39;) {
 			$this-&gt;mail-&gt;setText($mailData);
 		} else {
-			$this-&gt;mail-&gt;setHtml(nl2br($mailData));
+			$this-&gt;mail-&gt;setHtml($mailData);
 		}
 		
 		$this-&gt;mail-&gt;buildMessage();

Modified: branches/9.x/lib/test/core/Reports/fixtures/email_body.txt
===================================================================
--- branches/9.x/lib/test/core/Reports/fixtures/email_body.txt	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/lib/test/core/Reports/fixtures/email_body.txt	2012-03-31 02:26:19 UTC (rev 40562)
@@ -1,8 +1,44 @@
-Report for Test.&lt;br /&gt;
-&lt;br /&gt;
-Last Report sent on Sunday 15 of January, 2012.&lt;br /&gt;
-&lt;br /&gt;
-&lt;u&gt;Changes in detail:&lt;/u&gt;&lt;br /&gt;
-&lt;b&gt;Wiki pages updated:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:34: &lt;u&gt;admin&lt;/u&gt; edited the wikipage &lt;a href=&#34;tiki-index.php?page=HomePage&#34;&gt;HomePage&lt;/a&gt; (&lt;a href=&#34;tiki-pagehistory.php?page=HomePage&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=2&amp;oldver=1&#34;&gt;this history&lt;/a&gt;, &lt;a href=&#34;tiki-pagehistory.php?page=HomePage&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver=1&#34;&gt;all history&lt;/a&gt;)&lt;br&gt;&lt;b&gt;Wiki pages updated:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:35: &lt;u&gt;admin&lt;/u&gt; edited the wikipage &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt; (&lt;a href=&#34;tiki-pagehistory.php?page=test&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=2&amp;oldver=1&#34;&gt;this history&lt;/a&gt;, &lt;a href=&#34;tiki-pagehistory.php?page=test&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver=1&#34;&gt;all history&lt;/a&gt;)&lt;br&gt;&lt;b&gt;New attachments in wiki pages:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:37: &lt;u&gt;test&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_wiki_attachment.php?attId=1&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt;.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:37: &lt;u&gt;test&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_wiki_attachment.php?attId=2&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt;.&lt;br&gt;&lt;b&gt;Tracker items modified:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:38: &lt;u&gt;admin&lt;/u&gt; added or updated tracker item id &lt;a href=&#39;tiki-view_tracker_item.php?itemId=4&#39;&gt;4&lt;/a&gt; on tracker &lt;a href=&#39;tiki-view_tracker.php?trackerId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;&lt;b&gt;Comments in tracker items:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:39: &lt;u&gt;admin&lt;/u&gt; added a new comment to item id &lt;a href=&#39;tiki-view_tracker_item.php?itemId=4&amp;cookietab=2&#39;&gt;4&lt;/a&gt; on tracker &lt;a href=&#39;tiki-view_tracker.php?trackerId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;&lt;b&gt;New posts in forums:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:41: &lt;u&gt;admin&lt;/u&gt; created the topic &lt;a href=&#34;tiki-view_forum_thread.php?comments_parentId=2&amp;forumId=1&#34;&gt;New topic&lt;/a&gt; at forum &lt;a href=&#34;tiki-view_forum.php?forumId=1&#34;&gt;Discussion forum&lt;/a&gt;.&lt;br&gt;&lt;b&gt;New posts in foruns:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:42: &lt;u&gt;admin&lt;/u&gt; &lt;a href=&#34;tiki-view_forum_thread.php?forumId=1&amp;comments_parentId=2#threadId3&#34;&gt;replied&lt;/a&gt; to the topic &lt;a href=&#34;tiki-view_forum_thread.php?comments_parentId=2&amp;forumId=1&#34;&gt;&lt;/a&gt;.&lt;br&gt;&lt;b&gt;File galleries changed:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:49: &lt;u&gt;admin&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_file.php?fileId=2&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-list_file_gallery.php?galleryId=1&#34;&gt;File Galleries&lt;/a&gt;.&lt;br&gt;&lt;b&gt;New calendar events:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:50: &lt;u&gt;admin&lt;/u&gt; added or updated event &lt;a href=&#39;tiki-calendar_edit_item.php?viewcalitemId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:51: &lt;u&gt;admin&lt;/u&gt; added the wiki page &lt;a href=&#34;tiki-index.php?page=HomePage&#34;&gt;HomePage&lt;/a&gt; to the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:51: &lt;u&gt;admin&lt;/u&gt; added the wiki page &lt;a href=&#34;tiki-index.php?page=My+Resume&#34;&gt;My Resume&lt;/a&gt; to the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:52: &lt;u&gt;admin&lt;/u&gt; removed the wiki page &lt;a href=&#34;tiki-index.php?page=My+Resume&#34;&gt;My Resume&lt;/a&gt; from the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; edited the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; created the subcategory &lt;a href=&#34;tiki-browse_categories.php?parentId=2&amp;deep=off&#34;&gt;Child category&lt;/a&gt; in &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; removed the subcategory &lt;a href=&#34;tiki-browse_categories.php?parentId=2&amp;deep=off&#34;&gt;Child category&lt;/a&gt; from &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;&lt;b&gt;New blog posts:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:58: &lt;u&gt;admin&lt;/u&gt; replied to the blog &lt;a href=&#34;tiki-view_blog.php?blogId=1&#34;&gt;My Personal Blog&lt;/a&gt; &lt;a href=&#34;tiki-view_blog_post.php?postId=&#34;4&gt;&lt;/a&gt;.&lt;br&gt;&lt;b&gt;New articles submited:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:59: &lt;u&gt;admin&lt;/u&gt; created the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;&lt;b&gt;Edited articles:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 14:00: &lt;u&gt;admin&lt;/u&gt; edited the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;&lt;b&gt;Articles deleted:&lt;/b&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 14:00: &lt;u&gt;admin&lt;/u&gt; removed the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;&lt;br /&gt;
-&lt;br /&gt;
+Report for Test.&lt;br /&gt;&lt;br /&gt;
+Last Report sent on Sunday 15 of January, 2012.&lt;br /&gt;&lt;br /&gt;
+&lt;u&gt;Changes in detail:&lt;/u&gt;&lt;br /&gt;&lt;br /&gt;
+&lt;b&gt;Wiki pages updated:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:34: &lt;u&gt;admin&lt;/u&gt; edited the wikipage &lt;a href=&#34;tiki-index.php?page=HomePage&#34;&gt;HomePage&lt;/a&gt; (&lt;a href=&#34;tiki-pagehistory.php?page=HomePage&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=2&amp;oldver=1&#34;&gt;this history&lt;/a&gt;, &lt;a href=&#34;tiki-pagehistory.php?page=HomePage&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver=1&#34;&gt;all history&lt;/a&gt;)&lt;br&gt;
+&lt;b&gt;Wiki pages updated:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:35: &lt;u&gt;admin&lt;/u&gt; edited the wikipage &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt; (&lt;a href=&#34;tiki-pagehistory.php?page=test&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=2&amp;oldver=1&#34;&gt;this history&lt;/a&gt;, &lt;a href=&#34;tiki-pagehistory.php?page=test&amp;diff_style=sidediff&amp;compare=Compare&amp;newver=0&amp;oldver=1&#34;&gt;all history&lt;/a&gt;)&lt;br&gt;
+&lt;b&gt;New attachments in wiki pages:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:37: &lt;u&gt;test&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_wiki_attachment.php?attId=1&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt;.&lt;br&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:37: &lt;u&gt;test&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_wiki_attachment.php?attId=2&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-index.php?page=test&#34;&gt;test&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;Tracker items modified:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:38: &lt;u&gt;admin&lt;/u&gt; added or updated tracker item id &lt;a href=&#39;tiki-view_tracker_item.php?itemId=4&#39;&gt;4&lt;/a&gt; on tracker &lt;a href=&#39;tiki-view_tracker.php?trackerId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;
+&lt;b&gt;Comments in tracker items:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:39: &lt;u&gt;admin&lt;/u&gt; added a new comment to item id &lt;a href=&#39;tiki-view_tracker_item.php?itemId=4&amp;cookietab=2&#39;&gt;4&lt;/a&gt; on tracker &lt;a href=&#39;tiki-view_tracker.php?trackerId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;
+&lt;b&gt;New posts in forums:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:41: &lt;u&gt;admin&lt;/u&gt; created the topic &lt;a href=&#34;tiki-view_forum_thread.php?comments_parentId=2&amp;forumId=1&#34;&gt;New topic&lt;/a&gt; at forum &lt;a href=&#34;tiki-view_forum.php?forumId=1&#34;&gt;Discussion forum&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;New replies in foruns topics:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:42: &lt;u&gt;admin&lt;/u&gt; &lt;a href=&#34;tiki-view_forum_thread.php?forumId=1&amp;comments_parentId=2#threadId3&#34;&gt;replied&lt;/a&gt; to the topic &lt;a href=&#34;tiki-view_forum_thread.php?comments_parentId=2&amp;forumId=1&#34;&gt;&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;File galleries changed:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:49: &lt;u&gt;admin&lt;/u&gt; uploaded the file &lt;a href=&#34;tiki-download_file.php?fileId=2&#34;&gt;tiki&lt;/a&gt; onto &lt;a href=&#34;tiki-list_file_gallery.php?galleryId=1&#34;&gt;File Galleries&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;New calendar events:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:50: &lt;u&gt;admin&lt;/u&gt; added or updated event &lt;a href=&#39;tiki-calendar_edit_item.php?viewcalitemId=1&#39;&gt;&lt;/a&gt;&lt;br&gt;
+&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:51: &lt;u&gt;admin&lt;/u&gt; added the wiki page &lt;a href=&#34;tiki-index.php?page=HomePage&#34;&gt;HomePage&lt;/a&gt; to the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:51: &lt;u&gt;admin&lt;/u&gt; added the wiki page &lt;a href=&#34;tiki-index.php?page=My+Resume&#34;&gt;My Resume&lt;/a&gt; to the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;
+&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:52: &lt;u&gt;admin&lt;/u&gt; removed the wiki page &lt;a href=&#34;tiki-index.php?page=My+Resume&#34;&gt;My Resume&lt;/a&gt; from the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; edited the category &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;&lt;br&gt;
+&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; created the subcategory &lt;a href=&#34;tiki-browse_categories.php?parentId=2&amp;deep=off&#34;&gt;Child category&lt;/a&gt; in &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;Changes in categories:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:53: &lt;u&gt;admin&lt;/u&gt; removed the subcategory &lt;a href=&#34;tiki-browse_categories.php?parentId=2&amp;deep=off&#34;&gt;Child category&lt;/a&gt; from &lt;a href=&#34;tiki-browse_categories.php?parentId=1&amp;deep=off&#34;&gt;Test category&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;New blog posts:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:58: &lt;u&gt;admin&lt;/u&gt; replied to the blog &lt;a href=&#34;tiki-view_blog.php?blogId=1&#34;&gt;My Personal Blog&lt;/a&gt; &lt;a href=&#34;tiki-view_blog_post.php?postId=&#34;4&gt;&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;New articles submited:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 13:59: &lt;u&gt;admin&lt;/u&gt; created the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;Edited articles:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 14:00: &lt;u&gt;admin&lt;/u&gt; edited the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;
+&lt;b&gt;Articles deleted:&lt;/b&gt;&lt;br /&gt;
+&amp;nbsp;&amp;nbsp;&amp;nbsp;2012-03-30 14:00: &lt;u&gt;admin&lt;/u&gt; removed the article &lt;a href=&#34;tiki-read_article.php?articleId=3&#34;&gt;Test article&lt;/a&gt;.&lt;br&gt;
+&lt;br /&gt;&lt;br /&gt;
+
 You are receiving notification emails grouped in a periodic digest. To receive them individually when posted instead, change your preferences at &lt;a href=tiki-user_watches.php&gt;tiki-user_watches.php&lt;/a&gt;
\ No newline at end of file

Modified: branches/9.x/templates/mail/report.tpl
===================================================================
--- branches/9.x/templates/mail/report.tpl	2012-03-31 02:25:10 UTC (rev 40561)
+++ branches/9.x/templates/mail/report.tpl	2012-03-31 02:26:19 UTC (rev 40562)
@@ -1,12 +1,13 @@
-{tr _0=$report_user}Report for %0{/tr}.
+{tr _0=$report_user}Report for %0{/tr}.{if $report_preferences.type eq &#39;html&#39;}&lt;br /&gt;&lt;br /&gt;{/if}
 
-{tr _0=$report_last_report_date}Last Report sent on %0.{/tr}
+{tr _0=$report_last_report_date}Last Report sent on %0.{/tr}{if $report_preferences.type eq &#39;html&#39;}&lt;br /&gt;&lt;br /&gt;{/if}
 
-{if $report_preferences.type eq &#39;html&#39;}&lt;u&gt;{/if}{tr}Changes in detail:{/tr}{if $report_preferences.type eq &#39;html&#39;}&lt;/u&gt;{else}
+{if $report_preferences.type eq &#39;html&#39;}&lt;u&gt;{/if}{tr}Changes in detail:{/tr}{if $report_preferences.type eq &#39;html&#39;}&lt;/u&gt;&lt;br /&gt;&lt;br /&gt;{else}
 
 -----------------------
 {/if}
 
-{$report_body}
+{$report_body}{if $report_preferences.type eq &#39;html&#39;}&lt;br /&gt;&lt;br /&gt;{/if}
 
+
 {tr _0=$userWatchesUrl}You are receiving notification emails grouped in a periodic digest. To receive them individually when posted instead, change your preferences at %0{/tr}
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29066854">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29066854/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40566] branches/9.x</a></b></div>
      
      <small>From: &lt;jyhem@us...&gt; - 2012-03-31 15:02:35</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40566
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40566&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40566&amp;view=rev</a>
Author:   jyhem
Date:     2012-03-31 15:02:29 +0000 (Sat, 31 Mar 2012)
Log Message:
-----------
[FIX] Correct csv import for country selectors containing a space. Allow easier access to importing

Modified Paths:
--------------
    branches/9.x/lib/trackers/trackerlib.php
    branches/9.x/templates/tiki-view_tracker.tpl

Modified: branches/9.x/lib/trackers/trackerlib.php
===================================================================
--- branches/9.x/lib/trackers/trackerlib.php	2012-03-31 14:32:18 UTC (rev 40565)
+++ branches/9.x/lib/trackers/trackerlib.php	2012-03-31 15:02:29 UTC (rev 40566)
@@ -1715,6 +1715,9 @@
 						case &#39;s&#39;:
 							$data[$i] = &#39;&#39;;
 										break;
+						case &#39;y&#39;:	// Country selector
+							$data[$i] = preg_replace(&#39;/ /&#39;, &#34;_&#34;, $data[$i]);
+										break;
 						case &#39;a&#39;:
 							$data[$i] = preg_replace(&#39;/\%\%\%/&#39;, &#34;\r\n&#34;, $data[$i]);
 										break;

Modified: branches/9.x/templates/tiki-view_tracker.tpl
===================================================================
--- branches/9.x/templates/tiki-view_tracker.tpl	2012-03-31 14:32:18 UTC (rev 40565)
+++ branches/9.x/templates/tiki-view_tracker.tpl	2012-03-31 15:02:29 UTC (rev 40566)
@@ -16,6 +16,23 @@
 	{if $prefs.feed_tracker eq &#34;y&#34;}
 		&lt;a href=&#34;tiki-tracker_rss.php?trackerId={$trackerId}&#34;&gt;{icon _id=&#39;feed&#39; align=&#34;right&#34; hspace=&#34;1&#34; alt=&#34;{tr}RSS feed{/tr}&#34;}&lt;/a&gt;
 	{/if}
+	{if $tiki_p_admin_trackers}
+		&lt;a title=&#34;{tr}Import{/tr}&#34; class=&#34;import dialog&#34; href=&#34;{service controller=tracker action=import_items trackerId=$trackerId}&#34;&gt;{icon _id=&#39;upload&#39; align=&#34;right&#34; alt=&#34;{tr}Import{/tr}&#34;}&lt;/a&gt;
+		{jq}
+			$(&#39;.import.dialog&#39;).click(function () {
+				var link = this;
+				$(this).serviceDialog({
+					title: &#39;{tr}Import{/tr}&#39;,
+					data: {
+						controller: &#39;tracker&#39;,
+						action: &#39;import_items&#39;,
+						trackerId: {{$trackerId}}
+					}
+				});
+				return false;
+			});
+		{/jq}
+	{/if}
 	{if $tiki_p_export_tracker eq &#34;y&#34;}
 		&lt;a title=&#34;{tr}Export{/tr}&#34; class=&#34;export dialog&#34; href=&#34;{service controller=tracker action=export trackerId=$trackerId}&#34;&gt;{icon _id=&#39;disk&#39; align=&#34;right&#34; alt=&#34;{tr}Export{/tr}&#34;}&lt;/a&gt;
 		{jq}
@@ -29,7 +46,6 @@
 						trackerId: {{$trackerId}}
 					}
 				});
-	
 				return false;
 			});
 		{/jq}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29067081">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29067081/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40567] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-03-31 16:21:30</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40567
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40567&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40567&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-03-31 16:21:22 +0000 (Sat, 31 Mar 2012)
Log Message:
-----------
[FIX] wiki wysiwyg: Unlock a bunch of toolbar buttons that work ok in either mode; SpecialChar, tikilink &amp; other Dialog tools, fullscreen, help (with new help file tpl) and wiki plugins

Modified Paths:
--------------
    branches/9.x/lib/toolbars/toolbarslib.php

Added Paths:
-----------
    branches/9.x/templates/tiki-edit_help_wiki_wysiwyg.tpl

Modified: branches/9.x/lib/toolbars/toolbarslib.php
===================================================================
--- branches/9.x/lib/toolbars/toolbarslib.php	2012-03-31 15:02:29 UTC (rev 40566)
+++ branches/9.x/lib/toolbars/toolbarslib.php	2012-03-31 16:21:22 UTC (rev 40567)
@@ -974,9 +974,11 @@
 		switch ($this-&gt;wysiwyg) {
 			case &#39;BGColor&#39;:
 			case &#39;TextColor&#39;:
-				 return $this-&gt;wysiwyg;
-	    	 break;
-			default: return null;
+			case &#39;SpecialChar&#39;:
+				return $this-&gt;wysiwyg;
+	    		break;
+			default:
+				return null;
 		}
 	} // }}}
 	
@@ -1243,6 +1245,18 @@
 		return $this-&gt;wysiwyg;
 	} // }}}
 	
+	function getWysiwygWikiToken( $areaId ) // {{{ // wysiwyg_htmltowiki
+	{
+		switch ($this-&gt;name) {
+			case &#39;tikilink&#39;:
+				$this-&gt;wysiwyg = &#39;tikilink&#39;;
+				break;
+			default:
+		}
+
+		return $this-&gt;getWysiwygToken($areaId);
+	} // }}}
+
 }
 
 class ToolbarFullscreen extends Toolbar
@@ -1265,6 +1279,12 @@
 		);
 
 	} // }}}
+
+	function getWysiwygWikiToken( $areaId ) // {{{ // wysiwyg_htmltowiki
+	{
+		return $this-&gt;getWysiwygToken($areaId);
+	} // }}}
+
 }
 
 class ToolbarHelptool extends Toolbar
@@ -1307,12 +1327,20 @@
 		$plugins = $wikilib-&gt;list_plugins(true, $areaId);
 		
 		$smarty-&gt;assign_by_ref(&#39;plugins&#39;, $plugins);
-		$exec_js = $smarty-&gt;fetch(&#39;tiki-edit_help_wysiwyg.tpl&#39;) .
-				$smarty-&gt;fetch(&#39;tiki-edit_help_plugins.tpl&#39;);
-		
+
+		global $prefs;
+		if ($prefs[&#39;wysiwyg_htmltowiki&#39;] === &#39;y&#39;) {
+			$exec_js = $smarty-&gt;fetch(&#39;tiki-edit_help_wiki_wysiwyg.tpl&#39;) .
+					$smarty-&gt;fetch(&#39;tiki-edit_help_plugins.tpl&#39;);
+			$this-&gt;setLabel(tra(&#39;Wiki Wysiwyg Help&#39;));
+		} else {
+			$exec_js = $smarty-&gt;fetch(&#39;tiki-edit_help_wysiwyg.tpl&#39;) .
+					$smarty-&gt;fetch(&#39;tiki-edit_help_plugins.tpl&#39;);
+			$this-&gt;setLabel(tra(&#39;Wysiwyg Help&#39;));
+		}
+
 		$name = &#39;tikihelp&#39;;
-		$this-&gt;setLabel(tra(&#39;Wysiwyg Help&#39;));
-		
+
 		global $headerlib;
 		$label = addcslashes($this-&gt;label, &#34;&#39;&#34;);
 		$headerlib-&gt;add_jq_onready(
@@ -1343,6 +1371,12 @@
 		);
 		return $name;
 	}
+
+	function getWysiwygWikiToken( $areaId ) // {{{ // wysiwyg_htmltowiki
+	{
+		return $this-&gt;getWysiwygToken($areaId);
+	} // }}}
+
 }
 
 class ToolbarFileGallery extends Toolbar
@@ -1381,6 +1415,11 @@
 		return $this-&gt;wysiwyg;
 	} // }}}
 
+	function getWysiwygWikiToken( $areaId ) // {{{ // wysiwyg_htmltowiki
+	{
+		return $this-&gt;getWysiwygToken($areaId);
+	} // }}}
+
 	function isAccessible() // {{{
 	{
 		return parent::isAccessible();
@@ -1576,6 +1615,18 @@
 		return $this-&gt;wysiwyg;
 	} // }}}
 	
+	function getWysiwygWikiToken( $areaId ) // {{{ // wysiwyg_htmltowiki
+	{
+		switch ($this-&gt;pluginName) {
+			case &#39;img&#39;:
+				$this-&gt;wysiwyg = &#39;&#39;;	// don&#39;t use ckeditor&#39;s html image dialog
+				break;
+			default:
+		}
+
+		return $this-&gt;getWysiwygToken($areaId);
+	} // }}}
+
 }
 
 class ToolbarSheet extends Toolbar

Copied: branches/9.x/templates/tiki-edit_help_wiki_wysiwyg.tpl (from rev 40563, branches/9.x/templates/tiki-edit_help_wysiwyg.tpl)
===================================================================
--- branches/9.x/templates/tiki-edit_help_wiki_wysiwyg.tpl	                        (rev 0)
+++ branches/9.x/templates/tiki-edit_help_wiki_wysiwyg.tpl	2012-03-31 16:21:22 UTC (rev 40567)
@@ -0,0 +1,59 @@
+{* $Id$ *}
+{* \brief Show wysiwyg help 
+ * included by tiki-show_help.tpl via smarty_block_add_help() *}
+
+{add_help show=&#39;y&#39; title=&#34;{tr}Wiki Wysiwyg Help{/tr}&#34; id=&#34;wiki_help&#34;}
+
+&lt;h3&gt;{tr}Wiki Wysiwyg Help{/tr}&lt;/h3&gt;
+&lt;div class=&#34;help_section&#34;&gt;
+{if $prefs.feature_help eq &#39;y&#39;} 
+&lt;p&gt;{tr}For more information, please see{/tr}
+	&lt;a href=&#34;{$prefs.helpurl}Wysiwyg+Editor&#34; target=&#34;tikihelp&#34; class=&#34;tikihelp&#34; title=&#34;{tr}Wysiwyg Editor:{/tr} {tr}More help on wysiwyg editing{/tr}&#34;&gt;
+		{tr}Wysiwyg Editor{/tr} {icon _id=&#39;help&#39; style=&#34;vertical-align:middle&#34;}
+	&lt;/a&gt;
+&lt;/p&gt;
+{/if}
+ 
+&lt;hr /&gt;
+&lt;p&gt;
+	{icon _id=&#34;star&#34;} {tr}WYSIWYG in wiki mode is an experimental feature in Tiki 7+ and uses
+	&lt;a href=&#34;<a href="http://ckeditor.com&#34;&gt;CKEditor&lt;/a&gt;{/tr}&lt;/p&gt" rel="nofollow">http://ckeditor.com&#34;&gt;CKEditor&lt;/a&gt;{/tr}&lt;/p&gt</a>;
+&lt;p&gt;
+	{tr}To switch modes between WYSIWYG and Wiki edit modes click the {icon _id=&#34;pencil_go&#34;} button on the toolbar.{/tr}&lt;/p&gt;
+&lt;p style=&#34;margin-left: 2em; &#34;&gt;
+	{tr}&lt;strong&gt;N.B. &lt;/strong&gt;Using this button changes the editor between WYSIWYG and the usual wiki editor, but leaves the page source in wiki syntax.{/tr}&lt;/p&gt;
+&lt;p&gt;
+	{icon _id=&#34;plugin&#34;} {tr}Wiki plugins can be used and edited in WYSIWYG mode, double click the plugin to bring up the plugin edit popup form.&lt;br /&gt;
+	Here is an example of the {ldelim}BOX{rdelim} plugin:{/tr}&lt;/p&gt;
+&lt;div style=&#34;background-color: #fff; padding: 1em;&#34;&gt;
+&lt;div class=&#34;tiki_plugin&#34; plugin=&#34;box&#34; style=&#34;position:relative; background-color: #eee; border: 1px solid #666;&#34;&gt;
+	&lt;div contenteditable=&#34;false&#34;&gt;
+		&lt;img src=&#34;img/icons/wiki_plugin_edit.png&#34; width=&#34;16&#34; height=&#34;16&#34; style=&#34;float:left;position:absolute;z-index:10001&#34;/&gt;
+		&lt;table align=&#34;center&#34; width=&#34;80%&#34;&gt;
+			&lt;tr&gt;&lt;td&gt;
+				&lt;div class=&#39;cbox &#39; style=&#39; background:#fffff0&#39;&gt;&lt;div class=&#39;cbox-data&#39; style=&#34; background:#fffff0&#34;&gt;
+					{tr}This is the text in the box which is justified; the box has a cream background, takes 80% of the screen width and is centred.{/tr}
+    			&lt;/div&gt;&lt;/div&gt;
+    		&lt;/td&gt;&lt;/tr&gt;
+    	&lt;/table&gt;
+	&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;p style=&#34;margin-left: 2em;&#34;&gt;
+	{icon _id=&#34;error&#34;} {tr}&lt;strong&gt;Caution:&lt;/strong&gt; This is a new feature and still work in progress.&lt;br /&gt;
+	If you intend to use plugins extensively in a page consider editing that page in wiki mode only.&lt;br /&gt;
+	Currently (in Tiki 9.0) drag and drop of plugins in WYSIWYG does not work.{/tr}&lt;/p&gt;
+
+	{if $tiki_p_admin eq &#34;y&#34;}
+		&lt;hr style=&#34;border-width: 1px;&#34; /&gt;
+		&lt;p&gt;
+			{tr}&lt;strong&gt;Admins:&lt;/strong&gt;&lt;br /&gt;
+			&lt;em&gt;This new implementation is designed to work best with some site preferences set in a certain way.
+			These can all be found on the &lt;a href=&#34;tiki-admin.php?page=wysiwyg&#34;&gt;wysiwyg admin page&lt;/a&gt;.
+			A profile to set these up correctly can be found on &lt;a href=&#34;<a href="http://profiles.tiki.org/WYSIWYG_6x&#34;&gt;profiles.tiki.org&lt;/a&gt" rel="nofollow">http://profiles.tiki.org/WYSIWYG_6x&#34;&gt;profiles.tiki.org&lt;/a&gt</a>;
+			which can be applied using the &lt;a href=&#34;tiki-admin.php?page=profiles&#34;&gt;profiles admin page&lt;/a&gt;.&lt;/em&gt;{/tr}&lt;/p&gt;
+	{/if}
+
+&lt;/div&gt;
+
+{/add_help}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29070108">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29070108/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40585] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-01 14:44:56</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40585
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40585&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40585&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-01 14:44:50 +0000 (Sun, 01 Apr 2012)
Log Message:
-----------
[FIX] mobile: Make sure mobile_mode prefs is initialised (and remove a couple of now redundant checks)

Modified Paths:
--------------
    branches/9.x/templates/modules/mod-logo.tpl
    branches/9.x/templates/modules/mod-mobile.tpl
    branches/9.x/tiki-setup.php

Modified: branches/9.x/templates/modules/mod-logo.tpl
===================================================================
--- branches/9.x/templates/modules/mod-logo.tpl	2012-04-01 14:42:56 UTC (rev 40584)
+++ branches/9.x/templates/modules/mod-logo.tpl	2012-04-01 14:44:50 UTC (rev 40585)
@@ -2,12 +2,12 @@
 
 {tikimodule error=$module_params.error title=$tpl_module_title name=&#34;logo&#34; flip=$module_params.flip decorations=$module_params.decorations nobox=$module_params.nobox notitle=$module_params.notitle}
    &lt;div id=&#34;sitelogo&#34;{if $prefs.sitelogo_bgcolor ne &#39;&#39;} style=&#34;background-color: {$prefs.sitelogo_bgcolor};&#34; {/if} class=&#34;floatleft&#34;&gt;
-      {if $prefs.sitelogo_src}&lt;a href=&#34;./&#34; title=&#34;{$prefs.sitelogo_title}&#34;{if isset($prefs.mobile_mode) &amp;&amp; $prefs.mobile_mode eq &#34;y&#34;} rel=&#34;external&#34;{/if}&gt;&lt;img src=&#34;{$prefs.sitelogo_src}&#34; alt=&#34;{$prefs.sitelogo_alt}&#34; style=&#34;border: none&#34; /&gt;&lt;/a&gt;
+      {if $prefs.sitelogo_src}&lt;a href=&#34;./&#34; title=&#34;{$prefs.sitelogo_title}&#34;{if $prefs.mobile_mode eq &#34;y&#34;} rel=&#34;external&#34;{/if}&gt;&lt;img src=&#34;{$prefs.sitelogo_src}&#34; alt=&#34;{$prefs.sitelogo_alt}&#34; style=&#34;border: none&#34; /&gt;&lt;/a&gt;
       {/if}
    &lt;/div&gt;
    &lt;div id=&#34;sitetitles&#34; class=&#34;floatleft&#34;&gt;
       &lt;div id=&#34;sitetitle&#34;&gt;
-		  {if !empty($prefs.sitetitle)}&lt;a href=&#34;./&#34;{if isset($prefs.mobile_mode) &amp;&amp; $prefs.mobile_mode eq &#34;y&#34;} rel=&#34;external&#34;{/if}&gt;{$prefs.sitetitle}&lt;/a&gt;{/if}
+		  {if !empty($prefs.sitetitle)}&lt;a href=&#34;./&#34;{if $prefs.mobile_mode eq &#34;y&#34;} rel=&#34;external&#34;{/if}&gt;{$prefs.sitetitle}&lt;/a&gt;{/if}
 	  &lt;/div&gt;
       &lt;div id=&#34;sitesubtitle&#34;&gt;{if !empty($prefs.sitesubtitle)}{$prefs.sitesubtitle}{/if}&lt;/div&gt;
    &lt;/div&gt;

Modified: branches/9.x/templates/modules/mod-mobile.tpl
===================================================================
--- branches/9.x/templates/modules/mod-mobile.tpl	2012-04-01 14:42:56 UTC (rev 40584)
+++ branches/9.x/templates/modules/mod-mobile.tpl	2012-04-01 14:44:50 UTC (rev 40585)
@@ -1,6 +1,6 @@
 {* $Id$ *}
 {tikimodule error=$module_params.error title=$tpl_module_title name=$tpl_module_name flip=$module_params.flip decorations=$module_params.decorations nobox=$module_params.nobox notitle=$module_params.notitle}
-	{if !isset($prefs.mobile_mode) or $prefs.mobile_mode neq &#39;y&#39;}
+	{if $prefs.mobile_mode neq &#39;y&#39;}
 		{self_link _ajax=&#39;n&#39; _onclick=&#34;setCookie(&#39;mobile_mode&#39;,&#39;y&#39;, &#39;&#39;, &#39;session&#39;);return true;&#34;}{$module_params.to_label}{/self_link}
 	{elseif empty($mobile_params.switch_perspective) or $mobile_params.switch_perspective eq &#34;y&#34;}
 		{if empty($mobile_params.stay_on_same_page)}{assign var=stay_on_same_page value=&#34;1&#34;}{else}{assign var=stay_on_same_page value=&#34;0&#34;}{/if}

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-04-01 14:42:56 UTC (rev 40584)
+++ branches/9.x/tiki-setup.php	2012-04-01 14:44:50 UTC (rev 40585)
@@ -84,6 +84,8 @@
 
 if ($prefs[&#39;mobile_feature&#39;] === &#39;y&#39;) {
 	require_once (&#39;lib/setup/mobile.php&#39;);	// needs to be before js_detect
+} else {
+	$prefs[&#39;mobile_mode&#39;] = &#39;&#39;;
 }
 
 require_once (&#39;lib/setup/cookies.php&#39;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29070118">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29070118/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40586] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-01 14:48:07</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40586
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40586&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40586&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-01 14:48:00 +0000 (Sun, 01 Apr 2012)
Log Message:
-----------
[FIX] mobile: Make filegal thumbnail clicks rel:external for mobile (so they work, and rollback inorrect caching fix in tiki-download_file.php). Also improve button display in filegals

Modified Paths:
--------------
    branches/9.x/templates/browse_file_gallery.tpl
    branches/9.x/templates/tiki-list_file_gallery.tpl
    branches/9.x/tiki-download_file.php

Modified: branches/9.x/templates/browse_file_gallery.tpl
===================================================================
--- branches/9.x/templates/browse_file_gallery.tpl	2012-04-01 14:44:50 UTC (rev 40585)
+++ branches/9.x/templates/browse_file_gallery.tpl	2012-04-01 14:48:00 UTC (rev 40586)
@@ -81,6 +81,7 @@
           {else}
             href=&#34;{if $prefs.javascript_enabled eq &#39;y&#39; &amp;&amp; $files[changes].type|truncate:5:&#39;&#39;:true eq &#39;image&#39;}{$files[changes].id|sefurl:preview}{elseif $files[changes].type|truncate:5:&#39;&#39;:true neq &#39;image&#39;}{$files[changes].id|sefurl:file}{else}{$files[changes].id|sefurl:display}{/if}&#34;
           {/if}
+		  {if $prefs.mobile_mode eq &#39;y&#39;} rel=&#34;external&#34;{/if}
         {/if}
       {/if}
     {/strip}{/capture}

Modified: branches/9.x/templates/tiki-list_file_gallery.tpl
===================================================================
--- branches/9.x/templates/tiki-list_file_gallery.tpl	2012-04-01 14:44:50 UTC (rev 40585)
+++ branches/9.x/templates/tiki-list_file_gallery.tpl	2012-04-01 14:48:00 UTC (rev 40586)
@@ -27,7 +27,7 @@
 	&lt;/div&gt;
 {/if}
 
-&lt;div class=&#34;navbar&#34;&gt;
+&lt;div class=&#34;navbar&#34;{if $prefs.mobile_mode eq &#39;y&#39;} data-role=&#34;controlgroup&#34; data-type=&#34;horizontal&#34;{/if}&gt;
 	{if $galleryId gt 0}
 
 		{if $prefs.feature_group_watches eq &#39;y&#39; and ( $tiki_p_admin_users eq &#39;y&#39; or $tiki_p_admin eq &#39;y&#39; )}

Modified: branches/9.x/tiki-download_file.php
===================================================================
--- branches/9.x/tiki-download_file.php	2012-04-01 14:44:50 UTC (rev 40585)
+++ branches/9.x/tiki-download_file.php	2012-04-01 14:48:00 UTC (rev 40586)
@@ -184,7 +184,7 @@
 header(&#39;Expires: &#39;);
 header(&#39;Cache-Control: &#39;.( !empty($user) ? &#39;private&#39; : &#39;public&#39; ).&#39;,must-revalidate,post-check=0,pre-check=0&#39;);
 
-if ( $use_client_cache &amp;&amp; (empty($prefs[&#39;mobile_mode&#39;]) || $prefs[&#39;mobile_mode&#39;] !== &#39;y&#39;)) {
+if ( $use_client_cache) {
 	header(&#39;Status: 304 Not Modified&#39;, true, 304);
 	exit;
 } else {

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29070119">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29070119/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40587] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-01 14:51:00</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40587
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40587&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40587&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-01 14:50:54 +0000 (Sun, 01 Apr 2012)
Log Message:
-----------
[FIX] mobile: Disable a couple more incompatible features, put the untidy &#34;advanced&#34; search features in find.tpl in a collapsible block, and layout fix for filegals browse mode thumbnails/

Modified Paths:
--------------
    branches/9.x/lib/setup/mobile.php
    branches/9.x/styles/mobile.css
    branches/9.x/templates/styles/mobile/find.tpl

Modified: branches/9.x/lib/setup/mobile.php
===================================================================
--- branches/9.x/lib/setup/mobile.php	2012-04-01 14:48:00 UTC (rev 40586)
+++ branches/9.x/lib/setup/mobile.php	2012-04-01 14:50:54 UTC (rev 40587)
@@ -38,6 +38,8 @@
 		$prefs[&#39;ajax_autosave&#39;] = &#39;n&#39;;
 		$prefs[&#39;change_theme&#39;] = &#39;n&#39;;
 		$prefs[&#39;feature_syntax_highlighter&#39;] = &#39;n&#39;;
+		$prefs[&#39;feature_shadowbox&#39;] = &#39;n&#39;;
+		$prefs[&#39;jquery_ui_selectmenu&#39;] = &#39;n&#39;;
 
 		$headerlib-&gt;add_js(&#39;function sfHover() {alert(&#34;not working?&#34;);}&#39;, 100);	// try and override the css menu func
 

Modified: branches/9.x/styles/mobile.css
===================================================================
--- branches/9.x/styles/mobile.css	2012-04-01 14:48:00 UTC (rev 40586)
+++ branches/9.x/styles/mobile.css	2012-04-01 14:50:54 UTC (rev 40587)
@@ -201,7 +201,7 @@
 	background: #FEEAA1;
 }
 
-/* Generic find.tpl */
+/* Generic find.tpl
 
 .find-div label,
 .find-div span,
@@ -221,5 +221,10 @@
 
 .find-div label.findsubmit {
 	line-height: inherit;
-}
+} */
 
+/* filegals */
+
+.thumbnailcontener {
+	float: left;
+}
\ No newline at end of file

Modified: branches/9.x/templates/styles/mobile/find.tpl
===================================================================
--- branches/9.x/templates/styles/mobile/find.tpl	2012-04-01 14:48:00 UTC (rev 40586)
+++ branches/9.x/templates/styles/mobile/find.tpl	2012-04-01 14:50:54 UTC (rev 40587)
@@ -42,12 +42,16 @@
 		{else}
 			{tr}{$whatlabel}{/tr}
 		{/if}
+
 	&lt;/label&gt;
 		&lt;input type=&#34;text&#34; name=&#34;find&#34; id=&#34;find&#34; value=&#34;{$find|escape}&#34; data-type=&#34;search&#34; /&gt;
 		{if isset($autocomplete)}
 			{jq}$(&#34;#find&#34;).tiki(&#34;autocomplete&#34;, &#34;{{$autocomplete}}&#34;){/jq}
 		{/if}
 
+&lt;div data-role=&#34;collapsible&#34; data-collapsed=&#34;true&#34;&gt;
+	&lt;h3&gt;{tr}More search options{/tr}&lt;/h3&gt;
+	&lt;div data-role=&#34;controlgroup&#34;&gt;
 {if isset($exact_match)}
 	&lt;label class=&#34;findexactmatch&#34; for=&#34;findexactmatch&#34; style=&#34;white-space: nowrap&#34;&gt;
 			{tr}Exact match{/tr}
@@ -58,7 +62,6 @@
 {if !empty($find_show_sub) and $find_show_sub eq &#39;y&#39;}
 	&lt;label class=&#34;findsub&#34;&gt;
 		{tr}and all the sub-objects{/tr}
-		&lt;input type=&#34;checkbox&#34; name=&#34;find_sub&#34; id=&#34;find_sub&#34; {if !empty($find_sub) and $find_sub eq &#39;y&#39;}checked=&#34;checked&#34;{/if}/&gt;
 	&lt;/label&gt;
 {/if}
 
@@ -223,7 +226,8 @@
 			&lt;input type=&#34;text&#34; name=&#34;maxRecords&#34; id=&#34;findnumrows&#34; value=&#34;{$maxRecords|escape}&#34; size=&#34;3&#34; /&gt;
 	&lt;/label&gt;
 {/if}
-
+	&lt;/div&gt;
+&lt;/div&gt;
 &lt;label class=&#34;findsubmit&#34;&gt;
 	&lt;input type=&#34;submit&#34; name=&#34;search&#34; value=&#34;{tr}Go{/tr}&#34; /&gt;
 	{if $find ne &#39;&#39;}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29070570">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29070570/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40594] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-01 17:15:51</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40594
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40594&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40594&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-01 17:15:43 +0000 (Sun, 01 Apr 2012)
Log Message:
-----------
[ENH] mobile (currently experimental anyway): Use photoswipe for images where feature_shadowbox = y

Modified Paths:
--------------
    branches/9.x/lib/jquery_tiki/tiki-jquery.mobile.js
    branches/9.x/lib/setup/mobile.php
    branches/9.x/templates/browse_file_gallery.tpl

Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.mobile.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-jquery.mobile.js	2012-04-01 17:08:50 UTC (rev 40593)
+++ branches/9.x/lib/jquery_tiki/tiki-jquery.mobile.js	2012-04-01 17:15:43 UTC (rev 40594)
@@ -16,5 +16,24 @@
 				// callback after js loaded
 			} );
 		}
+	}).live(&#34;pageshow&#34;, function(e) {
+
+		var currentPage = $(e.target), options = {};
+		var $images = $(&#34;a[rel*=\&#39;box\&#39;][rel*=\&#39;type=img\&#39;], a[rel*=\&#39;box\&#39;][rel!=\&#39;type=\&#39;]&#34;, e.target);
+		if ($images.length) {
+			$images.photoSwipe(options,  currentPage.attr(&#34;id&#34;));
+		}
+		return true;
+
+	}).live(&#34;pagehide&#34;, function(e) {
+
+		if (typeof PhotoSwipe !== &#34;undefined&#34;) {
+			var currentPage = $(e.target), photoSwipeInstance = PhotoSwipe.getInstance(currentPage.attr(&#34;id&#34;));
+
+			if (typeof photoSwipeInstance != &#34;undefined&#34; &amp;&amp; photoSwipeInstance != null) {
+				PhotoSwipe.detatch(photoSwipeInstance);
+			}
+		}
+		return true;
 	});
 });

Modified: branches/9.x/lib/setup/mobile.php
===================================================================
--- branches/9.x/lib/setup/mobile.php	2012-04-01 17:08:50 UTC (rev 40593)
+++ branches/9.x/lib/setup/mobile.php	2012-04-01 17:15:43 UTC (rev 40594)
@@ -38,11 +38,17 @@
 		$prefs[&#39;ajax_autosave&#39;] = &#39;n&#39;;
 		$prefs[&#39;change_theme&#39;] = &#39;n&#39;;
 		$prefs[&#39;feature_syntax_highlighter&#39;] = &#39;n&#39;;
-		$prefs[&#39;feature_shadowbox&#39;] = &#39;n&#39;;
 		$prefs[&#39;jquery_ui_selectmenu&#39;] = &#39;n&#39;;
 
 		$headerlib-&gt;add_js(&#39;function sfHover() {alert(&#34;not working?&#34;);}&#39;, 100);	// try and override the css menu func
 
+		if ($prefs[&#39;feature_shadowbox&#39;] === &#39;y&#39;) {
+			$headerlib
+				-&gt;add_jsfile(&#39;lib/jquery/code.photoswipe/lib/klass.min.js&#39;)
+				-&gt;add_jsfile(&#34;lib/jquery/code.photoswipe/code.photoswipe.jquery-3.0.4.js&#34;)
+				-&gt;add_cssfile(&#39;lib/jquery/code.photoswipe/photoswipe.css&#39;);
+		}
+
 		// a few requirements
 		$prefs[&#39;feature_html_head_base_tag&#39;] = &#39;y&#39;;
 		$prefs[&#39;style&#39;] = &#39;mobile.css&#39;; // set in perspectives but seems to need a nudge here

Modified: branches/9.x/templates/browse_file_gallery.tpl
===================================================================
--- branches/9.x/templates/browse_file_gallery.tpl	2012-04-01 17:08:50 UTC (rev 40593)
+++ branches/9.x/templates/browse_file_gallery.tpl	2012-04-01 17:15:43 UTC (rev 40594)
@@ -81,7 +81,6 @@
           {else}
             href=&#34;{if $prefs.javascript_enabled eq &#39;y&#39; &amp;&amp; $files[changes].type|truncate:5:&#39;&#39;:true eq &#39;image&#39;}{$files[changes].id|sefurl:preview}{elseif $files[changes].type|truncate:5:&#39;&#39;:true neq &#39;image&#39;}{$files[changes].id|sefurl:file}{else}{$files[changes].id|sefurl:display}{/if}&#34;
           {/if}
-		  {if $prefs.mobile_mode eq &#39;y&#39;} rel=&#34;external&#34;{/if}
         {/if}
       {/if}
     {/strip}{/capture}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29070744">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29070744/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40600] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-01 18:22:00</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40600
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40600&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40600&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-01 18:21:52 +0000 (Sun, 01 Apr 2012)
Log Message:
-----------
[FIX] carousel: Some plugin fixes for the recent update to InfiniteCarousel v3 and some basic styling for the button/thumbs

Modified Paths:
--------------
    branches/9.x/lib/wiki-plugins/wikiplugin_carousel.php
    branches/9.x/styles/layout/design.css

Modified: branches/9.x/lib/wiki-plugins/wikiplugin_carousel.php
===================================================================
--- branches/9.x/lib/wiki-plugins/wikiplugin_carousel.php	2012-04-01 17:51:31 UTC (rev 40599)
+++ branches/9.x/lib/wiki-plugins/wikiplugin_carousel.php	2012-04-01 18:21:52 UTC (rev 40600)
@@ -58,8 +58,7 @@
 			),
 			&#39;displayProgressBar&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
-				&#39;name&#39; =&gt; tra(&#39;Display progress bar&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Display progress bar.&#39;),
+				&#39;name&#39; =&gt; tra(&#39;Display progress ring&#39;),
 				&#39;filter&#39; =&gt; &#39;digits&#39;,
 				&#39;options&#39; =&gt; array(
 					array(&#39;text&#39; =&gt; tra(&#39;Yes&#39;), &#39;value&#39; =&gt; &#39;1&#39;),
@@ -67,60 +66,89 @@
 				),
 				&#39;default&#39; =&gt; &#39;1&#39;,
 			),
+			&#39;thumbnailType&#39; =&gt; array(
+				&#39;required&#39; =&gt; false,
+				&#39;name&#39; =&gt; tra(&#39;Display thumbnails&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Display thumbnails, number, count etc.&#39;),
+				&#39;filter&#39; =&gt; &#39;text&#39;,
+				&#39;options&#39; =&gt; array(
+					array(&#39;text&#39; =&gt; tra(&#39;None&#39;), &#39;value&#39; =&gt; &#39;none&#39;),
+					array(&#39;text&#39; =&gt; tra(&#39;Buttons&#39;), &#39;value&#39; =&gt; &#39;buttons&#39;),
+					array(&#39;text&#39; =&gt; tra(&#39;Images&#39;), &#39;value&#39; =&gt; &#39;images&#39;),
+					array(&#39;text&#39; =&gt; tra(&#39;Numbers&#39;), &#39;value&#39; =&gt; &#39;numbers&#39;),
+					array(&#39;text&#39; =&gt; tra(&#39;Count&#39;), &#39;value&#39; =&gt; &#39;count&#39;),
+				),
+				&#39;default&#39; =&gt; &#39;none&#39;,
+			),
+			&#39;thumbnailWidth&#39; =&gt; array(
+				&#39;required&#39; =&gt; false,
+				&#39;name&#39; =&gt; tra(&#39;Thumbnail box width&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Width of thumbnail box in CSS units (default &#34;20px&#34;)&#39;),
+				&#39;filter&#39; =&gt; &#39;text&#39;,
+				&#39;default&#39; =&gt; &#39;20px&#39;,
+			),
+			&#39;thumbnailHeight&#39; =&gt; array(
+				&#39;required&#39; =&gt; false,
+				&#39;name&#39; =&gt; tra(&#39;Thumbnail box height&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Height of thumbnail box in CSS units (default &#34;20px&#34;)&#39;),
+				&#39;filter&#39; =&gt; &#39;text&#39;,
+				&#39;default&#39; =&gt; &#39;20px&#39;,
+			),
+			&#39;autoPilot&#39; =&gt; array(
+				&#39;required&#39; =&gt; false,
+				&#39;name&#39; =&gt; tra(&#39;Start automatically&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Move the carousel automatically when the page loads (default false).&#39;),
+				&#39;filter&#39; =&gt; &#39;digits&#39;,
+				&#39;options&#39; =&gt; array(
+					array(&#39;text&#39; =&gt; tra(&#39;Yes&#39;), &#39;value&#39; =&gt; &#39;1&#39;),
+					array(&#39;text&#39; =&gt; tra(&#39;No&#39;), &#39;value&#39; =&gt; &#39;0&#39;),
+				),
+				&#39;default&#39; =&gt; &#39;0&#39;,
+			),
 			&#39;displayThumbnails&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
 				&#39;name&#39; =&gt; tra(&#39;Display thumbnails&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Display thumbnails.&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Legacy v2 param:&#39;) . &#39; &#39; . tra(&#39;Display thumbnails.&#39;),
 				&#39;filter&#39; =&gt; &#39;digits&#39;,
 				&#39;options&#39; =&gt; array(
 					array(&#39;text&#39; =&gt; tra(&#39;Yes&#39;), &#39;value&#39; =&gt; &#39;1&#39;),
 					array(&#39;text&#39; =&gt; tra(&#39;No&#39;), &#39;value&#39; =&gt; &#39;0&#39;),
 				),
 				&#39;default&#39; =&gt; &#39;1&#39;,
+				&#39;advanced&#39; =&gt; true,
 			),
 			&#39;displayThumbnailNumbers&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
 				&#39;name&#39; =&gt; tra(&#39;Display place numbers in the thumbnail boxes&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Display place numbers in the thumbnail boxes.&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Legacy v2 param:&#39;) . &#39; &#39; . tra(&#39;Display place numbers in the thumbnail boxes.&#39;),
 				&#39;filter&#39; =&gt; &#39;digits&#39;,
 				&#39;options&#39; =&gt; array(
 					array(&#39;text&#39; =&gt; tra(&#39;Yes&#39;), &#39;value&#39; =&gt; &#39;1&#39;),
 					array(&#39;text&#39; =&gt; tra(&#39;No&#39;), &#39;value&#39; =&gt; &#39;0&#39;),
 				),
 				&#39;default&#39; =&gt; &#39;1&#39;,
+				&#39;advanced&#39; =&gt; true,
 			),
 			&#39;displayThumbnailBackground&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
 				&#39;name&#39; =&gt; tra(&#39;Use corresponding image as background for a thumbnail box&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Use corresponding image as background for a thumbnail box.&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Legacy v2 param:&#39;) . &#39; &#39; . tra(&#39;Use corresponding image as background for a thumbnail box.&#39;),
 				&#39;filter&#39; =&gt; &#39;digits&#39;,
 				&#39;options&#39; =&gt; array(
 					array(&#39;text&#39; =&gt; tra(&#39;Yes&#39;), &#39;value&#39; =&gt; &#39;1&#39;),
 					array(&#39;text&#39; =&gt; tra(&#39;No&#39;), &#39;value&#39; =&gt; &#39;0&#39;),
 				),
 				&#39;default&#39; =&gt; &#39;1&#39;,
+				&#39;advanced&#39; =&gt; true,
 			),
-			&#39;thumbnailWidth&#39; =&gt; array(
-				&#39;required&#39; =&gt; false,
-				&#39;name&#39; =&gt; tra(&#39;Thumbnail box width&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Width of thumbnail box in CSS units (default &#34;20px&#34;)&#39;),
-				&#39;filter&#39; =&gt; &#39;text&#39;,
-				&#39;default&#39; =&gt; &#39;20px&#39;,
-			),
-			&#39;thumbnailHeight&#39; =&gt; array(
-				&#39;required&#39; =&gt; false,
-				&#39;name&#39; =&gt; tra(&#39;Thumbnail box height&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Height of thumbnail box in CSS units (default &#34;20px&#34;)&#39;),
-				&#39;filter&#39; =&gt; &#39;text&#39;,
-				&#39;default&#39; =&gt; &#39;20px&#39;,
-			),
 			&#39;thumbnailFontSize&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
 				&#39;name&#39; =&gt; tra(&#39;Thumbnail box font size&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Font size of thumbnail box in CSS units (default &#34;.7em&#34;).&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Legacy v2 param:&#39;) . &#39; &#39; . tra(&#39;Font size of thumbnail box in CSS units (default &#34;.7em&#34;).&#39;),
 				&#39;filter&#39; =&gt; &#39;text&#39;,
 				&#39;accepted&#39; =&gt; tra(&#39;real between 0 and 1&#39;),
 				&#39;default&#39; =&gt; &#39;.7em&#39;,
+				&#39;advanced&#39; =&gt; true,
 			),
 		),
 	);
@@ -144,18 +172,44 @@
 	}
 
 	unset($params[&#39;fgalId&#39;], $params[&#39;sort_mode&#39;]);
-	$params[&#39;displayProgressBar&#39;] = ($params[&#39;displayProgressBar&#39;] == 1);
-	$params[&#39;displayThumbnails&#39;] = ($params[&#39;displayThumbnails&#39;] == 1);
-	$params[&#39;displayThumbnailNumbers&#39;] = ($params[&#39;displayThumbnailNumbers&#39;] == 1);
-	$params[&#39;displayThumbnailBackground&#39;] = ($params[&#39;displayThumbnailBackground&#39;] == 1);
+
+	$params[&#39;displayProgressRing&#39;] = ($params[&#39;displayProgressBar&#39;] == 1);
+
+	if (empty($params[&#39;thumbnailType&#39;])) {
+		$displayThumbnails = ($params[&#39;displayThumbnails&#39;] == 1);
+		$displayThumbnailNumbers = ($params[&#39;displayThumbnailNumbers&#39;] == 1);
+		$displayThumbnailBackground = ($params[&#39;displayThumbnailBackground&#39;] == 1);
+
+		if ($displayThumbnailNumbers) {
+			$params[&#39;thumbnailType&#39;]= &#39;numbers&#39;;
+		}
+		if ($displayThumbnails) {
+			$params[&#39;thumbnailType&#39;]= &#39;images&#39;;
+		}
+	}
+
 	foreach ( $params as &amp;$param) {
 		if (is_numeric($param)) {
 			$param = (float) $param;	// seems to leave ints as ints
 		}
 	}
+
+ 	if ($params[&#39;thumbnailType&#39;] === &#39;images&#39;) {
+		TikiLib::lib(&#39;header&#39;)-&gt;add_css(&#34;.ic_button { float: left; width: {$params[&#39;thumbnailWidth&#39;]}; height: {$params[&#39;thumbnailHeight&#39;]};}&#34;);
+	}
+
+	unset(
+		$params[&#39;displayProgressBar&#39;],
+		$params[&#39;displayThumbnails&#39;],
+		$params[&#39;displayThumbnailNumbers&#39;],
+		$params[&#39;displayThumbnailBackground&#39;],
+		$params[&#39;thumbnailWidth&#39;],
+		$params[&#39;thumbnailHeight&#39;],
+		$params[&#39;thumbnailFontSize&#39;]
+	);
 	
 	TikiLib::lib(&#39;header&#39;)-&gt;add_jq_onready(&#39;setTimeout( function() { $(&#34;#&#39; . $unique . &#39;&#34;).tiki(&#34;carousel&#34;, &#34;&#34;, &#39;. json_encode($params).&#39;); }, 1000);&#39;);
-	
+
 	$html = &#39;&lt;div id=&#34;&#39;.$unique.&#39;&#34; class=&#34;clearfix carousel&#34; style=&#34;width: 1px; height: 1px; overflow: hidden&#34;&gt;&lt;ul&gt;&#39;;
 	foreach ($files[&#39;data&#39;] as $file) {
 		$html .= &#39;&lt;li&gt;&lt;img src=&#34;tiki-download_file.php?fileId=&#39;.$file[&#39;fileId&#39;].&#39;&amp;amp;display&#34; alt=&#34;&#39;.htmlentities($file[&#39;description&#39;]).&#39;&#34; /&gt;&#39;;

Modified: branches/9.x/styles/layout/design.css
===================================================================
--- branches/9.x/styles/layout/design.css	2012-04-01 17:51:31 UTC (rev 40599)
+++ branches/9.x/styles/layout/design.css	2012-04-01 18:21:52 UTC (rev 40600)
@@ -757,6 +757,22 @@
 	margin-right: 5px;
 }
 
+/* wikiplugin_carousel v3 */
+
+.ic_button {
+    float: left;
+    margin: 0 2px 0  0;
+    border: 2px solid #eee;
+	width: 20px;
+	height: 20px;
+}
+
+.ic_active {
+    border: 2px solid #800;
+}
+
+/* end plugins */
+
 .magnify {
 	float: right;
 	padding-top: 2px;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29074198">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074198/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40643] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-02 13:52:30</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40643
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40643&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40643&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-02 13:52:21 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[ENH] Renamed am moving to dev tools next commit

Added Paths:
-----------
    branches/9.x/backup.php

Removed Paths:
-------------
    branches/9.x/tiki-backup.php

Copied: branches/9.x/backup.php (from rev 40641, branches/9.x/tiki-backup.php)
===================================================================
--- branches/9.x/backup.php	                        (rev 0)
+++ branches/9.x/backup.php	2012-04-02 13:52:21 UTC (rev 40643)
@@ -0,0 +1,31 @@
+&lt;?php
+require_once(&#39;tiki-setup.php&#39;);
+$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
+$backup = &#34;&#34;;
+foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
+	$table = end($table);
+	$result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
+	$num_fields = count($result);
+	
+	$backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
+	$createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
+	$backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
+	
+	foreach ($result as $row) {
+		$fields = array();
+		
+		foreach ($row as $field) {
+			$field = addslashes($field);
+			$field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
+			$fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; : &#39;&#34;&#34;&#39;);
+		}
+		
+		$backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;, $fields).&#39;);&#39; . &#34;\n&#34;;
+	}
+	
+	$backup.=&#34;\n\n\n&#34;;
+}
+//save file
+$handle = fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
+fwrite($handle, $backup);
+fclose($handle);
\ No newline at end of file

Deleted: branches/9.x/tiki-backup.php
===================================================================
--- branches/9.x/tiki-backup.php	2012-04-02 13:49:16 UTC (rev 40642)
+++ branches/9.x/tiki-backup.php	2012-04-02 13:52:21 UTC (rev 40643)
@@ -1,31 +0,0 @@
-&lt;?php
-require_once(&#39;tiki-setup.php&#39;);
-$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
-$backup = &#34;&#34;;
-foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
-	$table = end($table);
-	$result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
-	$num_fields = count($result);
-	
-	$backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
-	$createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
-	$backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
-	
-	foreach ($result as $row) {
-		$fields = array();
-		
-		foreach ($row as $field) {
-			$field = addslashes($field);
-			$field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
-			$fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; : &#39;&#34;&#34;&#39;);
-		}
-		
-		$backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;, $fields).&#39;);&#39; . &#34;\n&#34;;
-	}
-	
-	$backup.=&#34;\n\n\n&#34;;
-}
-//save file
-$handle = fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
-fwrite($handle, $backup);
-fclose($handle);
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29074199">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074199/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40644] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-02 13:53:26</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40644
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40644&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40644&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-02 13:53:15 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[FIX] Put backup in right place

Added Paths:
-----------
    branches/9.x/doc/devtools/backup.php

Removed Paths:
-------------
    branches/9.x/backup.php

Deleted: branches/9.x/backup.php
===================================================================
--- branches/9.x/backup.php	2012-04-02 13:52:21 UTC (rev 40643)
+++ branches/9.x/backup.php	2012-04-02 13:53:15 UTC (rev 40644)
@@ -1,31 +0,0 @@
-&lt;?php
-require_once(&#39;tiki-setup.php&#39;);
-$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
-$backup = &#34;&#34;;
-foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
-	$table = end($table);
-	$result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
-	$num_fields = count($result);
-	
-	$backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
-	$createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
-	$backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
-	
-	foreach ($result as $row) {
-		$fields = array();
-		
-		foreach ($row as $field) {
-			$field = addslashes($field);
-			$field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
-			$fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; : &#39;&#34;&#34;&#39;);
-		}
-		
-		$backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;, $fields).&#39;);&#39; . &#34;\n&#34;;
-	}
-	
-	$backup.=&#34;\n\n\n&#34;;
-}
-//save file
-$handle = fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
-fwrite($handle, $backup);
-fclose($handle);
\ No newline at end of file

Copied: branches/9.x/doc/devtools/backup.php (from rev 40643, branches/9.x/backup.php)
===================================================================
--- branches/9.x/doc/devtools/backup.php	                        (rev 0)
+++ branches/9.x/doc/devtools/backup.php	2012-04-02 13:53:15 UTC (rev 40644)
@@ -0,0 +1,31 @@
+&lt;?php
+require_once(&#39;tiki-setup.php&#39;);
+$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
+$backup = &#34;&#34;;
+foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
+	$table = end($table);
+	$result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
+	$num_fields = count($result);
+	
+	$backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
+	$createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
+	$backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
+	
+	foreach ($result as $row) {
+		$fields = array();
+		
+		foreach ($row as $field) {
+			$field = addslashes($field);
+			$field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
+			$fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; : &#39;&#34;&#34;&#39;);
+		}
+		
+		$backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;, $fields).&#39;);&#39; . &#34;\n&#34;;
+	}
+	
+	$backup.=&#34;\n\n\n&#34;;
+}
+//save file
+$handle = fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
+fwrite($handle, $backup);
+fclose($handle);
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29074374">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074374/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40644] branches/9.x</a></b></div>
      
      <small>From: Jean-François BILGER &lt;changi67@gm...&gt; - 2012-04-02 14:24:10</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAGQmJnNKJpPVXU3Yz-6vOFH6aFhv8OSkZy8oJr5b-ray8JzgOQ%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Missing Tiki header and svn props

Thx.

2012/4/2 &lt;robertplummer@...&gt;

&gt; Revision: 40644
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40644&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40644&amp;view=rev</a>
&gt; Author:   robertplummer
&gt; Date:     2012-04-02 13:53:15 +0000 (Mon, 02 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] Put backup in right place
&gt;
&gt; Added Paths:
&gt; -----------
&gt;    branches/9.x/doc/devtools/backup.php
&gt;
&gt; Removed Paths:
&gt; -------------
&gt;    branches/9.x/backup.php
&gt;
&gt; Deleted: branches/9.x/backup.php
&gt; ===================================================================
&gt; --- branches/9.x/backup.php     2012-04-02 13:52:21 UTC (rev 40643)
&gt; +++ branches/9.x/backup.php     2012-04-02 13:53:15 UTC (rev 40644)
&gt; @@ -1,31 +0,0 @@
&gt; -&lt;?php
&gt; -require_once(&#39;tiki-setup.php&#39;);
&gt; -$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
&gt; -$backup = &#34;&#34;;
&gt; -foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
&gt; -       $table = end($table);
&gt; -       $result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
&gt; -       $num_fields = count($result);
&gt; -
&gt; -       $backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
&gt; -       $createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
&gt; -       $backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
&gt; -
&gt; -       foreach ($result as $row) {
&gt; -               $fields = array();
&gt; -
&gt; -               foreach ($row as $field) {
&gt; -                       $field = addslashes($field);
&gt; -                       $field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
&gt; -                       $fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; :
&gt; &#39;&#34;&#34;&#39;);
&gt; -               }
&gt; -
&gt; -               $backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;,
&gt; $fields).&#39;);&#39; . &#34;\n&#34;;
&gt; -       }
&gt; -
&gt; -       $backup.=&#34;\n\n\n&#34;;
&gt; -}
&gt; -//save file
&gt; -$handle =
&gt; fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
&gt; -fwrite($handle, $backup);
&gt; -fclose($handle);
&gt; \ No newline at end of file
&gt;
&gt; Copied: branches/9.x/doc/devtools/backup.php (from rev 40643,
&gt; branches/9.x/backup.php)
&gt; ===================================================================
&gt; --- branches/9.x/doc/devtools/backup.php
&gt;  (rev 0)
&gt; +++ branches/9.x/doc/devtools/backup.php        2012-04-02 13:53:15 UTC
&gt; (rev 40644)
&gt; @@ -0,0 +1,31 @@
&gt; +&lt;?php
&gt; +require_once(&#39;tiki-setup.php&#39;);
&gt; +$access-&gt;check_permission(&#39;tiki_p_admin&#39;);
&gt; +$backup = &#34;&#34;;
&gt; +foreach(TikiLib::fetchAll(&#39;SHOW TABLES&#39;) as $table) {
&gt; +       $table = end($table);
&gt; +       $result = TikiLib::fetchAll(&#39;SELECT * FROM &#39;. $table);
&gt; +       $num_fields = count($result);
&gt; +
&gt; +       $backup.= &#39;DROP TABLE &#39;.$table.&#39;;&#39;;
&gt; +       $createTable = TikiLib::fetchAll(&#39;SHOW CREATE TABLE &#39;.$table);
&gt; +       $backup.= &#34;\n\n&#34;.$createTable[0][&#39;Create Table&#39;].&#34;;\n\n&#34;;
&gt; +
&gt; +       foreach ($result as $row) {
&gt; +               $fields = array();
&gt; +
&gt; +               foreach ($row as $field) {
&gt; +                       $field = addslashes($field);
&gt; +                       $field = ereg_replace(&#34;\n&#34;,&#34;\\n&#34;,$field);
&gt; +                       $fields[] = (isset($field) ? &#39;&#34;&#39;.$field.&#39;&#34;&#39; :
&gt; &#39;&#34;&#34;&#39;);
&gt; +               }
&gt; +
&gt; +               $backup.= &#39;INSERT INTO &#39;.$table.&#39; VALUES(&#39;.implode(&#34;,&#34;,
&gt; $fields).&#39;);&#39; . &#34;\n&#34;;
&gt; +       }
&gt; +
&gt; +       $backup.=&#34;\n\n\n&#34;;
&gt; +}
&gt; +//save file
&gt; +$handle =
&gt; fopen(&#39;temp/db-backup-&#39;.time().&#39;-&#39;.(md5(implode(&#39;,&#39;,$tables))).&#39;.sql&#39;,&#39;w+&#39;);
&gt; +fwrite($handle, $backup);
&gt; +fclose($handle);
&gt; \ No newline at end of file
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; This SF email is sponsosred by:
&gt; Try Windows Azure free for 90 days Click Here
&gt; <a href="http://p.sf.net/sfu/sfd2d-msazure" rel="nofollow">http://p.sf.net/sfu/sfd2d-msazure</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;



-- 
Changi
--
Tiki Wiki CMS Groupware Project - Infrastructure Team - <a href="http://tiki.org" rel="nofollow">http://tiki.org</a>
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29074375">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074375/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40646] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-02 14:30:47</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40646
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40646&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40646&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-02 14:30:38 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[FIX] Brought codemirror from cache to the propper way of handlign css/js, changed as well codemirror to a  dependancy so that it would cache with the first set of minified js.

Modified Paths:
--------------
    branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
    branches/9.x/tiki-setup.php

Modified: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
===================================================================
--- branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-04-02 13:55:24 UTC (rev 40645)
+++ branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-04-02 14:30:38 UTC (rev 40646)
@@ -7,11 +7,16 @@
 
 function codemirrorModes($minify = true)
 {
+	global $tikidomainslash;
 	$js = &#39;&#39;;
 	$css = &#39;&#39;;
 
-	if (TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;)) == false || TikiLib::lib(&#34;cache&#34;)-&gt;isCached(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;)) == false) {
+	$target = &#39;temp/public/&#39;.$tikidomainslash;
+	$jsfile = $target . &#39;codemirror.js&#39;;
+	$cssfile = $target . &#39;codemirror.css&#39;;
 
+	if (!file_exists($jsfile) || !file_exists($cssfile)) {
+
 		//tiki first, where are our priorities!
 		$js .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.js&#34;);
 		$css .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.css&#34;);
@@ -25,22 +30,14 @@
 			}
 		}
 
-		if ($minify) {
-			require_once(&#34;lib/minify/JSMin.php&#34;);
-			$js = JSMin::minify($js);
+		file_put_contents($jsfile, $js);
+		chmod($jsfile, 0644);
 
-			require_once(&#39;lib/pear/Minify/CSS/Compressor.php&#39;);
-			$css = Minify_CSS_Compressor::process($css);
-		}
-
-		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;), $js);
-		TikiLib::lib(&#34;cache&#34;)-&gt;cacheItem(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;), $css);
-	} else {
-		$js = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_js&#34; . ($minify ? &#34;min&#34; : &#34;&#34;));
-		$css = TikiLib::lib(&#34;cache&#34;)-&gt;getCached(&#34;codemirror_css&#34; . ($minify ? &#34;min&#34; : &#34;&#34;));
+		file_put_contents($cssfile, $css);
+		chmod($cssfile, 0644);
 	}
 
 	TikiLib::lib(&#34;header&#34;)
-		-&gt;add_js($js)
-		-&gt;add_css($css);
+		-&gt;add_jsfile_dependancy($jsfile)
+		-&gt;add_cssfile($cssfile);
 }
\ No newline at end of file

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-04-02 13:55:24 UTC (rev 40645)
+++ branches/9.x/tiki-setup.php	2012-04-02 14:30:38 UTC (rev 40646)
@@ -238,12 +238,12 @@
 
 	if ($prefs[&#39;feature_syntax_highlighter&#39;] == &#39;y&#39;) {
 		//add codemirror stuff
-		$headerlib-&gt;add_cssfile(&#39;lib/codemirror/lib/codemirror.css&#39;);
-		$headerlib-&gt;add_jsfile(&#39;lib/codemirror/lib/codemirror.js&#39;);
-		
+		$headerlib
+			-&gt;add_cssfile(&#39;lib/codemirror/lib/codemirror.css&#39;)
+			-&gt;add_jsfile_dependancy(&#39;lib/codemirror/lib/codemirror.js&#39;)
 		//add tiki stuff
-		$headerlib-&gt;add_cssfile(&#39;lib/codemirror_tiki/codemirror_tiki.css&#39;);
-		$headerlib-&gt;add_jsfile(&#39;lib/codemirror_tiki/codemirror_tiki.js&#39;);
+			-&gt;add_cssfile(&#39;lib/codemirror_tiki/codemirror_tiki.css&#39;)
+			-&gt;add_jsfile_dependancy(&#39;lib/codemirror_tiki/codemirror_tiki.js&#39;);
 
 		require_once(&#34;lib/codemirror_tiki/tiki_codemirror.php&#34;);
 		codemirrorModes($prefs[&#39;tiki_minify_javascript&#39;] === &#39;y&#39;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29074737">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074737/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40652] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-02 15:32:42</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40652
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40652&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40652&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-02 15:32:31 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[FIX] share module: Layout improvement for googleplus button and param label correction

Modified Paths:
--------------
    branches/9.x/modules/mod-func-share.php
    branches/9.x/styles/layout/layout.css
    branches/9.x/templates/modules/mod-share.tpl

Modified: branches/9.x/modules/mod-func-share.php
===================================================================
--- branches/9.x/modules/mod-func-share.php	2012-04-02 15:30:40 UTC (rev 40651)
+++ branches/9.x/modules/mod-func-share.php	2012-04-02 15:32:31 UTC (rev 40652)
@@ -69,7 +69,7 @@
 			),
 			&#39;facebook_show_faces&#39; =&gt; array(
 				&#39;name&#39; =&gt; tra(&#39;Facebook: Show Faces&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Button layout&#39;) . &#39; (y/n)&#39;,
+				&#39;description&#39; =&gt; tra(&#39;Show pictures of others who like this&#39;) . &#39; (y/n)&#39;,
 				&#39;filter&#39; =&gt; &#39;alpha&#39;,
 			),
 			&#39;facebook_verb&#39; =&gt; array(
@@ -233,7 +233,7 @@
 	if (!empty($module_params[&#39;facebook_font&#39;]) &amp;&amp; $module_params[&#39;facebook_font&#39;] !== &#39;lucida grande&#39;) {
 		$fbData .= &#39; data-font=&#34;&#39; . $module_params[&#39;facebook_font&#39;] . &#39;&#34;&#39;;
 	}
-	if (empty($module_params[&#39;facebook_ref&#39;]) || $module_params[&#39;facebook_ref&#39;] === &#39;y&#39;) {
+	if (!empty($module_params[&#39;facebook_ref&#39;])) {
 		$fbData .= &#39; data-ref=&#34;&#39; . htmlspecialchars($module_params[&#39;facebook_ref&#39;]) . &#39;&#34;&#39;;
 	}
 	if (!empty($module_params[&#39;facebook_href&#39;])) {

Modified: branches/9.x/styles/layout/layout.css
===================================================================
--- branches/9.x/styles/layout/layout.css	2012-04-02 15:30:40 UTC (rev 40651)
+++ branches/9.x/styles/layout/layout.css	2012-04-02 15:32:31 UTC (rev 40652)
@@ -423,6 +423,10 @@
 	margin-right: .5em;
 }
 
+.mod-share-item.google-root {
+	margin-left: .5em;
+}
+
 /* centercolumn */
 .fullscreen .tellafriend,
 .fullscreen .share {

Modified: branches/9.x/templates/modules/mod-share.tpl
===================================================================
--- branches/9.x/templates/modules/mod-share.tpl	2012-04-02 15:30:40 UTC (rev 40651)
+++ branches/9.x/templates/modules/mod-share.tpl	2012-04-02 15:32:31 UTC (rev 40652)
@@ -63,7 +63,7 @@
 	{/if}
 
 	{if (isset($module_params.google) and $module_params.google neq &#39;n&#39;)}
-		&lt;div class=&#34;mod-share-item&#34;&gt;&lt;div class=&#34;g-plusone&#34;{$gl_data_attributes}&gt;&lt;/div&gt;&lt;/div&gt;
+		&lt;div class=&#34;mod-share-item google-root&#34;&gt;&lt;div class=&#34;g-plusone&#34;{$gl_data_attributes}&gt;&lt;/div&gt;&lt;/div&gt;
 		{jq notonready=true}
 {{$gl_script_addition}}
   (function() {

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29074969">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29074969/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40655] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-02 16:19:32</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40655
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40655&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40655&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-02 16:19:20 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[FIX] cluetips: Prevent little box appearing sometimes top left on page load, speed up appearance interval and make div wider to account for new padding (fixed at 12 * 2 + 2 for now)

Modified Paths:
--------------
    branches/9.x/lib/jquery_tiki/tiki-jquery.js
    branches/9.x/styles/layout/layout.css

Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-02 15:55:45 UTC (rev 40654)
+++ branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-02 16:19:20 UTC (rev 40655)
@@ -184,7 +184,7 @@
 		if ($el.width() &gt; $(window).width()) {
 			$el.width($(window).width() * 0.8);
 		}
-		options.width = $el.width();
+		options.width = $el.width() + 26;	// add space for css padding
 		$el.remove();
 		
 		element.tipWidth = options.width;
@@ -194,7 +194,7 @@
 	$(element).attr(&#39;title&#39;, prefix + tip);
 
 	if (options.activation !== &#39;click&#39;) {
-		options.hoverIntent = {sensitivity: 3, interval: 300, timeout: 0};
+		options.hoverIntent = {sensitivity: 3, interval: 50, timeout: 0};
 	}
 	$(element).data(&#39;processed&#39;, true);	
 

Modified: branches/9.x/styles/layout/layout.css
===================================================================
--- branches/9.x/styles/layout/layout.css	2012-04-02 15:55:45 UTC (rev 40654)
+++ branches/9.x/styles/layout/layout.css	2012-04-02 16:19:20 UTC (rev 40655)
@@ -1973,6 +1973,10 @@
 	padding: 0;
 }
 
+#cluetip {
+	display: none;
+}
+
 /***** New (unsorted) *****/
 
 /* webmail &amp; groupmail */

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29075870">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29075870/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40655] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-02 19:34:39</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>It&#39;s looking good now in latest code.
<a href="http://demo.tiki.org/trunk/tiki-list_kaltura_entries.php" rel="nofollow">http://demo.tiki.org/trunk/tiki-list_kaltura_entries.php</a>

Thanks!



On Mon, Apr 2, 2012 at 12:19 PM,  &lt;jonnybradley@...&gt; wrote:
&gt; Revision: 40655
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40655&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40655&amp;view=rev</a>
&gt; Author:   jonnybradley
&gt; Date:     2012-04-02 16:19:20 +0000 (Mon, 02 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] cluetips: Prevent little box appearing sometimes top left on page load, speed up appearance interval and make div wider to account for new padding (fixed at 12 * 2 + 2 for now)
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt;    branches/9.x/styles/layout/layout.css
&gt;
&gt; Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt; ===================================================================
&gt; --- branches/9.x/lib/jquery_tiki/tiki-jquery.js 2012-04-02 15:55:45 UTC (rev 40654)
&gt; +++ branches/9.x/lib/jquery_tiki/tiki-jquery.js 2012-04-02 16:19:20 UTC (rev 40655)
&gt; @@ -184,7 +184,7 @@
&gt;                if ($el.width() &gt; $(window).width()) {
&gt;                        $el.width($(window).width() * 0.8);
&gt;                }
&gt; -               options.width = $el.width();
&gt; +               options.width = $el.width() + 26;       // add space for css padding
&gt;                $el.remove();
&gt;
&gt;                element.tipWidth = options.width;
&gt; @@ -194,7 +194,7 @@
&gt;        $(element).attr(&#39;title&#39;, prefix + tip);
&gt;
&gt;        if (options.activation !== &#39;click&#39;) {
&gt; -               options.hoverIntent = {sensitivity: 3, interval: 300, timeout: 0};
&gt; +               options.hoverIntent = {sensitivity: 3, interval: 50, timeout: 0};
&gt;        }
&gt;        $(element).data(&#39;processed&#39;, true);
&gt;
&gt;
&gt; Modified: branches/9.x/styles/layout/layout.css
&gt; ===================================================================
&gt; --- branches/9.x/styles/layout/layout.css       2012-04-02 15:55:45 UTC (rev 40654)
&gt; +++ branches/9.x/styles/layout/layout.css       2012-04-02 16:19:20 UTC (rev 40655)
&gt; @@ -1973,6 +1973,10 @@
&gt;        padding: 0;
&gt;  }
&gt;
&gt; +#cluetip {
&gt; +       display: none;
&gt; +}
&gt; +
&gt;  /***** New (unsorted) *****/
&gt;
&gt;  /* webmail &amp; groupmail */
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; This SF email is sponsosred by:
&gt; Try Windows Azure free for 90 days Click Here
&gt; <a href="http://p.sf.net/sfu/sfd2d-msazure" rel="nofollow">http://p.sf.net/sfu/sfd2d-msazure</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>



-- 
Marc Laporte

<a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
<a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
<a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29075539">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29075539/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40667] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-02 18:21:32</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40667
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40667&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40667&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-02 18:21:23 +0000 (Mon, 02 Apr 2012)
Log Message:
-----------
[NEW] Added codemirror themes, and the ability to set, and change them

Modified Paths:
--------------
    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
    branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
    branches/9.x/lib/prefs/feature.php
    branches/9.x/templates/admin/include_textarea.tpl

Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
===================================================================
--- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-02 17:38:09 UTC (rev 40666)
+++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-02 18:21:23 UTC (rev 40667)
@@ -7,7 +7,8 @@
 			lineNumbers: false,
 			lineWrapping: true,
 			readOnly: false,
-			force: false
+			force: false,
+			theme: window.codeMirrorTheme || &#39;default&#39;
 		}, s);
 
 		jQuery(this).addClass(&#39;CodeMirrorPrepSize&#39;); //we have to hide all the textareas or pre objects to know how much space we can take up
@@ -152,7 +153,8 @@
 			lineNumbers: settings.lineNumbers,
 			readOnly: settings.readOnly,
 			mode: mode,
-			lineWrapping: settings.lineWrapping
+			lineWrapping: settings.lineWrapping,
+			theme: settings.theme
 		});
 		
 		if (settings.readOnly) {
@@ -205,7 +207,8 @@
 				&#39;&lt;/div&gt;&#39;)
 					.insertAfter(textarea.next())
 					.click(function(){
-						var options = &#39;Modes: &lt;br /&gt;&#39;;
+						//Modes
+						var options = tr(&#39;Modes:&#39;) + &#39;&lt;br /&gt;&#39;;
 						options += &#34;&lt;select class=&#39;cm-mode&#39;&gt;&#34;;	
 						options += &#34;&lt;option value=&#39;&#39;&gt;&#34; + tr(&#34;Select a Mode&#34;) + &#34;&lt;/option&gt;&#34;;
 
@@ -214,8 +217,24 @@
 							options += &#39;&lt;option value=&#34;&#39; + modes[i] + &#39;&#34;&gt;&#39; + modes[i] + &#39;&lt;/option&gt;&#39;;
 						}
 						options += &#34;&lt;/select&gt;&lt;br /&gt;&#34;;
-						
-						options += &#39;Options:&lt;br /&gt;&#39;;
+
+						//Modes
+						options += tr(&#39;Theme:&#39;) + &#39;&lt;br /&gt;&#39;;
+						options += &#39;&lt;select class=&#34;cm-theme&#34;&gt;&#39;;
+						options += &#39;&lt;option value=&#34;default&#34;&gt;default&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;night&#34;&gt;night&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;monokia&#34;&gt;monokai&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;neat&#34;&gt;neat&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;elegant&#34;&gt;elegant&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;cobalt&#34;&gt;cobalt&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;eclipse&#34;&gt;eclipse&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;rubyblue&#34;&gt;rubyblue&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;lesser-dark&#34;&gt;lesser-dark&lt;/option&gt;&#39;;
+						options += &#39;&lt;option value=&#34;eq-dark&#34;&gt;xq-dark&lt;/option&gt;&#39;;
+						options += &#39;&lt;/select&gt;&lt;br /&gt;&#39;;
+
+						//Others
+						options += tr(&#39;Options:&#39;) + &#39;&lt;br /&gt;&#39;;
 						options += &#39;&lt;input class=&#34;opt&#34; type=&#34;checkbox&#34; value=&#34;lineNumbers&#34; &#39; + (settings.lineNumbers ? &#39;checked=&#34;true&#34;&#39; : &#39;&#39;) + &#39;/&gt;&#39; + tr(&#34;Line Numbers&#34;) + &#39;&lt;br /&gt;&#39;;
 						options += &#39;&lt;input class=&#34;opt&#34; type=&#34;checkbox&#34; value=&#34;lineWrapping&#34; &#39; + (settings.lineWrapping ? &#39;checked=&#34;true&#34;&#39; : &#39;&#39;) + &#39;/&gt;&#39; + tr(&#34;Line Wrapping&#34;) + &#39;&lt;br /&gt;&#39;;
 						
@@ -228,10 +247,11 @@
 									{
 										text: tr(&#34;Update&#34;),
 										click: function(){
-											var newSettings = {};
+											var newSettings = {
+												mode: msg.find(&#39;.cm-mode&#39;).val(),
+												theme: msg.find(&#39;.cm-theme&#39;).val()
+											};
 											
-											newSettings.mode = msg.find(&#39;.cm-mode&#39;).val();
-											
 											msg.find(&#39;.opt&#39;).each(function(){
 												var o = jQuery(this);
 												newSettings[o.val()] = o.is(&#39;:checked&#39;);
@@ -243,7 +263,7 @@
 											textarea.data(&#39;syntax&#39;, newSettings.mode);
 											
 											textarea.flexibleSyntaxHighlighter(jQuery.extend(settings, newSettings));
-											
+
 											msg.dialog(&#34;destroy&#34;);
 										}
 									},
@@ -257,6 +277,7 @@
 							});
 						
 						msg.find(&#34;.cm-mode&#34;).val(mode);
+						msg.find(&#34;.cm-theme&#34;).val(settings.theme);
 					});
 			
 			var removeButton = jQuery(

Modified: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
===================================================================
--- branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-04-02 17:38:09 UTC (rev 40666)
+++ branches/9.x/lib/codemirror_tiki/tiki_codemirror.php	2012-04-02 18:21:23 UTC (rev 40667)
@@ -7,16 +7,18 @@
 
 function codemirrorModes($minify = true)
 {
-	global $tikidomainslash;
+	global $prefs, $tikidomainslash;
 	$js = &#39;&#39;;
 	$css = &#39;&#39;;
 
 	$target = &#39;temp/public/&#39;.$tikidomainslash;
-	$jsfile = $target . &#39;codemirror_modes.js&#39;;
-	$cssfile = $target . &#39;codemirror_modes.css&#39;;
+	$jsModes = $target . &#39;codemirror_modes.js&#39;;
+	$cssModes = $target . &#39;codemirror_modes.css&#39;;
 
-	if (!file_exists($jsfile) || !file_exists($cssfile)) {
-
+	if (!file_exists($jsModes) || !file_exists($cssModes)) {
+		//codemirror theme
+		$js .= &#39;window.codeMirrorTheme = &#34;&#39; . $prefs[&#39;feature_syntax_highlighter_theme&#39;] .&#39;&#34;;&#39;;
+		//load modes first
 		//tiki first, where are our priorities!
 		$js .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.js&#34;);
 		$css .= @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.css&#34;);
@@ -32,14 +34,19 @@
 			}
 		}
 
-		file_put_contents($jsfile, $js);
-		chmod($jsfile, 0644);
+		//load themes
+		foreach(glob(&#39;lib/codemirror/theme/*.css&#39;) as $cssFile) {
+			$css .= @file_get_contents($cssFile);
+		}
 
-		file_put_contents($cssfile, $css);
-		chmod($cssfile, 0644);
+		file_put_contents($jsModes, $js);
+		chmod($jsModes, 0644);
+
+		file_put_contents($cssModes, $css);
+		chmod($cssModes, 0644);
 	}
 
 	TikiLib::lib(&#34;header&#34;)
-		-&gt;add_jsfile_dependancy($jsfile)
-		-&gt;add_cssfile($cssfile);
+		-&gt;add_jsfile_dependancy($jsModes)
+		-&gt;add_cssfile($cssModes);
 }
\ No newline at end of file

Modified: branches/9.x/lib/prefs/feature.php
===================================================================
--- branches/9.x/lib/prefs/feature.php	2012-04-02 17:38:09 UTC (rev 40666)
+++ branches/9.x/lib/prefs/feature.php	2012-04-02 18:21:23 UTC (rev 40667)
@@ -2423,11 +2423,33 @@
 		&#39;feature_syntax_highlighter&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Syntax Highlighter (CodeMirror)&#39;),
 			&#39;type&#39; =&gt; &#39;flag&#39;,
-			&#39;help&#39; =&gt; &#39;CodeMirror&#39;,
-			&#39;keywords&#39; =&gt; &#39;Code Mirror&#39;,
+			&#39;help&#39; =&gt; &#39;Syntax+Highlighter&#39;,
+			&#39;keywords&#39; =&gt; &#39;Code Mirror Syntax Highlighter&#39;,
 			&#39;description&#39; =&gt; tra(&#39;Enables syntax highlighting with the use of CodeMirror&#39;),
 			&#39;default&#39; =&gt; &#39;y&#39;,
 		),
+		&#39;feature_syntax_highlighter_theme&#39; =&gt; array(
+			&#39;name&#39; =&gt; tra(&#39;Syntax Highlighter (CodeMirror) Theme&#39;),
+			&#39;help&#39; =&gt; &#39;Syntax+Highlighter&#39;,
+			&#39;type&#39; =&gt; &#39;list&#39;,
+			&#39;description&#39; =&gt; tra(&#39;Code Mirror Themes&#39;),
+			&#39;dependencies&#39; =&gt; array(
+				&#39;feature_syntax_highlighter&#39;,
+			),
+			&#39;options&#39; =&gt; array(
+				   &#34;default&#34; =&gt; &#34;default&#34;,
+					&#34;night&#34; =&gt; &#34;night&#34;,
+					&#34;monokai&#34; =&gt; &#34;monokai&#34;,
+					&#34;neat&#34; =&gt; &#34;neat&#34;,
+					&#34;elegant&#34; =&gt; &#34;elegant&#34;,
+					&#34;cobalt&#34; =&gt; &#34;cobalt&#34;,
+					&#34;eclipse&#34; =&gt; &#34;eclipse&#34;,
+					&#34;rubyblue&#34; =&gt; &#34;rubyblue&#34;,
+					&#34;lesser-dark&#34; =&gt; &#34;lesser-dark&#34;,
+					&#34;xq-dark&#34; =&gt; &#34;xq-dark&#34;,
+			),
+			&#39;default&#39; =&gt; &#39;default&#39;,
+		),
 		&#39;feature_jison_wiki_parser&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Jison Wiki Parser&#39;),
 			&#39;type&#39; =&gt; &#39;flag&#39;,

Modified: branches/9.x/templates/admin/include_textarea.tpl
===================================================================
--- branches/9.x/templates/admin/include_textarea.tpl	2012-04-02 17:38:09 UTC (rev 40666)
+++ branches/9.x/templates/admin/include_textarea.tpl	2012-04-02 18:21:23 UTC (rev 40667)
@@ -16,6 +16,7 @@
 				{preference name=feature_dynamic_content}
 				{preference name=feature_wiki_replace}
 				{preference name=feature_syntax_highlighter}
+				{preference name=feature_syntax_highlighter_theme}
 				{preference name=feature_wysiwyg}				
 				{preference name=ajax_autosave}
 			&lt;/fieldset&gt;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29075808">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29075808/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40667] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-04-02 19:17:46</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQpFZrTnWRZSywAgXXAYOCh8vazqyopCqHws2-GQ7ESyBg%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Ok guys, I admit it, I did break a rule here (Codemirror had been out of
experimental for a bit over an hour).  I will roll it back if you see fit,
but this is basically just a class change for the codemirrror object,
setting of the default theme variable and load in the default css from
codemirror.  So in short, this feature really did already exist, I just
allow us to save and change it.

What do you think?

On Mon, Apr 2, 2012 at 2:21 PM, &lt;robertplummer@...&gt; wrote:

&gt; Revision: 40667
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40667&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40667&amp;view=rev</a>
&gt; Author:   robertplummer
&gt; Date:     2012-04-02 18:21:23 +0000 (Mon, 02 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [NEW] Added codemirror themes, and the ability to set, and change them
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt;    branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
&gt;    branches/9.x/lib/prefs/feature.php
&gt;    branches/9.x/templates/admin/include_textarea.tpl
&gt;
&gt; Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt; ===================================================================
&gt; --- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js 2012-04-02
&gt; 17:38:09 UTC (rev 40666)
&gt; +++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js 2012-04-02
&gt; 18:21:23 UTC (rev 40667)
&gt; @@ -7,7 +7,8 @@
&gt;                        lineNumbers: false,
&gt;                        lineWrapping: true,
&gt;                        readOnly: false,
&gt; -                       force: false
&gt; +                       force: false,
&gt; +                       theme: window.codeMirrorTheme || &#39;default&#39;
&gt;                }, s);
&gt;
&gt;                jQuery(this).addClass(&#39;CodeMirrorPrepSize&#39;); //we have to
&gt; hide all the textareas or pre objects to know how much space we can take up
&gt; @@ -152,7 +153,8 @@
&gt;                        lineNumbers: settings.lineNumbers,
&gt;                        readOnly: settings.readOnly,
&gt;                        mode: mode,
&gt; -                       lineWrapping: settings.lineWrapping
&gt; +                       lineWrapping: settings.lineWrapping,
&gt; +                       theme: settings.theme
&gt;                });
&gt;
&gt;                if (settings.readOnly) {
&gt; @@ -205,7 +207,8 @@
&gt;                                &#39;&lt;/div&gt;&#39;)
&gt;                                        .insertAfter(textarea.next())
&gt;                                        .click(function(){
&gt; -                                               var options = &#39;Modes: &lt;br
&gt; /&gt;&#39;;
&gt; +                                               //Modes
&gt; +                                               var options = tr(&#39;Modes:&#39;)
&gt; + &#39;&lt;br /&gt;&#39;;
&gt;                                                options += &#34;&lt;select
&gt; class=&#39;cm-mode&#39;&gt;&#34;;
&gt;                                                options += &#34;&lt;option
&gt; value=&#39;&#39;&gt;&#34; + tr(&#34;Select a Mode&#34;) + &#34;&lt;/option&gt;&#34;;
&gt;
&gt; @@ -214,8 +217,24 @@
&gt;                                                        options += &#39;&lt;option
&gt; value=&#34;&#39; + modes[i] + &#39;&#34;&gt;&#39; + modes[i] + &#39;&lt;/option&gt;&#39;;
&gt;                                                }
&gt;                                                options += &#34;&lt;/select&gt;&lt;br
&gt; /&gt;&#34;;
&gt; -
&gt; -                                               options += &#39;Options:&lt;br
&gt; /&gt;&#39;;
&gt; +
&gt; +                                               //Modes
&gt; +                                               options += tr(&#39;Theme:&#39;) +
&gt; &#39;&lt;br /&gt;&#39;;
&gt; +                                               options += &#39;&lt;select
&gt; class=&#34;cm-theme&#34;&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;default&#34;&gt;default&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;night&#34;&gt;night&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;monokia&#34;&gt;monokai&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;neat&#34;&gt;neat&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;elegant&#34;&gt;elegant&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;cobalt&#34;&gt;cobalt&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;eclipse&#34;&gt;eclipse&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;rubyblue&#34;&gt;rubyblue&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;lesser-dark&#34;&gt;lesser-dark&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;option
&gt; value=&#34;eq-dark&#34;&gt;xq-dark&lt;/option&gt;&#39;;
&gt; +                                               options += &#39;&lt;/select&gt;&lt;br
&gt; /&gt;&#39;;
&gt; +
&gt; +                                               //Others
&gt; +                                               options += tr(&#39;Options:&#39;)
&gt; + &#39;&lt;br /&gt;&#39;;
&gt;                                                options += &#39;&lt;input
&gt; class=&#34;opt&#34; type=&#34;checkbox&#34; value=&#34;lineNumbers&#34; &#39; + (settings.lineNumbers ?
&gt; &#39;checked=&#34;true&#34;&#39; : &#39;&#39;) + &#39;/&gt;&#39; + tr(&#34;Line Numbers&#34;) + &#39;&lt;br /&gt;&#39;;
&gt;                                                options += &#39;&lt;input
&gt; class=&#34;opt&#34; type=&#34;checkbox&#34; value=&#34;lineWrapping&#34; &#39; + (settings.lineWrapping
&gt; ? &#39;checked=&#34;true&#34;&#39; : &#39;&#39;) + &#39;/&gt;&#39; + tr(&#34;Line Wrapping&#34;) + &#39;&lt;br /&gt;&#39;;
&gt;
&gt; @@ -228,10 +247,11 @@
&gt;                                                                        {
&gt;
&gt;      text: tr(&#34;Update&#34;),
&gt;
&gt;      click: function(){
&gt; -
&gt;               var newSettings = {};
&gt; +
&gt;               var newSettings = {
&gt; +
&gt;                       mode: msg.find(&#39;.cm-mode&#39;).val(),
&gt; +
&gt;                       theme: msg.find(&#39;.cm-theme&#39;).val()
&gt; +
&gt;               };
&gt;
&gt; -
&gt;               newSettings.mode = msg.find(&#39;.cm-mode&#39;).val();
&gt; -
&gt;
&gt;              msg.find(&#39;.opt&#39;).each(function(){
&gt;
&gt;                      var o = jQuery(this);
&gt;
&gt;                      newSettings[o.val()] = o.is(&#39;:checked&#39;);
&gt; @@ -243,7 +263,7 @@
&gt;
&gt;              textarea.data(&#39;syntax&#39;, newSettings.mode);
&gt;
&gt;
&gt;              textarea.flexibleSyntaxHighlighter(jQuery.extend(settings,
&gt; newSettings));
&gt; -
&gt; +
&gt;
&gt;              msg.dialog(&#34;destroy&#34;);
&gt;
&gt;      }
&gt;                                                                        },
&gt; @@ -257,6 +277,7 @@
&gt;                                                        });
&gt;
&gt;
&gt;  msg.find(&#34;.cm-mode&#34;).val(mode);
&gt; +
&gt; msg.find(&#34;.cm-theme&#34;).val(settings.theme);
&gt;                                        });
&gt;
&gt;                        var removeButton = jQuery(
&gt;
&gt; Modified: branches/9.x/lib/codemirror_tiki/tiki_codemirror.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/codemirror_tiki/tiki_codemirror.php        2012-04-02
&gt; 17:38:09 UTC (rev 40666)
&gt; +++ branches/9.x/lib/codemirror_tiki/tiki_codemirror.php        2012-04-02
&gt; 18:21:23 UTC (rev 40667)
&gt; @@ -7,16 +7,18 @@
&gt;
&gt;  function codemirrorModes($minify = true)
&gt;  {
&gt; -       global $tikidomainslash;
&gt; +       global $prefs, $tikidomainslash;
&gt;        $js = &#39;&#39;;
&gt;        $css = &#39;&#39;;
&gt;
&gt;        $target = &#39;temp/public/&#39;.$tikidomainslash;
&gt; -       $jsfile = $target . &#39;codemirror_modes.js&#39;;
&gt; -       $cssfile = $target . &#39;codemirror_modes.css&#39;;
&gt; +       $jsModes = $target . &#39;codemirror_modes.js&#39;;
&gt; +       $cssModes = $target . &#39;codemirror_modes.css&#39;;
&gt;
&gt; -       if (!file_exists($jsfile) || !file_exists($cssfile)) {
&gt; -
&gt; +       if (!file_exists($jsModes) || !file_exists($cssModes)) {
&gt; +               //codemirror theme
&gt; +               $js .= &#39;window.codeMirrorTheme = &#34;&#39; .
&gt; $prefs[&#39;feature_syntax_highlighter_theme&#39;] .&#39;&#34;;&#39;;
&gt; +               //load modes first
&gt;                //tiki first, where are our priorities!
&gt;                $js .=
&gt; @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.js&#34;);
&gt;                $css .=
&gt; @file_get_contents(&#34;lib/codemirror_tiki/mode/tiki/tiki.css&#34;);
&gt; @@ -32,14 +34,19 @@
&gt;                        }
&gt;                }
&gt;
&gt; -               file_put_contents($jsfile, $js);
&gt; -               chmod($jsfile, 0644);
&gt; +               //load themes
&gt; +               foreach(glob(&#39;lib/codemirror/theme/*.css&#39;) as $cssFile) {
&gt; +                       $css .= @file_get_contents($cssFile);
&gt; +               }
&gt;
&gt; -               file_put_contents($cssfile, $css);
&gt; -               chmod($cssfile, 0644);
&gt; +               file_put_contents($jsModes, $js);
&gt; +               chmod($jsModes, 0644);
&gt; +
&gt; +               file_put_contents($cssModes, $css);
&gt; +               chmod($cssModes, 0644);
&gt;        }
&gt;
&gt;        TikiLib::lib(&#34;header&#34;)
&gt; -               -&gt;add_jsfile_dependancy($jsfile)
&gt; -               -&gt;add_cssfile($cssfile);
&gt; +               -&gt;add_jsfile_dependancy($jsModes)
&gt; +               -&gt;add_cssfile($cssModes);
&gt;  }
&gt; \ No newline at end of file
&gt;
&gt; Modified: branches/9.x/lib/prefs/feature.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/prefs/feature.php  2012-04-02 17:38:09 UTC (rev 40666)
&gt; +++ branches/9.x/lib/prefs/feature.php  2012-04-02 18:21:23 UTC (rev 40667)
&gt; @@ -2423,11 +2423,33 @@
&gt;                &#39;feature_syntax_highlighter&#39; =&gt; array(
&gt;                        &#39;name&#39; =&gt; tra(&#39;Syntax Highlighter (CodeMirror)&#39;),
&gt;                        &#39;type&#39; =&gt; &#39;flag&#39;,
&gt; -                       &#39;help&#39; =&gt; &#39;CodeMirror&#39;,
&gt; -                       &#39;keywords&#39; =&gt; &#39;Code Mirror&#39;,
&gt; +                       &#39;help&#39; =&gt; &#39;Syntax+Highlighter&#39;,
&gt; +                       &#39;keywords&#39; =&gt; &#39;Code Mirror Syntax Highlighter&#39;,
&gt;                        &#39;description&#39; =&gt; tra(&#39;Enables syntax highlighting
&gt; with the use of CodeMirror&#39;),
&gt;                        &#39;default&#39; =&gt; &#39;y&#39;,
&gt;                ),
&gt; +               &#39;feature_syntax_highlighter_theme&#39; =&gt; array(
&gt; +                       &#39;name&#39; =&gt; tra(&#39;Syntax Highlighter (CodeMirror)
&gt; Theme&#39;),
&gt; +                       &#39;help&#39; =&gt; &#39;Syntax+Highlighter&#39;,
&gt; +                       &#39;type&#39; =&gt; &#39;list&#39;,
&gt; +                       &#39;description&#39; =&gt; tra(&#39;Code Mirror Themes&#39;),
&gt; +                       &#39;dependencies&#39; =&gt; array(
&gt; +                               &#39;feature_syntax_highlighter&#39;,
&gt; +                       ),
&gt; +                       &#39;options&#39; =&gt; array(
&gt; +                                  &#34;default&#34; =&gt; &#34;default&#34;,
&gt; +                                       &#34;night&#34; =&gt; &#34;night&#34;,
&gt; +                                       &#34;monokai&#34; =&gt; &#34;monokai&#34;,
&gt; +                                       &#34;neat&#34; =&gt; &#34;neat&#34;,
&gt; +                                       &#34;elegant&#34; =&gt; &#34;elegant&#34;,
&gt; +                                       &#34;cobalt&#34; =&gt; &#34;cobalt&#34;,
&gt; +                                       &#34;eclipse&#34; =&gt; &#34;eclipse&#34;,
&gt; +                                       &#34;rubyblue&#34; =&gt; &#34;rubyblue&#34;,
&gt; +                                       &#34;lesser-dark&#34; =&gt; &#34;lesser-dark&#34;,
&gt; +                                       &#34;xq-dark&#34; =&gt; &#34;xq-dark&#34;,
&gt; +                       ),
&gt; +                       &#39;default&#39; =&gt; &#39;default&#39;,
&gt; +               ),
&gt;                &#39;feature_jison_wiki_parser&#39; =&gt; array(
&gt;                        &#39;name&#39; =&gt; tra(&#39;Jison Wiki Parser&#39;),
&gt;                        &#39;type&#39; =&gt; &#39;flag&#39;,
&gt;
&gt; Modified: branches/9.x/templates/admin/include_textarea.tpl
&gt; ===================================================================
&gt; --- branches/9.x/templates/admin/include_textarea.tpl   2012-04-02
&gt; 17:38:09 UTC (rev 40666)
&gt; +++ branches/9.x/templates/admin/include_textarea.tpl   2012-04-02
&gt; 18:21:23 UTC (rev 40667)
&gt; @@ -16,6 +16,7 @@
&gt;                                {preference name=feature_dynamic_content}
&gt;                                {preference name=feature_wiki_replace}
&gt;                                {preference name=feature_syntax_highlighter}
&gt; +                               {preference
&gt; name=feature_syntax_highlighter_theme}
&gt;                                {preference name=feature_wysiwyg}
&gt;                                {preference name=ajax_autosave}
&gt;                        &lt;/fieldset&gt;
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; This SF email is sponsosred by:
&gt; Try Windows Azure free for 90 days Click Here
&gt; <a href="http://p.sf.net/sfu/sfd2d-msazure" rel="nofollow">http://p.sf.net/sfu/sfd2d-msazure</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;



-- 
Robert Plummer
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29079251">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29079251/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40671] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-03 12:35:20</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40671
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-03 12:35:09 +0000 (Tue, 03 Apr 2012)
Log Message:
-----------
[FIX] Cleanup of a bit of problematic code with codemirror fullscreen removing the resize event from window, removed a bunch of references to $(window) and $(document) and added vars $window and $document, so that we don&#39;t call those so much
[FIX] I could not fix the textarea function for fullscreen, so I imported what I had created with codemirror

Modified Paths:
--------------
    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
    branches/9.x/lib/jquery_tiki/tiki-jquery.js
    branches/9.x/styles/layout/layout.css

Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
===================================================================
--- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-03 12:21:47 UTC (rev 40670)
+++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-03 12:35:09 UTC (rev 40671)
@@ -288,6 +288,8 @@
 				&#39;&lt;/div&gt;&#39;)
 					.insertAfter(changeButton)
 					.toggle(function(){
+						if ($(&#39;.CodeMirror-fullscreen&#39;).length) syntaxHighlighter.fullscreen(textarea);
+
 						syntaxHighlighter.remove(textarea);
 						var scroller = $(editor.getScrollerElement()),
 						scrollTop = scroller.scrollTop(),
@@ -355,7 +357,7 @@
 		return false;
 	},
 	fullscreen: function(textarea) {
-		$(&#39;.CodeMirror-fullscreen, .CodeMirror-fullscreen .CodeMirror&#39;).css(&#39;height&#39;, &#39;&#39;);
+		$(&#39;.CodeMirror-fullscreen&#39;).find(&#39;.CodeMirror&#39;).andSelf().css(&#39;height&#39;, &#39;&#39;);
 		
 		//removes wiki command buttons (save, cancel, preview) from fullscreen view
 		$(&#39;.CodeMirror-fullscreen .wikiaction&#39;).remove();
@@ -367,20 +369,28 @@
 		var isFullscreen = ($(&#39;.CodeMirror-fullscreen&#39;).length ? true : false);
 		
 		if (isFullscreen) {
-			var win = $(window);
+			var win = $(window)
+				.data(&#39;cm-resize&#39;, true),
+			screen = $(&#39;.CodeMirror-fullscreen&#39;),
+			editorObj = screen.find(&#39;.CodeMirror&#39;),
+			toolbar = $(&#39;#editwiki_toolbar&#39;);
+
 			win.resize(function() {
-				$(&#39;.CodeMirror-fullscreen&#39;)
-					.css(&#39;height&#39;, win.height() + &#39;px&#39;)
-					.find(&#39;.CodeMirror&#39;)
-					.css(&#39;height&#39;, ((win.height() - $(&#39;#editwiki_toolbar&#39;).height()) - 25) + &#39;px&#39;);
+				if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
+					screen.css(&#39;height&#39;, win.height() + &#39;px&#39;);
+
+					editorObj
+						.css(&#39;height&#39;, ((win.height() - toolbar.height()) - 25) + &#39;px&#39;);
+				}
 			})
 			.resize();
 			
 			//adds wiki command buttons (save, cancel, preview) from fullscreen view
 			$(&#39;.wikiaction&#39;).clone().appendTo(&#39;.CodeMirror-fullscreen&#39;);
 		} else {
-			$(window).unbind(&#39;resize&#39;);
+			$(window).removeData(&#39;cm-resize&#39;);
 		}
+
 		return false;
 	},
 	find: function(textareaEditor, val) {

Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 12:21:47 UTC (rev 40670)
+++ branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 12:35:09 UTC (rev 40671)
@@ -4,7 +4,9 @@
 // Tiki 6 - $ is now initialised in jquery.js
 // but let&#39;s keep $jq available too for legacy custom code
 
-var $jq = $;
+var $jq = $,
+$window = $(window)
+$document = $(document);
 
 // Escape a string for use as a jQuery selector value, for example an id or a class
 function escapeJquery(str) {
@@ -181,8 +183,8 @@
 			.insertBefore(&#34;#main&#34;)
 			.html(tip);
 		
-		if ($el.width() &gt; $(window).width()) {
-			$el.width($(window).width() * 0.8);
+		if ($el.width() &gt; $window.width()) {
+			$el.width($window.width() * 0.8);
 		}
 		options.width = $el.width() + 26;	// add space for css padding
 		$el.remove();
@@ -233,13 +235,13 @@
 	// find area of destination element
 	pos = $dest.offset();
 	// clip to page
-	if (pos.left + $dest.width() &gt; $(window).width()) {
-		w = $(window).width() - pos.left;
+	if (pos.left + $dest.width() &gt; $window.width()) {
+		w = $window.width() - pos.left;
 	} else {
 		w = $dest.width();
 	}
-	if (pos.top + $dest.height() &gt; $(window).height()) {
-		h = $(window).height() - pos.top;
+	if (pos.top + $dest.height() &gt; $window.height()) {
+		h = $window.height() - pos.top;
 	} else {
 		h = $dest.height();
 	}
@@ -309,7 +311,7 @@
 	// TODO after 5.0 - these need changes in the {button} Smarty fn
 }
 
-$(document).ready( function() { // JQuery&#39;s DOM is ready event - before onload
+$(function() { // JQuery&#39;s DOM is ready event - before onload
 	
 	// tooltip functions and setup
 	if (jqueryTiki.tooltips) {	// apply &#34;cluetips&#34; to all .tips class anchors
@@ -514,7 +516,7 @@
 		}
 	}
 	
-	$(document).ready( function() {
+	$( function() {
 		$(&#34;#keepOpenCbx&#34;).click(function() {
 			if (this.checked) {
 				setCookie(&#34;fgalKeepOpen&#34;, &#34;1&#34;);
@@ -527,10 +529,10 @@
 
 
 	$.paginationHelper();	
-});		// end $(document).ready
+});		// end $document.ready
 
 //For ajax/custom search
-$(document).bind(&#39;pageSearchReady&#39;, function() {
+$document.bind(&#39;pageSearchReady&#39;, function() {
 	$.paginationHelper();
 });
 
@@ -747,8 +749,8 @@
 		// IE throws errors destroying a non-existant dialog
 	}
 	container.dialog({
-		width: $(window).width() * 0.6,
-		height: $(window).height() * pfc,
+		width: $window.width() * 0.6,
+		height: $window.height() * pfc,
 		zIndex: 10000,
 		title: heading.text(),
 		autoOpen: false,
@@ -762,7 +764,7 @@
 	
 	
 	//This allows users to create plugin snippets for any plugin using the jQuery event &#39;plugin_#type#_ready&#39; for document
-	$(document)
+	$document
 		.trigger({
 			type: &#39;plugin_&#39; + type + &#39;_ready&#39;,
 			container: container,
@@ -822,199 +824,51 @@
  * JS only textarea fullscreen function (for Tiki 5+)
  */
 
-var fullScreenState = [];
-
-$(document).ready(function() {	// if in translation-diff-mode go fullscreen automatically
+$(function() {	// if in translation-diff-mode go fullscreen automatically
 	if ($(&#34;#diff_outer&#34;).length &amp;&amp; !$.trim($(&#34;.wikipreview .wikitext&#34;).html()).length) {	// but not if previewing (TODO better)
 		toggleFullScreen(&#34;editwiki&#34;);
 	}
 });
 
 function toggleFullScreen(area_id) {
-	var $ta = $(&#34;#&#34; + area_id);
+	var textarea = $(&#34;#&#34; + area_id);
 	
 	//codemirror interation and preservation
-	var textareaEditor = syntaxHighlighter.get($ta);
+	var textareaEditor = syntaxHighlighter.get(textarea);
 	if (textareaEditor) {
-		syntaxHighlighter.fullscreen($ta);
+		syntaxHighlighter.fullscreen(textarea);
 		return;
 	}
-	
-	var $diff = $(&#34;#diff_outer&#34;), $edit_form, $edit_form_innards;	// vars for translation diff elements if present
 
-	if (fullScreenState[area_id]) { // leave full screen - fullScreenState[area_id] contains info about previous page DOM state when fullscreen
-		if ($diff.length) {
-			$(&#34;#fs_grippy_&#34; + area_id).remove();
-			$diff.css(&#34;float&#34;, fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;]);
-			$(&#34;#diff_history&#34;).height(fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;]).width(fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;]);
-			for (var i = 0; i &lt; fullScreenState[area_id][&#34;edit_form_innards&#34;].length; i++) {
-				$(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;el&#34;]).css(&#34;left&#34;, fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;height&#34;]);
-			}
-			$edit_form = $(fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;]); // hmmm?
-			$edit_form.css(&#34;position&#34;, fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;]).css(&#34;left&#34;, fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;]);
-		}
-		$ta.css(&#34;float&#34;, fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;]);
-	
-		if ($ta.resizable) {
-			$ta.resizable({
-				minWidth: fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;],
-				minHeight: fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;]
-			});
-		}
-		
-		for (i = 0; i &lt; fullScreenState[area_id][&#34;hidden&#34;].length; i++) {
-			fullScreenState[area_id][&#34;hidden&#34;][i].show();
-		}
-		
-		for (i = 0; i &lt; fullScreenState[area_id][&#34;changed&#34;].length; i++) {
-			var $el = $(fullScreenState[area_id][&#34;changed&#34;][i][&#34;el&#34;]);
-			$el.css(&#34;margin-left&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-left&#34;]).css(&#34;margin-right&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-right&#34;]).css(&#34;margin-top&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-top&#34;]).css(&#34;margin-bottom&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-bottom&#34;]).css(&#34;padding-left&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-left&#34;]).css(&#34;padding-right&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-right&#34;]).css(&#34;padding-top&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-top&#34;]).css(&#34;padding-bottom&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-bottom&#34;]).width(fullScreenState[area_id][&#34;changed&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;changed&#34;][i][&#34;height&#34;]);
-		}
-		
-		$(&#34;.fs_clones&#34;).remove();
-		$(document.documentElement).css(&#34;overflow&#34;, &#34;auto&#34;);
-		
-		fullScreenState[area_id] = false;
-		
-	}
-	else { // go full screen
-		$(window).scrollTop(0);
-		$(document.documentElement).css(&#34;overflow&#34;, &#34;hidden&#34;);
-		
-		fullScreenState[area_id] = [];
-		fullScreenState[area_id][&#34;hidden&#34;] = [];
-		fullScreenState[area_id][&#34;changed&#34;] = [];
-		fullScreenState[area_id][&#34;resizable&#34;] = [];
-		if ($ta.resizable) {
-			fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;] = $ta.resizable(&#34;option&#34;, &#34;minWidth&#34;);
-			fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;] = $ta.resizable(&#34;option&#34;, &#34;minHeight&#34;);
-		
-			$ta.resizable(&#34;destroy&#34;);
-		}
-		
-		var h = $(window).height();
-		var w = $(window).width();
-		
-		if ($diff.length) {	// translation diff there so split the screen down the middle (for now)
-			w = Math.floor(w / 2) - 5;
-		}
-		
-		// store &amp; hide anything not in col1 
-		fullScreenState[area_id][&#34;hidden&#34;].push($(&#34;#header, #col2, #col3, #footer&#34;));
-		$(&#34;#header, #col2, #col3, #footer&#34;).hide();
-		
-		// store &amp; reset margins, padding and size for all the textarea parents, and hide siblings
-		$ta.parents().each(function() {
-			fullScreenState[area_id][&#34;hidden&#34;].push($(this).siblings(&#34;:visible:not(&#39;#diff_outer, .translation_message&#39;)&#34;));
-			var ob = [];
-			ob[&#34;el&#34;] = this;
-			ob[&#34;margin-left&#34;] = $(this).css(&#34;margin-left&#34;);	// this is for IE - it fails using margin or padding as a single setting
-			ob[&#34;margin-right&#34;] = $(this).css(&#34;margin-right&#34;);
-			ob[&#34;margin-top&#34;] = $(this).css(&#34;margin-top&#34;);
-			ob[&#34;margin-bottom&#34;] = $(this).css(&#34;margin-bottom&#34;);
-			ob[&#34;padding-left&#34;] = $(this).css(&#34;padding-left&#34;);
-			ob[&#34;padding-right&#34;] = $(this).css(&#34;padding-right&#34;);
-			ob[&#34;padding-top&#34;] = $(this).css(&#34;padding-top&#34;);
-			ob[&#34;padding-bottom&#34;] = $(this).css(&#34;padding-bottom&#34;);
-			ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
-			ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
-			fullScreenState[area_id][&#34;changed&#34;].push(ob);
-		});
-		$ta.parents().each(function() {
-			$(this).siblings(&#34;:visible:not(&#39;#diff_outer, .translation_message&#39;)&#34;).hide();
-			$(this).css(&#34;margin&#34;, 0).css(&#34;padding&#34;, 0).width(w).height(h);
-		});
-		
-		// store &amp; resize translation diff divs etc
-		if ($diff.length) {
-			fullScreenState[area_id][&#34;diff&#34;] = [];
-			fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;] = $diff.width();
-			fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;] = $diff.height();
-			fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;] = $diff.css(&#34;float&#34;);
-			fullScreenState[area_id][&#34;diff_history&#34;] = [];
-			fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;] = $(&#34;#diff_history&#34;).height();
-			fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;] = $(&#34;#diff_history&#34;).width();
-			$edit_form = $diff.next();
-			$edit_form_innards = $edit_form.find(&#34;.edit-zone, table.normal, textarea, fieldset&#34;);
-			fullScreenState[area_id][&#34;edit_form&#34;] = [];
-			fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;] = $edit_form[0];	// store this element for easy access later
-			fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;] = $edit_form.height();
-			fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;] = $edit_form.width();
-			fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;] = $edit_form.css(&#34;left&#34;) !== &#39;auto&#39; ? $edit_form.css(&#34;left&#34;) : 0;
-			fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;] = $edit_form.css(&#34;position&#34;);
-			fullScreenState[area_id][&#34;edit_form_innards&#34;] = [];
-			$edit_form_innards.each(function() {
-				var ob = [];
-				ob[&#34;el&#34;] = this;
-				ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
-				ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
-				ob[&#34;left&#34;] = $(this).css(&#34;left&#34;);
-				fullScreenState[area_id][&#34;edit_form_innards&#34;].push(ob);
-			});
-			
-			$diff.parents().each(function() {			// shares some parents with the textarea
-				$(this).width($(window).width());	// so make room for both
-			});
-		}
-		
-		// resize the actual textarea
-		fullScreenState[area_id][&#34;ta&#34;] = [];
-		fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;] = $ta.width();
-		fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;] = $ta.height();
-		fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;] = $ta.css(&#34;float&#34;);
-		
-		var b = 0;
-		if ($ta.css(&#34;border-left-width&#34;)) {
-		b = $ta.css(&#34;border-left-width&#34;).replace(&#34;px&#34;,&#34;&#34;);
-		}
+	$(&#39;.TextArea-fullscreen&#39;).add(textarea).css(&#39;height&#39;, &#39;&#39;);
 
-		$ta.width(w - b * 2).height($ta.parent().height() - $(&#34;.textarea-toolbar&#34;).height() - $(&#34;.translation_message&#34;).height() - 60 - b * 2);
-		
-		// add grippy resize bar to translation diff page
-		if ($diff.length) {
-			var grippy_width = 10;
-			$diff.width(w).height(h).css(&#34;float&#34;, &#34;left&#34;).next().css(&#34;float&#34;, &#34;right&#34;);
-			var vh = $(&#34;#diff_versions&#34;).css(&#34;overflow&#34;, &#34;auto&#34;).height() + 18;
-			if (vh &gt; h * 0.15) {
-				vh = h * 0.15;
-			}
-			$(&#34;#diff_versions&#34;).height(vh);
-			$(&#34;#diff_history&#34;).height(h - vh).width(w).css(&#34;left&#34;, w + grippy_width);
-			$edit_form.css(&#34;position&#34;,&#34;absolute&#34;).css(&#34;left&#34;, w + grippy_width).width(w - grippy_width);
-			
-			var $grippy = $(&#34;&lt;div id=&#39;fs_grippy_&#34; + area_id +&#34;&#39; /&gt;&#34;).css({&#34;background-image&#34;: &#34;url(img/icons/shading.png)&#34;,
-											&#34;background-repeat&#34;: &#34;repeat-y&#34;,
-											&#34;background-position&#34;: -3,
-											&#34;position&#34;: &#34;absolute&#34;,
-											&#34;left&#34;: w + &#34;px&#34;,
-											&#34;top&#34;: 0,
-											&#34;cursor&#34;: &#34;col-resize&#34;})
-									.width(grippy_width).height(h).draggable({axis: &#39;x&#39;, drag: function(event, ui) {
-										$diff.find(&#34;div,table&#34;).width(ui.offset.left - grippy_width);
-										$edit_form.css(&#34;left&#34;, ui.offset.left + grippy_width).find(&#34;#edit-zone, table.normal, textarea, fieldset&#34;)
-												.width($(window).width() - ui.offset.left);
-									}});
-			$diff.after($grippy);
-			
-		}
-		
-		// copy and add the action buttons (preview, save etc)
-		if ($(&#34;div.top_actions&#34;).length) {
-			$ta.parent().append($(&#34;div.top_actions &gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
-		} else {
-			$ta.parent().append($(&#34;#editpageform td &gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
-		}
+	//removes wiki command buttons (save, cancel, preview) from fullscreen view
+	$(&#39;.TextArea-fullscreen .wikiaction&#39;).remove();
 
-		// make sure scroll bars appear if necessary
-		$ta.parents(&#34;form:first&#34;).css(&#34;overflow&#34;, &#34;auto&#34;);
+	var textareaParent = textarea.parent().toggleClass(&#39;TextArea-fullscreen&#39;);
+	$(&#39;body&#39;).toggleClass(&#39;noScroll&#39;);
+	$(&#39;.tabs,.rbox-title&#39;).toggle();
 
-		// show action buttons and reapply cluetip options
-		if (jqueryTiki.tooltips) {
-			$(&#34;.fs_clones&#34;).cluetip({splitTitle: &#39;|&#39;, showTitle: false, width: &#39;150px&#39;, cluezIndex: 400, fx: {open: &#39;fadeIn&#39;, openSpeed: &#39;fast&#39;}, clickThrough: true}).show();
-		} else {
-			$(&#34;.fs_clones&#34;).show();
-		}
+	if (textareaParent.hasClass(&#39;TextArea-fullscreen&#39;)) {
+		var win = $window
+			.data(&#39;cm-resize&#39;, true),
+			screen = $(&#39;.TextArea-fullscreen&#39;),
+			toolbar = $(&#39;#editwiki_toolbar&#39;);
 
+		win.resize(function() {
+			if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
+				screen.css(&#39;height&#39;, win.height() + &#39;px&#39;);
+
+				textarea
+					.css(&#39;height&#39;, ((win.height() - toolbar.height()) - 30) + &#39;px&#39;);
+			}
+		})
+			.resize();
+
+		//adds wiki command buttons (save, cancel, preview) from fullscreen view
+		$(&#39;.wikiaction&#39;).clone().appendTo(&#39;.TextArea-fullscreen&#39;);
+	} else {
+		$window.removeData(&#39;cm-resize&#39;);
 	}
 }
 
@@ -2181,8 +2035,8 @@
 			$dialog.dialog({
 				title: options.title,
 				minWidth: 500,
-				height: (options.fullscreen ? $(window).height() - 20 : 600),
-				width: (options.fullscreen ? $(window).width() - 20 : null),
+				height: (options.fullscreen ? $window.height() - 20 : 600),
+				width: (options.fullscreen ? $window.width() - 20 : null),
 				close: function () {
 					if (options.close) {
 						options.close.apply([], this);
@@ -2628,8 +2482,8 @@
 	}
 
 	var mid = obj.height() / 2 + obj.offset().top;
-	if (mid &gt; $(window).height()) {
-		mid = ($(window).height() - obj.offset().top) / 2 + obj.offset().top;
+	if (mid &gt; $window.height()) {
+		mid = ($window.height() - obj.offset().top) / 2 + obj.offset().top;
 	}
 	s = $.extend({
 		isEverything: false,
@@ -2675,10 +2529,10 @@
 		s = $.extend(s, {
 			top: 	0,
 			left:	0,
-			height: $(document).height(),
-			width: 	$(window).width(),
-			middle: $(window).height() / 2,
-			center: $(window).width() / 2
+			height: $document.height(),
+			width: 	$window.width(),
+			middle: $window.height() / 2,
+			center: $window.width() / 2
 		});
 	}
 	 
@@ -2951,7 +2805,7 @@
 			.css(&#39;position&#39;, &#39;fixed&#39;)
 			.css(&#39;z-index&#39;, 9999999)
 			.css(&#39;padding&#39;, &#39;5px&#39;)
-			.width($(window).width() / 5)
+			.width($window.width() / 5)
 			.prependTo(&#39;body&#39;);
 	}
 	
@@ -2990,7 +2844,7 @@
 *   Close (user) sidebar column(s) if no modules are displayed.
 *   Modules can be hidden at runtime. So, check after the page/DOM model is loaded.
 */
-$(document).bind(&#34;ready&#34;, function () {
+$document.bind(&#34;ready&#34;, function () {
 
     // Do final client side adjustment of the sidebars
     /////////////////////////////////////////
@@ -3080,10 +2934,10 @@
 	w = $el.width(),
 	o = $el.offset(),
 	po = $el.parent().offset(),
-	st = $(window).scrollTop(),
-	sl = $(window).scrollLeft(),
-	wh = $(window).height(),
-	ww = $(window).width();
+	st = $window.scrollTop(),
+	sl = $window.scrollLeft(),
+	wh = $window.height(),
+	ww = $window.width();
 
 	if (w + o.left &gt; sl + ww) {
 		$el.animate({&#39;left&#39;: sl + ww - w - po.left}, &#39;fast&#39;);

Modified: branches/9.x/styles/layout/layout.css
===================================================================
--- branches/9.x/styles/layout/layout.css	2012-04-03 12:21:47 UTC (rev 40670)
+++ branches/9.x/styles/layout/layout.css	2012-04-03 12:35:09 UTC (rev 40671)
@@ -2402,4 +2402,33 @@
 }
 /* end structures tiki 9 */
 
+
+/*from the codemirror website*/
+.TextArea-fullscreen  #editwiki_toolbar {
+	width: 100% ! important;
+}
+
+.TextArea-fullscreen  textarea {
+	width: inherit ! important;
+}
+
+.TextArea-fullscreen {
+	display: block;
+	width: 100%;
+	height: 100%;
+	margin: 0;
+	padding: 0;
+	border: 0px solid #BBBBBB;
+	opacity: 1;
+	width: 100%;
+	top: 0px ! important;
+	left: 0px ! important;
+	position: fixed;
+	top: expression(eval(document.body.scrollTop + 15) + &#34;px&#34;);
+	/*left: expression(eval(document.body.scrollLeft) + &#34;px&#34;);*/
+	background-color: gray;
+}
+.TextArea-fullscreen .cm-remove {
+	display: none;
+}
 /* End of File */

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29434902">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29434902/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40671] branches/9.x</a></b></div>
      
      <small>From: Jonny Bradley &lt;svnupdates@no...&gt; - 2012-06-20 19:10:14</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>
Hi Robert &amp; all

Does full screen edit work for you since this commit? (pretty sure it works in 8.x)

Looks like you removed all the (messy) code that worked and only put half the new code back in?

As reported by Luci here: <a href="http://dev.tiki.org/Regressions+in+9x#General_regressions" rel="nofollow">http://dev.tiki.org/Regressions+in+9x#General_regressions</a>

I&#39;d call it a blocker i&#39;m afraid...

jb


On 3 Apr 2012, at 13:35, robertplummer@... wrote:

&gt; Revision: 40671
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev</a>
&gt; Author:   robertplummer
&gt; Date:     2012-04-03 12:35:09 +0000 (Tue, 03 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] Cleanup of a bit of problematic code with codemirror fullscreen removing the resize event from window, removed a bunch of references to $(window) and $(document) and added vars $window and $document, so that we don&#39;t call those so much
&gt; [FIX] I could not fix the textarea function for fullscreen, so I imported what I had created with codemirror
&gt; 
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt;    branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt;    branches/9.x/styles/layout/layout.css
&gt; 
&gt; Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt; ===================================================================
&gt; --- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-03 12:21:47 UTC (rev 40670)
&gt; +++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js	2012-04-03 12:35:09 UTC (rev 40671)
&gt; @@ -288,6 +288,8 @@
&gt; 				&#39;&lt;/div&gt;&#39;)
&gt; 					.insertAfter(changeButton)
&gt; 					.toggle(function(){
&gt; +						if ($(&#39;.CodeMirror-fullscreen&#39;).length) syntaxHighlighter.fullscreen(textarea);
&gt; +
&gt; 						syntaxHighlighter.remove(textarea);
&gt; 						var scroller = $(editor.getScrollerElement()),
&gt; 						scrollTop = scroller.scrollTop(),
&gt; @@ -355,7 +357,7 @@
&gt; 		return false;
&gt; 	},
&gt; 	fullscreen: function(textarea) {
&gt; -		$(&#39;.CodeMirror-fullscreen, .CodeMirror-fullscreen .CodeMirror&#39;).css(&#39;height&#39;, &#39;&#39;);
&gt; +		$(&#39;.CodeMirror-fullscreen&#39;).find(&#39;.CodeMirror&#39;).andSelf().css(&#39;height&#39;, &#39;&#39;);
&gt; 		
&gt; 		//removes wiki command buttons (save, cancel, preview) from fullscreen view
&gt; 		$(&#39;.CodeMirror-fullscreen .wikiaction&#39;).remove();
&gt; @@ -367,20 +369,28 @@
&gt; 		var isFullscreen = ($(&#39;.CodeMirror-fullscreen&#39;).length ? true : false);
&gt; 		
&gt; 		if (isFullscreen) {
&gt; -			var win = $(window);
&gt; +			var win = $(window)
&gt; +				.data(&#39;cm-resize&#39;, true),
&gt; +			screen = $(&#39;.CodeMirror-fullscreen&#39;),
&gt; +			editorObj = screen.find(&#39;.CodeMirror&#39;),
&gt; +			toolbar = $(&#39;#editwiki_toolbar&#39;);
&gt; +
&gt; 			win.resize(function() {
&gt; -				$(&#39;.CodeMirror-fullscreen&#39;)
&gt; -					.css(&#39;height&#39;, win.height() + &#39;px&#39;)
&gt; -					.find(&#39;.CodeMirror&#39;)
&gt; -					.css(&#39;height&#39;, ((win.height() - $(&#39;#editwiki_toolbar&#39;).height()) - 25) + &#39;px&#39;);
&gt; +				if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
&gt; +					screen.css(&#39;height&#39;, win.height() + &#39;px&#39;);
&gt; +
&gt; +					editorObj
&gt; +						.css(&#39;height&#39;, ((win.height() - toolbar.height()) - 25) + &#39;px&#39;);
&gt; +				}
&gt; 			})
&gt; 			.resize();
&gt; 			
&gt; 			//adds wiki command buttons (save, cancel, preview) from fullscreen view
&gt; 			$(&#39;.wikiaction&#39;).clone().appendTo(&#39;.CodeMirror-fullscreen&#39;);
&gt; 		} else {
&gt; -			$(window).unbind(&#39;resize&#39;);
&gt; +			$(window).removeData(&#39;cm-resize&#39;);
&gt; 		}
&gt; +
&gt; 		return false;
&gt; 	},
&gt; 	find: function(textareaEditor, val) {
&gt; 
&gt; Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt; ===================================================================
&gt; --- branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 12:21:47 UTC (rev 40670)
&gt; +++ branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 12:35:09 UTC (rev 40671)
&gt; @@ -4,7 +4,9 @@
&gt; // Tiki 6 - $ is now initialised in jquery.js
&gt; // but let&#39;s keep $jq available too for legacy custom code
&gt; 
&gt; -var $jq = $;
&gt; +var $jq = $,
&gt; +$window = $(window)
&gt; +$document = $(document);
&gt; 
&gt; // Escape a string for use as a jQuery selector value, for example an id or a class
&gt; function escapeJquery(str) {
&gt; @@ -181,8 +183,8 @@
&gt; 			.insertBefore(&#34;#main&#34;)
&gt; 			.html(tip);
&gt; 		
&gt; -		if ($el.width() &gt; $(window).width()) {
&gt; -			$el.width($(window).width() * 0.8);
&gt; +		if ($el.width() &gt; $window.width()) {
&gt; +			$el.width($window.width() * 0.8);
&gt; 		}
&gt; 		options.width = $el.width() + 26;	// add space for css padding
&gt; 		$el.remove();
&gt; @@ -233,13 +235,13 @@
&gt; 	// find area of destination element
&gt; 	pos = $dest.offset();
&gt; 	// clip to page
&gt; -	if (pos.left + $dest.width() &gt; $(window).width()) {
&gt; -		w = $(window).width() - pos.left;
&gt; +	if (pos.left + $dest.width() &gt; $window.width()) {
&gt; +		w = $window.width() - pos.left;
&gt; 	} else {
&gt; 		w = $dest.width();
&gt; 	}
&gt; -	if (pos.top + $dest.height() &gt; $(window).height()) {
&gt; -		h = $(window).height() - pos.top;
&gt; +	if (pos.top + $dest.height() &gt; $window.height()) {
&gt; +		h = $window.height() - pos.top;
&gt; 	} else {
&gt; 		h = $dest.height();
&gt; 	}
&gt; @@ -309,7 +311,7 @@
&gt; 	// TODO after 5.0 - these need changes in the {button} Smarty fn
&gt; }
&gt; 
&gt; -$(document).ready( function() { // JQuery&#39;s DOM is ready event - before onload
&gt; +$(function() { // JQuery&#39;s DOM is ready event - before onload
&gt; 	
&gt; 	// tooltip functions and setup
&gt; 	if (jqueryTiki.tooltips) {	// apply &#34;cluetips&#34; to all .tips class anchors
&gt; @@ -514,7 +516,7 @@
&gt; 		}
&gt; 	}
&gt; 	
&gt; -	$(document).ready( function() {
&gt; +	$( function() {
&gt; 		$(&#34;#keepOpenCbx&#34;).click(function() {
&gt; 			if (this.checked) {
&gt; 				setCookie(&#34;fgalKeepOpen&#34;, &#34;1&#34;);
&gt; @@ -527,10 +529,10 @@
&gt; 
&gt; 
&gt; 	$.paginationHelper();	
&gt; -});		// end $(document).ready
&gt; +});		// end $document.ready
&gt; 
&gt; //For ajax/custom search
&gt; -$(document).bind(&#39;pageSearchReady&#39;, function() {
&gt; +$document.bind(&#39;pageSearchReady&#39;, function() {
&gt; 	$.paginationHelper();
&gt; });
&gt; 
&gt; @@ -747,8 +749,8 @@
&gt; 		// IE throws errors destroying a non-existant dialog
&gt; 	}
&gt; 	container.dialog({
&gt; -		width: $(window).width() * 0.6,
&gt; -		height: $(window).height() * pfc,
&gt; +		width: $window.width() * 0.6,
&gt; +		height: $window.height() * pfc,
&gt; 		zIndex: 10000,
&gt; 		title: heading.text(),
&gt; 		autoOpen: false,
&gt; @@ -762,7 +764,7 @@
&gt; 	
&gt; 	
&gt; 	//This allows users to create plugin snippets for any plugin using the jQuery event &#39;plugin_#type#_ready&#39; for document
&gt; -	$(document)
&gt; +	$document
&gt; 		.trigger({
&gt; 			type: &#39;plugin_&#39; + type + &#39;_ready&#39;,
&gt; 			container: container,
&gt; @@ -822,199 +824,51 @@
&gt;  * JS only textarea fullscreen function (for Tiki 5+)
&gt;  */
&gt; 
&gt; -var fullScreenState = [];
&gt; -
&gt; -$(document).ready(function() {	// if in translation-diff-mode go fullscreen automatically
&gt; +$(function() {	// if in translation-diff-mode go fullscreen automatically
&gt; 	if ($(&#34;#diff_outer&#34;).length &amp;&amp; !$.trim($(&#34;.wikipreview .wikitext&#34;).html()).length) {	// but not if previewing (TODO better)
&gt; 		toggleFullScreen(&#34;editwiki&#34;);
&gt; 	}
&gt; });
&gt; 
&gt; function toggleFullScreen(area_id) {
&gt; -	var $ta = $(&#34;#&#34; + area_id);
&gt; +	var textarea = $(&#34;#&#34; + area_id);
&gt; 	
&gt; 	//codemirror interation and preservation
&gt; -	var textareaEditor = syntaxHighlighter.get($ta);
&gt; +	var textareaEditor = syntaxHighlighter.get(textarea);
&gt; 	if (textareaEditor) {
&gt; -		syntaxHighlighter.fullscreen($ta);
&gt; +		syntaxHighlighter.fullscreen(textarea);
&gt; 		return;
&gt; 	}
&gt; -	
&gt; -	var $diff = $(&#34;#diff_outer&#34;), $edit_form, $edit_form_innards;	// vars for translation diff elements if present
&gt; 
&gt; -	if (fullScreenState[area_id]) { // leave full screen - fullScreenState[area_id] contains info about previous page DOM state when fullscreen
&gt; -		if ($diff.length) {
&gt; -			$(&#34;#fs_grippy_&#34; + area_id).remove();
&gt; -			$diff.css(&#34;float&#34;, fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;]);
&gt; -			$(&#34;#diff_history&#34;).height(fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;]).width(fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;]);
&gt; -			for (var i = 0; i &lt; fullScreenState[area_id][&#34;edit_form_innards&#34;].length; i++) {
&gt; -				$(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;el&#34;]).css(&#34;left&#34;, fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;height&#34;]);
&gt; -			}
&gt; -			$edit_form = $(fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;]); // hmmm?
&gt; -			$edit_form.css(&#34;position&#34;, fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;]).css(&#34;left&#34;, fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;]);
&gt; -		}
&gt; -		$ta.css(&#34;float&#34;, fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;]);
&gt; -	
&gt; -		if ($ta.resizable) {
&gt; -			$ta.resizable({
&gt; -				minWidth: fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;],
&gt; -				minHeight: fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;]
&gt; -			});
&gt; -		}
&gt; -		
&gt; -		for (i = 0; i &lt; fullScreenState[area_id][&#34;hidden&#34;].length; i++) {
&gt; -			fullScreenState[area_id][&#34;hidden&#34;][i].show();
&gt; -		}
&gt; -		
&gt; -		for (i = 0; i &lt; fullScreenState[area_id][&#34;changed&#34;].length; i++) {
&gt; -			var $el = $(fullScreenState[area_id][&#34;changed&#34;][i][&#34;el&#34;]);
&gt; -			$el.css(&#34;margin-left&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-left&#34;]).css(&#34;margin-right&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-right&#34;]).css(&#34;margin-top&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-top&#34;]).css(&#34;margin-bottom&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-bottom&#34;]).css(&#34;padding-left&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-left&#34;]).css(&#34;padding-right&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-right&#34;]).css(&#34;padding-top&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-top&#34;]).css(&#34;padding-bottom&#34;, fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-bottom&#34;]).width(fullScreenState[area_id][&#34;changed&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;changed&#34;][i][&#34;height&#34;]);
&gt; -		}
&gt; -		
&gt; -		$(&#34;.fs_clones&#34;).remove();
&gt; -		$(document.documentElement).css(&#34;overflow&#34;, &#34;auto&#34;);
&gt; -		
&gt; -		fullScreenState[area_id] = false;
&gt; -		
&gt; -	}
&gt; -	else { // go full screen
&gt; -		$(window).scrollTop(0);
&gt; -		$(document.documentElement).css(&#34;overflow&#34;, &#34;hidden&#34;);
&gt; -		
&gt; -		fullScreenState[area_id] = [];
&gt; -		fullScreenState[area_id][&#34;hidden&#34;] = [];
&gt; -		fullScreenState[area_id][&#34;changed&#34;] = [];
&gt; -		fullScreenState[area_id][&#34;resizable&#34;] = [];
&gt; -		if ($ta.resizable) {
&gt; -			fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;] = $ta.resizable(&#34;option&#34;, &#34;minWidth&#34;);
&gt; -			fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;] = $ta.resizable(&#34;option&#34;, &#34;minHeight&#34;);
&gt; -		
&gt; -			$ta.resizable(&#34;destroy&#34;);
&gt; -		}
&gt; -		
&gt; -		var h = $(window).height();
&gt; -		var w = $(window).width();
&gt; -		
&gt; -		if ($diff.length) {	// translation diff there so split the screen down the middle (for now)
&gt; -			w = Math.floor(w / 2) - 5;
&gt; -		}
&gt; -		
&gt; -		// store &amp; hide anything not in col1 
&gt; -		fullScreenState[area_id][&#34;hidden&#34;].push($(&#34;#header, #col2, #col3, #footer&#34;));
&gt; -		$(&#34;#header, #col2, #col3, #footer&#34;).hide();
&gt; -		
&gt; -		// store &amp; reset margins, padding and size for all the textarea parents, and hide siblings
&gt; -		$ta.parents().each(function() {
&gt; -			fullScreenState[area_id][&#34;hidden&#34;].push($(this).siblings(&#34;:visible:not(&#39;#diff_outer, .translation_message&#39;)&#34;));
&gt; -			var ob = [];
&gt; -			ob[&#34;el&#34;] = this;
&gt; -			ob[&#34;margin-left&#34;] = $(this).css(&#34;margin-left&#34;);	// this is for IE - it fails using margin or padding as a single setting
&gt; -			ob[&#34;margin-right&#34;] = $(this).css(&#34;margin-right&#34;);
&gt; -			ob[&#34;margin-top&#34;] = $(this).css(&#34;margin-top&#34;);
&gt; -			ob[&#34;margin-bottom&#34;] = $(this).css(&#34;margin-bottom&#34;);
&gt; -			ob[&#34;padding-left&#34;] = $(this).css(&#34;padding-left&#34;);
&gt; -			ob[&#34;padding-right&#34;] = $(this).css(&#34;padding-right&#34;);
&gt; -			ob[&#34;padding-top&#34;] = $(this).css(&#34;padding-top&#34;);
&gt; -			ob[&#34;padding-bottom&#34;] = $(this).css(&#34;padding-bottom&#34;);
&gt; -			ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
&gt; -			ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
&gt; -			fullScreenState[area_id][&#34;changed&#34;].push(ob);
&gt; -		});
&gt; -		$ta.parents().each(function() {
&gt; -			$(this).siblings(&#34;:visible:not(&#39;#diff_outer, .translation_message&#39;)&#34;).hide();
&gt; -			$(this).css(&#34;margin&#34;, 0).css(&#34;padding&#34;, 0).width(w).height(h);
&gt; -		});
&gt; -		
&gt; -		// store &amp; resize translation diff divs etc
&gt; -		if ($diff.length) {
&gt; -			fullScreenState[area_id][&#34;diff&#34;] = [];
&gt; -			fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;] = $diff.width();
&gt; -			fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;] = $diff.height();
&gt; -			fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;] = $diff.css(&#34;float&#34;);
&gt; -			fullScreenState[area_id][&#34;diff_history&#34;] = [];
&gt; -			fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;] = $(&#34;#diff_history&#34;).height();
&gt; -			fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;] = $(&#34;#diff_history&#34;).width();
&gt; -			$edit_form = $diff.next();
&gt; -			$edit_form_innards = $edit_form.find(&#34;.edit-zone, table.normal, textarea, fieldset&#34;);
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;] = [];
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;] = $edit_form[0];	// store this element for easy access later
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;] = $edit_form.height();
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;] = $edit_form.width();
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;] = $edit_form.css(&#34;left&#34;) !== &#39;auto&#39; ? $edit_form.css(&#34;left&#34;) : 0;
&gt; -			fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;] = $edit_form.css(&#34;position&#34;);
&gt; -			fullScreenState[area_id][&#34;edit_form_innards&#34;] = [];
&gt; -			$edit_form_innards.each(function() {
&gt; -				var ob = [];
&gt; -				ob[&#34;el&#34;] = this;
&gt; -				ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
&gt; -				ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
&gt; -				ob[&#34;left&#34;] = $(this).css(&#34;left&#34;);
&gt; -				fullScreenState[area_id][&#34;edit_form_innards&#34;].push(ob);
&gt; -			});
&gt; -			
&gt; -			$diff.parents().each(function() {			// shares some parents with the textarea
&gt; -				$(this).width($(window).width());	// so make room for both
&gt; -			});
&gt; -		}
&gt; -		
&gt; -		// resize the actual textarea
&gt; -		fullScreenState[area_id][&#34;ta&#34;] = [];
&gt; -		fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;] = $ta.width();
&gt; -		fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;] = $ta.height();
&gt; -		fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;] = $ta.css(&#34;float&#34;);
&gt; -		
&gt; -		var b = 0;
&gt; -		if ($ta.css(&#34;border-left-width&#34;)) {
&gt; -		b = $ta.css(&#34;border-left-width&#34;).replace(&#34;px&#34;,&#34;&#34;);
&gt; -		}
&gt; +	$(&#39;.TextArea-fullscreen&#39;).add(textarea).css(&#39;height&#39;, &#39;&#39;);
&gt; 
&gt; -		$ta.width(w - b * 2).height($ta.parent().height() - $(&#34;.textarea-toolbar&#34;).height() - $(&#34;.translation_message&#34;).height() - 60 - b * 2);
&gt; -		
&gt; -		// add grippy resize bar to translation diff page
&gt; -		if ($diff.length) {
&gt; -			var grippy_width = 10;
&gt; -			$diff.width(w).height(h).css(&#34;float&#34;, &#34;left&#34;).next().css(&#34;float&#34;, &#34;right&#34;);
&gt; -			var vh = $(&#34;#diff_versions&#34;).css(&#34;overflow&#34;, &#34;auto&#34;).height() + 18;
&gt; -			if (vh &gt; h * 0.15) {
&gt; -				vh = h * 0.15;
&gt; -			}
&gt; -			$(&#34;#diff_versions&#34;).height(vh);
&gt; -			$(&#34;#diff_history&#34;).height(h - vh).width(w).css(&#34;left&#34;, w + grippy_width);
&gt; -			$edit_form.css(&#34;position&#34;,&#34;absolute&#34;).css(&#34;left&#34;, w + grippy_width).width(w - grippy_width);
&gt; -			
&gt; -			var $grippy = $(&#34;&lt;div id=&#39;fs_grippy_&#34; + area_id +&#34;&#39; /&gt;&#34;).css({&#34;background-image&#34;: &#34;url(img/icons/shading.png)&#34;,
&gt; -											&#34;background-repeat&#34;: &#34;repeat-y&#34;,
&gt; -											&#34;background-position&#34;: -3,
&gt; -											&#34;position&#34;: &#34;absolute&#34;,
&gt; -											&#34;left&#34;: w + &#34;px&#34;,
&gt; -											&#34;top&#34;: 0,
&gt; -											&#34;cursor&#34;: &#34;col-resize&#34;})
&gt; -									.width(grippy_width).height(h).draggable({axis: &#39;x&#39;, drag: function(event, ui) {
&gt; -										$diff.find(&#34;div,table&#34;).width(ui.offset.left - grippy_width);
&gt; -										$edit_form.css(&#34;left&#34;, ui.offset.left + grippy_width).find(&#34;#edit-zone, table.normal, textarea, fieldset&#34;)
&gt; -												.width($(window).width() - ui.offset.left);
&gt; -									}});
&gt; -			$diff.after($grippy);
&gt; -			
&gt; -		}
&gt; -		
&gt; -		// copy and add the action buttons (preview, save etc)
&gt; -		if ($(&#34;div.top_actions&#34;).length) {
&gt; -			$ta.parent().append($(&#34;div.top_actions &gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
&gt; -		} else {
&gt; -			$ta.parent().append($(&#34;#editpageform td &gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
&gt; -		}
&gt; +	//removes wiki command buttons (save, cancel, preview) from fullscreen view
&gt; +	$(&#39;.TextArea-fullscreen .wikiaction&#39;).remove();
&gt; 
&gt; -		// make sure scroll bars appear if necessary
&gt; -		$ta.parents(&#34;form:first&#34;).css(&#34;overflow&#34;, &#34;auto&#34;);
&gt; +	var textareaParent = textarea.parent().toggleClass(&#39;TextArea-fullscreen&#39;);
&gt; +	$(&#39;body&#39;).toggleClass(&#39;noScroll&#39;);
&gt; +	$(&#39;.tabs,.rbox-title&#39;).toggle();
&gt; 
&gt; -		// show action buttons and reapply cluetip options
&gt; -		if (jqueryTiki.tooltips) {
&gt; -			$(&#34;.fs_clones&#34;).cluetip({splitTitle: &#39;|&#39;, showTitle: false, width: &#39;150px&#39;, cluezIndex: 400, fx: {open: &#39;fadeIn&#39;, openSpeed: &#39;fast&#39;}, clickThrough: true}).show();
&gt; -		} else {
&gt; -			$(&#34;.fs_clones&#34;).show();
&gt; -		}
&gt; +	if (textareaParent.hasClass(&#39;TextArea-fullscreen&#39;)) {
&gt; +		var win = $window
&gt; +			.data(&#39;cm-resize&#39;, true),
&gt; +			screen = $(&#39;.TextArea-fullscreen&#39;),
&gt; +			toolbar = $(&#39;#editwiki_toolbar&#39;);
&gt; 
&gt; +		win.resize(function() {
&gt; +			if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
&gt; +				screen.css(&#39;height&#39;, win.height() + &#39;px&#39;);
&gt; +
&gt; +				textarea
&gt; +					.css(&#39;height&#39;, ((win.height() - toolbar.height()) - 30) + &#39;px&#39;);
&gt; +			}
&gt; +		})
&gt; +			.resize();
&gt; +
&gt; +		//adds wiki command buttons (save, cancel, preview) from fullscreen view
&gt; +		$(&#39;.wikiaction&#39;).clone().appendTo(&#39;.TextArea-fullscreen&#39;);
&gt; +	} else {
&gt; +		$window.removeData(&#39;cm-resize&#39;);
&gt; 	}
&gt; }
&gt; 
&gt; @@ -2181,8 +2035,8 @@
&gt; 			$dialog.dialog({
&gt; 				title: options.title,
&gt; 				minWidth: 500,
&gt; -				height: (options.fullscreen ? $(window).height() - 20 : 600),
&gt; -				width: (options.fullscreen ? $(window).width() - 20 : null),
&gt; +				height: (options.fullscreen ? $window.height() - 20 : 600),
&gt; +				width: (options.fullscreen ? $window.width() - 20 : null),
&gt; 				close: function () {
&gt; 					if (options.close) {
&gt; 						options.close.apply([], this);
&gt; @@ -2628,8 +2482,8 @@
&gt; 	}
&gt; 
&gt; 	var mid = obj.height() / 2 + obj.offset().top;
&gt; -	if (mid &gt; $(window).height()) {
&gt; -		mid = ($(window).height() - obj.offset().top) / 2 + obj.offset().top;
&gt; +	if (mid &gt; $window.height()) {
&gt; +		mid = ($window.height() - obj.offset().top) / 2 + obj.offset().top;
&gt; 	}
&gt; 	s = $.extend({
&gt; 		isEverything: false,
&gt; @@ -2675,10 +2529,10 @@
&gt; 		s = $.extend(s, {
&gt; 			top: 	0,
&gt; 			left:	0,
&gt; -			height: $(document).height(),
&gt; -			width: 	$(window).width(),
&gt; -			middle: $(window).height() / 2,
&gt; -			center: $(window).width() / 2
&gt; +			height: $document.height(),
&gt; +			width: 	$window.width(),
&gt; +			middle: $window.height() / 2,
&gt; +			center: $window.width() / 2
&gt; 		});
&gt; 	}
&gt; 	 
&gt; @@ -2951,7 +2805,7 @@
&gt; 			.css(&#39;position&#39;, &#39;fixed&#39;)
&gt; 			.css(&#39;z-index&#39;, 9999999)
&gt; 			.css(&#39;padding&#39;, &#39;5px&#39;)
&gt; -			.width($(window).width() / 5)
&gt; +			.width($window.width() / 5)
&gt; 			.prependTo(&#39;body&#39;);
&gt; 	}
&gt; 	
&gt; @@ -2990,7 +2844,7 @@
&gt; *   Close (user) sidebar column(s) if no modules are displayed.
&gt; *   Modules can be hidden at runtime. So, check after the page/DOM model is loaded.
&gt; */
&gt; -$(document).bind(&#34;ready&#34;, function () {
&gt; +$document.bind(&#34;ready&#34;, function () {
&gt; 
&gt;     // Do final client side adjustment of the sidebars
&gt;     /////////////////////////////////////////
&gt; @@ -3080,10 +2934,10 @@
&gt; 	w = $el.width(),
&gt; 	o = $el.offset(),
&gt; 	po = $el.parent().offset(),
&gt; -	st = $(window).scrollTop(),
&gt; -	sl = $(window).scrollLeft(),
&gt; -	wh = $(window).height(),
&gt; -	ww = $(window).width();
&gt; +	st = $window.scrollTop(),
&gt; +	sl = $window.scrollLeft(),
&gt; +	wh = $window.height(),
&gt; +	ww = $window.width();
&gt; 
&gt; 	if (w + o.left &gt; sl + ww) {
&gt; 		$el.animate({&#39;left&#39;: sl + ww - w - po.left}, &#39;fast&#39;);
&gt; 
&gt; Modified: branches/9.x/styles/layout/layout.css
&gt; ===================================================================
&gt; --- branches/9.x/styles/layout/layout.css	2012-04-03 12:21:47 UTC (rev 40670)
&gt; +++ branches/9.x/styles/layout/layout.css	2012-04-03 12:35:09 UTC (rev 40671)
&gt; @@ -2402,4 +2402,33 @@
&gt; }
&gt; /* end structures tiki 9 */
&gt; 
&gt; +
&gt; +/*from the codemirror website*/
&gt; +.TextArea-fullscreen  #editwiki_toolbar {
&gt; +	width: 100% ! important;
&gt; +}
&gt; +
&gt; +.TextArea-fullscreen  textarea {
&gt; +	width: inherit ! important;
&gt; +}
&gt; +
&gt; +.TextArea-fullscreen {
&gt; +	display: block;
&gt; +	width: 100%;
&gt; +	height: 100%;
&gt; +	margin: 0;
&gt; +	padding: 0;
&gt; +	border: 0px solid #BBBBBB;
&gt; +	opacity: 1;
&gt; +	width: 100%;
&gt; +	top: 0px ! important;
&gt; +	left: 0px ! important;
&gt; +	position: fixed;
&gt; +	top: expression(eval(document.body.scrollTop + 15) + &#34;px&#34;);
&gt; +	/*left: expression(eval(document.body.scrollLeft) + &#34;px&#34;);*/
&gt; +	background-color: gray;
&gt; +}
&gt; +.TextArea-fullscreen .cm-remove {
&gt; +	display: none;
&gt; +}
&gt; /* End of File */
&gt; 
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt; 
&gt; 
&gt; ------------------------------------------------------------------------------
&gt; Better than sec? Nothing is better than sec when it comes to
&gt; monitoring Big Data applications. Try Boundary one-second 
&gt; resolution app monitoring today. Free.
&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; 



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29438022">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29438022/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40671] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-06-21 11:01:10</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQrxXyUdih5Atzyz25qoK3uPeMzNLnArEb8oGz0LHKxvqA%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>I&#39;ll check this out in a few. Meet me in irc, lets squash some bugs today!
On Jun 20, 2012 3:10 PM, &#34;Jonny Bradley&#34; &lt;svnupdates@...&gt; wrote:

&gt;
&gt; Hi Robert &amp; all
&gt;
&gt; Does full screen edit work for you since this commit? (pretty sure it
&gt; works in 8.x)
&gt;
&gt; Looks like you removed all the (messy) code that worked and only put half
&gt; the new code back in?
&gt;
&gt; As reported by Luci here:
&gt; <a href="http://dev.tiki.org/Regressions+in+9x#General_regressions" rel="nofollow">http://dev.tiki.org/Regressions+in+9x#General_regressions</a>
&gt;
&gt; I&#39;d call it a blocker i&#39;m afraid...
&gt;
&gt; jb
&gt;
&gt;
&gt; On 3 Apr 2012, at 13:35, robertplummer@... wrote:
&gt;
&gt; &gt; Revision: 40671
&gt; &gt;
&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40671&amp;view=rev</a>
&gt; &gt; Author:   robertplummer
&gt; &gt; Date:     2012-04-03 12:35:09 +0000 (Tue, 03 Apr 2012)
&gt; &gt; Log Message:
&gt; &gt; -----------
&gt; &gt; [FIX] Cleanup of a bit of problematic code with codemirror fullscreen
&gt; removing the resize event from window, removed a bunch of references to
&gt; $(window) and $(document) and added vars $window and $document, so that we
&gt; don&#39;t call those so much
&gt; &gt; [FIX] I could not fix the textarea function for fullscreen, so I
&gt; imported what I had created with codemirror
&gt; &gt;
&gt; &gt; Modified Paths:
&gt; &gt; --------------
&gt; &gt;    branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt; &gt;    branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt; &gt;    branches/9.x/styles/layout/layout.css
&gt; &gt;
&gt; &gt; Modified: branches/9.x/lib/codemirror_tiki/codemirror_tiki.js
&gt; &gt; ===================================================================
&gt; &gt; --- branches/9.x/lib/codemirror_tiki/codemirror_tiki.js       2012-04-03
&gt; 12:21:47 UTC (rev 40670)
&gt; &gt; +++ branches/9.x/lib/codemirror_tiki/codemirror_tiki.js       2012-04-03
&gt; 12:35:09 UTC (rev 40671)
&gt; &gt; @@ -288,6 +288,8 @@
&gt; &gt;                               &#39;&lt;/div&gt;&#39;)
&gt; &gt;                                       .insertAfter(changeButton)
&gt; &gt;                                       .toggle(function(){
&gt; &gt; +                                             if
&gt; ($(&#39;.CodeMirror-fullscreen&#39;).length) syntaxHighlighter.fullscreen(textarea);
&gt; &gt; +
&gt; &gt;
&gt; syntaxHighlighter.remove(textarea);
&gt; &gt;                                               var scroller =
&gt; $(editor.getScrollerElement()),
&gt; &gt;                                               scrollTop =
&gt; scroller.scrollTop(),
&gt; &gt; @@ -355,7 +357,7 @@
&gt; &gt;               return false;
&gt; &gt;       },
&gt; &gt;       fullscreen: function(textarea) {
&gt; &gt; -             $(&#39;.CodeMirror-fullscreen, .CodeMirror-fullscreen
&gt; .CodeMirror&#39;).css(&#39;height&#39;, &#39;&#39;);
&gt; &gt; +
&gt; $(&#39;.CodeMirror-fullscreen&#39;).find(&#39;.CodeMirror&#39;).andSelf().css(&#39;height&#39;, &#39;&#39;);
&gt; &gt;
&gt; &gt;               //removes wiki command buttons (save, cancel, preview)
&gt; from fullscreen view
&gt; &gt;               $(&#39;.CodeMirror-fullscreen .wikiaction&#39;).remove();
&gt; &gt; @@ -367,20 +369,28 @@
&gt; &gt;               var isFullscreen = ($(&#39;.CodeMirror-fullscreen&#39;).length ?
&gt; true : false);
&gt; &gt;
&gt; &gt;               if (isFullscreen) {
&gt; &gt; -                     var win = $(window);
&gt; &gt; +                     var win = $(window)
&gt; &gt; +                             .data(&#39;cm-resize&#39;, true),
&gt; &gt; +                     screen = $(&#39;.CodeMirror-fullscreen&#39;),
&gt; &gt; +                     editorObj = screen.find(&#39;.CodeMirror&#39;),
&gt; &gt; +                     toolbar = $(&#39;#editwiki_toolbar&#39;);
&gt; &gt; +
&gt; &gt;                       win.resize(function() {
&gt; &gt; -                             $(&#39;.CodeMirror-fullscreen&#39;)
&gt; &gt; -                                     .css(&#39;height&#39;, win.height() + &#39;px&#39;)
&gt; &gt; -                                     .find(&#39;.CodeMirror&#39;)
&gt; &gt; -                                     .css(&#39;height&#39;, ((win.height() -
&gt; $(&#39;#editwiki_toolbar&#39;).height()) - 25) + &#39;px&#39;);
&gt; &gt; +                             if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
&gt; &gt; +                                     screen.css(&#39;height&#39;, win.height()
&gt; + &#39;px&#39;);
&gt; &gt; +
&gt; &gt; +                                     editorObj
&gt; &gt; +                                             .css(&#39;height&#39;,
&gt; ((win.height() - toolbar.height()) - 25) + &#39;px&#39;);
&gt; &gt; +                             }
&gt; &gt;                       })
&gt; &gt;                       .resize();
&gt; &gt;
&gt; &gt;                       //adds wiki command buttons (save, cancel,
&gt; preview) from fullscreen view
&gt; &gt;
&gt; $(&#39;.wikiaction&#39;).clone().appendTo(&#39;.CodeMirror-fullscreen&#39;);
&gt; &gt;               } else {
&gt; &gt; -                     $(window).unbind(&#39;resize&#39;);
&gt; &gt; +                     $(window).removeData(&#39;cm-resize&#39;);
&gt; &gt;               }
&gt; &gt; +
&gt; &gt;               return false;
&gt; &gt;       },
&gt; &gt;       find: function(textareaEditor, val) {
&gt; &gt;
&gt; &gt; Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
&gt; &gt; ===================================================================
&gt; &gt; --- branches/9.x/lib/jquery_tiki/tiki-jquery.js       2012-04-03
&gt; 12:21:47 UTC (rev 40670)
&gt; &gt; +++ branches/9.x/lib/jquery_tiki/tiki-jquery.js       2012-04-03
&gt; 12:35:09 UTC (rev 40671)
&gt; &gt; @@ -4,7 +4,9 @@
&gt; &gt; // Tiki 6 - $ is now initialised in jquery.js
&gt; &gt; // but let&#39;s keep $jq available too for legacy custom code
&gt; &gt;
&gt; &gt; -var $jq = $;
&gt; &gt; +var $jq = $,
&gt; &gt; +$window = $(window)
&gt; &gt; +$document = $(document);
&gt; &gt;
&gt; &gt; // Escape a string for use as a jQuery selector value, for example an id
&gt; or a class
&gt; &gt; function escapeJquery(str) {
&gt; &gt; @@ -181,8 +183,8 @@
&gt; &gt;                       .insertBefore(&#34;#main&#34;)
&gt; &gt;                       .html(tip);
&gt; &gt;
&gt; &gt; -             if ($el.width() &gt; $(window).width()) {
&gt; &gt; -                     $el.width($(window).width() * 0.8);
&gt; &gt; +             if ($el.width() &gt; $window.width()) {
&gt; &gt; +                     $el.width($window.width() * 0.8);
&gt; &gt;               }
&gt; &gt;               options.width = $el.width() + 26;       // add space for
&gt; css padding
&gt; &gt;               $el.remove();
&gt; &gt; @@ -233,13 +235,13 @@
&gt; &gt;       // find area of destination element
&gt; &gt;       pos = $dest.offset();
&gt; &gt;       // clip to page
&gt; &gt; -     if (pos.left + $dest.width() &gt; $(window).width()) {
&gt; &gt; -             w = $(window).width() - pos.left;
&gt; &gt; +     if (pos.left + $dest.width() &gt; $window.width()) {
&gt; &gt; +             w = $window.width() - pos.left;
&gt; &gt;       } else {
&gt; &gt;               w = $dest.width();
&gt; &gt;       }
&gt; &gt; -     if (pos.top + $dest.height() &gt; $(window).height()) {
&gt; &gt; -             h = $(window).height() - pos.top;
&gt; &gt; +     if (pos.top + $dest.height() &gt; $window.height()) {
&gt; &gt; +             h = $window.height() - pos.top;
&gt; &gt;       } else {
&gt; &gt;               h = $dest.height();
&gt; &gt;       }
&gt; &gt; @@ -309,7 +311,7 @@
&gt; &gt;       // TODO after 5.0 - these need changes in the {button} Smarty fn
&gt; &gt; }
&gt; &gt;
&gt; &gt; -$(document).ready( function() { // JQuery&#39;s DOM is ready event - before
&gt; onload
&gt; &gt; +$(function() { // JQuery&#39;s DOM is ready event - before onload
&gt; &gt;
&gt; &gt;       // tooltip functions and setup
&gt; &gt;       if (jqueryTiki.tooltips) {      // apply &#34;cluetips&#34; to all .tips
&gt; class anchors
&gt; &gt; @@ -514,7 +516,7 @@
&gt; &gt;               }
&gt; &gt;       }
&gt; &gt;
&gt; &gt; -     $(document).ready( function() {
&gt; &gt; +     $( function() {
&gt; &gt;               $(&#34;#keepOpenCbx&#34;).click(function() {
&gt; &gt;                       if (this.checked) {
&gt; &gt;                               setCookie(&#34;fgalKeepOpen&#34;, &#34;1&#34;);
&gt; &gt; @@ -527,10 +529,10 @@
&gt; &gt;
&gt; &gt;
&gt; &gt;       $.paginationHelper();
&gt; &gt; -});          // end $(document).ready
&gt; &gt; +});          // end $document.ready
&gt; &gt;
&gt; &gt; //For ajax/custom search
&gt; &gt; -$(document).bind(&#39;pageSearchReady&#39;, function() {
&gt; &gt; +$document.bind(&#39;pageSearchReady&#39;, function() {
&gt; &gt;       $.paginationHelper();
&gt; &gt; });
&gt; &gt;
&gt; &gt; @@ -747,8 +749,8 @@
&gt; &gt;               // IE throws errors destroying a non-existant dialog
&gt; &gt;       }
&gt; &gt;       container.dialog({
&gt; &gt; -             width: $(window).width() * 0.6,
&gt; &gt; -             height: $(window).height() * pfc,
&gt; &gt; +             width: $window.width() * 0.6,
&gt; &gt; +             height: $window.height() * pfc,
&gt; &gt;               zIndex: 10000,
&gt; &gt;               title: heading.text(),
&gt; &gt;               autoOpen: false,
&gt; &gt; @@ -762,7 +764,7 @@
&gt; &gt;
&gt; &gt;
&gt; &gt;       //This allows users to create plugin snippets for any plugin using
&gt; the jQuery event &#39;plugin_#type#_ready&#39; for document
&gt; &gt; -     $(document)
&gt; &gt; +     $document
&gt; &gt;               .trigger({
&gt; &gt;                       type: &#39;plugin_&#39; + type + &#39;_ready&#39;,
&gt; &gt;                       container: container,
&gt; &gt; @@ -822,199 +824,51 @@
&gt; &gt;  * JS only textarea fullscreen function (for Tiki 5+)
&gt; &gt;  */
&gt; &gt;
&gt; &gt; -var fullScreenState = [];
&gt; &gt; -
&gt; &gt; -$(document).ready(function() {       // if in translation-diff-mode go
&gt; fullscreen automatically
&gt; &gt; +$(function() {       // if in translation-diff-mode go fullscreen
&gt; automatically
&gt; &gt;       if ($(&#34;#diff_outer&#34;).length &amp;&amp; !$.trim($(&#34;.wikipreview
&gt; .wikitext&#34;).html()).length) {    // but not if previewing (TODO better)
&gt; &gt;               toggleFullScreen(&#34;editwiki&#34;);
&gt; &gt;       }
&gt; &gt; });
&gt; &gt;
&gt; &gt; function toggleFullScreen(area_id) {
&gt; &gt; -     var $ta = $(&#34;#&#34; + area_id);
&gt; &gt; +     var textarea = $(&#34;#&#34; + area_id);
&gt; &gt;
&gt; &gt;       //codemirror interation and preservation
&gt; &gt; -     var textareaEditor = syntaxHighlighter.get($ta);
&gt; &gt; +     var textareaEditor = syntaxHighlighter.get(textarea);
&gt; &gt;       if (textareaEditor) {
&gt; &gt; -             syntaxHighlighter.fullscreen($ta);
&gt; &gt; +             syntaxHighlighter.fullscreen(textarea);
&gt; &gt;               return;
&gt; &gt;       }
&gt; &gt; -
&gt; &gt; -     var $diff = $(&#34;#diff_outer&#34;), $edit_form, $edit_form_innards;   //
&gt; vars for translation diff elements if present
&gt; &gt;
&gt; &gt; -     if (fullScreenState[area_id]) { // leave full screen -
&gt; fullScreenState[area_id] contains info about previous page DOM state when
&gt; fullscreen
&gt; &gt; -             if ($diff.length) {
&gt; &gt; -                     $(&#34;#fs_grippy_&#34; + area_id).remove();
&gt; &gt; -                     $diff.css(&#34;float&#34;,
&gt; fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;]);
&gt; &gt; -
&gt; $(&#34;#diff_history&#34;).height(fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;]).width(fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;]);
&gt; &gt; -                     for (var i = 0; i &lt;
&gt; fullScreenState[area_id][&#34;edit_form_innards&#34;].length; i++) {
&gt; &gt; -
&gt; $(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;el&#34;]).css(&#34;left&#34;,
&gt; fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form_innards&#34;][i][&#34;height&#34;]);
&gt; &gt; -                     }
&gt; &gt; -                     $edit_form =
&gt; $(fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;]); // hmmm?
&gt; &gt; -                     $edit_form.css(&#34;position&#34;,
&gt; fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;]).css(&#34;left&#34;,
&gt; fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;]).width(fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;]);
&gt; &gt; -             }
&gt; &gt; -             $ta.css(&#34;float&#34;,
&gt; fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;]).width(fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;]).height(fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;]);
&gt; &gt; -
&gt; &gt; -             if ($ta.resizable) {
&gt; &gt; -                     $ta.resizable({
&gt; &gt; -                             minWidth:
&gt; fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;],
&gt; &gt; -                             minHeight:
&gt; fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;]
&gt; &gt; -                     });
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             for (i = 0; i &lt; fullScreenState[area_id][&#34;hidden&#34;].length;
&gt; i++) {
&gt; &gt; -                     fullScreenState[area_id][&#34;hidden&#34;][i].show();
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             for (i = 0; i &lt;
&gt; fullScreenState[area_id][&#34;changed&#34;].length; i++) {
&gt; &gt; -                     var $el =
&gt; $(fullScreenState[area_id][&#34;changed&#34;][i][&#34;el&#34;]);
&gt; &gt; -                     $el.css(&#34;margin-left&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-left&#34;]).css(&#34;margin-right&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-right&#34;]).css(&#34;margin-top&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-top&#34;]).css(&#34;margin-bottom&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;margin-bottom&#34;]).css(&#34;padding-left&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-left&#34;]).css(&#34;padding-right&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-right&#34;]).css(&#34;padding-top&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-top&#34;]).css(&#34;padding-bottom&#34;,
&gt; fullScreenState[area_id][&#34;changed&#34;][i][&#34;padding-bottom&#34;]).width(fullScreenState[area_id][&#34;changed&#34;][i][&#34;width&#34;]).height(fullScreenState[area_id][&#34;changed&#34;][i][&#34;height&#34;]);
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             $(&#34;.fs_clones&#34;).remove();
&gt; &gt; -             $(document.documentElement).css(&#34;overflow&#34;, &#34;auto&#34;);
&gt; &gt; -
&gt; &gt; -             fullScreenState[area_id] = false;
&gt; &gt; -
&gt; &gt; -     }
&gt; &gt; -     else { // go full screen
&gt; &gt; -             $(window).scrollTop(0);
&gt; &gt; -             $(document.documentElement).css(&#34;overflow&#34;, &#34;hidden&#34;);
&gt; &gt; -
&gt; &gt; -             fullScreenState[area_id] = [];
&gt; &gt; -             fullScreenState[area_id][&#34;hidden&#34;] = [];
&gt; &gt; -             fullScreenState[area_id][&#34;changed&#34;] = [];
&gt; &gt; -             fullScreenState[area_id][&#34;resizable&#34;] = [];
&gt; &gt; -             if ($ta.resizable) {
&gt; &gt; -                     fullScreenState[area_id][&#34;resizable&#34;][&#34;minWidth&#34;]
&gt; = $ta.resizable(&#34;option&#34;, &#34;minWidth&#34;);
&gt; &gt; -                     fullScreenState[area_id][&#34;resizable&#34;][&#34;minHeight&#34;]
&gt; = $ta.resizable(&#34;option&#34;, &#34;minHeight&#34;);
&gt; &gt; -
&gt; &gt; -                     $ta.resizable(&#34;destroy&#34;);
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             var h = $(window).height();
&gt; &gt; -             var w = $(window).width();
&gt; &gt; -
&gt; &gt; -             if ($diff.length) {     // translation diff there so split
&gt; the screen down the middle (for now)
&gt; &gt; -                     w = Math.floor(w / 2) - 5;
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             // store &amp; hide anything not in col1
&gt; &gt; -             fullScreenState[area_id][&#34;hidden&#34;].push($(&#34;#header, #col2,
&gt; #col3, #footer&#34;));
&gt; &gt; -             $(&#34;#header, #col2, #col3, #footer&#34;).hide();
&gt; &gt; -
&gt; &gt; -             // store &amp; reset margins, padding and size for all the
&gt; textarea parents, and hide siblings
&gt; &gt; -             $ta.parents().each(function() {
&gt; &gt; -
&gt; fullScreenState[area_id][&#34;hidden&#34;].push($(this).siblings(&#34;:visible:not(&#39;#diff_outer,
&gt; .translation_message&#39;)&#34;));
&gt; &gt; -                     var ob = [];
&gt; &gt; -                     ob[&#34;el&#34;] = this;
&gt; &gt; -                     ob[&#34;margin-left&#34;] = $(this).css(&#34;margin-left&#34;); //
&gt; this is for IE - it fails using margin or padding as a single setting
&gt; &gt; -                     ob[&#34;margin-right&#34;] = $(this).css(&#34;margin-right&#34;);
&gt; &gt; -                     ob[&#34;margin-top&#34;] = $(this).css(&#34;margin-top&#34;);
&gt; &gt; -                     ob[&#34;margin-bottom&#34;] = $(this).css(&#34;margin-bottom&#34;);
&gt; &gt; -                     ob[&#34;padding-left&#34;] = $(this).css(&#34;padding-left&#34;);
&gt; &gt; -                     ob[&#34;padding-right&#34;] = $(this).css(&#34;padding-right&#34;);
&gt; &gt; -                     ob[&#34;padding-top&#34;] = $(this).css(&#34;padding-top&#34;);
&gt; &gt; -                     ob[&#34;padding-bottom&#34;] =
&gt; $(this).css(&#34;padding-bottom&#34;);
&gt; &gt; -                     ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
&gt; &gt; -                     ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
&gt; &gt; -                     fullScreenState[area_id][&#34;changed&#34;].push(ob);
&gt; &gt; -             });
&gt; &gt; -             $ta.parents().each(function() {
&gt; &gt; -                     $(this).siblings(&#34;:visible:not(&#39;#diff_outer,
&gt; .translation_message&#39;)&#34;).hide();
&gt; &gt; -                     $(this).css(&#34;margin&#34;, 0).css(&#34;padding&#34;,
&gt; 0).width(w).height(h);
&gt; &gt; -             });
&gt; &gt; -
&gt; &gt; -             // store &amp; resize translation diff divs etc
&gt; &gt; -             if ($diff.length) {
&gt; &gt; -                     fullScreenState[area_id][&#34;diff&#34;] = [];
&gt; &gt; -                     fullScreenState[area_id][&#34;diff&#34;][&#34;width&#34;] =
&gt; $diff.width();
&gt; &gt; -                     fullScreenState[area_id][&#34;diff&#34;][&#34;height&#34;] =
&gt; $diff.height();
&gt; &gt; -                     fullScreenState[area_id][&#34;diff&#34;][&#34;float&#34;] =
&gt; $diff.css(&#34;float&#34;);
&gt; &gt; -                     fullScreenState[area_id][&#34;diff_history&#34;] = [];
&gt; &gt; -                     fullScreenState[area_id][&#34;diff_history&#34;][&#34;height&#34;]
&gt; = $(&#34;#diff_history&#34;).height();
&gt; &gt; -                     fullScreenState[area_id][&#34;diff_history&#34;][&#34;width&#34;]
&gt; = $(&#34;#diff_history&#34;).width();
&gt; &gt; -                     $edit_form = $diff.next();
&gt; &gt; -                     $edit_form_innards = $edit_form.find(&#34;.edit-zone,
&gt; table.normal, textarea, fieldset&#34;);
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;] = [];
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;][&#34;el&#34;] =
&gt; $edit_form[0];    // store this element for easy access later
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;][&#34;height&#34;] =
&gt; $edit_form.height();
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;][&#34;width&#34;] =
&gt; $edit_form.width();
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;][&#34;left&#34;] =
&gt; $edit_form.css(&#34;left&#34;) !== &#39;auto&#39; ? $edit_form.css(&#34;left&#34;) : 0;
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form&#34;][&#34;position&#34;]
&gt; = $edit_form.css(&#34;position&#34;);
&gt; &gt; -                     fullScreenState[area_id][&#34;edit_form_innards&#34;] = [];
&gt; &gt; -                     $edit_form_innards.each(function() {
&gt; &gt; -                             var ob = [];
&gt; &gt; -                             ob[&#34;el&#34;] = this;
&gt; &gt; -                             ob[&#34;width&#34;] = $(this).css(&#34;width&#34;);
&gt; &gt; -                             ob[&#34;height&#34;] = $(this).css(&#34;height&#34;);
&gt; &gt; -                             ob[&#34;left&#34;] = $(this).css(&#34;left&#34;);
&gt; &gt; -
&gt; fullScreenState[area_id][&#34;edit_form_innards&#34;].push(ob);
&gt; &gt; -                     });
&gt; &gt; -
&gt; &gt; -                     $diff.parents().each(function() {
&gt;       // shares some parents with the textarea
&gt; &gt; -                             $(this).width($(window).width());       //
&gt; so make room for both
&gt; &gt; -                     });
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             // resize the actual textarea
&gt; &gt; -             fullScreenState[area_id][&#34;ta&#34;] = [];
&gt; &gt; -             fullScreenState[area_id][&#34;ta&#34;][&#34;width&#34;] = $ta.width();
&gt; &gt; -             fullScreenState[area_id][&#34;ta&#34;][&#34;height&#34;] = $ta.height();
&gt; &gt; -             fullScreenState[area_id][&#34;ta&#34;][&#34;float&#34;] = $ta.css(&#34;float&#34;);
&gt; &gt; -
&gt; &gt; -             var b = 0;
&gt; &gt; -             if ($ta.css(&#34;border-left-width&#34;)) {
&gt; &gt; -             b = $ta.css(&#34;border-left-width&#34;).replace(&#34;px&#34;,&#34;&#34;);
&gt; &gt; -             }
&gt; &gt; +     $(&#39;.TextArea-fullscreen&#39;).add(textarea).css(&#39;height&#39;, &#39;&#39;);
&gt; &gt;
&gt; &gt; -             $ta.width(w - b * 2).height($ta.parent().height() -
&gt; $(&#34;.textarea-toolbar&#34;).height() - $(&#34;.translation_message&#34;).height() - 60 -
&gt; b * 2);
&gt; &gt; -
&gt; &gt; -             // add grippy resize bar to translation diff page
&gt; &gt; -             if ($diff.length) {
&gt; &gt; -                     var grippy_width = 10;
&gt; &gt; -                     $diff.width(w).height(h).css(&#34;float&#34;,
&gt; &#34;left&#34;).next().css(&#34;float&#34;, &#34;right&#34;);
&gt; &gt; -                     var vh = $(&#34;#diff_versions&#34;).css(&#34;overflow&#34;,
&gt; &#34;auto&#34;).height() + 18;
&gt; &gt; -                     if (vh &gt; h * 0.15) {
&gt; &gt; -                             vh = h * 0.15;
&gt; &gt; -                     }
&gt; &gt; -                     $(&#34;#diff_versions&#34;).height(vh);
&gt; &gt; -                     $(&#34;#diff_history&#34;).height(h -
&gt; vh).width(w).css(&#34;left&#34;, w + grippy_width);
&gt; &gt; -                     $edit_form.css(&#34;position&#34;,&#34;absolute&#34;).css(&#34;left&#34;,
&gt; w + grippy_width).width(w - grippy_width);
&gt; &gt; -
&gt; &gt; -                     var $grippy = $(&#34;&lt;div id=&#39;fs_grippy_&#34; + area_id
&gt; +&#34;&#39; /&gt;&#34;).css({&#34;background-image&#34;: &#34;url(img/icons/shading.png)&#34;,
&gt; &gt; -
&gt;               &#34;background-repeat&#34;: &#34;repeat-y&#34;,
&gt; &gt; -
&gt;               &#34;background-position&#34;: -3,
&gt; &gt; -
&gt;               &#34;position&#34;: &#34;absolute&#34;,
&gt; &gt; -
&gt;               &#34;left&#34;: w + &#34;px&#34;,
&gt; &gt; -
&gt;               &#34;top&#34;: 0,
&gt; &gt; -
&gt;               &#34;cursor&#34;: &#34;col-resize&#34;})
&gt; &gt; -
&gt; .width(grippy_width).height(h).draggable({axis: &#39;x&#39;, drag: function(event,
&gt; ui) {
&gt; &gt; -
&gt;       $diff.find(&#34;div,table&#34;).width(ui.offset.left - grippy_width);
&gt; &gt; -
&gt;       $edit_form.css(&#34;left&#34;, ui.offset.left +
&gt; grippy_width).find(&#34;#edit-zone, table.normal, textarea, fieldset&#34;)
&gt; &gt; -
&gt;                       .width($(window).width() - ui.offset.left);
&gt; &gt; -
&gt; }});
&gt; &gt; -                     $diff.after($grippy);
&gt; &gt; -
&gt; &gt; -             }
&gt; &gt; -
&gt; &gt; -             // copy and add the action buttons (preview, save etc)
&gt; &gt; -             if ($(&#34;div.top_actions&#34;).length) {
&gt; &gt; -                     $ta.parent().append($(&#34;div.top_actions &gt;
&gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
&gt; &gt; -             } else {
&gt; &gt; -                     $ta.parent().append($(&#34;#editpageform td &gt;
&gt; .wikiaction&#34;).clone(true).addClass(&#34;fs_clones&#34;));
&gt; &gt; -             }
&gt; &gt; +     //removes wiki command buttons (save, cancel, preview) from
&gt; fullscreen view
&gt; &gt; +     $(&#39;.TextArea-fullscreen .wikiaction&#39;).remove();
&gt; &gt;
&gt; &gt; -             // make sure scroll bars appear if necessary
&gt; &gt; -             $ta.parents(&#34;form:first&#34;).css(&#34;overflow&#34;, &#34;auto&#34;);
&gt; &gt; +     var textareaParent =
&gt; textarea.parent().toggleClass(&#39;TextArea-fullscreen&#39;);
&gt; &gt; +     $(&#39;body&#39;).toggleClass(&#39;noScroll&#39;);
&gt; &gt; +     $(&#39;.tabs,.rbox-title&#39;).toggle();
&gt; &gt;
&gt; &gt; -             // show action buttons and reapply cluetip options
&gt; &gt; -             if (jqueryTiki.tooltips) {
&gt; &gt; -                     $(&#34;.fs_clones&#34;).cluetip({splitTitle: &#39;|&#39;,
&gt; showTitle: false, width: &#39;150px&#39;, cluezIndex: 400, fx: {open: &#39;fadeIn&#39;,
&gt; openSpeed: &#39;fast&#39;}, clickThrough: true}).show();
&gt; &gt; -             } else {
&gt; &gt; -                     $(&#34;.fs_clones&#34;).show();
&gt; &gt; -             }
&gt; &gt; +     if (textareaParent.hasClass(&#39;TextArea-fullscreen&#39;)) {
&gt; &gt; +             var win = $window
&gt; &gt; +                     .data(&#39;cm-resize&#39;, true),
&gt; &gt; +                     screen = $(&#39;.TextArea-fullscreen&#39;),
&gt; &gt; +                     toolbar = $(&#39;#editwiki_toolbar&#39;);
&gt; &gt;
&gt; &gt; +             win.resize(function() {
&gt; &gt; +                     if (win.data(&#39;cm-resize&#39;) &amp;&amp; screen) {
&gt; &gt; +                             screen.css(&#39;height&#39;, win.height() + &#39;px&#39;);
&gt; &gt; +
&gt; &gt; +                             textarea
&gt; &gt; +                                     .css(&#39;height&#39;, ((win.height() -
&gt; toolbar.height()) - 30) + &#39;px&#39;);
&gt; &gt; +                     }
&gt; &gt; +             })
&gt; &gt; +                     .resize();
&gt; &gt; +
&gt; &gt; +             //adds wiki command buttons (save, cancel, preview) from
&gt; fullscreen view
&gt; &gt; +             $(&#39;.wikiaction&#39;).clone().appendTo(&#39;.TextArea-fullscreen&#39;);
&gt; &gt; +     } else {
&gt; &gt; +             $window.removeData(&#39;cm-resize&#39;);
&gt; &gt;       }
&gt; &gt; }
&gt; &gt;
&gt; &gt; @@ -2181,8 +2035,8 @@
&gt; &gt;                       $dialog.dialog({
&gt; &gt;                               title: options.title,
&gt; &gt;                               minWidth: 500,
&gt; &gt; -                             height: (options.fullscreen ?
&gt; $(window).height() - 20 : 600),
&gt; &gt; -                             width: (options.fullscreen ?
&gt; $(window).width() - 20 : null),
&gt; &gt; +                             height: (options.fullscreen ?
&gt; $window.height() - 20 : 600),
&gt; &gt; +                             width: (options.fullscreen ?
&gt; $window.width() - 20 : null),
&gt; &gt;                               close: function () {
&gt; &gt;                                       if (options.close) {
&gt; &gt;                                               options.close.apply([],
&gt; this);
&gt; &gt; @@ -2628,8 +2482,8 @@
&gt; &gt;       }
&gt; &gt;
&gt; &gt;       var mid = obj.height() / 2 + obj.offset().top;
&gt; &gt; -     if (mid &gt; $(window).height()) {
&gt; &gt; -             mid = ($(window).height() - obj.offset().top) / 2 +
&gt; obj.offset().top;
&gt; &gt; +     if (mid &gt; $window.height()) {
&gt; &gt; +             mid = ($window.height() - obj.offset().top) / 2 +
&gt; obj.offset().top;
&gt; &gt;       }
&gt; &gt;       s = $.extend({
&gt; &gt;               isEverything: false,
&gt; &gt; @@ -2675,10 +2529,10 @@
&gt; &gt;               s = $.extend(s, {
&gt; &gt;                       top:    0,
&gt; &gt;                       left:   0,
&gt; &gt; -                     height: $(document).height(),
&gt; &gt; -                     width:  $(window).width(),
&gt; &gt; -                     middle: $(window).height() / 2,
&gt; &gt; -                     center: $(window).width() / 2
&gt; &gt; +                     height: $document.height(),
&gt; &gt; +                     width:  $window.width(),
&gt; &gt; +                     middle: $window.height() / 2,
&gt; &gt; +                     center: $window.width() / 2
&gt; &gt;               });
&gt; &gt;       }
&gt; &gt;
&gt; &gt; @@ -2951,7 +2805,7 @@
&gt; &gt;                       .css(&#39;position&#39;, &#39;fixed&#39;)
&gt; &gt;                       .css(&#39;z-index&#39;, 9999999)
&gt; &gt;                       .css(&#39;padding&#39;, &#39;5px&#39;)
&gt; &gt; -                     .width($(window).width() / 5)
&gt; &gt; +                     .width($window.width() / 5)
&gt; &gt;                       .prependTo(&#39;body&#39;);
&gt; &gt;       }
&gt; &gt;
&gt; &gt; @@ -2990,7 +2844,7 @@
&gt; &gt; *   Close (user) sidebar column(s) if no modules are displayed.
&gt; &gt; *   Modules can be hidden at runtime. So, check after the page/DOM model
&gt; is loaded.
&gt; &gt; */
&gt; &gt; -$(document).bind(&#34;ready&#34;, function () {
&gt; &gt; +$document.bind(&#34;ready&#34;, function () {
&gt; &gt;
&gt; &gt;     // Do final client side adjustment of the sidebars
&gt; &gt;     /////////////////////////////////////////
&gt; &gt; @@ -3080,10 +2934,10 @@
&gt; &gt;       w = $el.width(),
&gt; &gt;       o = $el.offset(),
&gt; &gt;       po = $el.parent().offset(),
&gt; &gt; -     st = $(window).scrollTop(),
&gt; &gt; -     sl = $(window).scrollLeft(),
&gt; &gt; -     wh = $(window).height(),
&gt; &gt; -     ww = $(window).width();
&gt; &gt; +     st = $window.scrollTop(),
&gt; &gt; +     sl = $window.scrollLeft(),
&gt; &gt; +     wh = $window.height(),
&gt; &gt; +     ww = $window.width();
&gt; &gt;
&gt; &gt;       if (w + o.left &gt; sl + ww) {
&gt; &gt;               $el.animate({&#39;left&#39;: sl + ww - w - po.left}, &#39;fast&#39;);
&gt; &gt;
&gt; &gt; Modified: branches/9.x/styles/layout/layout.css
&gt; &gt; ===================================================================
&gt; &gt; --- branches/9.x/styles/layout/layout.css     2012-04-03 12:21:47 UTC
&gt; (rev 40670)
&gt; &gt; +++ branches/9.x/styles/layout/layout.css     2012-04-03 12:35:09 UTC
&gt; (rev 40671)
&gt; &gt; @@ -2402,4 +2402,33 @@
&gt; &gt; }
&gt; &gt; /* end structures tiki 9 */
&gt; &gt;
&gt; &gt; +
&gt; &gt; +/*from the codemirror website*/
&gt; &gt; +.TextArea-fullscreen  #editwiki_toolbar {
&gt; &gt; +     width: 100% ! important;
&gt; &gt; +}
&gt; &gt; +
&gt; &gt; +.TextArea-fullscreen  textarea {
&gt; &gt; +     width: inherit ! important;
&gt; &gt; +}
&gt; &gt; +
&gt; &gt; +.TextArea-fullscreen {
&gt; &gt; +     display: block;
&gt; &gt; +     width: 100%;
&gt; &gt; +     height: 100%;
&gt; &gt; +     margin: 0;
&gt; &gt; +     padding: 0;
&gt; &gt; +     border: 0px solid #BBBBBB;
&gt; &gt; +     opacity: 1;
&gt; &gt; +     width: 100%;
&gt; &gt; +     top: 0px ! important;
&gt; &gt; +     left: 0px ! important;
&gt; &gt; +     position: fixed;
&gt; &gt; +     top: expression(eval(document.body.scrollTop + 15) + &#34;px&#34;);
&gt; &gt; +     /*left: expression(eval(document.body.scrollLeft) + &#34;px&#34;);*/
&gt; &gt; +     background-color: gray;
&gt; &gt; +}
&gt; &gt; +.TextArea-fullscreen .cm-remove {
&gt; &gt; +     display: none;
&gt; &gt; +}
&gt; &gt; /* End of File */
&gt; &gt;
&gt; &gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt; Better than sec? Nothing is better than sec when it comes to
&gt; &gt; monitoring Big Data applications. Try Boundary one-second
&gt; &gt; resolution app monitoring today. Free.
&gt; &gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; &gt; _______________________________________________
&gt; &gt; Tikiwiki-cvs mailing list
&gt; &gt; Tikiwiki-cvs@...
&gt; &gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;
&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Live Security Virtual Conference
&gt; Exclusive live event will cover all the ways today&#39;s security and
&gt; threat landscape has changed and how IT managers can respond. Discussions
&gt; will include endpoint security, mobile security and the latest in malware
&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29079880">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29079880/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40681] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-03 14:40:15</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40681
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40681&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40681&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-03 14:40:04 +0000 (Tue, 03 Apr 2012)
Log Message:
-----------
[FIX] Delete wasen&#39;t working ajax style, so added a force parameter in request, and check if it is empty

Modified Paths:
--------------
    branches/9.x/lib/core/Feed/ForwardLink.php
    branches/9.x/lib/jquery_tiki/tiki-jquery.js
    branches/9.x/tiki-view_tracker.php

Modified: branches/9.x/lib/core/Feed/ForwardLink.php
===================================================================
--- branches/9.x/lib/core/Feed/ForwardLink.php	2012-04-03 14:22:53 UTC (rev 40680)
+++ branches/9.x/lib/core/Feed/ForwardLink.php	2012-04-03 14:40:04 UTC (rev 40681)
@@ -276,7 +276,7 @@
 								var itemId = me.data(&#39;itemid&#39;);
 								trackerForm($trackerId, itemId, function(frm) {
 									frm.submit();
-								});
+								}, true);
 
 								return false;
 							});

Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 14:22:53 UTC (rev 40680)
+++ branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-03 14:40:04 UTC (rev 40681)
@@ -2921,9 +2921,10 @@
 			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;save&#34; value=&#34;Save&#34; /&gt;&#39;)
 			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;viewitem&#34; value=&#34;new&#34; /&gt;&#39;);
 	} else {
-		return $(&#39;&lt;form id=&#34;newItemForm&#34; method=&#34;get&#34; action=&#34;tiki-view_tracker.php&#34; enctype=&#34;multipart/form-data&#34; novalidate=&#34;novalidate&#34; /&gt;&#39;)
+		return $(&#39;&lt;form id=&#34;deleteItemForm&#34; method=&#34;get&#34; action=&#34;tiki-view_tracker.php&#34; enctype=&#34;multipart/form-data&#34; novalidate=&#34;novalidate&#34; /&gt;&#39;)
 			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;trackerId&#34; value=&#34;&#39; + trackerId + &#39;&#34; /&gt;&#39;)
-			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;remove&#34; value=&#34;&#39; + itemId + &#39;&#34; /&gt;&#39;);
+			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;remove&#34; value=&#34;&#39; + itemId + &#39;&#34; /&gt;&#39;)
+			.append(&#39;&lt;input type=&#34;hidden&#34; name=&#34;force&#34; value=&#34;y&#34; /&gt;&#39;);
 	}
 };
 

Modified: branches/9.x/tiki-view_tracker.php
===================================================================
--- branches/9.x/tiki-view_tracker.php	2012-04-03 14:22:53 UTC (rev 40680)
+++ branches/9.x/tiki-view_tracker.php	2012-04-03 14:40:04 UTC (rev 40681)
@@ -1,4 +1,4 @@
-&lt;?php
+ &lt;?php
 // (c) Copyright 2002-2012 by authors of the Tiki Wiki CMS Groupware Project
 // 
 // All Rights Reserved. See copyright.txt for details and a complete list of authors.
@@ -251,7 +251,9 @@
 	$item_info = $trklib-&gt;get_item_info($_REQUEST[&#39;remove&#39;]);
 	$actionObject = Tracker_Item::fromInfo($item_info);
 	if ($actionObject-&gt;canRemove()) {
-		$access-&gt;check_authenticity();
+		//bypass the question to confirm delete or not
+		if (empty($_REQUEST[&#39;force&#39;]))
+			$access-&gt;check_authenticity();
 		$trklib-&gt;remove_tracker_item($_REQUEST[&#39;remove&#39;]);
 	}
 } elseif (isset($_REQUEST[&#34;batchaction&#34;]) and $_REQUEST[&#34;batchaction&#34;] == &#39;delete&#39;) {

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29086577">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29086577/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40699] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-04 18:49:30</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40699
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40699&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40699&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-04 18:49:22 +0000 (Wed, 04 Apr 2012)
Log Message:
-----------
[ENH] This is for experimental feature slideshow to pdf, to give font size and landscape

Modified Paths:
--------------
    branches/9.x/templates/tiki-show_page_raw.tpl
    branches/9.x/tiki-slideshow.php

Modified: branches/9.x/templates/tiki-show_page_raw.tpl
===================================================================
--- branches/9.x/templates/tiki-show_page_raw.tpl	2012-04-04 16:33:07 UTC (rev 40698)
+++ branches/9.x/templates/tiki-show_page_raw.tpl	2012-04-04 18:49:22 UTC (rev 40699)
@@ -65,7 +65,7 @@
 		&lt;a href=&#34;#&#34; onclick=&#34;$.s5.toggleLoop(); return false;&#34; title=&#34;{tr}Toggle Loop{/tr}&#34;&gt;
 			&lt;img src=&#34;lib/jquery.s5/images/arrow_rotate_clockwise.png&#34; alt=&#34;{tr}Toggle Loop{/tr}&#34; /&gt;&lt;/a&gt;
 		{if $prefs.feature_slideshow_pdfexport eq &#39;y&#39;}
-			&lt;a href=&#34;#&#34; onclick=&#34;$.s5.exportPDF(&#39;tiki-slideshow.php?page={$page}&amp;pdf&#39;);&#34; title=&#34;{tr}Export to PDF{/tr}&#34;&gt;
+			&lt;a href=&#34;#&#34; onclick=&#34;window.exportPdf(this);&#34;  title=&#34;{tr}Export to PDF{/tr}&#34;&gt;
 				&lt;img alt=&#34;{tr}Export to PDF{/tr}&#34; src=&#34;lib/jquery.s5/images/page_go.png&#34; /&gt;&lt;/a&gt;
 		{/if}
 		&lt;a href=&#34;tiki-index.php?page={$page}&#34; title=&#34;{tr}Exit{/tr}&#34;&gt;
@@ -125,7 +125,7 @@
 		&lt;a href=&#34;#&#34; onclick=&#34;window.opener.$.s5.toggleLoop(); return false;&#34; title=&#34;{tr}Toggle Loop{/tr}&#34;&gt;
 			&lt;img src=&#34;lib/jquery.s5/images/arrow_rotate_clockwise.png&#34; alt=&#34;{tr}Toggle Loop{/tr}&#34; /&gt;&lt;/a&gt;
 		{if $prefs.feature_slideshow_pdfexport eq &#39;y&#39;}
-			&lt;a href=&#34;#&#34; onclick=&#34;window.opener.$.s5.exportPDF(&#39;tiki-slideshow.php?page={$page}&amp;pdf&#39;);&#34; title=&#34;{tr}Export to PDF{/tr}&#34;&gt;
+			&lt;a href=&#34;#&#34; onclick=&#34;window.exportPdf(this);&#34; title=&#34;{tr}Export to PDF{/tr}&#34;&gt;
 				&lt;img alt=&#34;{tr}Export to PDF{/tr}&#34; src=&#34;lib/jquery.s5/images/page_go.png&#34; /&gt;&lt;/a&gt;
 		{/if}
 		&lt;a href=&#34;tiki-index.php?page={$page}&#34; title=&#34;{tr}Exit{/tr}&#34;&gt;
@@ -159,5 +159,61 @@
 			&lt;option value=&#34;swanky-purse&#34;&gt;swanky-purse&lt;/option&gt;
 		&lt;/select&gt;
 	&lt;/div&gt;
+	  {if $prefs.feature_slideshow_pdfexport eq &#39;y&#39;}
+		  {jq}
+
+	        window.exportPdf = function() {
+	            var inputs = $(&#39;&lt;div /&gt;&#39;);
+	            var buttons = {};
+
+	            inputs.append(
+		            tr(&#39;Layout: &#39;) +
+		            &#39;&lt;select id=&#34;layout&#34;&gt;&#39; +
+		                &#39;&lt;option value=&#34;landscape&#34;&gt;&#39; + tr(&#39;Landscape&#39;) + &#39;&lt;/option&gt;&#39; +
+		                &#39;&lt;option value=&#34;portrait&#34;&gt;&#39; + tr(&#39;Portrait&#39;) + &#39;&lt;/option&gt;&#39; +
+		            &#39;&lt;/select&gt;&#39;
+		        );
+
+		        inputs.append(&#39;&lt;br /&gt;&#39;);
+
+		        inputs.append(
+                    tr(&#39;Font Size: &#39;) +
+		            &#39;&lt;select id=&#34;fontsize&#34;&gt;&#39; +
+                        &#39;&lt;option value=&#34;small&#34;&gt;&#39; + tr(&#39;Small&#39;) + &#39;&lt;/option&gt;&#39; +
+                        &#39;&lt;option value=&#34;medium&#34;&gt;&#39; + tr(&#39;Medium&#39;) + &#39;&lt;/option&gt;&#39; +
+		                &#39;&lt;option value=&#34;large&#34;&gt;&#39; + tr(&#39;Large&#39;) + &#39;&lt;/option&gt;&#39; +
+		                &#39;&lt;option value=&#34;x-large&#34;&gt;&#39; + tr(&#39;X-Large&#39;) + &#39;&lt;/option&gt;&#39; +
+                    &#39;&lt;/select&gt;&#39;
+                );
+
+	            buttons[tr(&#34;Ok&#34;)] = function() {
+		            var s5;
+
+		            if (window.opener) {
+		                s5 = window.opener.$.s5;
+		            } else {
+		                s5 = $.s5;
+		            }
+
+		            $body.prepend(&#39;&lt;style id=&#34;tempStyle&#34;&gt;&#39; +
+		            &#39;body *{&#39; +
+		                &#39;font-size:&#39; + escape($(&#39;#fontsize&#39;).val()) + &#39; ! important;&#39; +
+		                &#39;}&#39; +
+		            &#39;&lt;/style&gt;&#39;);
+
+		            s5.exportPDF(&#39;tiki-slideshow.php?page={$page}&amp;pdf&amp;&#39; + $(&#39;#layout&#39;).val() + &#39;&amp;fontsize=&#39; + $(&#39;#fontsize&#39;).val(), tr(&#34;PDF Loading... This can take a minute or two.&#34;));
+		            inputs.dialog(&#39;close&#39;);
+		            $body.find(&#39;#tempStyle&#39;).remove();
+	            };
+
+
+	            inputs.dialog({
+	                title: tr(&#34;Configure&#34;),
+	                buttons: buttons,
+	                modal: true
+	            });
+	        };
+	      {/jq}
+	{/if}
   {/if}
 {/if}

Modified: branches/9.x/tiki-slideshow.php
===================================================================
--- branches/9.x/tiki-slideshow.php	2012-04-04 16:33:07 UTC (rev 40698)
+++ branches/9.x/tiki-slideshow.php	2012-04-04 18:49:22 UTC (rev 40699)
@@ -13,6 +13,7 @@
 include_once (&#39;lib/wiki-plugins/wikiplugin_slideshow.php&#39;);
 
 $access-&gt;check_feature(&#39;feature_wiki&#39;);
+$access-&gt;check_feature(&#39;feature_slideshow&#39;);
 
 //make the other things know we are loading a slideshow
 $tikilib-&gt;is_slideshow = true;
@@ -30,6 +31,7 @@
 }
 
 if (isset($_REQUEST[&#39;pdf&#39;])) {
+	$access-&gt;check_feature(&#34;feature_slideshow_pdfexport&#34;);
 	set_time_limit(777);
 	
 	$_POST[&#34;html&#34;] = urldecode($_POST[&#34;html&#34;]);
@@ -40,8 +42,9 @@
 	
 	if ( isset( $_POST[&#34;html&#34;] ) ) {
 		$dompdf = new DOMPDF();
-		$dompdf-&gt;load_html($_POST[&#34;html&#34;]);
-		$dompdf-&gt;set_paper(&#34;letter&#34;, &#34;portrait&#34;);
+
+		$dompdf-&gt;load_html(urldecode($_REQUEST[&#34;html&#34;]));
+		$dompdf-&gt;set_paper(&#34;letter&#34;, (isset($_REQUEST[&#39;landscape&#39;]) ? &#34;landscape&#34; : &#34;portrait&#34;));
 		$dompdf-&gt;render();
 		
 		$dompdf-&gt;stream(&#34;dompdf_out.pdf&#34;, array(&#34;Attachment&#34; =&gt; false));

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29089092">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29089092/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40745] branches/9.x</a></b></div>
      
      <small>From: &lt;jyhem@us...&gt; - 2012-04-05 07:57:41</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40745
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40745&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40745&amp;view=rev</a>
Author:   jyhem
Date:     2012-04-05 07:57:32 +0000 (Thu, 05 Apr 2012)
Log Message:
-----------
[ENH] Get useful feedback after tracker import

Modified Paths:
--------------
    branches/9.x/lib/core/Services/Tracker/Controller.php
    branches/9.x/templates/tracker/import_items.tpl

Modified: branches/9.x/lib/core/Services/Tracker/Controller.php
===================================================================
--- branches/9.x/lib/core/Services/Tracker/Controller.php	2012-04-05 07:57:06 UTC (rev 40744)
+++ branches/9.x/lib/core/Services/Tracker/Controller.php	2012-04-05 07:57:32 UTC (rev 40745)
@@ -1032,6 +1032,7 @@
 			return array(
 				&#39;trackerId&#39; =&gt; $trackerId,
 				&#39;return&#39; =&gt; $count,
+				&#39;importfile&#39; =&gt; $_FILES[&#39;importfile&#39;][&#39;name&#39;],
 			);
 		}
 		

Modified: branches/9.x/templates/tracker/import_items.tpl
===================================================================
--- branches/9.x/templates/tracker/import_items.tpl	2012-04-05 07:57:06 UTC (rev 40744)
+++ branches/9.x/templates/tracker/import_items.tpl	2012-04-05 07:57:32 UTC (rev 40745)
@@ -3,6 +3,7 @@
 		{include file=&#34;tracker_actions.tpl&#34;}
 	&lt;/div&gt;
 	{remarksbox type=&#34;note&#34; title=&#34;{tr}Confirmation{/tr}&#34;}
+		&lt;p&gt;{tr _0=$importfile}Imported file &#39;%0&#39;{/tr}&lt;/p&gt;
 		&lt;p&gt;{tr _0=$return}Import completed with &#39;%0&#39;{/tr}&lt;/p&gt;
 	{/remarksbox}
 {/if}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29095898">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29095898/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40781] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-06 19:41:08</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40781
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40781&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40781&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-06 19:41:02 +0000 (Fri, 06 Apr 2012)
Log Message:
-----------
[FIX] unit tests: Pass on $local_php to upgrade php scripts so they use the correct database in tests for updates and declare $smarty global

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/installer/schema/99999999_image_plugins_kill_tiki.php
    branches/9.x/lib/test/bootstrap.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-06 19:41:00 UTC (rev 40780)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-06 19:41:02 UTC (rev 40781)
@@ -10,7 +10,7 @@
   exit;
 }
 
-global $tikilib, $prefs, $tikiroot, $user_overrider_prefs, $tiki_p_trust_input, $smarty, $access;	// globals are required here for tiki-setup_base.php
+global $tikilib, $prefs, $tikiroot, $user_overrider_prefs, $tiki_p_trust_input, $smarty, $access, $local_php;	// globals are required here for tiki-setup_base.php
 include_once(&#39;tiki-setup_base.php&#39;);
 
 // ABOUT THE NUMBERING:

Modified: branches/9.x/installer/schema/99999999_image_plugins_kill_tiki.php
===================================================================
--- branches/9.x/installer/schema/99999999_image_plugins_kill_tiki.php	2012-04-06 19:41:00 UTC (rev 40780)
+++ branches/9.x/installer/schema/99999999_image_plugins_kill_tiki.php	2012-04-06 19:41:02 UTC (rev 40781)
@@ -10,7 +10,7 @@
   exit;
 }
 
-global $tikilib, $prefs, $tikiroot, $user_overrider_prefs, $tiki_p_trust_input;	// globals are required here for tiki-setup_base.php
+global $tikilib, $prefs, $tikiroot, $user_overrider_prefs, $tiki_p_trust_input, $smarty, $access, $local_php;	// globals are required here for tiki-setup_base.php
 include_once(&#39;tiki-setup_base.php&#39;);
 
 // ABOUT THE NUMBERING:

Modified: branches/9.x/lib/test/bootstrap.php
===================================================================
--- branches/9.x/lib/test/bootstrap.php	2012-04-06 19:41:00 UTC (rev 40780)
+++ branches/9.x/lib/test/bootstrap.php	2012-04-06 19:41:02 UTC (rev 40781)
@@ -32,7 +32,10 @@
 	die(&#34;\nYou need to setup a new database and create a local.php file for the test suite inside &#34; . dirname(__FILE__) . &#34;\n\n&#34;);
 }
 
-require_once(dirname(__FILE__) . &#39;/local.php&#39;);
+global $local_php, $api_tiki;
+$api_tiki = &#39;adodb&#39;;
+$local_php = dirname(__FILE__) . &#39;/local.php&#39;;
+require_once($local_php);
 
 require_once (&#39;lib/adodb/adodb.inc.php&#39;);
 include_once (&#39;lib/adodb/adodb-pear.inc.php&#39;);
@@ -64,6 +67,7 @@
 
 $pwd = getcwd();
 chdir(dirname(__FILE__) . &#39;/../..&#39;);
+global $smarty;
 require_once &#39;lib/init/smarty.php&#39;;
 $smarty-&gt;addPluginsDir(&#39;../smarty_tiki/&#39;);
 require_once &#39;lib/cache/cachelib.php&#39;;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29096374">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29096374/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40781] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-06 22:00:24</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CABd-ERE7OPu6p4XCs_PuSv-fVxKYLac2rFywA67du7wjpGGQEg%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>$api_tiki = &#39;adodb&#39;;

No pdo?

Tks!

&gt; Modified: branches/9.x/lib/test/bootstrap.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/test/bootstrap.php 2012-04-06 19:41:00 UTC (rev
40780)
&gt; +++ branches/9.x/lib/test/bootstrap.php 2012-04-06 19:41:02 UTC (rev
40781)
&gt; @@ -32,7 +32,10 @@
&gt;        die(&#34;\nYou need to setup a new database and create a local.php
file for the test suite inside &#34; . dirname(__FILE__) . &#34;\n\n&#34;);
&gt;  }
&gt;
&gt; -require_once(dirname(__FILE__) . &#39;/local.php&#39;);
&gt; +global $local_php, $api_tiki;
&gt; +$api_tiki = &#39;adodb&#39;;
&gt; +$local_php = dirname(__FILE__) . &#39;/local.php&#39;;
&gt; +require_once($local_php);
&gt;
&gt;  require_once (&#39;lib/adodb/adodb.inc.php&#39;);
&gt;  include_once (&#39;lib/adodb/adodb-pear.inc.php&#39;);
&gt; @@ -64,6 +67,7 @@
&gt;
&gt;  $pwd = getcwd();
&gt;  chdir(dirname(__FILE__) . &#39;/../..&#39;);
&gt; +global $smarty;
&gt;  require_once &#39;lib/init/smarty.php&#39;;
&gt;  $smarty-&gt;addPluginsDir(&#39;../smarty_tiki/&#39;);
&gt;  require_once &#39;lib/cache/cachelib.php&#39;;
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform,
the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;
------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29098092">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29098092/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40781] branches/9.x</a></b></div>
      
      <small>From: Jonny Bradley &lt;svnupdates@no...&gt; - 2012-04-07 12:38:56</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>
Seems not... &#34;tests&#34; are a very strange place! (i still can&#39;t get most of the tests to run!)

jb


On 6 Apr 2012, at 23:00, Marc Laporte wrote:

&gt; $api_tiki = &#39;adodb&#39;;
&gt; 
&gt; No pdo?
&gt; 
&gt; Tks!
&gt; 
&gt; 
&gt; &gt; Modified: branches/9.x/lib/test/bootstrap.php
&gt; &gt; ===================================================================
&gt; &gt; --- branches/9.x/lib/test/bootstrap.php 2012-04-06 19:41:00 UTC (rev 40780)
&gt; &gt; +++ branches/9.x/lib/test/bootstrap.php 2012-04-06 19:41:02 UTC (rev 40781)
&gt; &gt; @@ -32,7 +32,10 @@
&gt; &gt;        die(&#34;\nYou need to setup a new database and create a local.php file for the test suite inside &#34; . dirname(__FILE__) . &#34;\n\n&#34;);
&gt; &gt;  }
&gt; &gt;
&gt; &gt; -require_once(dirname(__FILE__) . &#39;/local.php&#39;);
&gt; &gt; +global $local_php, $api_tiki;
&gt; &gt; +$api_tiki = &#39;adodb&#39;;
&gt; &gt; +$local_php = dirname(__FILE__) . &#39;/local.php&#39;;
&gt; &gt; +require_once($local_php);
&gt; &gt;
&gt; &gt;  require_once (&#39;lib/adodb/adodb.inc.php&#39;);
&gt; &gt;  include_once (&#39;lib/adodb/adodb-pear.inc.php&#39;);
&gt; &gt; @@ -64,6 +67,7 @@
&gt; &gt;
&gt; &gt;  $pwd = getcwd();
&gt; &gt;  chdir(dirname(__FILE__) . &#39;/../..&#39;);
&gt; &gt; +global $smarty;
&gt; &gt;  require_once &#39;lib/init/smarty.php&#39;;
&gt; &gt;  $smarty-&gt;addPluginsDir(&#39;../smarty_tiki/&#39;);
&gt; &gt;  require_once &#39;lib/cache/cachelib.php&#39;;
&gt; &gt;
&gt; &gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt; &gt;
&gt; &gt;
&gt; &gt; ------------------------------------------------------------------------------
&gt; &gt; For Developers, A Lot Can Happen In A Second.
&gt; &gt; Boundary is the first to Know...and Tell You.
&gt; &gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; &gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; &gt; _______________________________________________
&gt; &gt; Tikiwiki-cvs mailing list
&gt; &gt; Tikiwiki-cvs@...
&gt; &gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2_______________________________________________" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2_______________________________________________</a>
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29098333">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29098333/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40803] branches/9.x</a></b></div>
      
      <small>From: J&lt;yhem@us...&gt; - 2012-04-07 14:25:59</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40803
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40803&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40803&amp;view=rev</a>
Author:   Jyhem
Date:     2012-04-07 14:25:49 +0000 (Sat, 07 Apr 2012)
Log Message:
-----------
[DOC] minor edits (typos, caps, consistency, etc) to English text items. No context or meaning changes.

Modified Paths:
--------------
    branches/9.x/lang/ar/language.php
    branches/9.x/lang/bg/language.php
    branches/9.x/lang/ca/language.php
    branches/9.x/lang/cn/language.php
    branches/9.x/lang/cs/language.php
    branches/9.x/lang/cy/language.php
    branches/9.x/lang/da/language.php
    branches/9.x/lang/de/language.php
    branches/9.x/lang/el/language.php
    branches/9.x/lang/en/language.php
    branches/9.x/lang/en-uk/language.php
    branches/9.x/lang/es/language.php
    branches/9.x/lang/fa/language.php
    branches/9.x/lang/fi/language.php
    branches/9.x/lang/fj/language.php
    branches/9.x/lang/fr/language.php
    branches/9.x/lang/fy-NL/language.php
    branches/9.x/lang/gl/language.php
    branches/9.x/lang/he/language.php
    branches/9.x/lang/hr/language.php
    branches/9.x/lang/hu/language.php
    branches/9.x/lang/id/language.php
    branches/9.x/lang/is/language.php
    branches/9.x/lang/it/language.php
    branches/9.x/lang/iu/language.php
    branches/9.x/lang/ja/language.php
    branches/9.x/lang/ko/language.php
    branches/9.x/lang/lt/language.php
    branches/9.x/lang/nds/language.php
    branches/9.x/lang/nl/language.php
    branches/9.x/lang/no/language.php
    branches/9.x/lang/pl/language.php
    branches/9.x/lang/pt/language.php
    branches/9.x/lang/pt-br/language.php
    branches/9.x/lang/rm/language.php
    branches/9.x/lang/ro/language.php
    branches/9.x/lang/ru/language.php
    branches/9.x/lang/sb/language.php
    branches/9.x/lang/si/language.php
    branches/9.x/lang/sk/language.php
    branches/9.x/lang/sl/language.php
    branches/9.x/lang/sq/language.php
    branches/9.x/lang/sr-latn/language.php
    branches/9.x/lang/sv/language.php
    branches/9.x/lang/tr/language.php
    branches/9.x/lang/tv/language.php
    branches/9.x/lang/tw/language.php
    branches/9.x/lang/uk/language.php
    branches/9.x/lang/vi/language.php
    branches/9.x/lib/core/Tracker/Field/Computed.php
    branches/9.x/lib/prefs/feature.php
    branches/9.x/lib/prefs/server.php
    branches/9.x/lib/prefs/wysiwyg.php
    branches/9.x/lib/rss/rsslib.php
    branches/9.x/lib/wiki-plugins/wikiplugin_addtocart.php
    branches/9.x/lib/wiki-plugins/wikiplugin_htmlfeed.php
    branches/9.x/lib/wiki-plugins/wikiplugin_htmlfeedlink.php
    branches/9.x/lib/wiki-plugins/wikiplugin_img.php
    branches/9.x/lib/wiki-plugins/wikiplugin_js.php
    branches/9.x/lib/wiki-plugins/wikiplugin_lsdir.php
    branches/9.x/lib/wiki-plugins/wikiplugin_sf.php
    branches/9.x/lib/wiki-plugins/wikiplugin_slideshow.php
    branches/9.x/lib/wiki-plugins/wikiplugin_tracker.php
    branches/9.x/templates/admin/include_profiles.tpl
    branches/9.x/templates/tiki-admin_modules.tpl
    branches/9.x/templates/tiki-admin_newsletters.tpl
    branches/9.x/templates/tiki-edit_article.tpl
    branches/9.x/templates/tiki-edit_help.tpl
    branches/9.x/templates/tiki-edit_templates.tpl
    branches/9.x/templates/tiki-importer.tpl
    branches/9.x/templates/tiki-send_newsletters.tpl
    branches/9.x/templates/tiki-user_preferences.tpl
    branches/9.x/tiki-admin_security.php

Modified: branches/9.x/lang/ar/language.php
===================================================================
--- branches/9.x/lang/ar/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/ar/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 // &#34;No&#34; =&gt; &#34;No&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
+// &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom JavaScript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
 // &#34;Formula&#34; =&gt; &#34;Formula&#34;,
 // &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34; =&gt; &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34;,
 // &#34;Country Selector&#34; =&gt; &#34;Country Selector&#34;,
@@ -2017,7 +2019,9 @@
 // &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34; =&gt; &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34;,
 // &#34;Search engine friendly url Postfilter&#34; =&gt; &#34;Search engine friendly url Postfilter&#34;,
 // &#34;Display article title in the sefurl&#34; =&gt; &#34;Display article title in the sefurl&#34;,
+// &#34;Display article title in the SEFURL&#34; =&gt; &#34;Display article title in the sefurl&#34;,
 // &#34;Display blog title in the sefurl&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
+// &#34;Display blog title in the SEFURL&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
 // &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34; =&gt; &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34;,
 // &#34;This redirection uses the wiki prefix alias feature&#34; =&gt; &#34;This redirection uses the wiki prefix alias feature&#34;,
 // &#34;Canonical URL tag&#34; =&gt; &#34;Canonical URL tag&#34;,
@@ -2259,6 +2263,7 @@
 // &#34;Time Sheet&#34; =&gt; &#34;Time Sheet&#34;,
 // &#34;A project time manager&#34; =&gt; &#34;A project time manager&#34;,
 // &#34;Html Feed&#34; =&gt; &#34;Html Feed&#34;,
+// &#34;HTML Feed&#34; =&gt; &#34;Html Feed&#34;,
 // &#34;A way to push and pull html bits around from one site to another&#34; =&gt; &#34;A way to push and pull html bits around from one site to another&#34;,
 // &#34;ForwardLink-Protocol&#34; =&gt; &#34;ForwardLink-Protocol&#34;,
 // &#34;A Dynamic Compendia&#34; =&gt; &#34;A Dynamic Compendia&#34;,
@@ -3056,6 +3061,7 @@
 // &#34;Sender email&#34; =&gt; &#34;Sender email&#34;,
 // &#34;Email address that will be used as the sender for outgoing emails&#34; =&gt; &#34;Email address that will be used as the sender for outgoing emails&#34;,
 // &#34;Timezone&#34; =&gt; &#34;Timezone&#34;,
+// &#34;Time zone&#34; =&gt; &#34;Timezone&#34;,
 // &#34;Indicates the default time zone to use for the server&#34; =&gt; &#34;Indicates the default time zone to use for the server&#34;,
 // &#34;Session storage location&#34; =&gt; &#34;Session storage location&#34;,
 // &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34; =&gt; &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34;,
@@ -3512,8 +3518,10 @@
 // &#34;Reopen with the same editor&#34; =&gt; &#34;Reopen with the same editor&#34;,
 // &#34;Content is parsed like wiki page&#34; =&gt; &#34;Content is parsed like wiki page&#34;,
 // &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
+// &#34;This allows a mixture of wiki and HTML. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
 // &#34;Content is partially wiki parsed&#34; =&gt; &#34;Content is partially wiki parsed&#34;,
 // &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
+// &#34;This also allows a mixture of wiki and HTML. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
 // &#34;Wysiwyg editor skin&#34; =&gt; &#34;Wysiwyg editor skin&#34;,
 // &#34;Kama (Default)&#34; =&gt; &#34;Kama (Default)&#34;,
 // &#34;Office 2003&#34; =&gt; &#34;Office 2003&#34;,
@@ -3637,6 +3645,7 @@
 // &#34;To fix this error go to Admin -&gt; Feeds&#34; =&gt; &#34;To fix this error go to Admin -&gt; Feeds&#34;,
 // &#34;Please contact the site administrator and ask him to fix this error&#34; =&gt; &#34;Please contact the site administrator and ask him to fix this error&#34;,
 // &#34;If you set feed author email or url you have to set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
+// &#34;If you set feed author email or URL, you must set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
 // &#34;Feed logo&#34; =&gt; &#34;Feed logo&#34;,
 // &#34;Unspecified&#34; =&gt; &#34;Unspecified&#34;,
 &#34;Log In&#34; =&gt; &#34;دخول&#34;,
@@ -4403,6 +4412,7 @@
 // &#34;Shop as anonymous always&#34; =&gt; &#34;Shop as anonymous always&#34;,
 // &#34;Add to cart as anonymous shopper even if logged in&#34; =&gt; &#34;Add to cart as anonymous shopper even if logged in&#34;,
 // &#34;Forward to this url after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
+// &#34;Forward to this URL after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
 // &#34;Gift certificate&#34; =&gt; &#34;Gift certificate&#34;,
 // &#34;Allows user to add gift certificate from the product view&#34; =&gt; &#34;Allows user to add gift certificate from the product view&#34;,
 // &#34;Order Item ID to exchange product&#34; =&gt; &#34;Order Item ID to exchange product&#34;,
@@ -5462,7 +5472,9 @@
 // &#34;Parse wiki syntax within the HTML code&#34; =&gt; &#34;Parse wiki syntax within the HTML code&#34;,
 // &#34;Textlink&#34; =&gt; &#34;Textlink&#34;,
 // &#34;Adds an item to html feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
+// &#34;Adds an item to HTML feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
 // &#34;Html Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
+// &#34;HTML Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
 // &#34;Display remote content&#34; =&gt; &#34;Display remote content&#34;,
 // &#34;Initial Value&#34; =&gt; &#34;Initial Value&#34;,
 // &#34;Feed location&#34; =&gt; &#34;Feed location&#34;,
@@ -5471,12 +5483,15 @@
 // &#34;Highlight&#34; =&gt; &#34;Highlight&#34;,
 // &#34;Asterisk&#34; =&gt; &#34;Asterisk&#34;,
 // &#34;Html Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
+// &#34;HTML Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
 &#34;Replace&#34; =&gt; &#34;تعويض&#34;,
 // &#34;Backlink&#34; =&gt; &#34;Backlink&#34;,
 // &#34;Popup&#34; =&gt; &#34;Popup&#34;,
 // &#34;Hover&#34; =&gt; &#34;Hover&#34;,
 // &#34;Is the html feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
+// &#34;Is the HTML feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
 // &#34;Date of last accepted html item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
+// &#34;Date of last accepted HTML item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
 // &#34;Iframe&#34; =&gt; &#34;Iframe&#34;,
 // &#34;Include another web page within a frame&#34; =&gt; &#34;Include another web page within a frame&#34;,
 // &#34;Frame title&#34; =&gt; &#34;Frame title&#34;,
@@ -5538,6 +5553,7 @@
 // &#34;Enlarge button&#34; =&gt; &#34;Enlarge button&#34;,
 // &#34;Button for enlarging image&#34; =&gt; &#34;Button for enlarging image&#34;,
 // &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
+// &#34;Enter a URL to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
 // &#34;Link relation&#34; =&gt; &#34;Link relation&#34;,
 // &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34; =&gt; &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34;,
 // &#34;Image map&#34; =&gt; &#34;Image map&#34;,
@@ -5616,6 +5632,7 @@
 // &#34;Optional markup for when JavaScript is off&#34; =&gt; &#34;Optional markup for when JavaScript is off&#34;,
 // &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34; =&gt; &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34;,
 // &#34;Javascript&#34; =&gt; &#34;Javascript&#34;,
+// &#34;JavaScript&#34; =&gt; &#34;Javascript&#34;,
 // &#34;javascript code&#34; =&gt; &#34;javascript code&#34;,
 // &#34;JavaScript filename&#34; =&gt; &#34;JavaScript filename&#34;,
 // &#34;Kaltura Video&#34; =&gt; &#34;Kaltura Video&#34;,
@@ -5671,6 +5688,7 @@
 // &#34;Full path to the server-local directory. Default is the document root&#34; =&gt; &#34;Full path to the server-local directory. Default is the document root&#34;,
 // &#34;URL Prefix&#34; =&gt; &#34;URL Prefix&#34;,
 // &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
+// &#34;Make the file name a link to the file by adding the URL path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
 // &#34;Set the sort order of the file list&#34; =&gt; &#34;Set the sort order of the file list&#34;,
 // &#34;File Name&#34; =&gt; &#34;File Name&#34;,
 // &#34;File Size&#34; =&gt; &#34;File Size&#34;,
@@ -6039,8 +6057,11 @@
 // &#34;Creates a link to SourceForge tracker items&#34; =&gt; &#34;Creates a link to SourceForge tracker items&#34;,
 // &#34;Group ID&#34; =&gt; &#34;Group ID&#34;,
 // &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
+// &#34;SourceForge project ID (shows as group_id in the URL of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
 // &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
+// &#34;SourceForge tracker ID (shows as atid in the URL of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
 // &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
+// &#34;SourceForge item ID (shows as aid in the URL of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
 // &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34; =&gt; &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34;,
 // &#34;ShareThis&#34; =&gt; &#34;ShareThis&#34;,
 // &#34;Add a ShareThis button&#34; =&gt; &#34;Add a ShareThis button&#34;,
@@ -6175,6 +6196,7 @@
 // &#34;Header font color&#34; =&gt; &#34;Header font color&#34;,
 // &#34;Apply a color to the headers of your slideshow&#34; =&gt; &#34;Apply a color to the headers of your slideshow&#34;,
 // &#34;Any html color&#34; =&gt; &#34;Any html color&#34;,
+// &#34;Any HTML color&#34; =&gt; &#34;Any html color&#34;,
 // &#34;Header background color&#34; =&gt; &#34;Header background color&#34;,
 // &#34;Slide font color&#34; =&gt; &#34;Slide font color&#34;,
 // &#34;Apply a color to the slides of your slideshow&#34; =&gt; &#34;Apply a color to the slides of your slideshow&#34;,
@@ -6414,6 +6436,7 @@
 // &#34;to&#34; =&gt; &#34;to&#34;,
 // &#34;Email format&#34; =&gt; &#34;Email format&#34;,
 // &#34;Text or html setting&#34; =&gt; &#34;Text or html setting&#34;,
+// &#34;Text or HTML setting&#34; =&gt; &#34;Text or html setting&#34;,
 // &#34;URL the user is sent to after the form is submitted&#34; =&gt; &#34;URL the user is sent to after the form is submitted&#34;,
 // &#34;URL Target&#34; =&gt; &#34;URL Target&#34;,
 // &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34; =&gt; &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34;,
@@ -8115,6 +8138,7 @@
 // &#34;Last update&#34; =&gt; &#34;Last update&#34;,
 // &#34;Refresh&#34; =&gt; &#34;Refresh&#34;,
 // &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
+// &#34;JavaScript must be turned &lt;strong&gt;ON&lt;/strong&gt; in order to apply Profiles. Please enable your JavaScript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
 // &#34;Export YAML&#34; =&gt; &#34;Export YAML&#34;,
 // &#34;Export modified preferences as YAML&#34; =&gt; &#34;Export modified preferences as YAML&#34;,
 // &#34;Toggle Visible&#34; =&gt; &#34;Toggle Visible&#34;,
@@ -10021,6 +10045,7 @@
 // &#34;Add unsubscribe instructions to each newsletter&#34; =&gt; &#34;Add unsubscribe instructions to each newsletter&#34;,
 &#34;Validate email addresses&#34; =&gt; &#34;تفعيل عنوان البريد الالكتروني&#34;,
 // &#34;Allow customized text message to be sent with the html version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
+// &#34;Allow customized text message to be sent with the HTML version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
 // &#34;Allow clipping of articles into newsletter&#34; =&gt; &#34;Allow clipping of articles into newsletter&#34;,
 // &#34;Automatically clip articles into newsletter&#34; =&gt; &#34;Automatically clip articles into newsletter&#34;,
 // &#34;Clip articles published in the past number of days&#34; =&gt; &#34;Clip articles published in the past number of days&#34;,
@@ -10780,7 +10805,9 @@
 // &#34;If not the topic name&#34; =&gt; &#34;If not the topic name&#34;,
 // &#34;Allow full HTML&#34; =&gt; &#34;Allow full HTML&#34;,
 // &#34;Keep any html tag&#34; =&gt; &#34;Keep any html tag&#34;,
+// &#34;Keep any HTML tag&#34; =&gt; &#34;Keep any html tag&#34;,
 // &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
+// &#34;If not enabled, Tiki will retain some HTML tags (a, p, pre, img, hr, b, i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
 // &#34;Emails to be notified (separated with commas)&#34; =&gt; &#34;Emails to be notified (separated with commas)&#34;,
 // &#34;Edit or create banners&#34; =&gt; &#34;Edit or create banners&#34;,
 // &#34;List banners&#34; =&gt; &#34;List banners&#34;,
@@ -10920,6 +10947,7 @@
 // &#34;Special characters&#34; =&gt; &#34;Special characters&#34;,
 // &#34;hard space&#34; =&gt; &#34;hard space&#34;,
 // &#34;numeric between ~ for html numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
+// &#34;numeric between ~ for HTML numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
 // &#34;Plugin Help&#34; =&gt; &#34;Plugin Help&#34;,
 // &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34; =&gt; &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34;,
 // &#34;More help here&#34; =&gt; &#34;More help here&#34;,
@@ -11301,6 +11329,7 @@
 // &#34;Tiki Importer&#34; =&gt; &#34;Tiki Importer&#34;,
 // &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34; =&gt; &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34;,
 // &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
+// &#34;If your pages contain XML code, the HTML purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
 // &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34; =&gt; &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34;,
 // &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34; =&gt; &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34;,
 // &#34;Select the software to import from&#34; =&gt; &#34;Select the software to import from&#34;,
@@ -12149,6 +12178,7 @@
 // &#34;Apply content template&#34; =&gt; &#34;Apply content template&#34;,
 // &#34;Data HTML&#34; =&gt; &#34;Data HTML&#34;,
 // &#34;Is html&#34; =&gt; &#34;Is html&#34;,
+// &#34;Is HTML&#34; =&gt; &#34;Is html&#34;,
 // &#34;Data Txt&#34; =&gt; &#34;Data Txt&#34;,
 // &#34;Article Clip (read only)&#34; =&gt; &#34;Article Clip (read only)&#34;,
 // &#34;Clip Now&#34; =&gt; &#34;Clip Now&#34;,
@@ -12534,6 +12564,7 @@
 // &#34;Other languages you can read (select on the left to add to the list on the right)&#34; =&gt; &#34;Other languages you can read (select on the left to add to the list on the right)&#34;,
 // &#34;Select language..&#34; =&gt; &#34;Select language..&#34;,
 // &#34;Detect user timezone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
+// &#34;Detect user time zone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
 // &#34;Use 12-hour clock in time selectors&#34; =&gt; &#34;Use 12-hour clock in time selectors&#34;,
 // &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34; =&gt; &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34;,
 // &#34;Notify sender when reading his mail&#34; =&gt; &#34;Notify sender when reading his mail&#34;,

Modified: branches/9.x/lang/bg/language.php
===================================================================
--- branches/9.x/lang/bg/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/bg/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 // &#34;No&#34; =&gt; &#34;No&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
+// &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom JavaScript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
 // &#34;Formula&#34; =&gt; &#34;Formula&#34;,
 // &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34; =&gt; &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34;,
 // &#34;Country Selector&#34; =&gt; &#34;Country Selector&#34;,
@@ -2017,7 +2019,9 @@
 // &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34; =&gt; &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34;,
 // &#34;Search engine friendly url Postfilter&#34; =&gt; &#34;Search engine friendly url Postfilter&#34;,
 // &#34;Display article title in the sefurl&#34; =&gt; &#34;Display article title in the sefurl&#34;,
+// &#34;Display article title in the SEFURL&#34; =&gt; &#34;Display article title in the sefurl&#34;,
 // &#34;Display blog title in the sefurl&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
+// &#34;Display blog title in the SEFURL&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
 // &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34; =&gt; &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34;,
 // &#34;This redirection uses the wiki prefix alias feature&#34; =&gt; &#34;This redirection uses the wiki prefix alias feature&#34;,
 // &#34;Canonical URL tag&#34; =&gt; &#34;Canonical URL tag&#34;,
@@ -2259,6 +2263,7 @@
 // &#34;Time Sheet&#34; =&gt; &#34;Time Sheet&#34;,
 // &#34;A project time manager&#34; =&gt; &#34;A project time manager&#34;,
 // &#34;Html Feed&#34; =&gt; &#34;Html Feed&#34;,
+// &#34;HTML Feed&#34; =&gt; &#34;Html Feed&#34;,
 // &#34;A way to push and pull html bits around from one site to another&#34; =&gt; &#34;A way to push and pull html bits around from one site to another&#34;,
 // &#34;ForwardLink-Protocol&#34; =&gt; &#34;ForwardLink-Protocol&#34;,
 // &#34;A Dynamic Compendia&#34; =&gt; &#34;A Dynamic Compendia&#34;,
@@ -3056,6 +3061,7 @@
 // &#34;Sender email&#34; =&gt; &#34;Sender email&#34;,
 // &#34;Email address that will be used as the sender for outgoing emails&#34; =&gt; &#34;Email address that will be used as the sender for outgoing emails&#34;,
 // &#34;Timezone&#34; =&gt; &#34;Timezone&#34;,
+// &#34;Time zone&#34; =&gt; &#34;Timezone&#34;,
 // &#34;Indicates the default time zone to use for the server&#34; =&gt; &#34;Indicates the default time zone to use for the server&#34;,
 // &#34;Session storage location&#34; =&gt; &#34;Session storage location&#34;,
 // &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34; =&gt; &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34;,
@@ -3512,8 +3518,10 @@
 // &#34;Reopen with the same editor&#34; =&gt; &#34;Reopen with the same editor&#34;,
 // &#34;Content is parsed like wiki page&#34; =&gt; &#34;Content is parsed like wiki page&#34;,
 // &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
+// &#34;This allows a mixture of wiki and HTML. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
 // &#34;Content is partially wiki parsed&#34; =&gt; &#34;Content is partially wiki parsed&#34;,
 // &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
+// &#34;This also allows a mixture of wiki and HTML. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
 // &#34;Wysiwyg editor skin&#34; =&gt; &#34;Wysiwyg editor skin&#34;,
 // &#34;Kama (Default)&#34; =&gt; &#34;Kama (Default)&#34;,
 // &#34;Office 2003&#34; =&gt; &#34;Office 2003&#34;,
@@ -3637,6 +3645,7 @@
 // &#34;To fix this error go to Admin -&gt; Feeds&#34; =&gt; &#34;To fix this error go to Admin -&gt; Feeds&#34;,
 // &#34;Please contact the site administrator and ask him to fix this error&#34; =&gt; &#34;Please contact the site administrator and ask him to fix this error&#34;,
 // &#34;If you set feed author email or url you have to set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
+// &#34;If you set feed author email or URL, you must set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
 // &#34;Feed logo&#34; =&gt; &#34;Feed logo&#34;,
 // &#34;Unspecified&#34; =&gt; &#34;Unspecified&#34;,
 // &#34;Log In&#34; =&gt; &#34;Log In&#34;,
@@ -4403,6 +4412,7 @@
 // &#34;Shop as anonymous always&#34; =&gt; &#34;Shop as anonymous always&#34;,
 // &#34;Add to cart as anonymous shopper even if logged in&#34; =&gt; &#34;Add to cart as anonymous shopper even if logged in&#34;,
 // &#34;Forward to this url after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
+// &#34;Forward to this URL after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
 // &#34;Gift certificate&#34; =&gt; &#34;Gift certificate&#34;,
 // &#34;Allows user to add gift certificate from the product view&#34; =&gt; &#34;Allows user to add gift certificate from the product view&#34;,
 // &#34;Order Item ID to exchange product&#34; =&gt; &#34;Order Item ID to exchange product&#34;,
@@ -5462,7 +5472,9 @@
 // &#34;Parse wiki syntax within the HTML code&#34; =&gt; &#34;Parse wiki syntax within the HTML code&#34;,
 // &#34;Textlink&#34; =&gt; &#34;Textlink&#34;,
 // &#34;Adds an item to html feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
+// &#34;Adds an item to HTML feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
 // &#34;Html Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
+// &#34;HTML Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
 // &#34;Display remote content&#34; =&gt; &#34;Display remote content&#34;,
 // &#34;Initial Value&#34; =&gt; &#34;Initial Value&#34;,
 // &#34;Feed location&#34; =&gt; &#34;Feed location&#34;,
@@ -5471,12 +5483,15 @@
 // &#34;Highlight&#34; =&gt; &#34;Highlight&#34;,
 // &#34;Asterisk&#34; =&gt; &#34;Asterisk&#34;,
 // &#34;Html Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
+// &#34;HTML Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
 // &#34;Replace&#34; =&gt; &#34;Replace&#34;,
 // &#34;Backlink&#34; =&gt; &#34;Backlink&#34;,
 // &#34;Popup&#34; =&gt; &#34;Popup&#34;,
 // &#34;Hover&#34; =&gt; &#34;Hover&#34;,
 // &#34;Is the html feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
+// &#34;Is the HTML feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
 // &#34;Date of last accepted html item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
+// &#34;Date of last accepted HTML item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
 // &#34;Iframe&#34; =&gt; &#34;Iframe&#34;,
 // &#34;Include another web page within a frame&#34; =&gt; &#34;Include another web page within a frame&#34;,
 // &#34;Frame title&#34; =&gt; &#34;Frame title&#34;,
@@ -5538,6 +5553,7 @@
 // &#34;Enlarge button&#34; =&gt; &#34;Enlarge button&#34;,
 // &#34;Button for enlarging image&#34; =&gt; &#34;Button for enlarging image&#34;,
 // &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
+// &#34;Enter a URL to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
 // &#34;Link relation&#34; =&gt; &#34;Link relation&#34;,
 // &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34; =&gt; &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34;,
 // &#34;Image map&#34; =&gt; &#34;Image map&#34;,
@@ -5616,6 +5632,7 @@
 // &#34;Optional markup for when JavaScript is off&#34; =&gt; &#34;Optional markup for when JavaScript is off&#34;,
 // &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34; =&gt; &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34;,
 // &#34;Javascript&#34; =&gt; &#34;Javascript&#34;,
+// &#34;JavaScript&#34; =&gt; &#34;Javascript&#34;,
 // &#34;javascript code&#34; =&gt; &#34;javascript code&#34;,
 // &#34;JavaScript filename&#34; =&gt; &#34;JavaScript filename&#34;,
 // &#34;Kaltura Video&#34; =&gt; &#34;Kaltura Video&#34;,
@@ -5671,6 +5688,7 @@
 // &#34;Full path to the server-local directory. Default is the document root&#34; =&gt; &#34;Full path to the server-local directory. Default is the document root&#34;,
 // &#34;URL Prefix&#34; =&gt; &#34;URL Prefix&#34;,
 // &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
+// &#34;Make the file name a link to the file by adding the URL path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
 // &#34;Set the sort order of the file list&#34; =&gt; &#34;Set the sort order of the file list&#34;,
 // &#34;File Name&#34; =&gt; &#34;File Name&#34;,
 // &#34;File Size&#34; =&gt; &#34;File Size&#34;,
@@ -6039,8 +6057,11 @@
 // &#34;Creates a link to SourceForge tracker items&#34; =&gt; &#34;Creates a link to SourceForge tracker items&#34;,
 // &#34;Group ID&#34; =&gt; &#34;Group ID&#34;,
 // &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
+// &#34;SourceForge project ID (shows as group_id in the URL of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
 // &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
+// &#34;SourceForge tracker ID (shows as atid in the URL of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
 // &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
+// &#34;SourceForge item ID (shows as aid in the URL of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
 // &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34; =&gt; &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34;,
 // &#34;ShareThis&#34; =&gt; &#34;ShareThis&#34;,
 // &#34;Add a ShareThis button&#34; =&gt; &#34;Add a ShareThis button&#34;,
@@ -6175,6 +6196,7 @@
 // &#34;Header font color&#34; =&gt; &#34;Header font color&#34;,
 // &#34;Apply a color to the headers of your slideshow&#34; =&gt; &#34;Apply a color to the headers of your slideshow&#34;,
 // &#34;Any html color&#34; =&gt; &#34;Any html color&#34;,
+// &#34;Any HTML color&#34; =&gt; &#34;Any html color&#34;,
 // &#34;Header background color&#34; =&gt; &#34;Header background color&#34;,
 // &#34;Slide font color&#34; =&gt; &#34;Slide font color&#34;,
 // &#34;Apply a color to the slides of your slideshow&#34; =&gt; &#34;Apply a color to the slides of your slideshow&#34;,
@@ -6414,6 +6436,7 @@
 // &#34;to&#34; =&gt; &#34;to&#34;,
 // &#34;Email format&#34; =&gt; &#34;Email format&#34;,
 // &#34;Text or html setting&#34; =&gt; &#34;Text or html setting&#34;,
+// &#34;Text or HTML setting&#34; =&gt; &#34;Text or html setting&#34;,
 // &#34;URL the user is sent to after the form is submitted&#34; =&gt; &#34;URL the user is sent to after the form is submitted&#34;,
 // &#34;URL Target&#34; =&gt; &#34;URL Target&#34;,
 // &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34; =&gt; &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34;,
@@ -8115,6 +8138,7 @@
 // &#34;Last update&#34; =&gt; &#34;Last update&#34;,
 // &#34;Refresh&#34; =&gt; &#34;Refresh&#34;,
 // &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
+// &#34;JavaScript must be turned &lt;strong&gt;ON&lt;/strong&gt; in order to apply Profiles. Please enable your JavaScript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
 // &#34;Export YAML&#34; =&gt; &#34;Export YAML&#34;,
 // &#34;Export modified preferences as YAML&#34; =&gt; &#34;Export modified preferences as YAML&#34;,
 // &#34;Toggle Visible&#34; =&gt; &#34;Toggle Visible&#34;,
@@ -10021,6 +10045,7 @@
 // &#34;Add unsubscribe instructions to each newsletter&#34; =&gt; &#34;Add unsubscribe instructions to each newsletter&#34;,
 // &#34;Validate email addresses&#34; =&gt; &#34;Validate email addresses&#34;,
 // &#34;Allow customized text message to be sent with the html version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
+// &#34;Allow customized text message to be sent with the HTML version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
 // &#34;Allow clipping of articles into newsletter&#34; =&gt; &#34;Allow clipping of articles into newsletter&#34;,
 // &#34;Automatically clip articles into newsletter&#34; =&gt; &#34;Automatically clip articles into newsletter&#34;,
 // &#34;Clip articles published in the past number of days&#34; =&gt; &#34;Clip articles published in the past number of days&#34;,
@@ -10780,7 +10805,9 @@
 // &#34;If not the topic name&#34; =&gt; &#34;If not the topic name&#34;,
 // &#34;Allow full HTML&#34; =&gt; &#34;Allow full HTML&#34;,
 // &#34;Keep any html tag&#34; =&gt; &#34;Keep any html tag&#34;,
+// &#34;Keep any HTML tag&#34; =&gt; &#34;Keep any html tag&#34;,
 // &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
+// &#34;If not enabled, Tiki will retain some HTML tags (a, p, pre, img, hr, b, i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
 // &#34;Emails to be notified (separated with commas)&#34; =&gt; &#34;Emails to be notified (separated with commas)&#34;,
 // &#34;Edit or create banners&#34; =&gt; &#34;Edit or create banners&#34;,
 // &#34;List banners&#34; =&gt; &#34;List banners&#34;,
@@ -10920,6 +10947,7 @@
 // &#34;Special characters&#34; =&gt; &#34;Special characters&#34;,
 // &#34;hard space&#34; =&gt; &#34;hard space&#34;,
 // &#34;numeric between ~ for html numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
+// &#34;numeric between ~ for HTML numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
 // &#34;Plugin Help&#34; =&gt; &#34;Plugin Help&#34;,
 // &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34; =&gt; &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34;,
 // &#34;More help here&#34; =&gt; &#34;More help here&#34;,
@@ -11301,6 +11329,7 @@
 // &#34;Tiki Importer&#34; =&gt; &#34;Tiki Importer&#34;,
 // &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34; =&gt; &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34;,
 // &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
+// &#34;If your pages contain XML code, the HTML purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
 // &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34; =&gt; &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34;,
 // &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34; =&gt; &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34;,
 // &#34;Select the software to import from&#34; =&gt; &#34;Select the software to import from&#34;,
@@ -12149,6 +12178,7 @@
 // &#34;Apply content template&#34; =&gt; &#34;Apply content template&#34;,
 // &#34;Data HTML&#34; =&gt; &#34;Data HTML&#34;,
 // &#34;Is html&#34; =&gt; &#34;Is html&#34;,
+// &#34;Is HTML&#34; =&gt; &#34;Is html&#34;,
 // &#34;Data Txt&#34; =&gt; &#34;Data Txt&#34;,
 // &#34;Article Clip (read only)&#34; =&gt; &#34;Article Clip (read only)&#34;,
 // &#34;Clip Now&#34; =&gt; &#34;Clip Now&#34;,
@@ -12534,6 +12564,7 @@
 // &#34;Other languages you can read (select on the left to add to the list on the right)&#34; =&gt; &#34;Other languages you can read (select on the left to add to the list on the right)&#34;,
 // &#34;Select language..&#34; =&gt; &#34;Select language..&#34;,
 // &#34;Detect user timezone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
+// &#34;Detect user time zone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
 // &#34;Use 12-hour clock in time selectors&#34; =&gt; &#34;Use 12-hour clock in time selectors&#34;,
 // &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34; =&gt; &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34;,
 // &#34;Notify sender when reading his mail&#34; =&gt; &#34;Notify sender when reading his mail&#34;,

Modified: branches/9.x/lang/ca/language.php
===================================================================
--- branches/9.x/lang/ca/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/ca/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 &#34;No&#34; =&gt; &#34;No&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
+// &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom JavaScript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
 &#34;Formula&#34; =&gt; &#34;Fórmula&#34;,
 // &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34; =&gt; &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34;,
 // &#34;Country Selector&#34; =&gt; &#34;Country Selector&#34;,
@@ -2017,7 +2019,9 @@
 // &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34; =&gt; &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34;,
 // &#34;Search engine friendly url Postfilter&#34; =&gt; &#34;Search engine friendly url Postfilter&#34;,
 // &#34;Display article title in the sefurl&#34; =&gt; &#34;Display article title in the sefurl&#34;,
+// &#34;Display article title in the SEFURL&#34; =&gt; &#34;Display article title in the sefurl&#34;,
 // &#34;Display blog title in the sefurl&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
+// &#34;Display blog title in the SEFURL&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
 // &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34; =&gt; &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34;,
 // &#34;This redirection uses the wiki prefix alias feature&#34; =&gt; &#34;This redirection uses the wiki prefix alias feature&#34;,
 // &#34;Canonical URL tag&#34; =&gt; &#34;Canonical URL tag&#34;,
@@ -2259,6 +2263,7 @@
 // &#34;Time Sheet&#34; =&gt; &#34;Time Sheet&#34;,
 // &#34;A project time manager&#34; =&gt; &#34;A project time manager&#34;,
 // &#34;Html Feed&#34; =&gt; &#34;Html Feed&#34;,
+// &#34;HTML Feed&#34; =&gt; &#34;Html Feed&#34;,
 // &#34;A way to push and pull html bits around from one site to another&#34; =&gt; &#34;A way to push and pull html bits around from one site to another&#34;,
 // &#34;ForwardLink-Protocol&#34; =&gt; &#34;ForwardLink-Protocol&#34;,
 // &#34;A Dynamic Compendia&#34; =&gt; &#34;A Dynamic Compendia&#34;,
@@ -3056,6 +3061,7 @@
 &#34;Sender email&#34; =&gt; &#34;correu-e de l&#39;enviador&#34;,
 // &#34;Email address that will be used as the sender for outgoing emails&#34; =&gt; &#34;Email address that will be used as the sender for outgoing emails&#34;,
 // &#34;Timezone&#34; =&gt; &#34;Timezone&#34;,
+// &#34;Time zone&#34; =&gt; &#34;Timezone&#34;,
 // &#34;Indicates the default time zone to use for the server&#34; =&gt; &#34;Indicates the default time zone to use for the server&#34;,
 // &#34;Session storage location&#34; =&gt; &#34;Session storage location&#34;,
 // &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34; =&gt; &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34;,
@@ -3512,8 +3518,10 @@
 &#34;Reopen with the same editor&#34; =&gt; &#34;Reobre amb el mateix editor&#34;,
 &#34;Content is parsed like wiki page&#34; =&gt; &#34;El contingut és processat com una pàgina Wiki&#34;,
 // &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
+// &#34;This allows a mixture of wiki and HTML. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
 // &#34;Content is partially wiki parsed&#34; =&gt; &#34;Content is partially wiki parsed&#34;,
 // &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
+// &#34;This also allows a mixture of wiki and HTML. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
 // &#34;Wysiwyg editor skin&#34; =&gt; &#34;Wysiwyg editor skin&#34;,
 // &#34;Kama (Default)&#34; =&gt; &#34;Kama (Default)&#34;,
 // &#34;Office 2003&#34; =&gt; &#34;Office 2003&#34;,
@@ -3637,6 +3645,7 @@
 // &#34;To fix this error go to Admin -&gt; Feeds&#34; =&gt; &#34;To fix this error go to Admin -&gt; Feeds&#34;,
 // &#34;Please contact the site administrator and ask him to fix this error&#34; =&gt; &#34;Please contact the site administrator and ask him to fix this error&#34;,
 // &#34;If you set feed author email or url you have to set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
+// &#34;If you set feed author email or URL, you must set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
 // &#34;Feed logo&#34; =&gt; &#34;Feed logo&#34;,
 &#34;Unspecified&#34; =&gt; &#34;No especificat&#34;,
 // &#34;Log In&#34; =&gt; &#34;Log In&#34;,
@@ -4404,6 +4413,7 @@
 // &#34;Shop as anonymous always&#34; =&gt; &#34;Shop as anonymous always&#34;,
 // &#34;Add to cart as anonymous shopper even if logged in&#34; =&gt; &#34;Add to cart as anonymous shopper even if logged in&#34;,
 // &#34;Forward to this url after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
+// &#34;Forward to this URL after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
 // &#34;Gift certificate&#34; =&gt; &#34;Gift certificate&#34;,
 // &#34;Allows user to add gift certificate from the product view&#34; =&gt; &#34;Allows user to add gift certificate from the product view&#34;,
 // &#34;Order Item ID to exchange product&#34; =&gt; &#34;Order Item ID to exchange product&#34;,
@@ -5464,7 +5474,9 @@
 // &#34;Parse wiki syntax within the HTML code&#34; =&gt; &#34;Parse wiki syntax within the HTML code&#34;,
 // &#34;Textlink&#34; =&gt; &#34;Textlink&#34;,
 // &#34;Adds an item to html feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
+// &#34;Adds an item to HTML feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
 // &#34;Html Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
+// &#34;HTML Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
 // &#34;Display remote content&#34; =&gt; &#34;Display remote content&#34;,
 // &#34;Initial Value&#34; =&gt; &#34;Initial Value&#34;,
 // &#34;Feed location&#34; =&gt; &#34;Feed location&#34;,
@@ -5473,12 +5485,15 @@
 // &#34;Highlight&#34; =&gt; &#34;Highlight&#34;,
 // &#34;Asterisk&#34; =&gt; &#34;Asterisk&#34;,
 // &#34;Html Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
+// &#34;HTML Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
 &#34;Replace&#34; =&gt; &#34;Reemplaçar&#34;,
 // &#34;Backlink&#34; =&gt; &#34;Backlink&#34;,
 // &#34;Popup&#34; =&gt; &#34;Popup&#34;,
 // &#34;Hover&#34; =&gt; &#34;Hover&#34;,
 // &#34;Is the html feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
+// &#34;Is the HTML feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
 // &#34;Date of last accepted html item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
+// &#34;Date of last accepted HTML item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
 &#34;Iframe&#34; =&gt; &#34;Iframe&#34;,
 // &#34;Include another web page within a frame&#34; =&gt; &#34;Include another web page within a frame&#34;,
 // &#34;Frame title&#34; =&gt; &#34;Frame title&#34;,
@@ -5540,6 +5555,7 @@
 // &#34;Enlarge button&#34; =&gt; &#34;Enlarge button&#34;,
 // &#34;Button for enlarging image&#34; =&gt; &#34;Button for enlarging image&#34;,
 // &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
+// &#34;Enter a URL to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
 // &#34;Link relation&#34; =&gt; &#34;Link relation&#34;,
 // &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34; =&gt; &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34;,
 // &#34;Image map&#34; =&gt; &#34;Image map&#34;,
@@ -5618,6 +5634,7 @@
 // &#34;Optional markup for when JavaScript is off&#34; =&gt; &#34;Optional markup for when JavaScript is off&#34;,
 // &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34; =&gt; &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34;,
 // &#34;Javascript&#34; =&gt; &#34;Javascript&#34;,
+// &#34;JavaScript&#34; =&gt; &#34;Javascript&#34;,
 // &#34;javascript code&#34; =&gt; &#34;javascript code&#34;,
 // &#34;JavaScript filename&#34; =&gt; &#34;JavaScript filename&#34;,
 // &#34;Kaltura Video&#34; =&gt; &#34;Kaltura Video&#34;,
@@ -5673,6 +5690,7 @@
 // &#34;Full path to the server-local directory. Default is the document root&#34; =&gt; &#34;Full path to the server-local directory. Default is the document root&#34;,
 // &#34;URL Prefix&#34; =&gt; &#34;URL Prefix&#34;,
 // &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
+// &#34;Make the file name a link to the file by adding the URL path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
 // &#34;Set the sort order of the file list&#34; =&gt; &#34;Set the sort order of the file list&#34;,
 &#34;File Name&#34; =&gt; &#34;Nom d&#39;arxiu&#34;,
 // &#34;File Size&#34; =&gt; &#34;File Size&#34;,
@@ -6043,8 +6061,11 @@
 // &#34;Creates a link to SourceForge tracker items&#34; =&gt; &#34;Creates a link to SourceForge tracker items&#34;,
 // &#34;Group ID&#34; =&gt; &#34;Group ID&#34;,
 // &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
+// &#34;SourceForge project ID (shows as group_id in the URL of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
 // &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
+// &#34;SourceForge tracker ID (shows as atid in the URL of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
 // &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
+// &#34;SourceForge item ID (shows as aid in the URL of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
 // &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34; =&gt; &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34;,
 // &#34;ShareThis&#34; =&gt; &#34;ShareThis&#34;,
 // &#34;Add a ShareThis button&#34; =&gt; &#34;Add a ShareThis button&#34;,
@@ -6179,6 +6200,7 @@
 // &#34;Header font color&#34; =&gt; &#34;Header font color&#34;,
 // &#34;Apply a color to the headers of your slideshow&#34; =&gt; &#34;Apply a color to the headers of your slideshow&#34;,
 // &#34;Any html color&#34; =&gt; &#34;Any html color&#34;,
+// &#34;Any HTML color&#34; =&gt; &#34;Any html color&#34;,
 // &#34;Header background color&#34; =&gt; &#34;Header background color&#34;,
 // &#34;Slide font color&#34; =&gt; &#34;Slide font color&#34;,
 // &#34;Apply a color to the slides of your slideshow&#34; =&gt; &#34;Apply a color to the slides of your slideshow&#34;,
@@ -6419,6 +6441,7 @@
 &#34;to&#34; =&gt; &#34;a&#34;,
 // &#34;Email format&#34; =&gt; &#34;Email format&#34;,
 // &#34;Text or html setting&#34; =&gt; &#34;Text or html setting&#34;,
+// &#34;Text or HTML setting&#34; =&gt; &#34;Text or html setting&#34;,
 // &#34;URL the user is sent to after the form is submitted&#34; =&gt; &#34;URL the user is sent to after the form is submitted&#34;,
 // &#34;URL Target&#34; =&gt; &#34;URL Target&#34;,
 // &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34; =&gt; &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34;,
@@ -8123,6 +8146,7 @@
 &#34;Last update&#34; =&gt; &#34;Última actualització&#34;,
 &#34;Refresh&#34; =&gt; &#34;Refrescar&#34;,
 // &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
+// &#34;JavaScript must be turned &lt;strong&gt;ON&lt;/strong&gt; in order to apply Profiles. Please enable your JavaScript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
 // &#34;Export YAML&#34; =&gt; &#34;Export YAML&#34;,
 &#34;Object type:&#34; =&gt; &#34;Tipus d&#39;objecte:&#34;,
 // &#34;Export modified preferences as YAML&#34; =&gt; &#34;Export modified preferences as YAML&#34;,
@@ -9988,7 +10012,7 @@
 // &#34;Custom Modules&#34; =&gt; &#34;Custom Modules&#34;,
 // &#34;Create new custom module&#34; =&gt; &#34;Create new custom module&#34;,
 // &#34;Edit this custom module&#34; =&gt; &#34;Edit this custom module&#34;,
-&#34;Create your new custom module below. Make sure to preview first and make sure all is OK before &lt;a href=\&#34;#assign\&#34;&gt;assigning it&lt;/a&gt;. Using html, you will be fine. However, if you improperly use wiki syntax or Smarty code, you could lock yourself out of the site.&#34; =&gt; &#34;Crea el teu nou mòdul personalitzat a continuació. Assegura&#39;t de previsualitzar-lo primer i que tot és correcte abans d&#39;&lt;a href=\&#34;#assign\&#34;&gt;assignar-lo&lt;/a&gt;. Pots emprar html si vols a més. No obstant això, si utilizes la sintaxi wiki o un codi Smarty de manera incorrecta, pot ser que tu mateix t&#39;expulsis del lloc web.&#34;,
+&#34;Create your new custom module below. Make sure to preview first and make sure all is OK before &lt;a href=\&#34;#assign\&#34;&gt;assigning it&lt;/a&gt;. Using HTML, you will be fine. However, if you improperly use wiki syntax or Smarty code, you could lock yourself out of the site.&#34; =&gt; &#34;Crea el teu nou mòdul personalitzat a continuació. Assegura&#39;t de previsualitzar-lo primer i que tot és correcte abans d&#39;&lt;a href=\&#34;#assign\&#34;&gt;assignar-lo&lt;/a&gt;. Pots emprar html si vols a més. No obstant això, si utilizes la sintaxi wiki o un codi Smarty de manera incorrecta, pot ser que tu mateix t&#39;expulsis del lloc web.&#34;,
 &#34;Must be wiki parsed&#34; =&gt; &#34;Interpreta el format Wiki&#34;,
 &#34;Objects that can be included&#34; =&gt; &#34;Objectes que es poden incloure&#34;,
 &#34;Available polls&#34; =&gt; &#34;Consultes disponibles&#34;,
@@ -10060,6 +10084,7 @@
 &#34;Add unsubscribe instructions to each newsletter&#34; =&gt; &#34;Afegir instruccions de desubscripció a cada butlletí&#34;,
 &#34;Validate email addresses&#34; =&gt; &#34;Valida adreces de correu-e&#34;,
 &#34;Allow customized text message to be sent with the html version&#34; =&gt; &#34;Permet que s&#39;hi pugui posar un missatge de text senzill personalitzat amb l&#39;enviament de la versió en html&#34;,
+&#34;Allow customized text message to be sent with the HTML version&#34; =&gt; &#34;Permet que s&#39;hi pugui posar un missatge de text senzill personalitzat amb l&#39;enviament de la versió en html&#34;,
 &#34;Allow clipping of articles into newsletter&#34; =&gt; &#34;Permet el retallat d&#39;articles a dins d&#39;un butlletí&#34;,
 &#34;Automatically clip articles into newsletter&#34; =&gt; &#34;Retalla automàticament els articles a dins del butlletí&#34;,
 &#34;Clip articles published in the past number of days&#34; =&gt; &#34;Retalla els articles publicats en el darrer número de dies&#34;,
@@ -10822,7 +10847,9 @@
 // &#34;If not the topic name&#34; =&gt; &#34;If not the topic name&#34;,
 // &#34;Allow full HTML&#34; =&gt; &#34;Allow full HTML&#34;,
 // &#34;Keep any html tag&#34; =&gt; &#34;Keep any html tag&#34;,
+// &#34;Keep any HTML tag&#34; =&gt; &#34;Keep any html tag&#34;,
 // &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
+// &#34;If not enabled, Tiki will retain some HTML tags (a, p, pre, img, hr, b, i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
 // &#34;Emails to be notified (separated with commas)&#34; =&gt; &#34;Emails to be notified (separated with commas)&#34;,
 &#34;Edit or create banners&#34; =&gt; &#34;Edita o crea blocs de publicitat&#34;,
 &#34;List banners&#34; =&gt; &#34;Llista butlletins&#34;,
@@ -10963,6 +10990,7 @@
 &#34;Special characters&#34; =&gt; &#34;Caràcters especials&#34;,
 &#34;hard space&#34; =&gt; &#34;espai rigid (no permet que es trenqui la línia)&#34;,
 &#34;numeric between ~ for html numeric characters entity&#34; =&gt; &#34;numeric entre ~ per a entitats html de caràcters numèrics&#34;,
+&#34;numeric between ~ for HTML numeric characters entity&#34; =&gt; &#34;numeric entre ~ per a entitats html de caràcters numèrics&#34;,
 &#34;Plugin Help&#34; =&gt; &#34;Ajuda de Plugins&#34;,
 &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt;&#34; =&gt; &#34;Fixa&#39;t que els arguments dels connectors (plugins) es poden envoltar de cometes dobles (&amp;quot;); això permet que continguin , o = o &amp;gt;&#34;,
 &#34;More help here&#34; =&gt; &#34;Més ajuda, aquí&#34;,
@@ -11348,6 +11376,7 @@
 // &#34;Tiki Importer&#34; =&gt; &#34;Tiki Importer&#34;,
 // &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34; =&gt; &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34;,
 // &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
+// &#34;If your pages contain XML code, the HTML purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
 // &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34; =&gt; &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34;,
 // &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34; =&gt; &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34;,
 // &#34;Select the software to import from&#34; =&gt; &#34;Select the software to import from&#34;,
@@ -12207,6 +12236,7 @@
 &#34;Apply content template&#34; =&gt; &#34;Aplica la plantilla de contingut&#34;,
 &#34;Data HTML&#34; =&gt; &#34;Dades HTML&#34;,
 // &#34;Is html&#34; =&gt; &#34;Is html&#34;,
+// &#34;Is HTML&#34; =&gt; &#34;Is html&#34;,
 &#34;Data Txt&#34; =&gt; &#34;Dades Txt&#34;,
 &#34;Article Clip (read only)&#34; =&gt; &#34;Retall d&#39;article (només de lectura)&#34;,
 &#34;Clip Now&#34; =&gt; &#34;Inclou retalls ara&#34;,
@@ -12593,6 +12623,7 @@
 &#34;Other languages you can read (select on the left to add to the list on the right)&#34; =&gt; &#34;Altres idiomes que pots llegir (selecciona a l&#39;esquerra per afegir a la llista de la dreta - l&#39;ordre importa)&#34;,
 &#34;Select language...&#34; =&gt; &#34;Selecciona l&#39;idioma...&#34;,
 &#34;Detect user timezone if browser allows, otherwise site default&#34; =&gt; &#34;Detecta la zona horària de l&#39;usuari si el navegador ho permet, d&#39;altra forma, per defecte del lloc&#34;,
+&#34;Detect user time zone if browser allows, otherwise site default&#34; =&gt; &#34;Detecta la zona horària de l&#39;usuari si el navegador ho permet, d&#39;altra forma, per defecte del lloc&#34;,
 // &#34;Use 12-hour clock in time selectors&#34; =&gt; &#34;Use 12-hour clock in time selectors&#34;,
 &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34; =&gt; &#34;Mostra requadre d&#39;informació en passar el ratolí per sobre per a cada usuari que permet que la seva informació sigui pública&#34;,
 &#34;Notify sender when reading his mail&#34; =&gt; &#34;Avisa l&#39;autor quan llegiu el seu missatge&#34;,

Modified: branches/9.x/lang/cn/language.php
===================================================================
--- branches/9.x/lang/cn/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/cn/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 &#34;No&#34; =&gt; &#34;否&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
+// &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom JavaScript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
 // &#34;Formula&#34; =&gt; &#34;Formula&#34;,
 // &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34; =&gt; &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34;,
 // &#34;Country Selector&#34; =&gt; &#34;Country Selector&#34;,
@@ -2017,7 +2019,9 @@
 // &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34; =&gt; &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34;,
 // &#34;Search engine friendly url Postfilter&#34; =&gt; &#34;Search engine friendly url Postfilter&#34;,
 // &#34;Display article title in the sefurl&#34; =&gt; &#34;Display article title in the sefurl&#34;,
+// &#34;Display article title in the SEFURL&#34; =&gt; &#34;Display article title in the sefurl&#34;,
 // &#34;Display blog title in the sefurl&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
+// &#34;Display blog title in the SEFURL&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
 // &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34; =&gt; &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34;,
 // &#34;This redirection uses the wiki prefix alias feature&#34; =&gt; &#34;This redirection uses the wiki prefix alias feature&#34;,
 // &#34;Canonical URL tag&#34; =&gt; &#34;Canonical URL tag&#34;,
@@ -2259,6 +2263,7 @@
 // &#34;Time Sheet&#34; =&gt; &#34;Time Sheet&#34;,
 // &#34;A project time manager&#34; =&gt; &#34;A project time manager&#34;,
 // &#34;Html Feed&#34; =&gt; &#34;Html Feed&#34;,
+// &#34;HTML Feed&#34; =&gt; &#34;Html Feed&#34;,
 // &#34;A way to push and pull html bits around from one site to another&#34; =&gt; &#34;A way to push and pull html bits around from one site to another&#34;,
 // &#34;ForwardLink-Protocol&#34; =&gt; &#34;ForwardLink-Protocol&#34;,
 // &#34;A Dynamic Compendia&#34; =&gt; &#34;A Dynamic Compendia&#34;,
@@ -3056,6 +3061,7 @@
 // &#34;Sender email&#34; =&gt; &#34;Sender email&#34;,
 // &#34;Email address that will be used as the sender for outgoing emails&#34; =&gt; &#34;Email address that will be used as the sender for outgoing emails&#34;,
 // &#34;Timezone&#34; =&gt; &#34;Timezone&#34;,
+// &#34;Time zone&#34; =&gt; &#34;Timezone&#34;,
 // &#34;Indicates the default time zone to use for the server&#34; =&gt; &#34;Indicates the default time zone to use for the server&#34;,
 // &#34;Session storage location&#34; =&gt; &#34;Session storage location&#34;,
 // &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34; =&gt; &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34;,
@@ -3512,8 +3518,10 @@
 // &#34;Reopen with the same editor&#34; =&gt; &#34;Reopen with the same editor&#34;,
 // &#34;Content is parsed like wiki page&#34; =&gt; &#34;Content is parsed like wiki page&#34;,
 // &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
+// &#34;This allows a mixture of wiki and HTML. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
 // &#34;Content is partially wiki parsed&#34; =&gt; &#34;Content is partially wiki parsed&#34;,
 // &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
+// &#34;This also allows a mixture of wiki and HTML. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
 // &#34;Wysiwyg editor skin&#34; =&gt; &#34;Wysiwyg editor skin&#34;,
 // &#34;Kama (Default)&#34; =&gt; &#34;Kama (Default)&#34;,
 // &#34;Office 2003&#34; =&gt; &#34;Office 2003&#34;,
@@ -3637,6 +3645,7 @@
 // &#34;To fix this error go to Admin -&gt; Feeds&#34; =&gt; &#34;To fix this error go to Admin -&gt; Feeds&#34;,
 // &#34;Please contact the site administrator and ask him to fix this error&#34; =&gt; &#34;Please contact the site administrator and ask him to fix this error&#34;,
 // &#34;If you set feed author email or url you have to set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
+// &#34;If you set feed author email or URL, you must set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
 // &#34;Feed logo&#34; =&gt; &#34;Feed logo&#34;,
 // &#34;Unspecified&#34; =&gt; &#34;Unspecified&#34;,
 &#34;Log In&#34; =&gt; &#34;登录&#34;,
@@ -4403,6 +4412,7 @@
 // &#34;Shop as anonymous always&#34; =&gt; &#34;Shop as anonymous always&#34;,
 // &#34;Add to cart as anonymous shopper even if logged in&#34; =&gt; &#34;Add to cart as anonymous shopper even if logged in&#34;,
 // &#34;Forward to this url after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
+// &#34;Forward to this URL after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
 // &#34;Gift certificate&#34; =&gt; &#34;Gift certificate&#34;,
 // &#34;Allows user to add gift certificate from the product view&#34; =&gt; &#34;Allows user to add gift certificate from the product view&#34;,
 // &#34;Order Item ID to exchange product&#34; =&gt; &#34;Order Item ID to exchange product&#34;,
@@ -5462,7 +5472,9 @@
 // &#34;Parse wiki syntax within the HTML code&#34; =&gt; &#34;Parse wiki syntax within the HTML code&#34;,
 // &#34;Textlink&#34; =&gt; &#34;Textlink&#34;,
 // &#34;Adds an item to html feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
+// &#34;Adds an item to HTML feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
 // &#34;Html Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
+// &#34;HTML Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
 // &#34;Display remote content&#34; =&gt; &#34;Display remote content&#34;,
 // &#34;Initial Value&#34; =&gt; &#34;Initial Value&#34;,
 // &#34;Feed location&#34; =&gt; &#34;Feed location&#34;,
@@ -5471,12 +5483,15 @@
 // &#34;Highlight&#34; =&gt; &#34;Highlight&#34;,
 // &#34;Asterisk&#34; =&gt; &#34;Asterisk&#34;,
 // &#34;Html Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
+// &#34;HTML Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
 &#34;Replace&#34; =&gt; &#34;替换&#34;,
 // &#34;Backlink&#34; =&gt; &#34;Backlink&#34;,
 // &#34;Popup&#34; =&gt; &#34;Popup&#34;,
 // &#34;Hover&#34; =&gt; &#34;Hover&#34;,
 // &#34;Is the html feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
+// &#34;Is the HTML feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
 // &#34;Date of last accepted html item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
+// &#34;Date of last accepted HTML item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
 // &#34;Iframe&#34; =&gt; &#34;Iframe&#34;,
 // &#34;Include another web page within a frame&#34; =&gt; &#34;Include another web page within a frame&#34;,
 // &#34;Frame title&#34; =&gt; &#34;Frame title&#34;,
@@ -5538,6 +5553,7 @@
 // &#34;Enlarge button&#34; =&gt; &#34;Enlarge button&#34;,
 // &#34;Button for enlarging image&#34; =&gt; &#34;Button for enlarging image&#34;,
 // &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
+// &#34;Enter a URL to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
 // &#34;Link relation&#34; =&gt; &#34;Link relation&#34;,
 // &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34; =&gt; &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34;,
 // &#34;Image map&#34; =&gt; &#34;Image map&#34;,
@@ -5616,6 +5632,7 @@
 // &#34;Optional markup for when JavaScript is off&#34; =&gt; &#34;Optional markup for when JavaScript is off&#34;,
 // &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34; =&gt; &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34;,
 // &#34;Javascript&#34; =&gt; &#34;Javascript&#34;,
+// &#34;JavaScript&#34; =&gt; &#34;Javascript&#34;,
 // &#34;javascript code&#34; =&gt; &#34;javascript code&#34;,
 // &#34;JavaScript filename&#34; =&gt; &#34;JavaScript filename&#34;,
 // &#34;Kaltura Video&#34; =&gt; &#34;Kaltura Video&#34;,
@@ -5671,6 +5688,7 @@
 // &#34;Full path to the server-local directory. Default is the document root&#34; =&gt; &#34;Full path to the server-local directory. Default is the document root&#34;,
 // &#34;URL Prefix&#34; =&gt; &#34;URL Prefix&#34;,
 // &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
+// &#34;Make the file name a link to the file by adding the URL path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
 // &#34;Set the sort order of the file list&#34; =&gt; &#34;Set the sort order of the file list&#34;,
 // &#34;File Name&#34; =&gt; &#34;File Name&#34;,
 // &#34;File Size&#34; =&gt; &#34;File Size&#34;,
@@ -6039,8 +6057,11 @@
 // &#34;Creates a link to SourceForge tracker items&#34; =&gt; &#34;Creates a link to SourceForge tracker items&#34;,
 // &#34;Group ID&#34; =&gt; &#34;Group ID&#34;,
 // &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
+// &#34;SourceForge project ID (shows as group_id in the URL of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
 // &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
+// &#34;SourceForge tracker ID (shows as atid in the URL of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
 // &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
+// &#34;SourceForge item ID (shows as aid in the URL of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
 // &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34; =&gt; &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34;,
 // &#34;ShareThis&#34; =&gt; &#34;ShareThis&#34;,
 // &#34;Add a ShareThis button&#34; =&gt; &#34;Add a ShareThis button&#34;,
@@ -6175,6 +6196,7 @@
 // &#34;Header font color&#34; =&gt; &#34;Header font color&#34;,
 // &#34;Apply a color to the headers of your slideshow&#34; =&gt; &#34;Apply a color to the headers of your slideshow&#34;,
 // &#34;Any html color&#34; =&gt; &#34;Any html color&#34;,
+// &#34;Any HTML color&#34; =&gt; &#34;Any html color&#34;,
 // &#34;Header background color&#34; =&gt; &#34;Header background color&#34;,
 // &#34;Slide font color&#34; =&gt; &#34;Slide font color&#34;,
 // &#34;Apply a color to the slides of your slideshow&#34; =&gt; &#34;Apply a color to the slides of your slideshow&#34;,
@@ -6414,6 +6436,7 @@
 &#34;to&#34; =&gt; &#34;到&#34;,
 // &#34;Email format&#34; =&gt; &#34;Email format&#34;,
 // &#34;Text or html setting&#34; =&gt; &#34;Text or html setting&#34;,
+// &#34;Text or HTML setting&#34; =&gt; &#34;Text or html setting&#34;,
 // &#34;URL the user is sent to after the form is submitted&#34; =&gt; &#34;URL the user is sent to after the form is submitted&#34;,
 // &#34;URL Target&#34; =&gt; &#34;URL Target&#34;,
 // &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34; =&gt; &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34;,
@@ -8116,6 +8139,7 @@
 &#34;Last update&#34; =&gt; &#34;最近更新&#34;,
 &#34;Refresh&#34; =&gt; &#34;刷新&#34;,
 // &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
+// &#34;JavaScript must be turned &lt;strong&gt;ON&lt;/strong&gt; in order to apply Profiles. Please enable your JavaScript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
 // &#34;Export YAML&#34; =&gt; &#34;Export YAML&#34;,
 // &#34;Export modified preferences as YAML&#34; =&gt; &#34;Export modified preferences as YAML&#34;,
 // &#34;Toggle Visible&#34; =&gt; &#34;Toggle Visible&#34;,
@@ -10039,6 +10063,7 @@
 &#34;Add unsubscribe instructions to each newsletter&#34; =&gt; &#34;增加取消订阅的介绍到每一个电子期刊&#34;,
 &#34;Validate email addresses&#34; =&gt; &#34;验证电子邮件地址&#34;,
 // &#34;Allow customized text message to be sent with the html version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
+// &#34;Allow customized text message to be sent with the HTML version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
 // &#34;Allow clipping of articles into newsletter&#34; =&gt; &#34;Allow clipping of articles into newsletter&#34;,
 // &#34;Automatically clip articles into newsletter&#34; =&gt; &#34;Automatically clip articles into newsletter&#34;,
 // &#34;Clip articles published in the past number of days&#34; =&gt; &#34;Clip articles published in the past number of days&#34;,
@@ -10800,7 +10825,9 @@
 // &#34;If not the topic name&#34; =&gt; &#34;If not the topic name&#34;,
 // &#34;Allow full HTML&#34; =&gt; &#34;Allow full HTML&#34;,
 // &#34;Keep any html tag&#34; =&gt; &#34;Keep any html tag&#34;,
+// &#34;Keep any HTML tag&#34; =&gt; &#34;Keep any html tag&#34;,
 // &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
+// &#34;If not enabled, Tiki will retain some HTML tags (a, p, pre, img, hr, b, i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
 // &#34;Emails to be notified (separated with commas)&#34; =&gt; &#34;Emails to be notified (separated with commas)&#34;,
 &#34;Edit or create banners&#34; =&gt; &#34;编辑或创建标语&#34;,
 &#34;List banners&#34; =&gt; &#34;列出横幅&#34;,
@@ -10941,6 +10968,7 @@
 // &#34;Special characters&#34; =&gt; &#34;Special characters&#34;,
 // &#34;hard space&#34; =&gt; &#34;hard space&#34;,
 // &#34;numeric between ~ for html numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
+// &#34;numeric between ~ for HTML numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
 // &#34;Plugin Help&#34; =&gt; &#34;Plugin Help&#34;,
 // &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34; =&gt; &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34;,
 // &#34;More help here&#34; =&gt; &#34;More help here&#34;,
@@ -11323,6 +11351,7 @@
 // &#34;Tiki Importer&#34; =&gt; &#34;Tiki Importer&#34;,
 // &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34; =&gt; &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34;,
 // &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
+// &#34;If your pages contain XML code, the HTML purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
 // &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34; =&gt; &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34;,
 // &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34; =&gt; &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34;,
 // &#34;Select the software to import from&#34; =&gt; &#34;Select the software to import from&#34;,
@@ -12175,6 +12204,7 @@
 // &#34;Apply content template&#34; =&gt; &#34;Apply content template&#34;,
 // &#34;Data HTML&#34; =&gt; &#34;Data HTML&#34;,
 // &#34;Is html&#34; =&gt; &#34;Is html&#34;,
+// &#34;Is HTML&#34; =&gt; &#34;Is html&#34;,
 // &#34;Data Txt&#34; =&gt; &#34;Data Txt&#34;,
 // &#34;Article Clip (read only)&#34; =&gt; &#34;Article Clip (read only)&#34;,
 // &#34;Clip Now&#34; =&gt; &#34;Clip Now&#34;,
@@ -12560,6 +12590,7 @@
 // &#34;Other languages you can read (select on the left to add to the list on the right)&#34; =&gt; &#34;Other languages you can read (select on the left to add to the list on the right)&#34;,
 // &#34;Select language..&#34; =&gt; &#34;Select language..&#34;,
 // &#34;Detect user timezone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
+// &#34;Detect user time zone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
 // &#34;Use 12-hour clock in time selectors&#34; =&gt; &#34;Use 12-hour clock in time selectors&#34;,
 // &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34; =&gt; &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34;,
 // &#34;Notify sender when reading his mail&#34; =&gt; &#34;Notify sender when reading his mail&#34;,

Modified: branches/9.x/lang/cs/language.php
===================================================================
--- branches/9.x/lang/cs/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/cs/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 &#34;No&#34; =&gt; &#34;Ne&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
+// &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom JavaScript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,
 // &#34;Formula&#34; =&gt; &#34;Formula&#34;,
 // &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34; =&gt; &#34;The formula to be computed supporting various operators (+ - * / and parenthesis), references to other field made using the field id preceeded by #&#34;,
 // &#34;Country Selector&#34; =&gt; &#34;Country Selector&#34;,
@@ -2017,7 +2019,9 @@
 // &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34; =&gt; &#34;If you are using Apache, you can copy _htaccess to .htaccess to get Short URLs. On IIS, copy web_config to web.config&#34;,
 // &#34;Search engine friendly url Postfilter&#34; =&gt; &#34;Search engine friendly url Postfilter&#34;,
 // &#34;Display article title in the sefurl&#34; =&gt; &#34;Display article title in the sefurl&#34;,
+// &#34;Display article title in the SEFURL&#34; =&gt; &#34;Display article title in the sefurl&#34;,
 // &#34;Display blog title in the sefurl&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
+// &#34;Display blog title in the SEFURL&#34; =&gt; &#34;Display blog title in the sefurl&#34;,
 // &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34; =&gt; &#34;Rewrite tiki-view_tracker.php?itemId=yyy to Prefixyyy page&#34;,
 // &#34;This redirection uses the wiki prefix alias feature&#34; =&gt; &#34;This redirection uses the wiki prefix alias feature&#34;,
 // &#34;Canonical URL tag&#34; =&gt; &#34;Canonical URL tag&#34;,
@@ -2259,6 +2263,7 @@
 // &#34;Time Sheet&#34; =&gt; &#34;Time Sheet&#34;,
 // &#34;A project time manager&#34; =&gt; &#34;A project time manager&#34;,
 // &#34;Html Feed&#34; =&gt; &#34;Html Feed&#34;,
+// &#34;HTML Feed&#34; =&gt; &#34;Html Feed&#34;,
 // &#34;A way to push and pull html bits around from one site to another&#34; =&gt; &#34;A way to push and pull html bits around from one site to another&#34;,
 // &#34;ForwardLink-Protocol&#34; =&gt; &#34;ForwardLink-Protocol&#34;,
 // &#34;A Dynamic Compendia&#34; =&gt; &#34;A Dynamic Compendia&#34;,
@@ -3056,6 +3061,7 @@
 // &#34;Sender email&#34; =&gt; &#34;Sender email&#34;,
 // &#34;Email address that will be used as the sender for outgoing emails&#34; =&gt; &#34;Email address that will be used as the sender for outgoing emails&#34;,
 // &#34;Timezone&#34; =&gt; &#34;Timezone&#34;,
+// &#34;Time zone&#34; =&gt; &#34;Timezone&#34;,
 // &#34;Indicates the default time zone to use for the server&#34; =&gt; &#34;Indicates the default time zone to use for the server&#34;,
 // &#34;Session storage location&#34; =&gt; &#34;Session storage location&#34;,
 // &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34; =&gt; &#34;Select where the session information should be stored. Memcache sessions require memcache to be configured&#34;,
@@ -3512,8 +3518,10 @@
 // &#34;Reopen with the same editor&#34; =&gt; &#34;Reopen with the same editor&#34;,
 // &#34;Content is parsed like wiki page&#34; =&gt; &#34;Content is parsed like wiki page&#34;,
 // &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
+// &#34;This allows a mixture of wiki and HTML. All wiki syntax is parsed&#34; =&gt; &#34;This allows a mixture of wiki and html. All wiki syntax is parsed&#34;,
 // &#34;Content is partially wiki parsed&#34; =&gt; &#34;Content is partially wiki parsed&#34;,
 // &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
+// &#34;This also allows a mixture of wiki and HTML. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34; =&gt; &#34;This also allows a mixture of wiki and html. Only some wiki syntax is parsed, such as plugins (not inline character styles etc)&#34;,
 // &#34;Wysiwyg editor skin&#34; =&gt; &#34;Wysiwyg editor skin&#34;,
 // &#34;Kama (Default)&#34; =&gt; &#34;Kama (Default)&#34;,
 // &#34;Office 2003&#34; =&gt; &#34;Office 2003&#34;,
@@ -3637,6 +3645,7 @@
 // &#34;To fix this error go to Admin -&gt; Feeds&#34; =&gt; &#34;To fix this error go to Admin -&gt; Feeds&#34;,
 // &#34;Please contact the site administrator and ask him to fix this error&#34; =&gt; &#34;Please contact the site administrator and ask him to fix this error&#34;,
 // &#34;If you set feed author email or url you have to set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
+// &#34;If you set feed author email or URL, you must set feed author name&#34; =&gt; &#34;If you set feed author email or url you have to set feed author name&#34;,
 // &#34;Feed logo&#34; =&gt; &#34;Feed logo&#34;,
 // &#34;Unspecified&#34; =&gt; &#34;Unspecified&#34;,
 &#34;Log In&#34; =&gt; &#34;Přihlášení&#34;,
@@ -4403,6 +4412,7 @@
 // &#34;Shop as anonymous always&#34; =&gt; &#34;Shop as anonymous always&#34;,
 // &#34;Add to cart as anonymous shopper even if logged in&#34; =&gt; &#34;Add to cart as anonymous shopper even if logged in&#34;,
 // &#34;Forward to this url after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
+// &#34;Forward to this URL after free purchase&#34; =&gt; &#34;Forward to this url after free purchase&#34;,
 // &#34;Gift certificate&#34; =&gt; &#34;Gift certificate&#34;,
 // &#34;Allows user to add gift certificate from the product view&#34; =&gt; &#34;Allows user to add gift certificate from the product view&#34;,
 // &#34;Order Item ID to exchange product&#34; =&gt; &#34;Order Item ID to exchange product&#34;,
@@ -5463,7 +5473,9 @@
 // &#34;Parse wiki syntax within the HTML code&#34; =&gt; &#34;Parse wiki syntax within the HTML code&#34;,
 // &#34;Textlink&#34; =&gt; &#34;Textlink&#34;,
 // &#34;Adds an item to html feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
+// &#34;Adds an item to HTML feed&#34; =&gt; &#34;Adds an item to html feed&#34;,
 // &#34;Html Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
+// &#34;HTML Feed Link&#34; =&gt; &#34;Html Feed Link&#34;,
 // &#34;Display remote content&#34; =&gt; &#34;Display remote content&#34;,
 // &#34;Initial Value&#34; =&gt; &#34;Initial Value&#34;,
 // &#34;Feed location&#34; =&gt; &#34;Feed location&#34;,
@@ -5472,12 +5484,15 @@
 // &#34;Highlight&#34; =&gt; &#34;Highlight&#34;,
 // &#34;Asterisk&#34; =&gt; &#34;Asterisk&#34;,
 // &#34;Html Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
+// &#34;HTML Feed Link Type&#34; =&gt; &#34;Html Feed Link Type&#34;,
 &#34;Replace&#34; =&gt; &#34;Zaměnit&#34;,
 // &#34;Backlink&#34; =&gt; &#34;Backlink&#34;,
 // &#34;Popup&#34; =&gt; &#34;Popup&#34;,
 // &#34;Hover&#34; =&gt; &#34;Hover&#34;,
 // &#34;Is the html feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
+// &#34;Is the HTML feed moderated&#34; =&gt; &#34;Is the html feed moderated&#34;,
 // &#34;Date of last accepted html item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
+// &#34;Date of last accepted HTML item, not used if not moderated&#34; =&gt; &#34;Date of last accepted html item, not used if not moderated&#34;,
 // &#34;Iframe&#34; =&gt; &#34;Iframe&#34;,
 // &#34;Include another web page within a frame&#34; =&gt; &#34;Include another web page within a frame&#34;,
 // &#34;Frame title&#34; =&gt; &#34;Frame title&#34;,
@@ -5539,6 +5554,7 @@
 // &#34;Enlarge button&#34; =&gt; &#34;Enlarge button&#34;,
 // &#34;Button for enlarging image&#34; =&gt; &#34;Button for enlarging image&#34;,
 // &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
+// &#34;Enter a URL to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34; =&gt; &#34;Enter a url to the address the image should link to. Not needed if thumb parameter is set; overrides thumb setting&#34;,
 // &#34;Link relation&#34; =&gt; &#34;Link relation&#34;,
 // &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34; =&gt; &#34;Enter \&#34;box\&#34; for colorbox effect (like shadowbox and lightbox) or appropriate syntax for link relation&#34;,
 // &#34;Image map&#34; =&gt; &#34;Image map&#34;,
@@ -5617,6 +5633,7 @@
 // &#34;Optional markup for when JavaScript is off&#34; =&gt; &#34;Optional markup for when JavaScript is off&#34;,
 // &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34; =&gt; &#34;&lt;!-- jq plugin inactive: JavaScript off --&gt;&#34;,
 // &#34;Javascript&#34; =&gt; &#34;Javascript&#34;,
+// &#34;JavaScript&#34; =&gt; &#34;Javascript&#34;,
 // &#34;javascript code&#34; =&gt; &#34;javascript code&#34;,
 // &#34;JavaScript filename&#34; =&gt; &#34;JavaScript filename&#34;,
 // &#34;Kaltura Video&#34; =&gt; &#34;Kaltura Video&#34;,
@@ -5672,6 +5689,7 @@
 // &#34;Full path to the server-local directory. Default is the document root&#34; =&gt; &#34;Full path to the server-local directory. Default is the document root&#34;,
 // &#34;URL Prefix&#34; =&gt; &#34;URL Prefix&#34;,
 // &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
+// &#34;Make the file name a link to the file by adding the URL path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>; =&gt; &#34;Make the file name a link to the file by adding the url path preceding the file name. Example: <a href="http://yoursite.com/tiki/&#34" rel="nofollow">http://yoursite.com/tiki/&#34</a>;,
 // &#34;Set the sort order of the file list&#34; =&gt; &#34;Set the sort order of the file list&#34;,
 &#34;File Name&#34; =&gt; &#34;Název souboru&#34;,
 // &#34;File Size&#34; =&gt; &#34;File Size&#34;,
@@ -6041,8 +6059,11 @@
 // &#34;Creates a link to SourceForge tracker items&#34; =&gt; &#34;Creates a link to SourceForge tracker items&#34;,
 // &#34;Group ID&#34; =&gt; &#34;Group ID&#34;,
 // &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
+// &#34;SourceForge project ID (shows as group_id in the URL of a tracker item&#34; =&gt; &#34;SourceForge project ID (shows as group_id in the url of a tracker item&#34;,
 // &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
+// &#34;SourceForge tracker ID (shows as atid in the URL of a tracker item&#34; =&gt; &#34;SourceForge tracker ID (shows as atid in the url of a tracker item&#34;,
 // &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
+// &#34;SourceForge item ID (shows as aid in the URL of a tracker item&#34; =&gt; &#34;SourceForge item ID (shows as aid in the url of a tracker item&#34;,
 // &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34; =&gt; &#34;First part of link tooltip identifying the type of tracker item (bug, feature request, patch or support request)&#34;,
 // &#34;ShareThis&#34; =&gt; &#34;ShareThis&#34;,
 // &#34;Add a ShareThis button&#34; =&gt; &#34;Add a ShareThis button&#34;,
@@ -6177,6 +6198,7 @@
 // &#34;Header font color&#34; =&gt; &#34;Header font color&#34;,
 // &#34;Apply a color to the headers of your slideshow&#34; =&gt; &#34;Apply a color to the headers of your slideshow&#34;,
 // &#34;Any html color&#34; =&gt; &#34;Any html color&#34;,
+// &#34;Any HTML color&#34; =&gt; &#34;Any html color&#34;,
 // &#34;Header background color&#34; =&gt; &#34;Header background color&#34;,
 // &#34;Slide font color&#34; =&gt; &#34;Slide font color&#34;,
 // &#34;Apply a color to the slides of your slideshow&#34; =&gt; &#34;Apply a color to the slides of your slideshow&#34;,
@@ -6417,6 +6439,7 @@
 &#34;to&#34; =&gt; &#34;do&#34;,
 // &#34;Email format&#34; =&gt; &#34;Email format&#34;,
 // &#34;Text or html setting&#34; =&gt; &#34;Text or html setting&#34;,
+// &#34;Text or HTML setting&#34; =&gt; &#34;Text or html setting&#34;,
 // &#34;URL the user is sent to after the form is submitted&#34; =&gt; &#34;URL the user is sent to after the form is submitted&#34;,
 // &#34;URL Target&#34; =&gt; &#34;URL Target&#34;,
 // &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34; =&gt; &#34;Set the target parameter for the url (determines whether target will open in a new page, etc.)&#34;,
@@ -8119,6 +8142,7 @@
 &#34;Last update&#34; =&gt; &#34;Poslední update&#34;,
 &#34;Refresh&#34; =&gt; &#34;Obnovit&#34;,
 // &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
+// &#34;JavaScript must be turned &lt;strong&gt;ON&lt;/strong&gt; in order to apply Profiles. Please enable your JavaScript and try again&#34; =&gt; &#34;Javascript must be turned &lt;b&gt;ON&lt;/b&gt; in order to apply Profiles. Please enable your javascript and try again&#34;,
 // &#34;Export YAML&#34; =&gt; &#34;Export YAML&#34;,
 // &#34;Export modified preferences as YAML&#34; =&gt; &#34;Export modified preferences as YAML&#34;,
 // &#34;Toggle Visible&#34; =&gt; &#34;Toggle Visible&#34;,
@@ -10051,6 +10075,7 @@
 &#34;Add unsubscribe instructions to each newsletter&#34; =&gt; &#34;Přidat instrukce jak se odhlásit do každého newsletteru&#34;,
 &#34;Validate email addresses&#34; =&gt; &#34;Ověřit e-mailové adresy&#34;,
 // &#34;Allow customized text message to be sent with the html version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
+// &#34;Allow customized text message to be sent with the HTML version&#34; =&gt; &#34;Allow customized text message to be sent with the html version&#34;,
 // &#34;Allow clipping of articles into newsletter&#34; =&gt; &#34;Allow clipping of articles into newsletter&#34;,
 // &#34;Automatically clip articles into newsletter&#34; =&gt; &#34;Automatically clip articles into newsletter&#34;,
 // &#34;Clip articles published in the past number of days&#34; =&gt; &#34;Clip articles published in the past number of days&#34;,
@@ -10814,7 +10839,9 @@
 // &#34;If not the topic name&#34; =&gt; &#34;If not the topic name&#34;,
 // &#34;Allow full HTML&#34; =&gt; &#34;Allow full HTML&#34;,
 // &#34;Keep any html tag&#34; =&gt; &#34;Keep any html tag&#34;,
+// &#34;Keep any HTML tag&#34; =&gt; &#34;Keep any html tag&#34;,
 // &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
+// &#34;If not enabled, Tiki will retain some HTML tags (a, p, pre, img, hr, b, i)&#34; =&gt; &#34;If uncheck will keep anyway some html tags (a,p,pre,img,hr,b,i)&#34;,
 // &#34;Emails to be notified (separated with commas)&#34; =&gt; &#34;Emails to be notified (separated with commas)&#34;,
 &#34;Edit or create banners&#34; =&gt; &#34;Upravit nebo vytvořit bannery&#34;,
 &#34;List banners&#34; =&gt; &#34;Vypsat bannery&#34;,
@@ -10955,6 +10982,7 @@
 // &#34;Special characters&#34; =&gt; &#34;Special characters&#34;,
 // &#34;hard space&#34; =&gt; &#34;hard space&#34;,
 // &#34;numeric between ~ for html numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
+// &#34;numeric between ~ for HTML numeric characters entity&#34; =&gt; &#34;numeric between ~ for html numeric characters entity&#34;,
 // &#34;Plugin Help&#34; =&gt; &#34;Plugin Help&#34;,
 // &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34; =&gt; &#34;Note that plugin arguments can be enclosed with double quotes (&amp;quot;); this allows them to contain , or = or &amp;gt&#34;,
 // &#34;More help here&#34; =&gt; &#34;More help here&#34;,
@@ -11338,6 +11366,7 @@
 // &#34;Tiki Importer&#34; =&gt; &#34;Tiki Importer&#34;,
 // &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34; =&gt; &#34;If you are NOT running a new Tiki installation, make a backup of your database before using this importer&#34;,
 // &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
+// &#34;If your pages contain XML code, the HTML purifier will delete it. Deactivate this feature&#34; =&gt; &#34;If your pages contain xml code, the html purifier will delete it. Deactivate this feature&#34;,
 // &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34; =&gt; &#34;Your PHP is running with safe mode enabled. This might cause problems to the import process as safe mode limits the possibility to change in run time some PHP settings (like max_execution_time). It is recommended to run this script without safe mode&#34;,
 // &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34; =&gt; &#34;Depending on the size of the file from the source software, the import process may take a while to complete. This might be a problem according to your PHP and web server settings. This script tries to change the relevant settings but there are some settings that the script cannot change. So, if you are having problems with the script, please try to increase the value of the following PHP settings: max_input_time, max_execution_time (this setting is limited by the web server setting, if you are running Apache also change its Timeout setting), post_max_size, upload_max_filesize, memory_limit. It is recommended that you run this script on a server where you can change the values of those settings (if needed)&#34;,
 // &#34;Select the software to import from&#34; =&gt; &#34;Select the software to import from&#34;,
@@ -12190,6 +12219,7 @@
 &#34;Apply content template&#34; =&gt; &#34;Aplikovat obsahovou šablonu&#34;,
 // &#34;Data HTML&#34; =&gt; &#34;Data HTML&#34;,
 // &#34;Is html&#34; =&gt; &#34;Is html&#34;,
+// &#34;Is HTML&#34; =&gt; &#34;Is html&#34;,
 // &#34;Data Txt&#34; =&gt; &#34;Data Txt&#34;,
 // &#34;Article Clip (read only)&#34; =&gt; &#34;Article Clip (read only)&#34;,
 // &#34;Clip Now&#34; =&gt; &#34;Clip Now&#34;,
@@ -12575,6 +12605,7 @@
 // &#34;Other languages you can read (select on the left to add to the list on the right)&#34; =&gt; &#34;Other languages you can read (select on the left to add to the list on the right)&#34;,
 // &#34;Select language..&#34; =&gt; &#34;Select language..&#34;,
 // &#34;Detect user timezone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
+// &#34;Detect user time zone if browser allows, otherwise site default&#34; =&gt; &#34;Detect user timezone if browser allows, otherwise site default&#34;,
 // &#34;Use 12-hour clock in time selectors&#34; =&gt; &#34;Use 12-hour clock in time selectors&#34;,
 // &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34; =&gt; &#34;Display info tooltip on mouseover for every user who allows his/her information to be public&#34;,
 // &#34;Notify sender when reading his mail&#34; =&gt; &#34;Notify sender when reading his mail&#34;,

Modified: branches/9.x/lang/cy/language.php
===================================================================
--- branches/9.x/lang/cy/language.php	2012-04-07 14:02:18 UTC (rev 40802)
+++ branches/9.x/lang/cy/language.php	2012-04-07 14:25:49 UTC (rev 40803)
@@ -830,7 +830,9 @@
 &#34;No&#34; =&gt; &#34;Na&#34;,
 // &#34;Computed Field&#34; =&gt; &#34;Computed Field&#34;,
 // &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
+// &#34;Provides a computed value based on numeric field values. Consider using webservices or JavaScript to perform the task instead of using this type&#34; =&gt; &#34;Provides a computed value based on numeric field values. Consider using webservices or javascript to perform the task instead of using this type&#34;,
 // &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34; =&gt; &#34;This feature is still in place for backwards compatibility. While there are no flaws associated to it, it could be used as a vector for attacks causing a lot of damage. Webservice field or custom javascript is recommended instead of this field&#34;,

@@ Diff output truncated at 100000 characters. @@
This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29098782">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29098782/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40815] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-07 17:42:49</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40815
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40815&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40815&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-07 17:42:42 +0000 (Sat, 07 Apr 2012)
Log Message:
-----------
[FIX] javascript_cdn: Use https to access jquery files if appropriate (and removed workround for for missing 1.7.2 files)

Modified Paths:
--------------
    branches/9.x/lib/prefs/javascript.php
    branches/9.x/tiki-setup.php

Modified: branches/9.x/lib/prefs/javascript.php
===================================================================
--- branches/9.x/lib/prefs/javascript.php	2012-04-07 17:33:57 UTC (rev 40814)
+++ branches/9.x/lib/prefs/javascript.php	2012-04-07 17:42:42 UTC (rev 40815)
@@ -14,7 +14,7 @@
 			&#39;type&#39; =&gt; &#39;list&#39;,
 			&#39;options&#39; =&gt; array(
 				&#39;none&#39; =&gt; tra(&#39;None&#39;),
-				&#39;google&#39; =&gt; tra(&#39;Google&#39;),
+				&#39;google&#39; =&gt; tra(&#39;Google (supports SSL via HTTPS)&#39;),
 				&#39;jquery&#39; =&gt; tra(&#39;jQuery&#39;),
 			),
 			&#39;default&#39; =&gt; &#39;none&#39;,

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-04-07 17:33:57 UTC (rev 40814)
+++ branches/9.x/tiki-setup.php	2012-04-07 17:42:42 UTC (rev 40815)
@@ -218,10 +218,7 @@
 
 
 	if ( isset($prefs[&#39;javascript_cdn&#39;]) &amp;&amp; $prefs[&#39;javascript_cdn&#39;] == &#39;google&#39; ) {
-		// google doesn&#39;t keep up to date, so use the most recent minor release they have available
-		$v = explode(&#39;.&#39;, $headerlib-&gt;jquery_version);
-		$v = $v[0] . &#39;.&#39; . $v[1];
-		$headerlib-&gt;add_jsfile_dependancy(&#34;<a href="http://ajax.googleapis.com/ajax/libs/jquery/$v/jquery.min.js&#34" rel="nofollow">http://ajax.googleapis.com/ajax/libs/jquery/$v/jquery.min.js&#34</a>;);
+		$headerlib-&gt;add_jsfile_dependancy(&#34;$<a href="url_scheme://ajax.googleapis.com/ajax/libs/jquery/$headerlib-&gt;jquery_version/jquery.min.js&#34" rel="nofollow">url_scheme://ajax.googleapis.com/ajax/libs/jquery/$headerlib-&gt;jquery_version/jquery.min.js&#34</a>;);
 	} else if ( isset($prefs[&#39;javascript_cdn&#39;]) &amp;&amp; $prefs[&#39;javascript_cdn&#39;] == &#39;jquery&#39; ) {
 		$headerlib-&gt;add_jsfile_dependancy(&#34;<a href="http://code.jquery.com/jquery-$headerlib-&gt;jquery_version.min.js&#34" rel="nofollow">http://code.jquery.com/jquery-$headerlib-&gt;jquery_version.min.js&#34</a>;);
 	} else {
@@ -279,7 +276,7 @@
 
 		if ( $prefs[&#39;feature_jquery_ui&#39;] == &#39;y&#39; ) {
 			if ( isset($prefs[&#39;javascript_cdn&#39;]) &amp;&amp; $prefs[&#39;javascript_cdn&#39;] == &#39;google&#39; ) {
-				$headerlib-&gt;add_jsfile_dependancy(&#34;<a href="http://ajax.googleapis.com/ajax/libs/jqueryui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34" rel="nofollow">http://ajax.googleapis.com/ajax/libs/jqueryui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34</a>;);
+				$headerlib-&gt;add_jsfile_dependancy(&#34;$<a href="url_scheme://ajax.googleapis.com/ajax/libs/jqueryui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34" rel="nofollow">url_scheme://ajax.googleapis.com/ajax/libs/jqueryui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34</a>;);
 			} else if ( isset($prefs[&#39;javascript_cdn&#39;]) &amp;&amp; $prefs[&#39;javascript_cdn&#39;] == &#39;jquery&#39; ) {
 				$headerlib-&gt;add_jsfile_dependancy(&#34;<a href="http://code.jquery.com/ui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34" rel="nofollow">http://code.jquery.com/ui/$headerlib-&gt;jqueryui_version/jquery-ui.min.js&#34</a>;);
 			} else {

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29098969">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29098969/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40821] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-07 19:07:46</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40821
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40821&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40821&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-07 19:07:39 +0000 (Sat, 07 Apr 2012)
Log Message:
-----------
[FIX] content templates: Cheap fix for html no longer being parsed by default (since tiki 7?).
Done by adding a new template &#34;section&#34; section_wiki_html which parses as is_html and uses the wysiwyg editor.
Seems to work in (html) wiki pages, needs further testing...

Modified Paths:
--------------
    branches/9.x/templates/tiki-admin_content_templates.tpl
    branches/9.x/tiki-admin_content_templates.php

Modified: branches/9.x/templates/tiki-admin_content_templates.tpl
===================================================================
--- branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-07 19:03:53 UTC (rev 40820)
+++ branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-07 19:07:39 UTC (rev 40821)
@@ -37,6 +37,9 @@
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_wiki&#34; {if $info.section_wiki eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
 					{tr}Wiki{/tr}&lt;/label&gt;
 					&lt;br /&gt;
+					&lt;label style=&#34;margin-left: 2em;&#34;&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_wiki_html&#34; {if $info.section_wiki_html eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{tr}Is HTML{/tr}&lt;/label&gt;
+					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_file_galleries_templates eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_file_galleries&#34; {if $info.section_file_galleries eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
@@ -78,6 +81,7 @@
 			&lt;td&gt;{tr}Page Name:{/tr}&lt;/td&gt;
 			&lt;td&gt;
 				&lt;input type=&#34;text&#34; name=&#34;page_name&#34; value=&#34;{$info.page_name}&#34;/&gt;
+				{autocomplete element=&#39;input[name=page_name]&#39; type=&#39;pagename&#39;}
 			&lt;/td&gt;
 		&lt;/tr&gt;
 
@@ -88,7 +92,15 @@
 		&lt;/tr&gt;
 		&lt;tr class=&#34;type-cond for-static&#34;&gt;
 			&lt;td colspan=&#34;2&#34;&gt;
-				{textarea id=&#34;editwiki&#34; name=&#34;content&#34; switcheditor=&#34;y&#34;}{$info.content}{/textarea}
+				{if $prefs.feature_wysiwyg eq &#39;y&#39; and $info.section_wiki_html eq &#39;y&#39;}
+					{$use_wysiwyg=&#39;y&#39;}
+					&lt;input type=&#34;hidden&#34; id=&#34;allowhtml&#34; value=&#34;y&#34;/&gt;
+					{if $prefs.wysiwyg_htmltowiki eq &#39;y&#39;}{$is_html = &#39;y&#39;}{else}{$is_html = &#39;n&#39;}{/if}
+				{else}
+					{$use_wysiwyg=&#39;n&#39;}
+					{$is_html = &#39;n&#39;}
+				{/if}
+				{textarea id=&#34;editwiki&#34; name=&#34;content&#34; switcheditor=&#34;y&#34; _wysiwyg=$use_wysiwyg _is_html=$is_html}{$info.content}{/textarea}
 			&lt;/td&gt;
 		&lt;/tr&gt;
 

Modified: branches/9.x/tiki-admin_content_templates.php
===================================================================
--- branches/9.x/tiki-admin_content_templates.php	2012-04-07 19:03:53 UTC (rev 40820)
+++ branches/9.x/tiki-admin_content_templates.php	2012-04-07 19:07:39 UTC (rev 40821)
@@ -11,6 +11,8 @@
 
 include_once (&#39;lib/templates/templateslib.php&#39;);
 
+$auto_query_args = array(&#39;templateId&#39;);
+
 $access-&gt;check_permission(&#39;tiki_p_edit_content_templates&#39;);
 //get_strings tra(&#39;Content Templates&#39;)
 
@@ -30,6 +32,11 @@
 	} else {
 		$info[&#34;section_wiki&#34;] = &#39;n&#39;;
 	}
+	if ($templateslib-&gt;template_is_in_section($_REQUEST[&#34;templateId&#34;], &#39;wiki_html&#39;)) {
+		$info[&#34;section_wiki_html&#34;] = &#39;y&#39;;
+	} else {
+		$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
+	}
 	if ($templateslib-&gt;template_is_in_section($_REQUEST[&#34;templateId&#34;], &#39;file_galleries&#39;)) {
 		$info[&#34;section_file_galleries&#34;] = &#39;y&#39;;
 	} else {
@@ -63,6 +70,7 @@
 	$info[&#34;section_cms&#34;] = &#39;n&#39;;
 	$info[&#34;section_html&#34;] = &#39;n&#39;;
 	$info[&#34;section_wiki&#34;] = &#39;n&#39;;
+	$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
 	$info[&#34;section_file_galleries&#34;] = &#39;n&#39;;
 	$info[&#34;section_newsletters&#34;] = &#39;n&#39;;
 	$info[&#34;section_event&#34;] = &#39;n&#39;;
@@ -85,7 +93,7 @@
 		$parsed = nl2br($_REQUEST[&#34;content&#34;]);
 	} else {
 		$info[&#34;section_html&#34;] = &#39;n&#39;;
-		$parsed = $tikilib-&gt;parse_data($_REQUEST[&#34;content&#34;]);
+		$parsed = $tikilib-&gt;parse_data($_REQUEST[&#34;content&#34;], array(&#39;is_html&#39; =&gt; $info[&#39;section_wiki_html&#39;] === &#39;y&#39;));
 	}
 	$smarty-&gt;assign(&#39;parsed&#39;, $parsed);
 	if (isset($_REQUEST[&#34;section_wiki&#34;]) &amp;&amp; $_REQUEST[&#34;section_wiki&#34;] == &#39;on&#39;) {
@@ -135,6 +143,7 @@
 		$info[&#34;content&#34;] = &#39;&#39;;
 		$info[&#34;section_cms&#34;] = &#39;n&#39;;
 		$info[&#34;section_wiki&#34;] = &#39;n&#39;;
+		$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
 		$info[&#34;section_file_galleries&#34;] = &#39;n&#39;;
 		$info[&#34;section_newsletters&#34;] = &#39;n&#39;;
 		$info[&#34;section_events&#34;] = &#39;n&#39;;
@@ -150,6 +159,11 @@
 		} else {
 			$templateslib-&gt;remove_template_from_section($tid, &#39;wiki&#39;);
 		}
+		if (isset($_REQUEST[&#34;section_wiki_html&#34;]) &amp;&amp; $_REQUEST[&#34;section_wiki_html&#34;] == &#39;on&#39;) {
+			$templateslib-&gt;add_template_to_section($tid, &#39;wiki_html&#39;);
+		} else {
+			$templateslib-&gt;remove_template_from_section($tid, &#39;wiki_html&#39;);
+		}
 		if (isset($_REQUEST[&#34;section_file_galleries&#34;]) &amp;&amp; $_REQUEST[&#34;section_file_galleries&#34;] == &#39;on&#39;) {
 			$templateslib-&gt;add_template_to_section($tid, &#39;file_galleries&#39;);
 		} else {
@@ -176,6 +190,7 @@
 		$info[&#34;content&#34;] = (isset($_REQUEST[&#34;content&#34;]) &amp;&amp; $_REQUEST[&#34;content&#34;] != &#39;&#39;) ? $_REQUEST[&#34;content&#34;] : &#39;&#39; ;
 		$info[&#34;section_cms&#34;] = (isset($_REQUEST[&#34;section_cms&#34;]) &amp;&amp; $_REQUEST[&#34;section_cms&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_wiki&#34;] = (isset($_REQUEST[&#34;section_wiki&#34;]) &amp;&amp; $_REQUEST[&#34;section_wiki&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
+		$info[&#34;section_wiki_html&#34;] = (isset($_REQUEST[&#34;section_wiki_html&#34;]) &amp;&amp; $_REQUEST[&#34;section_wiki_html&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_file_galleries&#34;] = (isset($_REQUEST[&#34;section_file_galleries&#34;]) &amp;&amp; $_REQUEST[&#34;section_file_galleries&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_newsletters&#34;] = (isset($_REQUEST[&#34;section_newsletters&#34;]) &amp;&amp; $_REQUEST[&#34;section_newsletters&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39; ;
 		$info[&#34;section_events&#34;] = (isset($_REQUEST[&#34;section_events&#34;]) &amp;&amp; $_REQUEST[&#34;section_events&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29099302">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29099302/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40821] branches/9.x</a></b></div>
      
      <small>From: &lt;geoff@en...&gt; - 2012-04-07 21:38:38</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre> hmmm - seems to be a step back for me

I can&#39;t get the editor to toggle into the wysiwyg mode any more in the
&#39;Content templates&#39; area

The toolbar in Content templates still doesn&#39;t show the same as on a
&#39;proper&#39; wiki page - and existing/new templates will only open in the wiki
editor

Using r40823 and FF

geoff

-----Original Message-----
From: jonnybradley@...
[mailto:jonnybradley@...] 
Sent: 07 April 2012 20:08
To: tikiwiki-cvs@...
Subject: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40821] branches/9.x

Revision: 40821
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40821&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40821&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-07 19:07:39 +0000 (Sat, 07 Apr 2012)
Log Message:
-----------
[FIX] content templates: Cheap fix for html no longer being parsed by
default (since tiki 7?).
Done by adding a new template &#34;section&#34; section_wiki_html which parses as
is_html and uses the wysiwyg editor.
Seems to work in (html) wiki pages, needs further testing...

Modified Paths:
--------------
    branches/9.x/templates/tiki-admin_content_templates.tpl
    branches/9.x/tiki-admin_content_templates.php

Modified: branches/9.x/templates/tiki-admin_content_templates.tpl
===================================================================
--- branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-07
19:03:53 UTC (rev 40820)
+++ branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-07
19:07:39 UTC (rev 40821)
@@ -37,6 +37,9 @@
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34;
name=&#34;section_wiki&#34; {if $info.section_wiki eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
 					{tr}Wiki{/tr}&lt;/label&gt;
 					&lt;br /&gt;
+					&lt;label style=&#34;margin-left:
2em;&#34;&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_wiki_html&#34; {if
$info.section_wiki_html eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{tr}Is HTML{/tr}&lt;/label&gt;
+					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_file_galleries_templates
eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34;
name=&#34;section_file_galleries&#34; {if $info.section_file_galleries eq
&#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt; @@ -78,6 +81,7 @@
 			&lt;td&gt;{tr}Page Name:{/tr}&lt;/td&gt;
 			&lt;td&gt;
 				&lt;input type=&#34;text&#34; name=&#34;page_name&#34;
value=&#34;{$info.page_name}&#34;/&gt;
+				{autocomplete
element=&#39;input[name=page_name]&#39; type=&#39;pagename&#39;}
 			&lt;/td&gt;
 		&lt;/tr&gt;
 
@@ -88,7 +92,15 @@
 		&lt;/tr&gt;
 		&lt;tr class=&#34;type-cond for-static&#34;&gt;
 			&lt;td colspan=&#34;2&#34;&gt;
-				{textarea id=&#34;editwiki&#34; name=&#34;content&#34;
switcheditor=&#34;y&#34;}{$info.content}{/textarea}
+				{if $prefs.feature_wysiwyg eq &#39;y&#39; and
$info.section_wiki_html eq &#39;y&#39;}
+					{$use_wysiwyg=&#39;y&#39;}
+					&lt;input type=&#34;hidden&#34; id=&#34;allowhtml&#34;
value=&#34;y&#34;/&gt;
+					{if $prefs.wysiwyg_htmltowiki eq
&#39;y&#39;}{$is_html = &#39;y&#39;}{else}{$is_html = &#39;n&#39;}{/if}
+				{else}
+					{$use_wysiwyg=&#39;n&#39;}
+					{$is_html = &#39;n&#39;}
+				{/if}
+				{textarea id=&#34;editwiki&#34; name=&#34;content&#34;
switcheditor=&#34;y&#34; 
+_wysiwyg=$use_wysiwyg _is_html=$is_html}{$info.content}{/textarea}
 			&lt;/td&gt;
 		&lt;/tr&gt;
 

Modified: branches/9.x/tiki-admin_content_templates.php
===================================================================
--- branches/9.x/tiki-admin_content_templates.php	2012-04-07 19:03:53
UTC (rev 40820)
+++ branches/9.x/tiki-admin_content_templates.php	2012-04-07 19:07:39
UTC (rev 40821)
@@ -11,6 +11,8 @@
 
 include_once (&#39;lib/templates/templateslib.php&#39;);
 
+$auto_query_args = array(&#39;templateId&#39;);
+
 $access-&gt;check_permission(&#39;tiki_p_edit_content_templates&#39;);
 //get_strings tra(&#39;Content Templates&#39;)
 
@@ -30,6 +32,11 @@
 	} else {
 		$info[&#34;section_wiki&#34;] = &#39;n&#39;;
 	}
+	if ($templateslib-&gt;template_is_in_section($_REQUEST[&#34;templateId&#34;],
&#39;wiki_html&#39;)) {
+		$info[&#34;section_wiki_html&#34;] = &#39;y&#39;;
+	} else {
+		$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
+	}
 	if ($templateslib-&gt;template_is_in_section($_REQUEST[&#34;templateId&#34;],
&#39;file_galleries&#39;)) {
 		$info[&#34;section_file_galleries&#34;] = &#39;y&#39;;
 	} else {
@@ -63,6 +70,7 @@
 	$info[&#34;section_cms&#34;] = &#39;n&#39;;
 	$info[&#34;section_html&#34;] = &#39;n&#39;;
 	$info[&#34;section_wiki&#34;] = &#39;n&#39;;
+	$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
 	$info[&#34;section_file_galleries&#34;] = &#39;n&#39;;
 	$info[&#34;section_newsletters&#34;] = &#39;n&#39;;
 	$info[&#34;section_event&#34;] = &#39;n&#39;;
@@ -85,7 +93,7 @@
 		$parsed = nl2br($_REQUEST[&#34;content&#34;]);
 	} else {
 		$info[&#34;section_html&#34;] = &#39;n&#39;;
-		$parsed = $tikilib-&gt;parse_data($_REQUEST[&#34;content&#34;]);
+		$parsed = $tikilib-&gt;parse_data($_REQUEST[&#34;content&#34;],
array(&#39;is_html&#39; 
+=&gt; $info[&#39;section_wiki_html&#39;] === &#39;y&#39;));
 	}
 	$smarty-&gt;assign(&#39;parsed&#39;, $parsed);
 	if (isset($_REQUEST[&#34;section_wiki&#34;]) &amp;&amp; $_REQUEST[&#34;section_wiki&#34;] ==
&#39;on&#39;) { @@ -135,6 +143,7 @@
 		$info[&#34;content&#34;] = &#39;&#39;;
 		$info[&#34;section_cms&#34;] = &#39;n&#39;;
 		$info[&#34;section_wiki&#34;] = &#39;n&#39;;
+		$info[&#34;section_wiki_html&#34;] = &#39;n&#39;;
 		$info[&#34;section_file_galleries&#34;] = &#39;n&#39;;
 		$info[&#34;section_newsletters&#34;] = &#39;n&#39;;
 		$info[&#34;section_events&#34;] = &#39;n&#39;;
@@ -150,6 +159,11 @@
 		} else {
 			$templateslib-&gt;remove_template_from_section($tid,
&#39;wiki&#39;);
 		}
+		if (isset($_REQUEST[&#34;section_wiki_html&#34;]) &amp;&amp;
$_REQUEST[&#34;section_wiki_html&#34;] == &#39;on&#39;) {
+			$templateslib-&gt;add_template_to_section($tid,
&#39;wiki_html&#39;);
+		} else {
+			$templateslib-&gt;remove_template_from_section($tid,
&#39;wiki_html&#39;);
+		}
 		if (isset($_REQUEST[&#34;section_file_galleries&#34;]) &amp;&amp;
$_REQUEST[&#34;section_file_galleries&#34;] == &#39;on&#39;) {
 			$templateslib-&gt;add_template_to_section($tid,
&#39;file_galleries&#39;);
 		} else {
@@ -176,6 +190,7 @@
 		$info[&#34;content&#34;] = (isset($_REQUEST[&#34;content&#34;]) &amp;&amp;
$_REQUEST[&#34;content&#34;] != &#39;&#39;) ? $_REQUEST[&#34;content&#34;] : &#39;&#39; ;
 		$info[&#34;section_cms&#34;] = (isset($_REQUEST[&#34;section_cms&#34;]) &amp;&amp;
$_REQUEST[&#34;section_cms&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_wiki&#34;] = (isset($_REQUEST[&#34;section_wiki&#34;]) &amp;&amp;
$_REQUEST[&#34;section_wiki&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
+		$info[&#34;section_wiki_html&#34;] =
(isset($_REQUEST[&#34;section_wiki_html&#34;]) 
+&amp;&amp; $_REQUEST[&#34;section_wiki_html&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_file_galleries&#34;] =
(isset($_REQUEST[&#34;section_file_galleries&#34;]) &amp;&amp;
$_REQUEST[&#34;section_file_galleries&#34;] == &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39;;
 		$info[&#34;section_newsletters&#34;] =
(isset($_REQUEST[&#34;section_newsletters&#34;]) &amp;&amp; $_REQUEST[&#34;section_newsletters&#34;]
== &#39;on&#39;) ? &#39;y&#39; : &#39;n&#39; ;
 		$info[&#34;section_events&#34;] =
(isset($_REQUEST[&#34;section_events&#34;]) &amp;&amp; $_REQUEST[&#34;section_events&#34;] == &#39;on&#39;)
? &#39;y&#39; : &#39;n&#39;;

This was sent by the SourceForge.net collaborative development platform, the
world&#39;s largest Open Source development site.


----------------------------------------------------------------------------
--
For Developers, A Lot Can Happen In A Second.
Boundary is the first to Know...and Tell You.
Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
<a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
_______________________________________________
Tikiwiki-cvs mailing list
Tikiwiki-cvs@...
<a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
-----
No virus found in this message.
Checked by AVG - <a href="http://www.avg.com" rel="nofollow">http://www.avg.com</a>
Version: 2012.0.1913 / Virus Database: 2409/4920 - Release Date: 04/07/12
-----
No virus found in this message.
Checked by AVG - <a href="http://www.avg.com" rel="nofollow">http://www.avg.com</a>
Version: 2012.0.1913 / Virus Database: 2409/4920 - Release Date: 04/07/12



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29100800">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29100800/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40826] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-08 13:23:21</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40826
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40826&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40826&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-08 13:23:13 +0000 (Sun, 08 Apr 2012)
Log Message:
-----------
[FIX] content templates: Restore switcing of editors and use correct toolbar for template section

Modified Paths:
--------------
    branches/9.x/templates/tiki-admin_content_templates.tpl
    branches/9.x/tiki-admin_content_templates.php

Modified: branches/9.x/templates/tiki-admin_content_templates.tpl
===================================================================
--- branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-07 22:16:51 UTC (rev 40825)
+++ branches/9.x/templates/tiki-admin_content_templates.tpl	2012-04-08 13:23:13 UTC (rev 40826)
@@ -31,11 +31,13 @@
 				{if $prefs.feature_cms_templates eq &#39;y&#39;}
 					&lt;input type=&#34;checkbox&#34; name=&#34;section_cms&#34; {if $info.section_cms eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt; 
 					{tr}CMS{/tr} ({tr}Articles{/tr})
+					{$toolbar_section=&#39;cms&#39;}
 					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_wiki_templates eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_wiki&#34; {if $info.section_wiki eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
 					{tr}Wiki{/tr}&lt;/label&gt;
+					{$toolbar_section=&#39;wiki page&#39;}
 					&lt;br /&gt;
 					&lt;label style=&#34;margin-left: 2em;&#34;&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_wiki_html&#34; {if $info.section_wiki_html eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
 					{tr}Is HTML{/tr}&lt;/label&gt;
@@ -43,21 +45,25 @@
 				{/if}
 				{if $prefs.feature_file_galleries_templates eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_file_galleries&#34; {if $info.section_file_galleries eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{$toolbar_section=&#39;admin&#39;}
 					{tr}File Galleries{/tr}&lt;/label&gt;
 					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_newsletters eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_newsletters&#34; {if $info.section_newsletters eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{$toolbar_section=&#39;newsletters&#39;}
 					{tr}Newsletters{/tr}&lt;/label&gt;
 					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_events eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_events&#34; {if $info.section_events eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{$toolbar_section=&#39;calendar&#39;}
 					{tr}Events{/tr}&lt;/label&gt;
 					&lt;br /&gt;
 				{/if}
 				{if $prefs.feature_html_pages eq &#39;y&#39;}
 					&lt;label&gt;&lt;input type=&#34;checkbox&#34; name=&#34;section_html&#34; {if $info.section_html eq &#39;y&#39;}checked=&#34;checked&#34;{/if} /&gt;
+					{$toolbar_section=&#39;wiki page&#39;}
 					{tr}HTML Pages{/tr}&lt;/label&gt;
 					&lt;br /&gt;
 				{/if}
@@ -100,7 +106,7 @@
 					{$use_wysiwyg=&#39;n&#39;}
 					{$is_html = &#39;n&#39;}
 				{/if}
-				{textarea id=&#34;editwiki&#34; name=&#34;content&#34; switcheditor=&#34;y&#34; _wysiwyg=$use_wysiwyg _is_html=$is_html}{$info.content}{/textarea}
+				{textarea id=&#34;editwiki&#34; name=&#34;content&#34; switcheditor=&#34;y&#34; _wysiwyg=$use_wysiwyg _is_html=$is_html section=$toolbar_section}{$info.content}{/textarea}
 			&lt;/td&gt;
 		&lt;/tr&gt;
 

Modified: branches/9.x/tiki-admin_content_templates.php
===================================================================
--- branches/9.x/tiki-admin_content_templates.php	2012-04-07 22:16:51 UTC (rev 40825)
+++ branches/9.x/tiki-admin_content_templates.php	2012-04-08 13:23:13 UTC (rev 40826)
@@ -76,7 +76,7 @@
 	$info[&#34;section_event&#34;] = &#39;n&#39;;
 }
 
-$smarty-&gt;assign(&#39;info&#39;, $info);
+$smarty-&gt;assign_by_ref(&#39;info&#39;, $info);
 if (isset($_REQUEST[&#34;remove&#34;])) {
 	$access-&gt;check_authenticity();
 	$templateslib-&gt;remove_template($_REQUEST[&#34;remove&#34;]);
@@ -219,8 +219,27 @@
 $smarty-&gt;assign_by_ref(&#39;sort_mode&#39;, $sort_mode);
 $channels = $templateslib-&gt;list_all_templates($offset, $maxRecords, $sort_mode, $find);
 $smarty-&gt;assign_by_ref(&#39;cant_pages&#39;, $channels[&#34;cant&#34;]);
+
 // wysiwyg decision
+$info[&#39;is_html&#39;] = $info[&#39;section_wiki_html&#39;] === &#39;y&#39; ? 1 : 0;
+$info[&#39;wysiwyg&#39;] = $info[&#39;section_wiki_html&#39;];
 include &#39;lib/setup/editmode.php&#39;;
+$info[&#39;section_wiki_html&#39;] = $_SESSION[&#39;wysiwyg&#39;];	//$info[&#39;is_html&#39;] ? &#39;y&#39; : &#39;n&#39;;
+
+// Handles switching editor modes
+global $editlib; include_once (&#39;lib/wiki/editlib.php&#39;);
+if (isset($_REQUEST[&#39;mode_normal&#39;]) &amp;&amp; $_REQUEST[&#39;mode_normal&#39;]==&#39;y&#39;) {
+	// Parsing page data as first time seeing html page in normal editor
+	$smarty-&gt;assign(&#39;msg&#39;, &#34;Parsing html to wiki&#34;);
+	$info[&#39;content&#39;] = $editlib-&gt;parseToWiki($_REQUEST[&#34;content&#34;]);
+	$smarty-&gt;assign(&#39;parsed&#39;, $parsed);
+} elseif (isset($_REQUEST[&#39;mode_wysiwyg&#39;]) &amp;&amp; $_REQUEST[&#39;mode_wysiwyg&#39;]==&#39;y&#39;) {
+	// Parsing page data as first time seeing wiki page in wysiwyg editor
+	$smarty-&gt;assign(&#39;msg&#39;, &#34;Parsing wiki to html&#34;);
+	$info[&#39;content&#39;] = $editlib-&gt;parseToWysiwyg($_REQUEST[&#34;content&#34;]);
+	$smarty-&gt;assign(&#39;parsed&#39;, $parsed);
+}
+
 $smarty-&gt;assign_by_ref(&#39;channels&#39;, $channels[&#34;data&#34;]);
 ask_ticket(&#39;admin-content-templates&#39;);
 global $wikilib;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29101242">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29101242/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40832] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-08 17:00:34</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40832
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40832&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40832&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-08 17:00:26 +0000 (Sun, 08 Apr 2012)
Log Message:
-----------
[ENH] sefurl/canonical: Add in missing objects types for canonical links, which necessitated completing some missing sefurl rules (hence partly an enhancement which started out as a fix)

Modified Paths:
--------------
    branches/9.x/_htaccess
    branches/9.x/lib/smarty_tiki/modifier.sefurl.php
    branches/9.x/templates/canonical.tpl

Added Paths:
-----------
    branches/9.x/installer/schema/20120408_add_forumthread_sefurl_tiki.sql

Modified: branches/9.x/_htaccess
===================================================================
--- branches/9.x/_htaccess	2012-04-08 15:47:08 UTC (rev 40831)
+++ branches/9.x/_htaccess	2012-04-08 17:00:26 UTC (rev 40832)
@@ -173,6 +173,7 @@
 RewriteRule ^display([0-9]+)(.*)   tiki-download_file.php?fileId=$1&amp;display$2 [QSA,L]
 RewriteRule ^preview([0-9]+)(.*)   tiki-download_file.php?fileId=$1&amp;preview$2 [QSA,L]
 RewriteRule ^forum([0-9]+)(.*)     tiki-view_forum.php?forumId=$1$2         [QSA,L]
+RewriteRule ^forumthread([0-9]+)(.*) tiki-view_forum_thread.php?comments_parentId=$1$2 [QSA,L]
 RewriteRule ^gallery([0-9]+)(.*)   tiki-browse_gallery.php?galleryId=$1$2   [QSA,L]
 RewriteRule ^img([0-9]+)(.*)       show_image.php?id=$1$2                   [QSA,L]
 RewriteRule ^image([0-9]+)(.*)     show_image.php?id=$1$2                   [QSA,L]

Added: branches/9.x/installer/schema/20120408_add_forumthread_sefurl_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120408_add_forumthread_sefurl_tiki.sql	                        (rev 0)
+++ branches/9.x/installer/schema/20120408_add_forumthread_sefurl_tiki.sql	2012-04-08 17:00:26 UTC (rev 40832)
@@ -0,0 +1,2 @@
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`)
+	VALUES (&#39;tiki-view_forum_thread.php\\?comments_parentId=(\\d+)&#39;, &#39;forumthread$1&#39;, &#39;forumthread&#39;, &#39;feature_forums&#39;, &#39;0&#39;);

Modified: branches/9.x/lib/smarty_tiki/modifier.sefurl.php
===================================================================
--- branches/9.x/lib/smarty_tiki/modifier.sefurl.php	2012-04-08 15:47:08 UTC (rev 40831)
+++ branches/9.x/lib/smarty_tiki/modifier.sefurl.php	2012-04-08 17:00:26 UTC (rev 40832)
@@ -94,10 +94,15 @@
 			$href = &#39;tiki-list_file_gallery.php?galleryId=&#39;.$source;
 						break;
 
-		case &#39;forum post&#39;:
-			$href = &#39;tiki-view_forum_thread.php?comments_parentId=&#39;.$source;
+		case &#39;forum&#39;:
+			$href = $sefurl ? &#34;forum$source&#34; : &#39;tiki-view_forum.php?forumId=&#39;.$source;
 						break;
 
+		case &#39;forumthread&#39;:
+		case &#39;forum post&#39;:	// unused?
+			$href = $sefurl ? &#34;forumthread$source&#34; : &#39;tiki-view_forum_thread.php?comments_parentId=&#39;.$source;
+						break;
+
 		case &#39;image&#39;:
 			$href = &#39;tiki-browse_image.php?imageId=&#39;.$source;
 						break;

Modified: branches/9.x/templates/canonical.tpl
===================================================================
--- branches/9.x/templates/canonical.tpl	2012-04-08 15:47:08 UTC (rev 40831)
+++ branches/9.x/templates/canonical.tpl	2012-04-08 17:00:26 UTC (rev 40832)
@@ -4,11 +4,17 @@
 		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$page|sefurl}&#34; /&gt;
 	{elseif $mid eq &#39;tiki-view_tracker_item.tpl&#39;}
 		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$itemId|sefurl:trackeritem}&#34; /&gt;
+	{elseif $mid eq &#39;tiki-view_forum.tpl&#39;}
+		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$forumId|sefurl:forum}&#34; /&gt;
 	{elseif $mid eq &#39;tiki-view_forum_thread.tpl&#39;}
-		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}tiki-view_forum_thread.php?comments_parentId={$comments_parentId}&#34; /&gt;
+		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$comments_parentId|sefurl:forumthread}&#34; /&gt;
+	{elseif $mid eq &#39;tiki-view_blog.tpl&#39;}
+		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$blogId|sefurl:blog}&#34; /&gt;
 	{elseif $mid eq &#39;tiki-view_blog_post.tpl&#39;}
 		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$postId|sefurl:blogpost}&#34; /&gt;
 	{elseif $mid eq &#39;tiki-read_article.tpl&#39;}
 		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$articleId|sefurl:article}&#34; /&gt;
+	{elseif $mid eq &#39;tiki-browse_categories.tpl&#39;}
+		&lt;link rel=&#34;canonical&#34; href=&#34;{$base_url}{$parentId|sefurl:category}&#34; /&gt;
 	{/if}
 {/if}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29101635">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29101635/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40839] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-08 20:09:45</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40839
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40839&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40839&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-08 20:09:39 +0000 (Sun, 08 Apr 2012)
Log Message:
-----------
[FIX] selectmenu: Make menu wider so the text doesn&#39;t get covered over by the triangle graphic, improve workaround for creating selectmenus in hidden divs as well as fieldsets and add warning on pref (also another warning on feature_jquery_tablesorter re js minify)

Modified Paths:
--------------
    branches/9.x/lib/jquery_tiki/tiki-jquery.js
    branches/9.x/lib/prefs/feature.php
    branches/9.x/lib/prefs/jquery.php
    branches/9.x/tiki-setup.php

Modified: branches/9.x/lib/jquery_tiki/tiki-jquery.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-08 18:22:20 UTC (rev 40838)
+++ branches/9.x/lib/jquery_tiki/tiki-jquery.js	2012-04-08 20:09:39 UTC (rev 40839)
@@ -507,7 +507,7 @@
 		}
 		if ($smenus.length) {
 			$smenus.each ( function () {
-				$.merge( hidden, $(this).parents(&#34;fieldset:hidden:last&#34;));
+				$.merge( hidden, $(this).parents(&#34;fieldset:hidden:last, div:hidden:last&#34;));
 			});
 			hidden = $.unique($(hidden));
 			hidden.show();

Modified: branches/9.x/lib/prefs/feature.php
===================================================================
--- branches/9.x/lib/prefs/feature.php	2012-04-08 18:22:20 UTC (rev 40838)
+++ branches/9.x/lib/prefs/feature.php	2012-04-08 20:09:39 UTC (rev 40839)
@@ -1806,6 +1806,7 @@
 			&#39;type&#39; =&gt; &#39;flag&#39;,
 			&#39;help&#39; =&gt; &#39;JQuery#TableSorter&#39;,
 			&#39;description&#39; =&gt; tra(&#39;Sort in fancytable plugin&#39;),
+			&#39;warning&#39; =&gt; tra(&#39;This feature can cause problems with JS minify on some systems.&#39;),
 			&#39;default&#39; =&gt; &#39;n&#39;,	// sortable tables ([will] override existing)
 		),
 		&#39;feature_jquery_media&#39; =&gt; array(

Modified: branches/9.x/lib/prefs/jquery.php
===================================================================
--- branches/9.x/lib/prefs/jquery.php	2012-04-08 18:22:20 UTC (rev 40838)
+++ branches/9.x/lib/prefs/jquery.php	2012-04-08 20:09:39 UTC (rev 40839)
@@ -104,6 +104,7 @@
 			&#39;type&#39; =&gt; &#39;flag&#39;,
 			&#39;default&#39; =&gt; &#39;n&#39;,
 			&#39;tags&#39; =&gt; array(&#39;experimental&#39;),
+			&#39;warning&#39; =&gt; tra(&#39;Experimental. This feature is under development.&#39;),
 			&#39;dependencies&#39; =&gt; array(
 				&#39;jquery_ui_selectmenu&#39;,
 			),

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-04-08 18:22:20 UTC (rev 40838)
+++ branches/9.x/tiki-setup.php	2012-04-08 20:09:39 UTC (rev 40839)
@@ -306,9 +306,10 @@
 				// standard css for selectmenu seems way too big for tiki - to be added to layout.css when not so experimental
 				$headerlib-&gt;add_css(
 								&#39;.ui-selectmenu-menu ul li a, .ui-selectmenu-status { white-space: nowrap; }
-.ui-selectmenu { height: 1.8em; }
+.ui-selectmenu { height: 1.8em; padding-right: 16px; }
+.ui-selectmenu-menu ul { padding-right: 16px; }
 .ui-selectmenu-menu li a,.ui-selectmenu-status { line-height: 1.0em; padding: .4em 1em; }
-.ui-selectmenu-status { line-height: .8em; }&#39;
+.ui-selectmenu-status { line-height: .8em; margin-right: 16px; }&#39;
 				);
 			}
 		}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29103908">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29103908/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40842] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-09 13:06:05</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40842
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40842&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40842&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-09 13:05:54 +0000 (Mon, 09 Apr 2012)
Log Message:
-----------
[FIX]  Switch theme: Empty values were obscuring site defaults following prefs overhaul (so themegen theme could not be set - thanks Chibaguy!)

Modified Paths:
--------------
    branches/9.x/lib/tikilib.php
    branches/9.x/tiki-switch_theme.php

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-09 11:15:41 UTC (rev 40841)
+++ branches/9.x/lib/tikilib.php	2012-04-09 13:05:54 UTC (rev 40842)
@@ -3426,6 +3426,7 @@
 				$prefs[&#39;style&#39;] = $value;
 				if ( $value == &#39;&#39; ) {
 					$prefs[&#39;style&#39;] = $prefs[&#39;site_style&#39;];
+					$userPreferences-&gt;delete(array(&#39;user&#39; =&gt; $my_user, &#39;prefName&#39; =&gt; $name));
 				}
 			} elseif ( $name == &#39;theme-option&#39; &amp;&amp; $prefs[&#39;change_theme&#39;] == &#39;y&#39; ) { // FIXME: Remove this exception as well?
 				$prefs[&#39;style_option&#39;] = $value;
@@ -3433,10 +3434,12 @@
 					$prefs[&#39;style_option&#39;] = $prefs[&#39;site_style_option&#39;];
 				} else if ( $value == &#39;None&#39; ) {
 					$prefs[&#39;style_option&#39;] = &#39;&#39;;
+					$userPreferences-&gt;delete(array(&#39;user&#39; =&gt; $my_user, &#39;prefName&#39; =&gt; $name));
 				}
 			} elseif ( $value == &#39;&#39; ) {
 				if ( in_array($name, $user_overrider_prefs) ) {
 					$prefs[$name] = $prefs[&#39;site_&#39;.$name];
+					$userPreferences-&gt;delete(array(&#39;user&#39; =&gt; $my_user, &#39;prefName&#39; =&gt; $name));
 				}
 			}
 		}

Modified: branches/9.x/tiki-switch_theme.php
===================================================================
--- branches/9.x/tiki-switch_theme.php	2012-04-09 11:15:41 UTC (rev 40841)
+++ branches/9.x/tiki-switch_theme.php	2012-04-09 13:05:54 UTC (rev 40842)
@@ -24,11 +24,12 @@
 	$theme = $_REQUEST[&#39;theme&#39;];
 
 	if (empty($theme)) {
-		$theme = $prefs[&#39;site_style&#39;];
-		$themeOption = $prefs[&#39;site_style_option&#39;];
-		$themeGenerator_theme = $prefs[&#39;site_themegenerator_theme&#39;];
+		$theme = &#39;&#39;;
+		$themeOption = &#39;&#39;;
+		$themeGenerator_theme = &#39;&#39;;
 	} elseif ($theme != $prefs[&#39;style&#39;]) { // use default theme option when changing main theme
 		$themeOption = &#39;&#39;;
+		$themeGenerator_theme = &#39;&#39;;
 	}
 	
 	$tikilib-&gt;set_user_preference($user, &#39;theme&#39;, $theme);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29111085">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29111085/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40863] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-04-10 20:59:20</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40863
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40863&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40863&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-04-10 20:59:13 +0000 (Tue, 10 Apr 2012)
Log Message:
-----------
[FIX] structures: Restore top level alias form from pre-revamp, not pretty but functional (thanks again Geoff)

Modified Paths:
--------------
    branches/9.x/templates/tiki-edit_structure.tpl
    branches/9.x/tiki-edit_structure.php

Modified: branches/9.x/templates/tiki-edit_structure.tpl
===================================================================
--- branches/9.x/templates/tiki-edit_structure.tpl	2012-04-10 20:27:48 UTC (rev 40862)
+++ branches/9.x/templates/tiki-edit_structure.tpl	2012-04-10 20:59:13 UTC (rev 40863)
@@ -67,12 +67,19 @@
 
 &lt;h2&gt;{tr}Structure Layout{/tr}&lt;/h2&gt;
 {button _text=&#34;{tr}Save{/tr}&#34; _style=&#34;display:none;&#34; _class=&#34;save_structure&#34; _ajax=&#34;n&#34; _auto_args=&#34;save_structure,page_ref_id&#34;}
+{self_link page_ref_id=$structure_id}
+	{if $structure_id eq $page_ref_id}&lt;strong&gt;{/if}
+	{tr}Top{/tr}
+	{if $structure_id eq $page_ref_id}&lt;/strong&gt;
+	{/if}
+{/self_link}
+&lt;form action=&#34;tiki-edit_structure.php&#34; method=&#34;post&#34; style=&#34;display: inline-block; margin-left: 1em;&#34;&gt;
+	&lt;input type=&#34;hidden&#34; name=&#34;page_ref_id&#34; value=&#34;{$structure_id}&#34; /&gt;
+	&lt;label for=&#34;pageAlias&#34;&gt;{tr}Alias:{/tr}&lt;/label&gt;&lt;/td&gt;
+	&lt;input type=&#34;text&#34; name=&#34;pageAlias&#34; id=&#34;pageAlias&#34; value=&#34;{$topPageAlias}&#34; /&gt;
+	&lt;small&gt;&lt;input type=&#34;submit&#34; name=&#34;create&#34; value=&#34;{tr}Update{/tr}&#34; /&gt;&lt;/small&gt;
+&lt;/form&gt;
 &lt;div class=&#34;structure-container&#34;&gt;
-	{self_link page_ref_id=$structure_id}
-		{if $structure_id eq $page_ref_id}&lt;strong&gt;{/if}
-		{tr}Top{/tr}
-		{if $structure_id eq $page_ref_id}&lt;/strong&gt;{/if}
-	{/self_link}
 	{$nodelist}
 &lt;/div&gt;
 {button _text=&#34;{tr}Save{/tr}&#34; _style=&#34;display:none;&#34; _class=&#34;save_structure&#34; _ajax=&#34;n&#34; _auto_args=&#34;save_structure,page_ref_id&#34;}

Modified: branches/9.x/tiki-edit_structure.php
===================================================================
--- branches/9.x/tiki-edit_structure.php	2012-04-10 20:27:48 UTC (rev 40862)
+++ branches/9.x/tiki-edit_structure.php	2012-04-10 20:59:13 UTC (rev 40863)
@@ -194,6 +194,7 @@
 $page_info = $structlib-&gt;s_get_page_info($_REQUEST[&#34;page_ref_id&#34;]);
 $smarty-&gt;assign(&#39;pageName&#39;, $page_info[&#34;pageName&#34;]);
 $smarty-&gt;assign(&#39;pageAlias&#39;, $page_info[&#34;page_alias&#34;]);
+$smarty-&gt;assign(&#39;topPageAlias&#39;, $structure_info[&#34;page_alias&#34;]);
 
 $subpages = $structlib-&gt;s_get_pages($_REQUEST[&#34;page_ref_id&#34;]);
 $max = count($subpages);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29111241">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29111241/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-10 21:36:44</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40866
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
Log Message:
-----------
[NEW] Some much needed prefs for lucene search to help make it more controllable, from jonnyb

Modified Paths:
--------------
    branches/9.x/lib/core/Search/Index/Lucene.php
    branches/9.x/lib/prefs/unified.php
    branches/9.x/templates/admin/include_search.tpl

Modified: branches/9.x/lib/core/Search/Index/Lucene.php
===================================================================
--- branches/9.x/lib/core/Search/Index/Lucene.php	2012-04-10 21:26:17 UTC (rev 40865)
+++ branches/9.x/lib/core/Search/Index/Lucene.php	2012-04-10 21:36:38 UTC (rev 40866)
@@ -40,10 +40,16 @@
 		} catch (Zend_Search_Lucene_Exception $e) {
 			$this-&gt;lucene = Zend_Search_Lucene::create($this-&gt;directory);
 		}
-
-		$this-&gt;lucene-&gt;setMaxBufferedDocs(100);
-		$this-&gt;lucene-&gt;setMaxMergeDocs(5000);
-		$this-&gt;lucene-&gt;setMergeFactor(50);
+		global $prefs;
+		if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {							// these break indexing if set empty
+			$this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);	// default is 10
+		}
+		if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
+			$this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);		// default is PHP_INT_MAX (effectively &#34;infinite&#34;)
+		}
+		if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
+			$this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);			// default is 10
+		}
 		$this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
 
 		return $this-&gt;lucene;

Modified: branches/9.x/lib/prefs/unified.php
===================================================================
--- branches/9.x/lib/prefs/unified.php	2012-04-10 21:26:17 UTC (rev 40865)
+++ branches/9.x/lib/prefs/unified.php	2012-04-10 21:36:38 UTC (rev 40866)
@@ -40,8 +40,8 @@
 		),
 		&#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
-			&#39;description&#39; =&gt; tra(&#39;Maximum size of result set to consider. Default 1000, 0 = unlimited.&#39;),
-			&#39;hint&#39; =&gt; tra(&#39;This is used when calculating result scores and sort order which can lead to out of memory errors on large data sets. The default of 1000 is safe with the PHP memory_limit set to 128M&#39;),
+			&#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to consider. Default 1000, 0 = unlimited.&#39;),
+			&#39;description&#39; =&gt; tra(&#39;This is used when calculating result scores and sort order which can lead to out of memory errors on large data sets. The default of 1000 is safe with the PHP memory_limit set to 128M&#39;),
 			&#39;type&#39; =&gt; &#39;text&#39;,
 			&#39;filter&#39; =&gt; &#39;int&#39;,
 			&#39;default&#39; =&gt; 1000,
@@ -55,6 +55,33 @@
 			&#39;default&#39; =&gt; 1024,
 			&#39;size&#39; =&gt; 6,
 		),
+		&#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
+			&#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
+			&#39;description&#39; =&gt; tra(&#39;Number of documents required before the buffered in-memory documents are written into a new segment.&#39;),
+			&#39;hint&#39; =&gt; tra(&#39;&#39;),
+			&#39;type&#39; =&gt; &#39;text&#39;,
+			&#39;filter&#39; =&gt; &#39;int&#39;,
+			&#39;default&#39; =&gt; 10,
+			&#39;size&#39; =&gt; 6,
+		),
+		&#39;unified_lucene_max_merge_docs&#39; =&gt; array(
+			&#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
+			&#39;description&#39; =&gt; tra(&#39;Largest number of documents ever merged by addDocument(). Small values (e.g., less than 10,000) are best for interactive indexing, as this limits the length of pauses while indexing to a few seconds. Larger values are best for batched indexing and speedier searches.&#39;),
+			&#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than 10,000) are best for interactive indexing. Use 0 for the Lucene default, which is practically infinite.&#39;),
+			&#39;type&#39; =&gt; &#39;text&#39;,
+			&#39;filter&#39; =&gt; &#39;int&#39;,
+			&#39;default&#39; =&gt; 0,
+			&#39;size&#39; =&gt; 8,
+		),
+		&#39;unified_lucene_merge_factor&#39; =&gt; array(
+			&#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
+			&#39;description&#39; =&gt; tra(&#39;How often segment indices are merged by addDocument(). With smaller values, less RAM is used while indexing, and searches on unoptimized indices are faster, but indexing speed is slower. With larger values, more RAM is used during indexing, and while searches on unoptimized indices are slower, indexing is faster. Thus larger values (&gt; 10) are best for batch index creation, and smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
+			&#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for batch index creation, and smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
+			&#39;type&#39; =&gt; &#39;text&#39;,
+			&#39;filter&#39; =&gt; &#39;int&#39;,
+			&#39;default&#39; =&gt; 10,
+			&#39;size&#39; =&gt; 6,
+		),
 		&#39;unified_incremental_update&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
 			&#39;description&#39; =&gt; tra(&#39;Update the index incrementally as the site content is modified. This may lead to lower performance and accuracy than processing the index on a periodic basis.&#39;),

Modified: branches/9.x/templates/admin/include_search.tpl
===================================================================
--- branches/9.x/templates/admin/include_search.tpl	2012-04-10 21:26:17 UTC (rev 40865)
+++ branches/9.x/templates/admin/include_search.tpl	2012-04-10 21:36:38 UTC (rev 40866)
@@ -22,14 +22,20 @@
 
 				{preference name=feature_search visible=&#34;always&#34;}
 				&lt;div class=&#34;adminoptionboxchild&#34; id=&#34;feature_search_childcontainer&#34;&gt;				
-					{preference name=&#34;unified_incremental_update&#34;}
 					{preference name=&#34;unified_engine&#34;}
 					&lt;div class=&#34;adminoptionboxchild unified_engine_childcontainer lucene&#34;&gt;
+						{preference name=&#34;unified_incremental_update&#34;}
+						{preference name=&#34;unified_lucene_highlight&#34;}
 						{preference name=&#34;unified_lucene_location&#34;}
-						{preference name=&#34;unified_lucene_highlight&#34;}
-						{preference name=&#34;unified_lucene_max_result&#34;}
-						{preference name=&#34;unified_lucene_max_resultset_limit&#34;}
-						{preference name=&#34;unified_lucene_terms_limit&#34;}
+						&lt;fieldset&gt;
+							&lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
+							{preference name=&#34;unified_lucene_max_result&#34;}
+							{preference name=&#34;unified_lucene_max_resultset_limit&#34;}
+							{preference name=&#34;unified_lucene_terms_limit&#34;}
+							{preference name=&#34;unified_lucene_max_buffered_docs&#34;}
+							{preference name=&#34;unified_lucene_max_merge_docs&#34;}
+							{preference name=&#34;unified_lucene_merge_factor&#34;}
+						&lt;/fieldset&gt;
 					&lt;/div&gt;
 
 					{preference name=unified_forum_deepindexing}
@@ -48,7 +54,19 @@
 					&lt;ul&gt;
 						&lt;li&gt;&lt;a href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
 						&lt;li&gt;
-							&lt;a href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
+							&lt;a href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
+							&lt;label for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
+							&lt;input type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
+							&lt;span class=&#34;description&#34;&gt;{tr}Log file is saved as temp/Search_Indexer.log{/tr}&lt;/span&gt;
+							{jq}
+$(&#34;#log-rebuild&#34;).click(function(){
+	if ($(this).prop(&#34;checked&#34;)) {
+		$(&#34;#rebuild-link&#34;).attr(&#34;href&#34;, $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
+	} else {
+		$(&#34;#rebuild-link&#34;).attr(&#34;href&#34;, $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
+	}
+});
+							{/jq}
 							{if !empty($stat)}
 								{remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
 									&lt;ul&gt;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29111994">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29111994/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-11 01:42:52</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CABd-EREq1on5%2BtM0SqVvQKfJUKTQmLXVJfVr9NOfnwM9QE3tLw%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>awesome!

I hope doc.tiki.org and dev.tiki.org can complete index rebuilding with
these new preferences!
On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:

&gt; Revision: 40866
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt; Author:   robertplummer
&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt; controllable, from jonnyb
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;    branches/9.x/lib/prefs/unified.php
&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;
&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt; 21:26:17 UTC (rev 40865)
&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt; 21:36:38 UTC (rev 40866)
&gt; @@ -40,10 +40,16 @@
&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;                        $this-&gt;lucene =
&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt;                }
&gt; -
&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt; +               global $prefs;
&gt; +               if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {
&gt;                                                       // these break
&gt; indexing if set empty
&gt; +
&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;  // default is 10
&gt; +               }
&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt; +
&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt; +               }
&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt; +
&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;             // default is 10
&gt; +               }
&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;
&gt;                return $this-&gt;lucene;
&gt;
&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev 40865)
&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev 40866)
&gt; @@ -40,8 +40,8 @@
&gt;                ),
&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result set
&gt; to consider. Default 1000, 0 = unlimited.&#39;),
&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating
&gt; result scores and sort order which can lead to out of memory errors on
&gt; large data sets. The default of 1000 is safe with the PHP memory_limit set
&gt; to 128M&#39;),
&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to
&gt; consider. Default 1000, 0 = unlimited.&#39;),
&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt; calculating result scores and sort order which can lead to out of memory
&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt; memory_limit set to 128M&#39;),
&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;                        &#39;default&#39; =&gt; 1000,
&gt; @@ -55,6 +55,33 @@
&gt;                        &#39;default&#39; =&gt; 1024,
&gt;                        &#39;size&#39; =&gt; 6,
&gt;                ),
&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents required
&gt; before the buffered in-memory documents are written into a new segment.&#39;),
&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; +                       &#39;default&#39; =&gt; 10,
&gt; +                       &#39;size&#39; =&gt; 6,
&gt; +               ),
&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of documents
&gt; ever merged by addDocument(). Small values (e.g., less than 10,000) are
&gt; best for interactive indexing, as this limits the length of pauses while
&gt; indexing to a few seconds. Larger values are best for batched indexing and
&gt; speedier searches.&#39;),
&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than
&gt; 10,000) are best for interactive indexing. Use 0 for the Lucene default,
&gt; which is practically infinite.&#39;),
&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; +                       &#39;default&#39; =&gt; 0,
&gt; +                       &#39;size&#39; =&gt; 8,
&gt; +               ),
&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment indices
&gt; are merged by addDocument(). With smaller values, less RAM is used while
&gt; indexing, and searches on unoptimized indices are faster, but indexing
&gt; speed is slower. With larger values, more RAM is used during indexing, and
&gt; while searches on unoptimized indices are slower, indexing is faster. Thus
&gt; larger values (&gt; 10) are best for batch index creation, and smaller values
&gt; (&lt; 10) for indices that are interactively maintained.&#39;),
&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for
&gt; batch index creation, and smaller values (&lt; 10) for indices that are
&gt; interactively maintained.&#39;),
&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; +                       &#39;default&#39; =&gt; 10,
&gt; +                       &#39;size&#39; =&gt; 6,
&gt; +               ),
&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt; incrementally as the site content is modified. This may lead to lower
&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;
&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt; ===================================================================
&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt; 21:26:17 UTC (rev 40865)
&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt; 21:36:38 UTC (rev 40866)
&gt; @@ -22,14 +22,20 @@
&gt;
&gt;                                {preference name=feature_search
&gt; visible=&#34;always&#34;}
&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt; -                                       {preference
&gt; name=&#34;unified_incremental_update&#34;}
&gt;                                        {preference name=&#34;unified_engine&#34;}
&gt;                                        &lt;div class=&#34;adminoptionboxchild
&gt; unified_engine_childcontainer lucene&#34;&gt;
&gt; +                                               {preference
&gt; name=&#34;unified_incremental_update&#34;}
&gt; +                                               {preference
&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;                                                {preference
&gt; name=&#34;unified_lucene_location&#34;}
&gt; -                                               {preference
&gt; name=&#34;unified_lucene_highlight&#34;}
&gt; -                                               {preference
&gt; name=&#34;unified_lucene_max_result&#34;}
&gt; -                                               {preference
&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt; -                                               {preference
&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt; +                                               &lt;fieldset&gt;
&gt; +                                                       &lt;legend&gt;{tr}Search
&gt; Engine Settings{/tr}&lt;/legend&gt;
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_result&#34;}
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt; +                                               &lt;/fieldset&gt;
&gt;                                        &lt;/div&gt;
&gt;
&gt;                                        {preference
&gt; name=unified_forum_deepindexing}
&gt; @@ -48,7 +54,19 @@
&gt;                                        &lt;ul&gt;
&gt;                                                &lt;li&gt;&lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;                                                &lt;li&gt;
&gt; -                                                       &lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt; +                                                       &lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt; +                                                       &lt;label
&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt; +                                                       &lt;input
&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt; +                                                       &lt;span
&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt; +                                                       {jq}
&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt; +       } else {
&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt; +       }
&gt; +});
&gt; +                                                       {/jq}
&gt;                                                        {if !empty($stat)}
&gt;                                                                {remarksbox
&gt; type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;                                                                        &lt;ul&gt;
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Better than sec? Nothing is better than sec when it comes to
&gt; monitoring Big Data applications. Try Boundary one-second
&gt; resolution app monitoring today. Free.
&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29114573">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29114573/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-04-11 14:08:05</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQrTsdkGRV2SCAyhFHqirS57f7QKiWCh%2BBnOfZW-mF%3DKiQ%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>I&#39;m not sure why, but before rebuilding indexes on my site took about 1 to
3 min. Now it takes just a few seconds, I wonder why.....
On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:

&gt; awesome!
&gt;
&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding with
&gt; these new preferences!
&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt;
&gt;&gt; Revision: 40866
&gt;&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt;&gt; Author:   robertplummer
&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt;&gt; Log Message:
&gt;&gt; -----------
&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt;&gt; controllable, from jonnyb
&gt;&gt;
&gt;&gt; Modified Paths:
&gt;&gt; --------------
&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;&gt;
&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt; @@ -40,10 +40,16 @@
&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;&gt;                        $this-&gt;lucene =
&gt;&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt;&gt;                }
&gt;&gt; -
&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt;&gt; +               global $prefs;
&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {
&gt;&gt;                                                       // these break
&gt;&gt; indexing if set empty
&gt;&gt; +
&gt;&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;&gt;  // default is 10
&gt;&gt; +               }
&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt;&gt; +
&gt;&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt;&gt; +               }
&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt;&gt; +
&gt;&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;&gt;             // default is 10
&gt;&gt; +               }
&gt;&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;&gt;
&gt;&gt;                return $this-&gt;lucene;
&gt;&gt;
&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev
&gt;&gt; 40865)
&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev
&gt;&gt; 40866)
&gt;&gt; @@ -40,8 +40,8 @@
&gt;&gt;                ),
&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result set
&gt;&gt; to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating
&gt;&gt; result scores and sort order which can lead to out of memory errors on
&gt;&gt; large data sets. The default of 1000 is safe with the PHP memory_limit set
&gt;&gt; to 128M&#39;),
&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to
&gt;&gt; consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt;&gt; calculating result scores and sort order which can lead to out of memory
&gt;&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt;&gt; memory_limit set to 128M&#39;),
&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt;&gt; @@ -55,6 +55,33 @@
&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt;&gt;                ),
&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents
&gt;&gt; required before the buffered in-memory documents are written into a new
&gt;&gt; segment.&#39;),
&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt; +               ),
&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of documents
&gt;&gt; ever merged by addDocument(). Small values (e.g., less than 10,000) are
&gt;&gt; best for interactive indexing, as this limits the length of pauses while
&gt;&gt; indexing to a few seconds. Larger values are best for batched indexing and
&gt;&gt; speedier searches.&#39;),
&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than
&gt;&gt; 10,000) are best for interactive indexing. Use 0 for the Lucene default,
&gt;&gt; which is practically infinite.&#39;),
&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt;&gt; +               ),
&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment indices
&gt;&gt; are merged by addDocument(). With smaller values, less RAM is used while
&gt;&gt; indexing, and searches on unoptimized indices are faster, but indexing
&gt;&gt; speed is slower. With larger values, more RAM is used during indexing, and
&gt;&gt; while searches on unoptimized indices are slower, indexing is faster. Thus
&gt;&gt; larger values (&gt; 10) are best for batch index creation, and smaller values
&gt;&gt; (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for
&gt;&gt; batch index creation, and smaller values (&lt; 10) for indices that are
&gt;&gt; interactively maintained.&#39;),
&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt; +               ),
&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt;&gt; incrementally as the site content is modified. This may lead to lower
&gt;&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;&gt;
&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt; @@ -22,14 +22,20 @@
&gt;&gt;
&gt;&gt;                                {preference name=feature_search
&gt;&gt; visible=&#34;always&#34;}
&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt;&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt;&gt; -                                       {preference
&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;                                        {preference name=&#34;unified_engine&#34;}
&gt;&gt;                                        &lt;div class=&#34;adminoptionboxchild
&gt;&gt; unified_engine_childcontainer lucene&#34;&gt;
&gt;&gt; +                                               {preference
&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt; +                                               {preference
&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;                                                {preference
&gt;&gt; name=&#34;unified_lucene_location&#34;}
&gt;&gt; -                                               {preference
&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt; -                                               {preference
&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt; -                                               {preference
&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt; -                                               {preference
&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt; +                                               &lt;fieldset&gt;
&gt;&gt; +
&gt;&gt; &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt;&gt; +                                                       {preference
&gt;&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt;&gt; +                                               &lt;/fieldset&gt;
&gt;&gt;                                        &lt;/div&gt;
&gt;&gt;
&gt;&gt;                                        {preference
&gt;&gt; name=unified_forum_deepindexing}
&gt;&gt; @@ -48,7 +54,19 @@
&gt;&gt;                                        &lt;ul&gt;
&gt;&gt;                                                &lt;li&gt;&lt;a
&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;&gt;                                                &lt;li&gt;
&gt;&gt; -                                                       &lt;a
&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt;&gt; +                                                       &lt;a
&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt;&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt;&gt; +                                                       &lt;label
&gt;&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt;&gt; +                                                       &lt;input
&gt;&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt;&gt; +                                                       &lt;span
&gt;&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt;&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt;&gt; +                                                       {jq}
&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt;&gt; +       } else {
&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt;&gt; +       }
&gt;&gt; +});
&gt;&gt; +                                                       {/jq}
&gt;&gt;                                                        {if !empty($stat)}
&gt;&gt;
&gt;&gt;  {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;&gt;
&gt;&gt;  &lt;ul&gt;
&gt;&gt;
&gt;&gt; This was sent by the SourceForge.net collaborative development platform,
&gt;&gt; the world&#39;s largest Open Source development site.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt; resolution app monitoring today. Free.
&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Better than sec? Nothing is better than sec when it comes to
&gt; monitoring Big Data applications. Try Boundary one-second
&gt; resolution app monitoring today. Free.
&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29116640">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29116640/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-11 20:50:00</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CABd-ERG4_bzVYVwx36xNrq5HEGQJu%3DBKtK%2BLkg91a%3DwwUkgX3Q%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Makes you wonder if it worked!   :-)
On 2012-04-11 10:08 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt;
wrote:

&gt; I&#39;m not sure why, but before rebuilding indexes on my site took about 1 to
&gt; 3 min. Now it takes just a few seconds, I wonder why.....
&gt; On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;
&gt;&gt; awesome!
&gt;&gt;
&gt;&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding with
&gt;&gt; these new preferences!
&gt;&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Revision: 40866
&gt;&gt;&gt;
&gt;&gt;&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt;&gt;&gt; Author:   robertplummer
&gt;&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt;&gt;&gt; Log Message:
&gt;&gt;&gt; -----------
&gt;&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt;&gt;&gt; controllable, from jonnyb
&gt;&gt;&gt;
&gt;&gt;&gt; Modified Paths:
&gt;&gt;&gt; --------------
&gt;&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;
&gt;&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt; @@ -40,10 +40,16 @@
&gt;&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;&gt;&gt;                        $this-&gt;lucene =
&gt;&gt;&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt;&gt;&gt;                }
&gt;&gt;&gt; -
&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt;&gt;&gt; +               global $prefs;
&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;]))
&gt;&gt;&gt; {                                                       // these break
&gt;&gt;&gt; indexing if set empty
&gt;&gt;&gt; +
&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;&gt;&gt;  // default is 10
&gt;&gt;&gt; +               }
&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt;&gt;&gt; +
&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;&gt;&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt;&gt;&gt; +               }
&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt;&gt;&gt; +
&gt;&gt;&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;&gt;&gt;             // default is 10
&gt;&gt;&gt; +               }
&gt;&gt;&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;&gt;&gt;
&gt;&gt;&gt;                return $this-&gt;lucene;
&gt;&gt;&gt;
&gt;&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev
&gt;&gt;&gt; 40865)
&gt;&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev
&gt;&gt;&gt; 40866)
&gt;&gt;&gt; @@ -40,8 +40,8 @@
&gt;&gt;&gt;                ),
&gt;&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
&gt;&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result set
&gt;&gt;&gt; to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating
&gt;&gt;&gt; result scores and sort order which can lead to out of memory errors on
&gt;&gt;&gt; large data sets. The default of 1000 is safe with the PHP memory_limit set
&gt;&gt;&gt; to 128M&#39;),
&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to
&gt;&gt;&gt; consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt;&gt;&gt; calculating result scores and sort order which can lead to out of memory
&gt;&gt;&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt;&gt;&gt; memory_limit set to 128M&#39;),
&gt;&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt;&gt;&gt; @@ -55,6 +55,33 @@
&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt;&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;                ),
&gt;&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents
&gt;&gt;&gt; required before the buffered in-memory documents are written into a new
&gt;&gt;&gt; segment.&#39;),
&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt; +               ),
&gt;&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of
&gt;&gt;&gt; documents ever merged by addDocument(). Small values (e.g., less than
&gt;&gt;&gt; 10,000) are best for interactive indexing, as this limits the length of
&gt;&gt;&gt; pauses while indexing to a few seconds. Larger values are best for batched
&gt;&gt;&gt; indexing and speedier searches.&#39;),
&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than
&gt;&gt;&gt; 10,000) are best for interactive indexing. Use 0 for the Lucene default,
&gt;&gt;&gt; which is practically infinite.&#39;),
&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt;&gt;&gt; +               ),
&gt;&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment indices
&gt;&gt;&gt; are merged by addDocument(). With smaller values, less RAM is used while
&gt;&gt;&gt; indexing, and searches on unoptimized indices are faster, but indexing
&gt;&gt;&gt; speed is slower. With larger values, more RAM is used during indexing, and
&gt;&gt;&gt; while searches on unoptimized indices are slower, indexing is faster. Thus
&gt;&gt;&gt; larger values (&gt; 10) are best for batch index creation, and smaller values
&gt;&gt;&gt; (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for
&gt;&gt;&gt; batch index creation, and smaller values (&lt; 10) for indices that are
&gt;&gt;&gt; interactively maintained.&#39;),
&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt; +               ),
&gt;&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt;&gt;&gt; incrementally as the site content is modified. This may lead to lower
&gt;&gt;&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;&gt;&gt;
&gt;&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt; @@ -22,14 +22,20 @@
&gt;&gt;&gt;
&gt;&gt;&gt;                                {preference name=feature_search
&gt;&gt;&gt; visible=&#34;always&#34;}
&gt;&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt;&gt;&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt;&gt;&gt; -                                       {preference
&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;                                        {preference name=&#34;unified_engine&#34;}
&gt;&gt;&gt;                                        &lt;div class=&#34;adminoptionboxchild
&gt;&gt;&gt; unified_engine_childcontainer lucene&#34;&gt;
&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;                                                {preference
&gt;&gt;&gt; name=&#34;unified_lucene_location&#34;}
&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt; +                                               &lt;fieldset&gt;
&gt;&gt;&gt; +
&gt;&gt;&gt; &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt;&gt;&gt; +                                               &lt;/fieldset&gt;
&gt;&gt;&gt;                                        &lt;/div&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;                                        {preference
&gt;&gt;&gt; name=unified_forum_deepindexing}
&gt;&gt;&gt; @@ -48,7 +54,19 @@
&gt;&gt;&gt;                                        &lt;ul&gt;
&gt;&gt;&gt;                                                &lt;li&gt;&lt;a
&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;&gt;&gt;                                                &lt;li&gt;
&gt;&gt;&gt; -                                                       &lt;a
&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt;&gt;&gt; +                                                       &lt;a
&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt;&gt;&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt;&gt;&gt; +                                                       &lt;label
&gt;&gt;&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt;&gt;&gt; +                                                       &lt;input
&gt;&gt;&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt;&gt;&gt; +                                                       &lt;span
&gt;&gt;&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt;&gt;&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt;&gt;&gt; +                                                       {jq}
&gt;&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt;&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt;&gt;&gt; +       } else {
&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt;&gt;&gt; +       }
&gt;&gt;&gt; +});
&gt;&gt;&gt; +                                                       {/jq}
&gt;&gt;&gt;                                                        {if !empty($stat)}
&gt;&gt;&gt;
&gt;&gt;&gt;  {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;&gt;&gt;
&gt;&gt;&gt;  &lt;ul&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; This was sent by the SourceForge.net collaborative development platform,
&gt;&gt;&gt; the world&#39;s largest Open Source development site.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt; resolution app monitoring today. Free.
&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;
&gt;&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Better than sec? Nothing is better than sec when it comes to
&gt; monitoring Big Data applications. Try Boundary one-second
&gt; resolution app monitoring today. Free.
&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29117845">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29117845/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-04-12 03:47:30</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQoUCiGG_bLBAs2-0-M-275RMCp-%3DRVUw-h845ZtEppXsg%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>I did a few searches, it worked. In fact I had integrated lucene in the
past in c# and it only took a few seconds for small indexes, so I wondered
why 3 pages and a tracker with 1 item would take so long.  Now it works
like I thought it should.  I will double check in the morning.
On Apr 11, 2012 4:50 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:

&gt; Makes you wonder if it worked!   :-)
&gt; On 2012-04-11 10:08 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt;
&gt; wrote:
&gt;
&gt;&gt; I&#39;m not sure why, but before rebuilding indexes on my site took about 1
&gt;&gt; to 3 min. Now it takes just a few seconds, I wonder why.....
&gt;&gt; On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; awesome!
&gt;&gt;&gt;
&gt;&gt;&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding with
&gt;&gt;&gt; these new preferences!
&gt;&gt;&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Revision: 40866
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt;&gt;&gt;&gt; Author:   robertplummer
&gt;&gt;&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt;&gt;&gt;&gt; Log Message:
&gt;&gt;&gt;&gt; -----------
&gt;&gt;&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt;&gt;&gt;&gt; controllable, from jonnyb
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Modified Paths:
&gt;&gt;&gt;&gt; --------------
&gt;&gt;&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt; @@ -40,10 +40,16 @@
&gt;&gt;&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;&gt;&gt;&gt;                        $this-&gt;lucene =
&gt;&gt;&gt;&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt;&gt;&gt;&gt;                }
&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt;&gt;&gt;&gt; +               global $prefs;
&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;]))
&gt;&gt;&gt;&gt; {                                                       // these break
&gt;&gt;&gt;&gt; indexing if set empty
&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;&gt;&gt;&gt;  // default is 10
&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;&gt;&gt;&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;&gt;&gt;&gt;             // default is 10
&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;                return $this-&gt;lucene;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev
&gt;&gt;&gt;&gt; 40865)
&gt;&gt;&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev
&gt;&gt;&gt;&gt; 40866)
&gt;&gt;&gt;&gt; @@ -40,8 +40,8 @@
&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
&gt;&gt;&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result
&gt;&gt;&gt;&gt; set to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating
&gt;&gt;&gt;&gt; result scores and sort order which can lead to out of memory errors on
&gt;&gt;&gt;&gt; large data sets. The default of 1000 is safe with the PHP memory_limit set
&gt;&gt;&gt;&gt; to 128M&#39;),
&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to
&gt;&gt;&gt;&gt; consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt;&gt;&gt;&gt; calculating result scores and sort order which can lead to out of memory
&gt;&gt;&gt;&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt;&gt;&gt;&gt; memory_limit set to 128M&#39;),
&gt;&gt;&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt;&gt;&gt;&gt; @@ -55,6 +55,33 @@
&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt;&gt;&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents
&gt;&gt;&gt;&gt; required before the buffered in-memory documents are written into a new
&gt;&gt;&gt;&gt; segment.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of
&gt;&gt;&gt;&gt; documents ever merged by addDocument(). Small values (e.g., less than
&gt;&gt;&gt;&gt; 10,000) are best for interactive indexing, as this limits the length of
&gt;&gt;&gt;&gt; pauses while indexing to a few seconds. Larger values are best for batched
&gt;&gt;&gt;&gt; indexing and speedier searches.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than
&gt;&gt;&gt;&gt; 10,000) are best for interactive indexing. Use 0 for the Lucene default,
&gt;&gt;&gt;&gt; which is practically infinite.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment indices
&gt;&gt;&gt;&gt; are merged by addDocument(). With smaller values, less RAM is used while
&gt;&gt;&gt;&gt; indexing, and searches on unoptimized indices are faster, but indexing
&gt;&gt;&gt;&gt; speed is slower. With larger values, more RAM is used during indexing, and
&gt;&gt;&gt;&gt; while searches on unoptimized indices are slower, indexing is faster. Thus
&gt;&gt;&gt;&gt; larger values (&gt; 10) are best for batch index creation, and smaller values
&gt;&gt;&gt;&gt; (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for
&gt;&gt;&gt;&gt; batch index creation, and smaller values (&lt; 10) for indices that are
&gt;&gt;&gt;&gt; interactively maintained.&#39;),
&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;&gt;&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt;&gt;&gt;&gt; incrementally as the site content is modified. This may lead to lower
&gt;&gt;&gt;&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt; @@ -22,14 +22,20 @@
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;                                {preference name=feature_search
&gt;&gt;&gt;&gt; visible=&#34;always&#34;}
&gt;&gt;&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt;&gt;&gt;&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt;&gt;&gt;&gt; -                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt;                                        {preference
&gt;&gt;&gt;&gt; name=&#34;unified_engine&#34;}
&gt;&gt;&gt;&gt;                                        &lt;div class=&#34;adminoptionboxchild
&gt;&gt;&gt;&gt; unified_engine_childcontainer lucene&#34;&gt;
&gt;&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt;                                                {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_location&#34;}
&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt; +                                               &lt;fieldset&gt;
&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt; &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt;&gt;&gt;&gt; +                                               &lt;/fieldset&gt;
&gt;&gt;&gt;&gt;                                        &lt;/div&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;                                        {preference
&gt;&gt;&gt;&gt; name=unified_forum_deepindexing}
&gt;&gt;&gt;&gt; @@ -48,7 +54,19 @@
&gt;&gt;&gt;&gt;                                        &lt;ul&gt;
&gt;&gt;&gt;&gt;                                                &lt;li&gt;&lt;a
&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;&gt;&gt;&gt;                                                &lt;li&gt;
&gt;&gt;&gt;&gt; -                                                       &lt;a
&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt;&gt;&gt;&gt; +                                                       &lt;a
&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt;&gt;&gt;&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt;&gt;&gt;&gt; +                                                       &lt;label
&gt;&gt;&gt;&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt;&gt;&gt;&gt; +                                                       &lt;input
&gt;&gt;&gt;&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt;&gt;&gt;&gt; +                                                       &lt;span
&gt;&gt;&gt;&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt;&gt;&gt;&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt;&gt;&gt;&gt; +                                                       {jq}
&gt;&gt;&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt;&gt;&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt;&gt;&gt;&gt; +       } else {
&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt;&gt;&gt;&gt; +       }
&gt;&gt;&gt;&gt; +});
&gt;&gt;&gt;&gt; +                                                       {/jq}
&gt;&gt;&gt;&gt;                                                        {if
&gt;&gt;&gt;&gt; !empty($stat)}
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;  {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;  &lt;ul&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This was sent by the SourceForge.net collaborative development
&gt;&gt;&gt;&gt; platform, the world&#39;s largest Open Source development site.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt; resolution app monitoring today. Free.
&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;
&gt;&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Better than sec? Nothing is better than sec when it comes to
&gt; monitoring Big Data applications. Try Boundary one-second
&gt; resolution app monitoring today. Free.
&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29120637">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29120637/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-04-12 15:42:36</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQpqORVpgbDx17kR-kxS_vhVtBrnfx3H-uz6fGG-n1bbiA%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Just checked, works great.  However it seems that some pages are executed
and others are not, I&#39;m having trouble with the group plugin particularly.
Shouldn&#39;t the source be searched but the rendered page be displayed?

On Wed, Apr 11, 2012 at 11:39 PM, Robert Plummer &lt;
robertleeplummerjr@...&gt; wrote:

&gt; I did a few searches, it worked. In fact I had integrated lucene in the
&gt; past in c# and it only took a few seconds for small indexes, so I wondered
&gt; why 3 pages and a tracker with 1 item would take so long.  Now it works
&gt; like I thought it should.  I will double check in the morning.
&gt; On Apr 11, 2012 4:50 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;
&gt;&gt; Makes you wonder if it worked!   :-)
&gt;&gt; On 2012-04-11 10:08 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt;
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; I&#39;m not sure why, but before rebuilding indexes on my site took about 1
&gt;&gt;&gt; to 3 min. Now it takes just a few seconds, I wonder why.....
&gt;&gt;&gt; On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; awesome!
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding
&gt;&gt;&gt;&gt; with these new preferences!
&gt;&gt;&gt;&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Revision: 40866
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt;&gt;&gt;&gt;&gt; Author:   robertplummer
&gt;&gt;&gt;&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt;&gt;&gt;&gt;&gt; Log Message:
&gt;&gt;&gt;&gt;&gt; -----------
&gt;&gt;&gt;&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt;&gt;&gt;&gt;&gt; controllable, from jonnyb
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Modified Paths:
&gt;&gt;&gt;&gt;&gt; --------------
&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt;&gt;&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt;&gt; @@ -40,10 +40,16 @@
&gt;&gt;&gt;&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;&gt;&gt;&gt;&gt;                        $this-&gt;lucene =
&gt;&gt;&gt;&gt;&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt;&gt;&gt;&gt;&gt;                }
&gt;&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt;&gt;&gt;&gt;&gt; +               global $prefs;
&gt;&gt;&gt;&gt;&gt; +               if
&gt;&gt;&gt;&gt;&gt; (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {
&gt;&gt;&gt;&gt;&gt;                                   // these break indexing if set empty
&gt;&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;&gt;&gt;&gt;&gt;  // default is 10
&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt;&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;&gt;&gt;&gt;&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt;&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt;&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;&gt;&gt;&gt;&gt;             // default is 10
&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;                return $this-&gt;lucene;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev
&gt;&gt;&gt;&gt;&gt; 40865)
&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev
&gt;&gt;&gt;&gt;&gt; 40866)
&gt;&gt;&gt;&gt;&gt; @@ -40,8 +40,8 @@
&gt;&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set
&gt;&gt;&gt;&gt;&gt; Limit&#39;),
&gt;&gt;&gt;&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result
&gt;&gt;&gt;&gt;&gt; set to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating
&gt;&gt;&gt;&gt;&gt; result scores and sort order which can lead to out of memory errors on
&gt;&gt;&gt;&gt;&gt; large data sets. The default of 1000 is safe with the PHP memory_limit set
&gt;&gt;&gt;&gt;&gt; to 128M&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to
&gt;&gt;&gt;&gt;&gt; consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt;&gt;&gt;&gt;&gt; calculating result scores and sort order which can lead to out of memory
&gt;&gt;&gt;&gt;&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt;&gt;&gt;&gt;&gt; memory_limit set to 128M&#39;),
&gt;&gt;&gt;&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt;&gt;&gt;&gt;&gt; @@ -55,6 +55,33 @@
&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt;&gt;&gt;&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents
&gt;&gt;&gt;&gt;&gt; required before the buffered in-memory documents are written into a new
&gt;&gt;&gt;&gt;&gt; segment.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of
&gt;&gt;&gt;&gt;&gt; documents ever merged by addDocument(). Small values (e.g., less than
&gt;&gt;&gt;&gt;&gt; 10,000) are best for interactive indexing, as this limits the length of
&gt;&gt;&gt;&gt;&gt; pauses while indexing to a few seconds. Larger values are best for batched
&gt;&gt;&gt;&gt;&gt; indexing and speedier searches.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than
&gt;&gt;&gt;&gt;&gt; 10,000) are best for interactive indexing. Use 0 for the Lucene default,
&gt;&gt;&gt;&gt;&gt; which is practically infinite.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment
&gt;&gt;&gt;&gt;&gt; indices are merged by addDocument(). With smaller values, less RAM is used
&gt;&gt;&gt;&gt;&gt; while indexing, and searches on unoptimized indices are faster, but
&gt;&gt;&gt;&gt;&gt; indexing speed is slower. With larger values, more RAM is used during
&gt;&gt;&gt;&gt;&gt; indexing, and while searches on unoptimized indices are slower, indexing is
&gt;&gt;&gt;&gt;&gt; faster. Thus larger values (&gt; 10) are best for batch index creation, and
&gt;&gt;&gt;&gt;&gt; smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best
&gt;&gt;&gt;&gt;&gt; for batch index creation, and smaller values (&lt; 10) for indices that are
&gt;&gt;&gt;&gt;&gt; interactively maintained.&#39;),
&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;&gt;&gt;&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt;&gt;&gt;&gt;&gt; incrementally as the site content is modified. This may lead to lower
&gt;&gt;&gt;&gt;&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt;&gt;&gt; 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt;&gt;&gt;&gt;&gt; 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt;&gt; @@ -22,14 +22,20 @@
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;                                {preference name=feature_search
&gt;&gt;&gt;&gt;&gt; visible=&#34;always&#34;}
&gt;&gt;&gt;&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt;&gt;&gt;&gt;&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt;&gt;&gt;&gt;&gt; -                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt;&gt;                                        {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_engine&#34;}
&gt;&gt;&gt;&gt;&gt;                                        &lt;div class=&#34;adminoptionboxchild
&gt;&gt;&gt;&gt;&gt; unified_engine_childcontainer lucene&#34;&gt;
&gt;&gt;&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt;&gt; +                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt;&gt;                                                {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_location&#34;}
&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt;&gt; +                                               &lt;fieldset&gt;
&gt;&gt;&gt;&gt;&gt; +
&gt;&gt;&gt;&gt;&gt; &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt;&gt;&gt;&gt;&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt;&gt;&gt;&gt;&gt; +                                               &lt;/fieldset&gt;
&gt;&gt;&gt;&gt;&gt;                                        &lt;/div&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;                                        {preference
&gt;&gt;&gt;&gt;&gt; name=unified_forum_deepindexing}
&gt;&gt;&gt;&gt;&gt; @@ -48,7 +54,19 @@
&gt;&gt;&gt;&gt;&gt;                                        &lt;ul&gt;
&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;&lt;a
&gt;&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;
&gt;&gt;&gt;&gt;&gt; -                                                       &lt;a
&gt;&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       &lt;a
&gt;&gt;&gt;&gt;&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt;&gt;&gt;&gt;&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       &lt;label
&gt;&gt;&gt;&gt;&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       &lt;input
&gt;&gt;&gt;&gt;&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       &lt;span
&gt;&gt;&gt;&gt;&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt;&gt;&gt;&gt;&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt;&gt;&gt;&gt;&gt; +                                                       {jq}
&gt;&gt;&gt;&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt;&gt;&gt;&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt;&gt;&gt;&gt;&gt; +       } else {
&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt;&gt;&gt;&gt;&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt;&gt;&gt;&gt;&gt; +       }
&gt;&gt;&gt;&gt;&gt; +});
&gt;&gt;&gt;&gt;&gt; +                                                       {/jq}
&gt;&gt;&gt;&gt;&gt;                                                        {if
&gt;&gt;&gt;&gt;&gt; !empty($stat)}
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;  {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;  &lt;ul&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; This was sent by the SourceForge.net collaborative development
&gt;&gt;&gt;&gt;&gt; platform, the world&#39;s largest Open Source development site.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt; resolution app monitoring today. Free.
&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;
&gt;&gt;


-- 
Robert Plummer
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29138266">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29138266/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-16 22:44:36</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>source vs rendered:

but rendered for whom? current user?



On 2012-04-12 11:43 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt; wrote:
&gt;
&gt; Just checked, works great.  However it seems that some pages are executed and others are not, I&#39;m having trouble with the group plugin particularly.  Shouldn&#39;t the source be searched but the rendered page be displayed?
&gt;
&gt; On Wed, Apr 11, 2012 at 11:39 PM, Robert Plummer &lt;robertleeplummerjr@...&gt; wrote:
&gt;&gt;
&gt;&gt; I did a few searches, it worked. In fact I had integrated lucene in the past in c# and it only took a few seconds for small indexes, so I wondered why 3 pages and a tracker with 1 item would take so long.  Now it works like I thought it should.  I will double check in the morning.
&gt;&gt;
&gt;&gt; On Apr 11, 2012 4:50 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Makes you wonder if it worked!   :-)
&gt;&gt;&gt;
&gt;&gt;&gt; On 2012-04-11 10:08 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I&#39;m not sure why, but before rebuilding indexes on my site took about 1 to 3 min. Now it takes just a few seconds, I wonder why.....
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; awesome!
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding with these new preferences!
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Revision: 40866
&gt;&gt;&gt;&gt;&gt;&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt;&gt;&gt;&gt;&gt;&gt; Author:   robertplummer
&gt;&gt;&gt;&gt;&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt;&gt;&gt;&gt;&gt;&gt; Log Message:
&gt;&gt;&gt;&gt;&gt;&gt; -----------
&gt;&gt;&gt;&gt;&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more controllable, from jonnyb
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Modified Paths:
&gt;&gt;&gt;&gt;&gt;&gt; --------------
&gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt;&gt;&gt; @@ -40,10 +40,16 @@
&gt;&gt;&gt;&gt;&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt;&gt;&gt;&gt;&gt;&gt;                        $this-&gt;lucene = Zend_Search_Lucene::create($this-&gt;directory);
&gt;&gt;&gt;&gt;&gt;&gt;                }
&gt;&gt;&gt;&gt;&gt;&gt; -
&gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt;&gt;&gt;&gt;&gt;&gt; +               global $prefs;
&gt;&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {                                                       // these break indexing if set empty
&gt;&gt;&gt;&gt;&gt;&gt; +                       $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);  // default is 10
&gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt;&gt;&gt;&gt;&gt;&gt; +                       $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);                // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt;&gt;&gt;&gt;&gt;&gt; +                       $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);                   // default is 10
&gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt;&gt;&gt;&gt;&gt;&gt;                $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                return $this-&gt;lucene;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt;&gt;&gt; @@ -40,8 +40,8 @@
&gt;&gt;&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt;&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set Limit&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of result set to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when calculating result scores and sort order which can lead to out of memory errors on large data sets. The default of 1000 is safe with the PHP memory_limit set to 128M&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set to consider. Default 1000, 0 = unlimited.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when calculating result scores and sort order which can lead to out of memory errors on large data sets. The default of 1000 is safe with the PHP memory_limit set to 128M&#39;),
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt;&gt;&gt;&gt;&gt;&gt; @@ -55,6 +55,33 @@
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt;&gt;                ),
&gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered Documents&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents required before the buffered in-memory documents are written into a new segment.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of documents ever merged by addDocument(). Small values (e.g., less than 10,000) are best for interactive indexing, as this limits the length of pauses while indexing to a few seconds. Larger values are best for batched indexing and speedier searches.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less than 10,000) are best for interactive indexing. Use 0 for the Lucene default, which is practically infinite.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment indices are merged by addDocument(). With smaller values, less RAM is used while indexing, and searches on unoptimized indices are faster, but indexing speed is slower. With larger values, more RAM is used during indexing, and while searches on unoptimized indices are slower, indexing is faster. Thus larger values (&gt; 10) are best for batch index creation, and smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best for batch index creation, and smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt;&gt;&gt;&gt;&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt;&gt;&gt;&gt;&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index incrementally as the site content is modified. This may lead to lower performance and accuracy than processing the index on a periodic basis.&#39;),
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10 21:26:17 UTC (rev 40865)
&gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10 21:36:38 UTC (rev 40866)
&gt;&gt;&gt;&gt;&gt;&gt; @@ -22,14 +22,20 @@
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                                {preference name=feature_search visible=&#34;always&#34;}
&gt;&gt;&gt;&gt;&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34; id=&#34;feature_search_childcontainer&#34;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; -                                       {preference name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt;&gt;&gt;                                        {preference name=&#34;unified_engine&#34;}
&gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;div class=&#34;adminoptionboxchild unified_engine_childcontainer lucene&#34;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                               {preference name=&#34;unified_incremental_update&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                               {preference name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt;&gt;&gt;                                                {preference name=&#34;unified_lucene_location&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference name=&#34;unified_lucene_highlight&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                               &lt;fieldset&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_max_result&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_terms_limit&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_max_merge_docs&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference name=&#34;unified_lucene_merge_factor&#34;}
&gt;&gt;&gt;&gt;&gt;&gt; +                                               &lt;/fieldset&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;/div&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                                        {preference name=unified_forum_deepindexing}
&gt;&gt;&gt;&gt;&gt;&gt; @@ -48,7 +54,19 @@
&gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;ul&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;&lt;a href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt;&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;
&gt;&gt;&gt;&gt;&gt;&gt; -                                                       &lt;a href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;a href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;label for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;input type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;span class=&#34;description&#34;&gt;{tr}Log file is saved as temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {jq}
&gt;&gt;&gt;&gt;&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt;&gt;&gt;&gt;&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt;&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;, $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt;&gt;&gt;&gt;&gt;&gt; +       } else {
&gt;&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;, $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt;&gt;&gt;&gt;&gt;&gt; +       }
&gt;&gt;&gt;&gt;&gt;&gt; +});
&gt;&gt;&gt;&gt;&gt;&gt; +                                                       {/jq}
&gt;&gt;&gt;&gt;&gt;&gt;                                                        {if !empty($stat)}
&gt;&gt;&gt;&gt;&gt;&gt;                                                                {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt;&gt;&gt;&gt;&gt;&gt;                                                                        &lt;ul&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt;&gt;&gt; resolution app monitoring today. Free.
&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt;&gt; Tikiwiki-cvs@...
&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Robert Plummer
&gt;
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29138361">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29138361/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40866] branches/9.x</a></b></div>
      
      <small>From: Robert Plummer &lt;robertleeplummerjr@gm...&gt; - 2012-04-16 23:10:43</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAD9WoQpxpz0Cc47Amxh4zmANhHv_qauTcL3cz-uBDovAXoLdKg%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Exactly. Rendered for current user.
On Apr 16, 2012 6:44 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:

&gt; source vs rendered:
&gt;
&gt; but rendered for whom? current user?
&gt;
&gt;
&gt;
&gt; On 2012-04-12 11:43 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt;
&gt; wrote:
&gt; &gt;
&gt; &gt; Just checked, works great.  However it seems that some pages are
&gt; executed and others are not, I&#39;m having trouble with the group plugin
&gt; particularly.  Shouldn&#39;t the source be searched but the rendered page be
&gt; displayed?
&gt; &gt;
&gt; &gt; On Wed, Apr 11, 2012 at 11:39 PM, Robert Plummer &lt;
&gt; robertleeplummerjr@...&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; I did a few searches, it worked. In fact I had integrated lucene in the
&gt; past in c# and it only took a few seconds for small indexes, so I wondered
&gt; why 3 pages and a tracker with 1 item would take so long.  Now it works
&gt; like I thought it should.  I will double check in the morning.
&gt; &gt;&gt;
&gt; &gt;&gt; On Apr 11, 2012 4:50 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Makes you wonder if it worked!   :-)
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On 2012-04-11 10:08 AM, &#34;Robert Plummer&#34; &lt;robertleeplummerjr@...&gt;
&gt; wrote:
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; I&#39;m not sure why, but before rebuilding indexes on my site took about
&gt; 1 to 3 min. Now it takes just a few seconds, I wonder why.....
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; On Apr 10, 2012 9:42 PM, &#34;Marc Laporte&#34; &lt;marc@...&gt; wrote:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; awesome!
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I hope doc.tiki.org and dev.tiki.org can complete index rebuilding
&gt; with these new preferences!
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; On 2012-04-10 5:37 PM, &lt;robertplummer@...&gt; wrote:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Revision: 40866
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40866&amp;view=rev</a>
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Author:   robertplummer
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Date:     2012-04-10 21:36:38 +0000 (Tue, 10 Apr 2012)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Log Message:
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -----------
&gt; &gt;&gt;&gt;&gt;&gt;&gt; [NEW] Some much needed prefs for lucene search to help make it more
&gt; controllable, from jonnyb
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Modified Paths:
&gt; &gt;&gt;&gt;&gt;&gt;&gt; --------------
&gt; &gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/core/Search/Index/Lucene.php
&gt; &gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/lib/prefs/unified.php
&gt; &gt;&gt;&gt;&gt;&gt;&gt;    branches/9.x/templates/admin/include_search.tpl
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/core/Search/Index/Lucene.php
&gt; &gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt; &gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt; 21:26:17 UTC (rev 40865)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/core/Search/Index/Lucene.php       2012-04-10
&gt; 21:36:38 UTC (rev 40866)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; @@ -40,10 +40,16 @@
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                } catch (Zend_Search_Lucene_Exception $e) {
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        $this-&gt;lucene =
&gt; Zend_Search_Lucene::create($this-&gt;directory);
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                }
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxBufferedDocs(100);
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMaxMergeDocs(5000);
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -               $this-&gt;lucene-&gt;setMergeFactor(50);
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               global $prefs;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               if
&gt; (!empty($prefs[&#39;unified_lucene_max_buffered_docs&#39;])) {
&gt;                                   // these break indexing if set empty
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +
&gt; $this-&gt;lucene-&gt;setMaxBufferedDocs($prefs[&#39;unified_lucene_max_buffered_docs&#39;]);
&gt;  // default is 10
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               if
&gt; (!empty($prefs[&#39;unified_lucene_max_merge_docs&#39;])) {
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +
&gt; $this-&gt;lucene-&gt;setMaxMergeDocs($prefs[&#39;unified_lucene_max_merge_docs&#39;]);
&gt;              // default is PHP_INT_MAX (effectively &#34;infinite&#34;)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               if (!empty($prefs[&#39;unified_lucene_merge_factor&#39;])) {
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +
&gt; $this-&gt;lucene-&gt;setMergeFactor($prefs[&#39;unified_lucene_merge_factor&#39;]);
&gt;             // default is 10
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               }
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt;  $this-&gt;lucene-&gt;setResultSetLimit($this-&gt;resultSetLimit);
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                return $this-&gt;lucene;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/lib/prefs/unified.php
&gt; &gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt; &gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/lib/prefs/unified.php  2012-04-10 21:26:17 UTC
&gt; (rev 40865)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/lib/prefs/unified.php  2012-04-10 21:36:38 UTC
&gt; (rev 40866)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; @@ -40,8 +40,8 @@
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                ),
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                &#39;unified_lucene_max_resultset_limit&#39; =&gt; array(
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Lucene Maximum Result Set
&gt; Limit&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                       &#39;description&#39; =&gt; tra(&#39;Maximum size of
&gt; result set to consider. Default 1000, 0 = unlimited.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                       &#39;hint&#39; =&gt; tra(&#39;This is used when
&gt; calculating result scores and sort order which can lead to out of memory
&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt; memory_limit set to 128M&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Maximum size of result set
&gt; to consider. Default 1000, 0 = unlimited.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;This is used when
&gt; calculating result scores and sort order which can lead to out of memory
&gt; errors on large data sets. The default of 1000 is safe with the PHP
&gt; memory_limit set to 128M&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;type&#39; =&gt; &#39;text&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1000,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; @@ -55,6 +55,33 @@
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;default&#39; =&gt; 1024,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;size&#39; =&gt; 6,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                ),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_buffered_docs&#39; =&gt; array(
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Buffered
&gt; Documents&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Number of documents
&gt; required before the buffered in-memory documents are written into a new
&gt; segment.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_max_merge_docs&#39; =&gt; array(
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Max Merge Documents&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;Largest number of
&gt; documents ever merged by addDocument(). Small values (e.g., less than
&gt; 10,000) are best for interactive indexing, as this limits the length of
&gt; pauses while indexing to a few seconds. Larger values are best for batched
&gt; indexing and speedier searches.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Small values (e.g., less
&gt; than 10,000) are best for interactive indexing. Use 0 for the Lucene
&gt; default, which is practically infinite.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 0,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 8,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               &#39;unified_lucene_merge_factor&#39; =&gt; array(
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;name&#39; =&gt; tra(&#39;Lucene Merge Factor&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;description&#39; =&gt; tra(&#39;How often segment
&gt; indices are merged by addDocument(). With smaller values, less RAM is used
&gt; while indexing, and searches on unoptimized indices are faster, but
&gt; indexing speed is slower. With larger values, more RAM is used during
&gt; indexing, and while searches on unoptimized indices are slower, indexing is
&gt; faster. Thus larger values (&gt; 10) are best for batch index creation, and
&gt; smaller values (&lt; 10) for indices that are interactively maintained.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;hint&#39; =&gt; tra(&#39;Large values (&gt; 10) are best
&gt; for batch index creation, and smaller values (&lt; 10) for indices that are
&gt; interactively maintained.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;type&#39; =&gt; &#39;text&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;filter&#39; =&gt; &#39;int&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;default&#39; =&gt; 10,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                       &#39;size&#39; =&gt; 6,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               ),
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                &#39;unified_incremental_update&#39; =&gt; array(
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;name&#39; =&gt; tra(&#39;Incremental Index Update&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                        &#39;description&#39; =&gt; tra(&#39;Update the index
&gt; incrementally as the site content is modified. This may lead to lower
&gt; performance and accuracy than processing the index on a periodic basis.&#39;),
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Modified: branches/9.x/templates/admin/include_search.tpl
&gt; &gt;&gt;&gt;&gt;&gt;&gt; ===================================================================
&gt; &gt;&gt;&gt;&gt;&gt;&gt; --- branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt; 21:26:17 UTC (rev 40865)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +++ branches/9.x/templates/admin/include_search.tpl     2012-04-10
&gt; 21:36:38 UTC (rev 40866)
&gt; &gt;&gt;&gt;&gt;&gt;&gt; @@ -22,14 +22,20 @@
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                {preference name=feature_search
&gt; visible=&#34;always&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                &lt;div class=&#34;adminoptionboxchild&#34;
&gt; id=&#34;feature_search_childcontainer&#34;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                       {preference
&gt; name=&#34;unified_incremental_update&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                        {preference
&gt; name=&#34;unified_engine&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;div
&gt; class=&#34;adminoptionboxchild unified_engine_childcontainer lucene&#34;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                               {preference
&gt; name=&#34;unified_incremental_update&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                               {preference
&gt; name=&#34;unified_lucene_highlight&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                                {preference
&gt; name=&#34;unified_lucene_location&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt; name=&#34;unified_lucene_highlight&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt; name=&#34;unified_lucene_max_result&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                               {preference
&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                               &lt;fieldset&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +
&gt; &lt;legend&gt;{tr}Search Engine Settings{/tr}&lt;/legend&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_result&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_resultset_limit&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_terms_limit&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_buffered_docs&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_max_merge_docs&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {preference
&gt; name=&#34;unified_lucene_merge_factor&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                               &lt;/fieldset&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;/div&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                        {preference
&gt; name=unified_forum_deepindexing}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; @@ -48,7 +54,19 @@
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                        &lt;ul&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;&lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;optimize=now&#34;&gt;{tr}Optimize{/tr}&lt;/a&gt;&lt;/li&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                                &lt;li&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; -                                                       &lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;a
&gt; href=&#34;tiki-admin.php?page=search&amp;amp;rebuild=now&#34;
&gt; id=&#34;rebuild-link&#34;&gt;{tr}Rebuild Index{/tr}&lt;/a&gt;&lt;br /&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;label
&gt; for=&#34;log-rebuild&#34;&gt;{tr}Log rebuild?{/tr}&lt;/label&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;input
&gt; type=&#34;checkbox&#34; id=&#34;log-rebuild&#34; /&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       &lt;span
&gt; class=&#34;description&#34;&gt;{tr}Log file is saved as
&gt; temp/Search_Indexer.log{/tr}&lt;/span&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {jq}
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +$(&#34;#log-rebuild&#34;).click(function(){
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +       if ($(this).prop(&#34;checked&#34;)) {
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;) + &#34;&amp;loggit&#34;);
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +       } else {
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +               $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;,
&gt; $(&#34;#rebuild-link&#34;).attr(&#34;href&#34;).replace(&#34;&amp;loggit&#34;,&#34;&#34;));
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +       }
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +});
&gt; &gt;&gt;&gt;&gt;&gt;&gt; +                                                       {/jq}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;                                                        {if
&gt; !empty($stat)}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt;  {remarksbox type=&#39;feedback&#39; title=&#34;{tr}Indexation{/tr}&#34;}
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt;    &lt;ul&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; This was sent by the SourceForge.net collaborative development
&gt; platform, the world&#39;s largest Open Source development site.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt; &gt;&gt;&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt; &gt;&gt;&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt; &gt;&gt;&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; &gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt; &gt;&gt;&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt;&gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt; &gt;&gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt; &gt;&gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt; &gt;&gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; &gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt; &gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt; &gt;&gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt; &gt;&gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt;&gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt; &gt;&gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt; &gt;&gt;&gt;&gt; resolution app monitoring today. Free.
&gt; &gt;&gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; &gt;&gt;&gt;&gt; _______________________________________________
&gt; &gt;&gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt; &gt;&gt;&gt;&gt; Tikiwiki-cvs@...
&gt; &gt;&gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt;&gt;&gt; Better than sec? Nothing is better than sec when it comes to
&gt; &gt;&gt;&gt; monitoring Big Data applications. Try Boundary one-second
&gt; &gt;&gt;&gt; resolution app monitoring today. Free.
&gt; &gt;&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-dev2dev" rel="nofollow">http://p.sf.net/sfu/Boundary-dev2dev</a>
&gt; &gt;&gt;&gt; _______________________________________________
&gt; &gt;&gt;&gt; Tikiwiki-cvs mailing list
&gt; &gt;&gt;&gt; Tikiwiki-cvs@...
&gt; &gt;&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;&gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Robert Plummer
&gt; &gt;
&gt; &gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt; For Developers, A Lot Can Happen In A Second.
&gt; &gt; Boundary is the first to Know...and Tell You.
&gt; &gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; &gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; &gt; _______________________________________________
&gt; &gt; Tikiwiki-cvs mailing list
&gt; &gt; Tikiwiki-cvs@...
&gt; &gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; &gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29121901">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29121901/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40875] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-12 20:49:33</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40875
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40875&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40875&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-12 20:49:26 +0000 (Thu, 12 Apr 2012)
Log Message:
-----------
[FIX] Profile check on user with right permissions, migrated from the nast hack into trackers from request to a mildy nast hack of using the $.trackerForm, which isn&#39;t so bad, but will be on large sets of items.  It works well though.
[REM] Deleted replaceItemFromRequestValues and replaceItemFromRequestValue from tracker lib, they were just hacks and did not work
[FIX] Commented out the reference to the above in tiki-edit_invoice, will find a better way once tracker query lib matures, it wasen&#39;t really working anyway

Modified Paths:
--------------
    branches/9.x/templates/tiki-timesheet.tpl
    branches/9.x/tiki-edit_invoice.php
    branches/9.x/tiki-timesheet.php

Modified: branches/9.x/templates/tiki-timesheet.tpl
===================================================================
--- branches/9.x/templates/tiki-timesheet.tpl	2012-04-12 20:38:05 UTC (rev 40874)
+++ branches/9.x/templates/tiki-timesheet.tpl	2012-04-12 20:49:26 UTC (rev 40875)
@@ -1,4 +1,4 @@
-{if $timeSheetProfileLoaded neq true}
+{if $timeSheetProfileLoaded neq true AND $tiki_p_admin eq &#39;y&#39;}
 {tr}Apply the following profile for enhancements: {/tr}
 {button href=&#34;tiki-admin.php&#34; profile=&#34;time_sheet&#34; page=&#34;profiles&#34; list=&#34;List&#34; _text=&#34;Time_Sheet&#34;}
 {/if}

Modified: branches/9.x/tiki-edit_invoice.php
===================================================================
--- branches/9.x/tiki-edit_invoice.php	2012-04-12 20:38:05 UTC (rev 40874)
+++ branches/9.x/tiki-edit_invoice.php	2012-04-12 20:49:26 UTC (rev 40875)
@@ -23,6 +23,7 @@
 //handle saving data (edit or update)
 if ($_SERVER[&#39;REQUEST_METHOD&#39;] == &#39;POST&#39;) {	
 	//start invoice
+	/*
 	$_REQUEST[&#39;InvoiceId&#39;] = $trklib-&gt;replaceItemFromRequestValues(
 					$trklib-&gt;get_tracker_by_name(&#34;Invoices&#34;),
 					array(
@@ -38,7 +39,8 @@
 						&#34;Days Payment Due&#34;,
 					),
 					$_REQUEST, $_REQUEST[&#39;InvoiceId&#39;]
-	);
+	);*/
+	die;
 	//end invoice
 	
 	//start invoice items
@@ -190,6 +192,8 @@
 		
 		var InvoiceId = $(&#39;#InvoiceId&#39;);
 		InvoiceId.val(InvoiceId.val() ? InvoiceId.val() : 0);
+
+		return false;
 	});&#34;
 );
 

Modified: branches/9.x/tiki-timesheet.php
===================================================================
--- branches/9.x/tiki-timesheet.php	2012-04-12 20:38:05 UTC (rev 40874)
+++ branches/9.x/tiki-timesheet.php	2012-04-12 20:49:26 UTC (rev 40875)
@@ -9,7 +9,7 @@
 $access-&gt;check_feature(array(&#39;feature_time_sheet&#39;,&#39;feature_trackers&#39;));
 $access-&gt;check_permission_either(array(&#39;tiki_p_view_trackers&#39;, &#39;tiki_p_create_tracker_items&#39;));
 
-global $user;
+global $user, $prefs, $tiki_p_admin;
 $auto_query_args = array(
 	&#39;all&#39;,
 	&#39;profile&#39;,
@@ -17,6 +17,10 @@
 	&#39;list&#39;
 );
 
+$trackerId = (int)TikiLib::lib(&#39;trk&#39;)-&gt;get_tracker_by_name(&#39;Time sheet&#39;);
+$smarty-&gt;assign(&#34;tiki_p_admin&#34;, $tiki_p_admin);
+$smarty-&gt;assign(&#34;timeSheetProfileLoaded&#34;, $trackerId &gt; 0 ? true : false);
+
 $projectList = Tracker_Query::tracker(&#34;Project list&#34;)-&gt;byName()-&gt;query();
 
 if (isset($_REQUEST[&#39;all&#39;])) { //all views all sheet items
@@ -36,35 +40,25 @@
 
 if (isset($projectList)) {
 	if (isset($_REQUEST[&#39;save&#39;])) {
-		$_REQUEST[&#39;Done_by&#39;] = $user;
-		TikiLib::lib(&#34;trk&#34;)-&gt;replaceItemFromRequestValuesByName(
-						&#34;Time sheet&#34;,
-						array(
-							&#34;Summary&#34;,
-   			         &#34;Associated project&#34;,
-   			         &#34;Description&#34;,
-   			         &#34;Amount of time spent&#34;,
-   			         &#34;Done by&#34;
-						),
-						$_REQUEST
-		); 
+		echo json_encode(
+			$timeSheetNewInputs = Tracker_Query::tracker(&#34;Time sheet&#34;)
+				-&gt;byName()
+				-&gt;queryInput()
+		);
 		die;
 	}
 
-	$timeSheetProfileLoaded = true;
-	$smarty-&gt;assign(&#34;timeSheetProfileLoaded&#34;, $timeSheetProfileLoaded);
 	$smarty-&gt;assign(&#34;projectList&#34;, $projectList);
 	$smarty-&gt;assign(&#34;timeSheet&#34;, $timeSheet);
 }
 
 TikiLib::lib(&#34;sheet&#34;)-&gt;setup_jquery_sheet();
 
-$headerlib = TikiLib::lib(&#34;header&#34;);
-$headerlib-&gt;add_cssfile(&#34;lib/jquery/jtrack/css/jtrack.css&#34;);
-$headerlib-&gt;add_jsfile(&#34;lib/jquery/jtrack/js/domcached-0.1-jquery.js&#34;);
-$headerlib-&gt;add_jsfile(&#34;lib/jquery/jtrack/js/jtrack.js&#34;);
-$headerlib-&gt;add_jq_onready(
-				&#34;
+$headerlib = TikiLib::lib(&#34;header&#34;)
+	-&gt;add_cssfile(&#34;lib/jquery/jtrack/css/jtrack.css&#34;)
+	-&gt;add_jsfile(&#34;lib/jquery/jtrack/js/domcached-0.1-jquery.js&#34;)
+	-&gt;add_jsfile(&#34;lib/jquery/jtrack/js/jtrack.js&#34;)
+	-&gt;add_jq_onready(&#34;
 	jTask.init();
 	
 	$.timesheetSpreadsheet = function() {
@@ -123,29 +117,49 @@
 	$(&#39;#timeSheetCommit&#39;).click(function() {
 		$(&#39;#timeSheetTabs&#39;).modal(tr(&#39;Committing...&#39;));
 		var stack = [];
-		for (var namespace in $.DOMCached.getStorage()) {
-			stack.push(namespace);
-			$.post(&#39;tiki-timesheet.php?save&#39;, {
-				&#39;Summary&#39;: namespace,
-				&#39;Description&#39;: &#39;&#39;,
-				&#39;Amount of time spent&#39;: $.DOMCached.get(&#39;timer&#39;, namespace) / 60
-			}, function(o) {
-				$.DOMCached.deleteNamespace(namespace);
-				stack.pop();
-				
-				if (stack.length == 0) {
-					$(&#39;#timeSheetTabs&#39;).modal();
-					document.location = document.location + &#39;&#39;;
-				}
-			});
-		}
+		$.getJSON(&#39;tiki-timesheet.php?save&#39;, function(inputs) {
+			for (var namespace in $.DOMCached.getStorage()) {
+				var summary = namespace + &#39;&#39;,
+				time =  $.DOMCached.get(&#39;timer&#39;, summary) / 60;
+				stack.push(summary);
+
+				var form = $.trackerForm($trackerId).submit(function() {
+					$.post(form.attr(&#39;action&#39;) + &#39;?&#39; + form.serialize(), function() {
+						$.DOMCached.deleteNamespace(namespace);
+
+						stack.pop();
+
+						if (stack.length == 0) {
+							document.location = document.location + &#39;&#39;;
+						}
+					});
+					return false;
+				});
+
+				var input = {
+					&#39;Summary&#39;: $(inputs[&#39;Summary&#39;]),
+					&#39;Description&#39;: $(inputs[&#39;Description&#39;]),
+					&#39;Amount of time spent&#39;: $(inputs[&#39;Amount of time spent&#39;])
+				};
+
+				input[&#39;Summary&#39;].val(summary);
+				input[&#39;Amount of time spent&#39;].val(time);
+				console.log(input);
+				form.append(input[&#39;Summary&#39;]);
+				form.append(input[&#39;Description&#39;]);
+				form.append(input[&#39;Amount of time spent&#39;]);
+				form.submit();
+			}
+		});
+
+		return false;
 	});
 	
 	$(&#39;#timeSheetTabs&#39;)
 		.width($(&#39;#timeSheetTabs&#39;).parent().width())
 		.tabs();
-&#34;
-);
+&#34;);
+
 $smarty-&gt;assign(&#39;mid&#39;, &#39;tiki-timesheet.tpl&#39;);
 // use tiki_full to include include CSS and JavaScript
 $smarty-&gt;display(&#34;tiki.tpl&#34;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29130365">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29130365/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40908] branches/9.x</a></b></div>
      
      <small>From: &lt;marclaporte@us...&gt; - 2012-04-14 23:29:28</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40908
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40908&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40908&amp;view=rev</a>
Author:   marclaporte
Date:     2012-04-14 23:29:21 +0000 (Sat, 14 Apr 2012)
Log Message:
-----------
improve admin panels for PluginNow and PluginCountDown

Modified Paths:
--------------
    branches/9.x/lib/prefs/wikiplugin.php
    branches/9.x/templates/admin/include_general.tpl
    branches/9.x/templates/admin/include_textarea.tpl

Modified: branches/9.x/lib/prefs/wikiplugin.php
===================================================================
--- branches/9.x/lib/prefs/wikiplugin.php	2012-04-14 23:21:19 UTC (rev 40907)
+++ branches/9.x/lib/prefs/wikiplugin.php	2012-04-14 23:29:21 UTC (rev 40908)
@@ -54,6 +54,7 @@
 		&#39;miniquiz&#39; =&gt; &#39;y&#39;,
 		&#39;module&#39; =&gt; &#39;y&#39;,
 		&#39;mouseover&#39; =&gt; &#39;y&#39;,
+		&#39;now&#39; =&gt; &#39;y&#39;,
 		&#39;payment&#39; =&gt; &#39;y&#39;,
 		&#39;poll&#39; =&gt; &#39;y&#39;,
 		&#39;quote&#39; =&gt; &#39;y&#39;,

Modified: branches/9.x/templates/admin/include_general.tpl
===================================================================
--- branches/9.x/templates/admin/include_general.tpl	2012-04-14 23:21:19 UTC (rev 40907)
+++ branches/9.x/templates/admin/include_general.tpl	2012-04-14 23:29:21 UTC (rev 40908)
@@ -284,6 +284,8 @@
 			{preference name=display_field_order}
 			{preference name=users_prefs_display_12hr_clock}
 			{preference name=tiki_same_day_time_only}
+			{preference name=wikiplugin_now}
+			{preference name=wikiplugin_countdown}
 
 			&lt;div class=&#34;adminoptionbox&#34;&gt;
 				{assign var=&#34;fcnlink&#34; value=&#34;<a href="http://www.php.net/manual/en/function.strftime.php&#34" rel="nofollow">http://www.php.net/manual/en/function.strftime.php&#34</a>;}

Modified: branches/9.x/templates/admin/include_textarea.tpl
===================================================================
--- branches/9.x/templates/admin/include_textarea.tpl	2012-04-14 23:21:19 UTC (rev 40907)
+++ branches/9.x/templates/admin/include_textarea.tpl	2012-04-14 23:29:21 UTC (rev 40908)
@@ -45,6 +45,7 @@
 				{preference name=wikiplugin_button}
 				{preference name=wikiplugin_center}
 				{preference name=wikiplugin_code}
+                                {preference name=wikiplugin_countdown}
 				{preference name=wikiplugin_div}
 				{preference name=wikiplugin_dl}
 				{preference name=wikiplugin_fade}
@@ -60,6 +61,7 @@
 				{preference name=wikiplugin_mono}
 				{preference name=wikiplugin_mouseover}
 				{preference name=wikiplugin_mwtable}
+				{preference name=wikiplugin_now}
 				{preference name=wikiplugin_quote}
 				{preference name=wikiplugin_remarksbox}
 				{preference name=wikiplugin_scroll}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29132540">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29132540/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40925] branches/9.x</a></b></div>
      
      <small>From: &lt;lindonb@us...&gt; - 2012-04-15 17:42:36</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40925
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40925&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40925&amp;view=rev</a>
Author:   lindonb
Date:     2012-04-15 17:42:29 +0000 (Sun, 15 Apr 2012)
Log Message:
-----------
[FIX] Renumber array keys from 0 for article topic arrays used in Smarty section loops. It appears there may be a bug in Smarty 3 in looping through arrays that aren&#39;t zero-based. I don&#39;t see a bug report but it is noted here: <a href="https://bugs.launchpad.net/phpdevshell/+bug/781565" rel="nofollow">https://bugs.launchpad.net/phpdevshell/+bug/781565</a>

Modified Paths:
--------------
    branches/9.x/modules/mod-func-article_topics.php
    branches/9.x/tiki-admin_topics.php
    branches/9.x/tiki-edit_article.php

Modified: branches/9.x/modules/mod-func-article_topics.php
===================================================================
--- branches/9.x/modules/mod-func-article_topics.php	2012-04-15 15:31:56 UTC (rev 40924)
+++ branches/9.x/modules/mod-func-article_topics.php	2012-04-15 17:42:29 UTC (rev 40925)
@@ -28,5 +28,9 @@
 	global $artlib; include_once(&#39;lib/articles/artlib.php&#39;);
 	
 	$listTopics = $artlib-&gt;list_topics();
+	/* To renumber array keys from 0 since smarty 3 doesn&#39;t seem to like arrays
+	 * that start with other keys in a section loop, which this variable is used in
+	 */
+	$listTopics = array_values($listTopics);
 	$smarty-&gt;assign(&#39;listTopics&#39;, $listTopics);
 }

Modified: branches/9.x/tiki-admin_topics.php
===================================================================
--- branches/9.x/tiki-admin_topics.php	2012-04-15 15:31:56 UTC (rev 40924)
+++ branches/9.x/tiki-admin_topics.php	2012-04-15 17:42:29 UTC (rev 40925)
@@ -47,6 +47,10 @@
 	$artlib-&gt;deactivate_topic($_REQUEST[&#34;deactivate&#34;]);
 }
 $topics = $artlib-&gt;list_topics();
+/* To renumber array keys from 0 since smarty 3 doesn&#39;t seem to like arrays
+ * that start with other keys in a section loop, which this variable is used in
+ */
+$topics = array_values($topics);
 $temp_max = count($topics);
 for ($i = 0; $i &lt; $temp_max; $i++) {
 	if ($userlib-&gt;object_has_one_permission($topics[$i][&#34;topicId&#34;], &#39;topic&#39;)) {

Modified: branches/9.x/tiki-edit_article.php
===================================================================
--- branches/9.x/tiki-edit_article.php	2012-04-15 15:31:56 UTC (rev 40924)
+++ branches/9.x/tiki-edit_article.php	2012-04-15 17:42:29 UTC (rev 40925)
@@ -224,6 +224,10 @@
 }
 
 $topics = $artlib-&gt;list_topics();
+/* To renumber array keys from 0 since smarty 3 doesn&#39;t seem to like arrays
+ * that start with other keys in a section loop, which this variable is used in
+ */
+$topics = array_values($topics);
 $smarty-&gt;assign_by_ref(&#39;topics&#39;, $topics);
 
 if (isset($_REQUEST[&#39;preview&#39;]))

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29138531">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29138531/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40950] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-17 00:22:45</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40950
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40950&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40950&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-17 00:22:38 +0000 (Tue, 17 Apr 2012)
Log Message:
-----------
[FIX] Ensure that handler columns and rows are imported, but found them not to even be saving on layouts, commented out till v10

Modified Paths:
--------------
    branches/9.x/lib/sheet/grid.php
    branches/9.x/templates/tiki-sheets.tpl

Modified: branches/9.x/lib/sheet/grid.php
===================================================================
--- branches/9.x/lib/sheet/grid.php	2012-04-17 00:10:04 UTC (rev 40949)
+++ branches/9.x/lib/sheet/grid.php	2012-04-17 00:22:38 UTC (rev 40950)
@@ -551,6 +551,8 @@
 		$this-&gt;id = $handler-&gt;id;
 		$this-&gt;type = $handler-&gt;type;
 		$this-&gt;cssName = $handler-&gt;cssName;
+		$this-&gt;rowCount = (isset($handler-&gt;rowCount) ? $handler-&gt;rowCount : $this-&gt;rowCount);
+		$this-&gt;columnCount = (isset($handler-&gt;columnCount) ? $handler-&gt;columnCount : $this-&gt;columnCount);
 
 		$this-&gt;dataGrid = array();
 		$this-&gt;calcGrid = array();
@@ -1320,7 +1322,9 @@
 {
 	var $id;
 	var $readDate;
-	
+	var $rowCount;
+	var $columnCount;
+
 	/** Constructor {{{2
 	 * Assigns a sheet ID to the handler.
 	 * @param $id The ID of the sheet in the database.

Modified: branches/9.x/templates/tiki-sheets.tpl
===================================================================
--- branches/9.x/templates/tiki-sheets.tpl	2012-04-17 00:10:04 UTC (rev 40949)
+++ branches/9.x/templates/tiki-sheets.tpl	2012-04-17 00:22:38 UTC (rev 40950)
@@ -55,9 +55,9 @@
 			&lt;table class=&#34;formcolor&#34;&gt;
 				&lt;tr&gt;&lt;td&gt;{tr}Title:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;title&#34; value=&#34;{$title|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;
 				&lt;tr&gt;&lt;td&gt;{tr}Description:{/tr}&lt;/td&gt;&lt;td&gt;&lt;textarea rows=&#34;5&#34; cols=&#34;40&#34; name=&#34;description&#34;&gt;{$description|escape}&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;
-				&lt;tr&gt;&lt;td&gt;{tr}Class Name:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;className&#34; value=&#34;{$className|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;
+				&lt;!--&lt;tr&gt;&lt;td&gt;{tr}Class Name:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;className&#34; value=&#34;{$className|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;
 				&lt;tr&gt;&lt;td&gt;{tr}Header Rows:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;headerRow&#34; value=&#34;{$headerRow|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;
-				&lt;tr&gt;&lt;td&gt;{tr}Footer Rows:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;footerRow&#34; value=&#34;{$footerRow|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;
+				&lt;tr&gt;&lt;td&gt;{tr}Footer Rows:{/tr}&lt;/td&gt;&lt;td&gt;&lt;input type=&#34;text&#34; name=&#34;footerRow&#34; value=&#34;{$footerRow|escape}&#34;/&gt;&lt;/td&gt;&lt;/tr&gt;--&gt;
 				&lt;tr&gt;
 					&lt;td&gt;{tr}Wiki Parse Values:{/tr}&lt;/td&gt;&lt;td&gt;
 						&lt;input type=&#34;checkbox&#34; name=&#34;parseValues&#34;{if $parseValues eq &#39;y&#39;} checked=&#34;checked&#34;{/if}/&gt;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29148319">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29148319/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40985] branches/9.x</a></b></div>
      
      <small>From: &lt;arildb@us...&gt; - 2012-04-18 20:48:44</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40985
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40985&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40985&amp;view=rev</a>
Author:   arildb
Date:     2012-04-18 20:48:37 +0000 (Wed, 18 Apr 2012)
Log Message:
-----------
[MOD][bp/40907+40930] Copying of direct object permissions when adding structure pages are now done for users
with tiki_p_edit_structures and tiki_p_edit permissions (in addition to users with tiki_p_admin_wiki permissions).
A new wiki structure option &#34;feature_wiki_no_inherit_perms_structure&#34; is added, which will disable the copying.

Modified Paths:
--------------
    branches/9.x/lib/prefs/feature.php
    branches/9.x/lib/tikilib.php
    branches/9.x/templates/admin/include_wiki.tpl
    branches/9.x/tiki-editpage.php

Modified: branches/9.x/lib/prefs/feature.php
===================================================================
--- branches/9.x/lib/prefs/feature.php	2012-04-18 17:02:14 UTC (rev 40984)
+++ branches/9.x/lib/prefs/feature.php	2012-04-18 20:48:37 UTC (rev 40985)
@@ -2022,6 +2022,11 @@
 			&#39;type&#39; =&gt; &#39;flag&#39;,
 			&#39;default&#39; =&gt; &#39;n&#39;,
 		),
+		&#39;feature_wiki_no_inherit_perms_structure&#39; =&gt; array(
+			&#39;name&#39; =&gt; tra(&#39;Disable inheritance of direct object permissions when adding pages from a structure&#39;),
+			&#39;type&#39; =&gt; &#39;flag&#39;,
+			&#39;default&#39; =&gt; &#39;n&#39;,
+		),
 		&#39;feature_create_webhelp&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Create webhelp from structure&#39;),
 			&#39;type&#39; =&gt; &#39;flag&#39;,

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-18 17:02:14 UTC (rev 40984)
+++ branches/9.x/lib/tikilib.php	2012-04-18 20:48:37 UTC (rev 40985)
@@ -2972,17 +2972,26 @@
 	// - category permission
 	// if O.K. this function shall replace similar constructs in list_pages and other functions above.
 	// $categperm is the category permission that should grant $perm. if none, pass 0
-	function user_has_perm_on_object($usertocheck,$object,$objtype,$perm)
+	// If additional perm arguments are specified, the user must have all the perms to pass the test
+	function user_has_perm_on_object($usertocheck,$object,$objtype,$perm1,$perm2=null,$perm3=null)
 	{
 		global $user;
 		// Do not override perms for current users otherwise security tokens won&#39;t work
-		if ($usertocheck != $user) $groups = $this-&gt;get_user_groups($usertocheck);
+		if ($usertocheck != $user) {
+			$groups = $this-&gt;get_user_groups($usertocheck);
+		}
 		$context = array( &#39;type&#39; =&gt; $objtype, &#39;object&#39; =&gt; $object );
 
 		$accessor = Perms::get($context);
-		if ($usertocheck != $user) $accessor-&gt;setGroups($groups);
+		if ($usertocheck != $user) {
+			$accessor-&gt;setGroups($groups);
+		}
 
-		return $accessor-&gt;$perm;
+		$chk1 = $perm1 != null ? $accessor-&gt;$perm1 : true;
+		$chk2 = $perm2 != null ? $accessor-&gt;$perm2 : true;
+		$chk3 = $perm3 != null ? $accessor-&gt;$perm3 : true;
+		
+		return $chk1 &amp;&amp; $chk2 &amp; $chk3;
 	}
 
 	/* get all the perm of an object either in a table or global+smarty set

Modified: branches/9.x/templates/admin/include_wiki.tpl
===================================================================
--- branches/9.x/templates/admin/include_wiki.tpl	2012-04-18 17:02:14 UTC (rev 40984)
+++ branches/9.x/templates/admin/include_wiki.tpl	2012-04-18 20:48:37 UTC (rev 40985)
@@ -262,6 +262,7 @@
 			{preference name=feature_wiki_categorize_structure}
 			{preference name=feature_create_webhelp}
 			{preference name=page_n_times_in_a_structure}
+			{preference name=feature_wiki_no_inherit_perms_structure}
 			{preference name=wiki_structure_bar_position}
 			{preference name=wikiplugin_toc}
 		&lt;/div&gt;

Modified: branches/9.x/tiki-editpage.php
===================================================================
--- branches/9.x/tiki-editpage.php	2012-04-18 17:02:14 UTC (rev 40984)
+++ branches/9.x/tiki-editpage.php	2012-04-18 20:48:37 UTC (rev 40985)
@@ -1086,10 +1086,13 @@
 			//Insert page after current page
 			$page_ref_id = $structlib-&gt;s_create_page($page_info[&#34;parent_id&#34;], $_REQUEST[&#39;current_page_id&#39;], $_REQUEST[&#34;page&#34;], &#39;&#39;, $page_info[&#39;structure_id&#39;]);
 		}
-		//Criss Holman added the if containing this code of which I don&#39;t know the use, but a check before the permissions copy
-		//is definitely needed in case someone has tiki_p_edit/tiki_p_admin_wiki in a page belonging to a structure. chealer
-		if ($tikilib-&gt;user_has_perm_on_object($user, $_REQUEST[&#34;page&#34;], &#39;wiki page&#39;, &#39;tiki_p_admin_wiki&#39;, &#39;tiki_p_admin_categories&#39;))
-			$userlib-&gt;copy_object_permissions($page_info[&#34;pageName&#34;], $_REQUEST[&#34;page&#34;], &#39;wiki page&#39;);
+		// Inherit direct object permissions for pages added to a structure, if the user can edit the structure and the page
+		if(!isset($prefs[&#39;feature_wiki_no_inherit_perms_structure&#39;]) || $prefs[&#39;feature_wiki_no_inherit_perms_structure&#39;] === &#39;n&#39;) {
+			if ($tikilib-&gt;user_has_perm_on_object($user, $_REQUEST[&#34;page&#34;],&#39;wiki page&#39;, &#39;tiki_p_edit_structures&#39;, &#39;tiki_p_edit&#39;) ||
+				($tikilib-&gt;user_has_perm_on_object($user, $_REQUEST[&#34;page&#34;],&#39;wiki page&#39;, &#39;tiki_p_admin_wiki&#39;)) {
+				 $userlib-&gt;copy_object_permissions($page_info[&#34;pageName&#34;], $_REQUEST[&#34;page&#34;],&#39;wiki page&#39;);
+			}
+		}
 	} 
 
 	// If the watch state is not the same

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29153423">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29153423/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40996] branches/9.x</a></b></div>
      
      <small>From: &lt;changi67@us...&gt; - 2012-04-19 18:45:52</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40996
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev</a>
Author:   changi67
Date:     2012-04-19 18:45:46 +0000 (Thu, 19 Apr 2012)
Log Message:
-----------
[FIX] Typo

Modified Paths:
--------------
    branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
    branches/9.x/lib/core/Tracker/Field/AutoIncrement.php

Modified: branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
===================================================================
--- branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php	2012-04-19 18:04:23 UTC (rev 40995)
+++ branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php	2012-04-19 18:45:46 UTC (rev 40996)
@@ -16,7 +16,7 @@
 	$map = array (
 			&#39;x&#39; =&gt; &#39;trackerfield_action&#39;,
 			&#39;A&#39; =&gt; &#39;trackerfield_file&#39;,
-			&#39;q&#39; =&gt; &#39;trackerfield_autoincement&#39;,
+			&#39;q&#39; =&gt; &#39;trackerfield_autoincrement&#39;,
 			&#39;e&#39; =&gt; &#39;trackerfield_category&#39;,
 			&#39;c&#39; =&gt; &#39;trackerfield_checkbox&#39;,
 			&#39;C&#39; =&gt; &#39;trackerfield_computed&#39;,

Modified: branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
===================================================================
--- branches/9.x/lib/core/Tracker/Field/AutoIncrement.php	2012-04-19 18:04:23 UTC (rev 40995)
+++ branches/9.x/lib/core/Tracker/Field/AutoIncrement.php	2012-04-19 18:45:46 UTC (rev 40996)
@@ -21,7 +21,7 @@
 				&#39;description&#39; =&gt; tr(&#39;Allows an incrementing value field, or itemId field.&#39;),
 				&#39;readonly&#39; =&gt; true,
 				&#39;help&#39; =&gt; &#39;Auto-Increment Field&#39;,				
-				&#39;prefs&#39; =&gt; array(&#39;trackerfield_autoincement&#39;),
+				&#39;prefs&#39; =&gt; array(&#39;trackerfield_autoincrement&#39;),
 				&#39;tags&#39; =&gt; array(&#39;advanced&#39;),
 				&#39;default&#39; =&gt; &#39;n&#39;,
 				&#39;params&#39; =&gt; array(

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29153847">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29153847/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40996] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-19 20:18:52</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>What about people that already ran
installer/schema/20110830_default_enable_in_use_tiki.php (which people
already ran if they upgraded from 7.x to 8.x

Thanks!


On Thu, Apr 19, 2012 at 2:45 PM,  &lt;changi67@...&gt; wrote:
&gt; Revision: 40996
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev</a>
&gt; Author:   changi67
&gt; Date:     2012-04-19 18:45:46 +0000 (Thu, 19 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] Typo
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;    branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt;
&gt; Modified: branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; ===================================================================
&gt; --- branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php       2012-04-19 18:04:23 UTC (rev 40995)
&gt; +++ branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php       2012-04-19 18:45:46 UTC (rev 40996)
&gt; @@ -16,7 +16,7 @@
&gt;        $map = array (
&gt;                        &#39;x&#39; =&gt; &#39;trackerfield_action&#39;,
&gt;                        &#39;A&#39; =&gt; &#39;trackerfield_file&#39;,
&gt; -                       &#39;q&#39; =&gt; &#39;trackerfield_autoincement&#39;,
&gt; +                       &#39;q&#39; =&gt; &#39;trackerfield_autoincrement&#39;,
&gt;                        &#39;e&#39; =&gt; &#39;trackerfield_category&#39;,
&gt;                        &#39;c&#39; =&gt; &#39;trackerfield_checkbox&#39;,
&gt;                        &#39;C&#39; =&gt; &#39;trackerfield_computed&#39;,
&gt;
&gt; Modified: branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/core/Tracker/Field/AutoIncrement.php       2012-04-19 18:04:23 UTC (rev 40995)
&gt; +++ branches/9.x/lib/core/Tracker/Field/AutoIncrement.php       2012-04-19 18:45:46 UTC (rev 40996)
&gt; @@ -21,7 +21,7 @@
&gt;                                &#39;description&#39; =&gt; tr(&#39;Allows an incrementing value field, or itemId field.&#39;),
&gt;                                &#39;readonly&#39; =&gt; true,
&gt;                                &#39;help&#39; =&gt; &#39;Auto-Increment Field&#39;,
&gt; -                               &#39;prefs&#39; =&gt; array(&#39;trackerfield_autoincement&#39;),
&gt; +                               &#39;prefs&#39; =&gt; array(&#39;trackerfield_autoincrement&#39;),
&gt;                                &#39;tags&#39; =&gt; array(&#39;advanced&#39;),
&gt;                                &#39;default&#39; =&gt; &#39;n&#39;,
&gt;                                &#39;params&#39; =&gt; array(
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>



-- 
Marc Laporte

<a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
<a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
<a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29156741">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29156741/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40996] branches/9.x</a></b></div>
      
      <small>From: Jean-Marc Libs &lt;jeanmarc.libs@gm...&gt; - 2012-04-20 11:50:02</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CA%2B%2BRN4fzLCH5LHARUZRWPFkM9T7zm78YrPYfBLffStLSqUuucQ%40mail.gmail.com/1/">spiral-03.png</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Marc is correct: There is a need for an SQL update script...

Cheers,
J-M

On 4/19/12, Marc Laporte &lt;marc@...&gt; wrote:
&gt; What about people that already ran
&gt; installer/schema/20110830_default_enable_in_use_tiki.php (which people
&gt; already ran if they upgraded from 7.x to 8.x
&gt;
&gt; Thanks!
&gt;
&gt;
&gt; On Thu, Apr 19, 2012 at 2:45 PM,  &lt;changi67@...&gt; wrote:
&gt;&gt; Revision: 40996
&gt;&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev</a>
&gt;&gt; Author:   changi67
&gt;&gt; Date:     2012-04-19 18:45:46 +0000 (Thu, 19 Apr 2012)
&gt;&gt; Log Message:
&gt;&gt; -----------
&gt;&gt; [FIX] Typo
&gt;&gt;
&gt;&gt; Modified Paths:
&gt;&gt; --------------
&gt;&gt;    branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;&gt;    branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt;&gt;
&gt;&gt; Modified:
&gt;&gt; branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;&gt;       2012-04-19 18:04:23 UTC (rev 40995)
&gt;&gt; +++ branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;&gt;       2012-04-19 18:45:46 UTC (rev 40996)
&gt;&gt; @@ -16,7 +16,7 @@
&gt;&gt;        $map = array (
&gt;&gt;                        &#39;x&#39; =&gt; &#39;trackerfield_action&#39;,
&gt;&gt;                        &#39;A&#39; =&gt; &#39;trackerfield_file&#39;,
&gt;&gt; -                       &#39;q&#39; =&gt; &#39;trackerfield_autoincement&#39;,
&gt;&gt; +                       &#39;q&#39; =&gt; &#39;trackerfield_autoincrement&#39;,
&gt;&gt;                        &#39;e&#39; =&gt; &#39;trackerfield_category&#39;,
&gt;&gt;                        &#39;c&#39; =&gt; &#39;trackerfield_checkbox&#39;,
&gt;&gt;                        &#39;C&#39; =&gt; &#39;trackerfield_computed&#39;,
&gt;&gt;
&gt;&gt; Modified: branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/lib/core/Tracker/Field/AutoIncrement.php       2012-04-19
&gt;&gt; 18:04:23 UTC (rev 40995)
&gt;&gt; +++ branches/9.x/lib/core/Tracker/Field/AutoIncrement.php       2012-04-19
&gt;&gt; 18:45:46 UTC (rev 40996)
&gt;&gt; @@ -21,7 +21,7 @@
&gt;&gt;                                &#39;description&#39; =&gt; tr(&#39;Allows an incrementing
&gt;&gt; value field, or itemId field.&#39;),
&gt;&gt;                                &#39;readonly&#39; =&gt; true,
&gt;&gt;                                &#39;help&#39; =&gt; &#39;Auto-Increment Field&#39;,
&gt;&gt; -                               &#39;prefs&#39; =&gt;
&gt;&gt; array(&#39;trackerfield_autoincement&#39;),
&gt;&gt; +                               &#39;prefs&#39; =&gt;
&gt;&gt; array(&#39;trackerfield_autoincrement&#39;),
&gt;&gt;                                &#39;tags&#39; =&gt; array(&#39;advanced&#39;),
&gt;&gt;                                &#39;default&#39; =&gt; &#39;n&#39;,
&gt;&gt;                                &#39;params&#39; =&gt; array(
&gt;&gt;
&gt;&gt; This was sent by the SourceForge.net collaborative development platform,
&gt;&gt; the world&#39;s largest Open Source development site.
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; For Developers, A Lot Can Happen In A Second.
&gt;&gt; Boundary is the first to Know...and Tell You.
&gt;&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt;&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
&gt;
&gt; --
&gt; Marc Laporte
&gt;
&gt; <a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
&gt; <a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
&gt; <a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>
&gt;
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29160917">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29160917/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40996] branches/9.x</a></b></div>
      
      <small>From: Jean-François BILGER &lt;changi67@gm...&gt; - 2012-04-21 10:32:37</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CAGQmJnOYrr9m32aLH7gWqFPa8tiYxptGAQ4Pr5waFw_V5%2BE-ng%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Fixed

2012/4/19 Marc Laporte &lt;marc@...&gt;

&gt; What about people that already ran
&gt; installer/schema/20110830_default_enable_in_use_tiki.php (which people
&gt; already ran if they upgraded from 7.x to 8.x
&gt;
&gt; Thanks!
&gt;
&gt;
&gt; On Thu, Apr 19, 2012 at 2:45 PM,  &lt;changi67@...&gt; wrote:
&gt; &gt; Revision: 40996
&gt; &gt;
&gt; <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev</a>
&gt; &gt; Author:   changi67
&gt; &gt; Date:     2012-04-19 18:45:46 +0000 (Thu, 19 Apr 2012)
&gt; &gt; Log Message:
&gt; &gt; -----------
&gt; &gt; [FIX] Typo
&gt; &gt;
&gt; &gt; Modified Paths:
&gt; &gt; --------------
&gt; &gt;    branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; &gt;    branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; &gt;
&gt; &gt; Modified:
&gt; branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; &gt; ===================================================================
&gt; &gt; ---
&gt; branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; 2012-04-19 18:04:23 UTC (rev 40995)
&gt; &gt; +++
&gt; branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; 2012-04-19 18:45:46 UTC (rev 40996)
&gt; &gt; @@ -16,7 +16,7 @@
&gt; &gt;        $map = array (
&gt; &gt;                        &#39;x&#39; =&gt; &#39;trackerfield_action&#39;,
&gt; &gt;                        &#39;A&#39; =&gt; &#39;trackerfield_file&#39;,
&gt; &gt; -                       &#39;q&#39; =&gt; &#39;trackerfield_autoincement&#39;,
&gt; &gt; +                       &#39;q&#39; =&gt; &#39;trackerfield_autoincrement&#39;,
&gt; &gt;                        &#39;e&#39; =&gt; &#39;trackerfield_category&#39;,
&gt; &gt;                        &#39;c&#39; =&gt; &#39;trackerfield_checkbox&#39;,
&gt; &gt;                        &#39;C&#39; =&gt; &#39;trackerfield_computed&#39;,
&gt; &gt;
&gt; &gt; Modified: branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; &gt; ===================================================================
&gt; &gt; --- branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; 2012-04-19 18:04:23 UTC (rev 40995)
&gt; &gt; +++ branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; 2012-04-19 18:45:46 UTC (rev 40996)
&gt; &gt; @@ -21,7 +21,7 @@
&gt; &gt;                                &#39;description&#39; =&gt; tr(&#39;Allows an
&gt; incrementing value field, or itemId field.&#39;),
&gt; &gt;                                &#39;readonly&#39; =&gt; true,
&gt; &gt;                                &#39;help&#39; =&gt; &#39;Auto-Increment Field&#39;,
&gt; &gt; -                               &#39;prefs&#39; =&gt;
&gt; array(&#39;trackerfield_autoincement&#39;),
&gt; &gt; +                               &#39;prefs&#39; =&gt;
&gt; array(&#39;trackerfield_autoincrement&#39;),
&gt; &gt;                                &#39;tags&#39; =&gt; array(&#39;advanced&#39;),
&gt; &gt;                                &#39;default&#39; =&gt; &#39;n&#39;,
&gt; &gt;                                &#39;params&#39; =&gt; array(
&gt; &gt;
&gt; &gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; ------------------------------------------------------------------------------
&gt; &gt; For Developers, A Lot Can Happen In A Second.
&gt; &gt; Boundary is the first to Know...and Tell You.
&gt; &gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; &gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; &gt; _______________________________________________
&gt; &gt; Tikiwiki-cvs mailing list
&gt; &gt; Tikiwiki-cvs@...
&gt; &gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
&gt;
&gt; --
&gt; Marc Laporte
&gt;
&gt; <a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
&gt; <a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
&gt; <a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; For Developers, A Lot Can Happen In A Second.
&gt; Boundary is the first to Know...and Tell You.
&gt; Monitor Your Applications in Ultra-Fine Resolution. Try it FREE!
&gt; <a href="http://p.sf.net/sfu/Boundary-d2dvs2" rel="nofollow">http://p.sf.net/sfu/Boundary-d2dvs2</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;



-- 
Changi
--
Tiki Wiki CMS Groupware Project - Infrastructure Team - <a href="http://tiki.org" rel="nofollow">http://tiki.org</a>
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29158208">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29158208/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40996] branches/9.x</a></b></div>
      
      <small>From: Xavier de Pedro &lt;xavier.depedro@vh...&gt; - 2012-04-20 16:38:36</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>changi, you need to upgrade the documentation of profiles, and release 
notes for 10.x, etc. to reflect this change you have commited in the 
code (a few profiles are using autoincrement with the typo-word already, 
and they work)
my 2 cents
Xavi


On 19/04/12 20:45, changi67@... wrote:
&gt; Revision: 40996
&gt;            <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40996&amp;view=rev</a>
&gt; Author:   changi67
&gt; Date:     2012-04-19 18:45:46 +0000 (Thu, 19 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] Typo
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;      branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt;      branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt;
&gt; Modified: branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php
&gt; ===================================================================
&gt; --- branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php	2012-04-19 18:04:23 UTC (rev 40995)
&gt; +++ branches/9.x/installer/schema/20110830_default_enable_in_use_tiki.php	2012-04-19 18:45:46 UTC (rev 40996)
&gt; @@ -16,7 +16,7 @@
&gt;   	$map = array (
&gt;   			&#39;x&#39; =&gt;  &#39;trackerfield_action&#39;,
&gt;   			&#39;A&#39; =&gt;  &#39;trackerfield_file&#39;,
&gt; -			&#39;q&#39; =&gt;  &#39;trackerfield_autoincement&#39;,
&gt; +			&#39;q&#39; =&gt;  &#39;trackerfield_autoincrement&#39;,
&gt;   			&#39;e&#39; =&gt;  &#39;trackerfield_category&#39;,
&gt;   			&#39;c&#39; =&gt;  &#39;trackerfield_checkbox&#39;,
&gt;   			&#39;C&#39; =&gt;  &#39;trackerfield_computed&#39;,
&gt;
&gt; Modified: branches/9.x/lib/core/Tracker/Field/AutoIncrement.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/core/Tracker/Field/AutoIncrement.php	2012-04-19 18:04:23 UTC (rev 40995)
&gt; +++ branches/9.x/lib/core/Tracker/Field/AutoIncrement.php	2012-04-19 18:45:46 UTC (rev 40996)
&gt; @@ -21,7 +21,7 @@
&gt;   				&#39;description&#39; =&gt;  tr(&#39;Allows an incrementing value field, or itemId field.&#39;),
&gt;   				&#39;readonly&#39; =&gt;  true,
&gt;   				&#39;help&#39; =&gt;  &#39;Auto-Increment Field&#39;,				
&gt; -				&#39;prefs&#39; =&gt;  array(&#39;trackerfield_autoincement&#39;),
&gt; +				&#39;prefs&#39; =&gt;  array(&#39;trackerfield_autoincrement&#39;),
&gt;   				&#39;tags&#39; =&gt;  array(&#39;advanced&#39;),
&gt;   				&#39;default&#39; =&gt;  &#39;n&#39;,
&gt;   				&#39;params&#39; =&gt;  array(
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29154195">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29154195/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[40999] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-19 21:41:38</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 40999
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40999&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40999&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-19 21:41:31 +0000 (Thu, 19 Apr 2012)
Log Message:
-----------
[ENH] Moved the upgrade script for decoding pages to it&#39;s own class for use in other parts of tiki

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-19 21:40:12 UTC (rev 40998)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-19 21:41:31 UTC (rev 40999)
@@ -32,61 +32,12 @@
 
 function upgrade_999999991_decode_pages_sources_tiki($installer)
 {
-	set_time_limit(60 * 60 * 3); //3 hours
-
-	global $tikilib, $prefs, $tikiroot, $user_overrider_prefs, $tiki_p_trust_input, $smarty, $access, $local_php, $categlib, $headerlib;	// globals are required here for tiki-setup_base.php
+	set_time_limit(60 * 60); //1 hours
 	include_once(&#39;tiki-setup_base.php&#39;);
-	$parserlib = TikiLib::lib(&#39;parser&#39;);
-
 	include_once (&#39;lib/categories/categlib.php&#39;);	// needed for cat_jail fn in list_pages()
+	include_once(&#39;lib/wiki/wikilib.php&#39;);
 
-	//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
-	$ids =
-		TikiLib::fetchAll(&#39;SELECT page_id FROM tiki_pages&#39;) +
-		TikiLib::fetchAll(&#39;SELECT historyId FROM tiki_history&#39;);
-
-	foreach($ids as $id) {
-		if (isset($id[&#39;page_id&#39;])) {
-			$data = TikiLib::getOne(&#34;SELECT data FROM tiki_pages WHERE page_id = ?&#34;, array($id[&#39;page_id&#39;]));
-		} else {
-			$data = TikiLib::getOne(&#34;SELECT data FROM tiki_history WHERE historyId = ?&#34;, array($id[&#39;historyId&#39;]));
-		}
-
-		//We know the page was single encoded, but plugin possibly double?
-		$data =  htmlspecialchars_decode($data);
-
-		$matches = WikiParser_PluginMatcher::match($data);			// find the plugins
-
-		$replaced = array();
-
-		foreach ($matches as $match) {								// each plugin
-			$plugin = (string) $match;
-			$key = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;				// by replace whole plugin with a guid
-			$data = preg_replace(&#39;/&#39; . preg_quote($plugin, &#39;/&#39;) . &#39;/&#39;, $key, $data);
-
-			$body = $match-&gt;getBody();									// leave the bodies alone
-			$key2 = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;					// by replacing it with a guid
-			$plugin = preg_replace(&#39;/&#39; . preg_quote($body, &#39;/&#39;) . &#39;/&#39;, $key2, $plugin);
-
-			//Here we detect if a plugin was double encoded and this is the second decode
-			if (preg_match(&#34;/&amp;amp;&amp;/i&#34;, $plugin) || preg_match(&#34;/&amp;quot;/i&#34;, $plugin)) { //try to detect double encoding
-				$plugin = htmlspecialchars_decode($plugin);					// decode entities in the plugin args (usually &amp;quot;)
-			}
-
-			$plugin = str_replace($key2, $body, $plugin);				// finally put the body back
-
-			$replaced[&#39;key&#39;][] = $key;
-			$replaced[&#39;data&#39;][] = $plugin;						// store the decoded-args plugin for replacement later
-
-		}
-
-		$parserlib-&gt;plugins_replace($data, $replaced);			// put the plugins back into the page
-
-		if (isset($id[&#39;page_id&#39;])) {
-			TikiLib::query(&#34;UPDATE tiki_pages SET data = ? WHERE page_id = ?&#34;, array($data, $id[&#39;page_id&#39;]));
-		} else {
-			TikiLib::query(&#34;UPDATE tiki_history SET data = ? WHERE historyId = ?&#34;, array($data, $id[&#39;historyId&#39;]));
-		}
-	}
+	$converter = new convertPagesToTiki9();
+	$converter-&gt;convertPages();
 }
 

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-19 21:40:12 UTC (rev 40998)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-19 21:41:31 UTC (rev 40999)
@@ -1213,3 +1213,112 @@
 
 global $wikilib;
 $wikilib = new WikiLib;
+
+
+class convertPagesToTiki9
+{
+	var $oldMatches;
+	var $matches;
+	var $replaced;
+	var $fingerPrintsOld;
+	var $fingerPrintsNew;
+	var $parserlib;
+	var $argumentParser;
+
+	function __construct()
+	{
+		$this-&gt;parserlib = TikiLib::lib(&#39;parser&#39;);
+		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
+	}
+
+	function convertPages() {
+		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
+		$infos = TikiLib::fetchAll(&#39;SELECT data, page_id FROM tiki_pages&#39;);
+
+		foreach($infos as $info) {
+			$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+			$this-&gt;savePage($info[&#39;page_id&#39;], $converted);
+		}
+	}
+
+	function convertPageHistories() {
+		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
+		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history&#39;);
+
+		foreach($infos as $info) {
+			$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+			$this-&gt;savePageHistory($info[&#39;page_id&#39;], $converted);
+		}
+	}
+
+	function savePage($id, $converted) {
+		//TikiLib::query(&#34;UPDATE tiki_pages SET data = ? WHERE page_id = ?&#34;, array($data, $id));
+	}
+
+	function savePageHistory($id, $converted) {
+		//TikiLib::query(&#34;UPDATE tiki_history SET data = ? WHERE historyId = ?&#34;, array($data, $id));
+	}
+
+	function convertData(&amp;$data) {
+		global $tikilib;
+
+		//we store the original matches because we are about to change and update them
+		$this-&gt;oldMatches = WikiParser_PluginMatcher::match($data);
+
+		//We know the page was single encoded, but plugin possibly double?
+		$data =  htmlspecialchars_decode($data);
+
+		// find the plugins
+		$this-&gt;matches = WikiParser_PluginMatcher::match($data);
+
+		$this-&gt;replaced = array();
+
+		$this-&gt;fingerPrintsOld = array();
+		foreach ($this-&gt;oldMatches as $match) {
+			$match-&gt;name = $match-&gt;getName();
+			$match-&gt;meta = $this-&gt;parserlib-&gt;plugin_info($match-&gt;name);
+			$match-&gt;args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
+			$match-&gt;body = $match-&gt;getBody();
+
+			$fingerPrintsOld[] = $this-&gt;parserlib-&gt;plugin_fingerprint($match-&gt;name, $match-&gt;meta, $match-&gt;body, $match-&gt;args);
+		}
+
+		$fingerPrintsNew = array();
+		foreach ($this-&gt;matches as $match) {							// each plugin
+			$match-&gt;name = $match-&gt;getName();
+			$match-&gt;meta = $this-&gt;parserlib-&gt;plugin_info($match-&gt;name);
+			$match-&gt;args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
+			$match-&gt;plugin = (string) $match;
+			$match-&gt;key = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;					// by replace whole plugin with a guid
+			$data = str_replace($match-&gt;plugin, $match-&gt;key, $data);
+
+			$match-&gt;body = $match-&gt;getBody();									// leave the bodies alone
+			$match-&gt;key2 = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;					// by replacing it with a guid
+			$match-&gt;plugin = str_replace($match-&gt;body, $match-&gt;key2, $match-&gt;plugin);
+
+			//Here we detect if a plugin was double encoded and this is the second decode
+			if (preg_match(&#34;/&amp;amp;&amp;/i&#34;, $match-&gt;plugin) || preg_match(&#34;/&amp;quot;/i&#34;, $match-&gt;plugin)) { //try to detect double encoding
+				$match-&gt;plugin = htmlspecialchars_decode($match-&gt;plugin);				// decode entities in the plugin args (usually &amp;quot;)
+			}
+
+			$match-&gt;plugin = str_replace($match-&gt;key2, $match-&gt;body, $match-&gt;plugin);				// finally put the body back
+
+			$replaced[&#39;key&#39;][] = $match-&gt;key;
+			$replaced[&#39;data&#39;][] = $match-&gt;plugin;								// store the decoded-args plugin for replacement later
+
+			$fingerPrintsNew[] = $this-&gt;parserlib-&gt;plugin_fingerprint($match-&gt;name, $match-&gt;meta, $match-&gt;body, $match-&gt;args);
+		}
+
+		$data = $this-&gt;parserlib-&gt;plugins_replace($data, $this-&gt;replaced);					// put the plugins back into the page
+
+		//if (!empty(array_diff($fingerPrintsOld, $fingerPrintsNew))) {
+			//here we find the old fingerprint and replace it with the new one
+		//}
+
+		return array(
+			&#34;data&#34;=&gt;$data,
+			&#34;oldPluginFingerPrints&#34;=&gt;$fingerPrintsOld,
+			&#34;newPluginFingerPrints&#34;=&gt;$fingerPrintsNew
+		);
+	}
+}
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29154354">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29154354/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41000] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-19 22:27:21</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41000
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41000&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41000&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-19 22:27:14 +0000 (Thu, 19 Apr 2012)
Log Message:
-----------
[ENH] Added state to tiki_history and tiki_pages

Modified Paths:
--------------
    branches/9.x/db/tiki.sql

Added Paths:
-----------
    branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql

Modified: branches/9.x/db/tiki.sql
===================================================================
--- branches/9.x/db/tiki.sql	2012-04-19 21:41:31 UTC (rev 40999)
+++ branches/9.x/db/tiki.sql	2012-04-19 22:27:14 UTC (rev 41000)
@@ -1024,6 +1024,7 @@
   `data` longblob,
   `type` varchar(50) default NULL,
   `is_html` TINYINT(1) NOT NULL DEFAULT 0,
+  `status` varchar(60) default &#39;&#39;,
   PRIMARY KEY (`pageName`,`version`),
   KEY `user` (`user`),
   KEY (`historyId`)
@@ -1628,12 +1629,13 @@
   `wysiwyg` char(1) default NULL,
   `wiki_authors_style` varchar(20) default &#39;&#39;,
   `comments_enabled` char(1) default NULL,
-  `keywords` TEXT, 
+  `keywords` TEXT,
+  `status` varchar(60) default &#39;&#39;,
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),
   KEY `pageRank` (`pageRank`),
-  KEY `lastModif`(`lastModif`)
+  KEY `lastModif`(`lastModif`),
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_pageviews`;

Added: branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql	                        (rev 0)
+++ branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql	2012-04-19 22:27:14 UTC (rev 41000)
@@ -0,0 +1,2 @@
+ALTER TABLE tiki_pages ADD status VARCHAR(60) AFTER keywords;
+ALTER TABLE tiki_history ADD status VARCHAR(60) AFTER is_html;
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29158873">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29158873/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41008] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-20 19:26:45</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41008
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41008&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41008&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-20 19:26:38 +0000 (Fri, 20 Apr 2012)
Log Message:
-----------
[FIX] Did first successful upgrade with new wiki9 converter on moderatly large db, and committing those changes
[FIX] Deleted the upgrade script that added the columns, migrated the changes within the upgrade script to the new class that actually does the upgrade so we can properly check for the existance of the column &#34;status&#34;

Modified Paths:
--------------
    branches/9.x/lib/wiki/wikilib.php

Removed Paths:
-------------
    branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql

Deleted: branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql	2012-04-20 19:24:55 UTC (rev 41007)
+++ branches/9.x/installer/schema/20120419_add_tiki_pages_and_tiki_history_state_field_tiki.sql	2012-04-20 19:26:38 UTC (rev 41008)
@@ -1,2 +0,0 @@
-ALTER TABLE tiki_pages ADD status VARCHAR(60) default &#39;&#39; AFTER keywords;
-ALTER TABLE tiki_history ADD status VARCHAR(60) default &#39;&#39; AFTER is_html;
\ No newline at end of file

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-20 19:24:55 UTC (rev 41007)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-20 19:26:38 UTC (rev 41008)
@@ -1217,108 +1217,170 @@
 
 class convertPagesToTiki9
 {
-	var $oldMatches;
-	var $matches;
-	var $replaced;
-	var $fingerPrintsOld;
-	var $fingerPrintsNew;
 	var $parserlib;
 	var $argumentParser;
 
 	function __construct()
 	{
+		ini_set(&#39;error_reporting&#39;, E_ALL);
+		ini_set(&#39;display_errors&#39;, 1);
 		$this-&gt;parserlib = TikiLib::lib(&#39;parser&#39;);
 		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
 	}
 
-	function convertPages() {
+	function addStatus()
+	{
+		$dbs_tiki = &#39;&#39;;
+
+		require (&#39;db/local.php&#39;);
+
+		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_pages&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
+		if (empty($statusExists)) {
+			TikiLib::query(&#34;ALTER TABLE tiki_pages ADD status VARCHAR(60) default &#39;&#39; AFTER keywords;&#34;);
+		}
+
+		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_history&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
+		if (empty($statusExists)) {
+			TikiLib::query(&#34;ALTER TABLE tiki_history ADD status VARCHAR(60) default &#39;&#39; AFTER is_html;&#34;);
+		}
+	}
+
+	function convertPages()
+	{
+		$this-&gt;addStatus();
 		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
-		$infos = TikiLib::fetchAll(&#39;SELECT data, page_id FROM tiki_pages&#39;);
+		$infos = TikiLib::fetchAll(&#39;SELECT data, page_id FROM tiki_pages WHERE status &lt;&gt; &#34;conv9&#34;&#39;);
 
 		foreach($infos as $info) {
-			$converted = $this-&gt;convertData($info[&#39;data&#39;]);
-			$this-&gt;savePage($info[&#39;page_id&#39;], $converted);
+			if (!empty($info[&#39;data&#39;])) {
+				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+
+				$this-&gt;updatePlugins($converted[&#39;fingerPrintsOld&#39;], $converted[&#39;fingerPrintsNew&#39;]);
+
+				$this-&gt;savePage($info[&#39;page_id&#39;], $converted[&#39;data&#39;]);
+			}
 		}
 	}
 
-	function convertPageHistories() {
+	function convertPageHistoryFromPageAndVersion($page, $version)
+	{
+		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history WHERE status &lt;&gt; &#34;conv9&#34; AND page = ? AND version = ?&#39;, array($page, $version));
+
+		foreach($infos as $info) {
+			if (!empty($info[&#39;data&#39;])) {
+				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+
+				//update plugins first, if it failes, no problems with the page
+				$this-&gt;updatePlugins($converted[&#39;fingerPrintsOld&#39;], $converted[&#39;fingerPrintsNew&#39;]);
+
+				$this-&gt;savePageHistory($info[&#39;historyId&#39;], $converted[&#39;data&#39;]);
+			}
+		}
+	}
+
+	function convertPageHistories()
+	{
+		$this-&gt;addStatus();
+
 		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
-		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history&#39;);
+		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history WHERE status &lt;&gt; &#34;conv9&#34;&#39;);
 
 		foreach($infos as $info) {
-			$converted = $this-&gt;convertData($info[&#39;data&#39;]);
-			$this-&gt;savePageHistory($info[&#39;page_id&#39;], $converted);
+			if (!empty($info[&#39;data&#39;])) {
+				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+
+				$this-&gt;updatePlugins($converted[&#39;fingerPrintsOld&#39;], $converted[&#39;fingerPrintsNew&#39;]);
+
+				$this-&gt;savePageHistory($info[&#39;historyId&#39;], $converted[&#39;data&#39;]);
+			}
 		}
 	}
 
-	function savePage($id, $converted) {
-		//TikiLib::query(&#34;UPDATE tiki_pages SET data = ? WHERE page_id = ?&#34;, array($data, $id));
+	function savePage($id, $data)
+	{
+		TikiLib::query(&#34;
+			UPDATE tiki_pages
+			SET data = ?, status = &#39;conv9&#39;
+			WHERE page_id = ? AND status &lt;&gt; &#39;conv9&#39;
+			&#34;, array($data, $id));
 	}
 
-	function savePageHistory($id, $converted) {
-		//TikiLib::query(&#34;UPDATE tiki_history SET data = ? WHERE historyId = ?&#34;, array($data, $id));
+	function savePageHistory($id, $data)
+	{
+		TikiLib::query(&#34;
+			UPDATE tiki_history
+			SET data = ?, status = &#39;conv9&#39;
+			WHERE historyId = ? AND status &lt;&gt; &#39;conv9&#39;
+			&#34;, array($data, $id));
 	}
 
-	function convertData(&amp;$data) {
-		global $tikilib;
+	function updatePlugins($fingerPrintsOld, $fingerPrintsNew)
+	{
+		//here we find the old fingerprint and replace it with the new one
+		for($i = 0; $i &lt; count($fingerPrintsOld);$i++) {
+			//Remove any that may conflict with the new fingerprint, not sure how to fix this yet
+			TikiLib::query(&#34;DELETE FROM tiki_plugin_security WHERE fingerprint = ?&#34;, array($fingerPrintsNew[$i]));
 
-		//we store the original matches because we are about to change and update them
-		$this-&gt;oldMatches = WikiParser_PluginMatcher::match($data);
+			//Now add in new fingerprints
+			TikiLib::query(&#34;UPDATE tiki_plugin_security SET fingerprint = ? WHERE fingerprint = ?&#34;, array($fingerPrintsNew[$i], $fingerPrintsOld[$i]));
+		}
+	}
 
+	function convertData($data)
+	{
+		//we store the original matches because we are about to change and update them, we need to get their fingerprint
+		$oldMatches = WikiParser_PluginMatcher::match($data);
+
 		//We know the page was single encoded, but plugin possibly double?
 		$data =  htmlspecialchars_decode($data);
 
 		// find the plugins
-		$this-&gt;matches = WikiParser_PluginMatcher::match($data);
+		$matches = WikiParser_PluginMatcher::match($data);
 
-		$this-&gt;replaced = array();
+		$replaced = array();
 
-		$this-&gt;fingerPrintsOld = array();
-		foreach ($this-&gt;oldMatches as $match) {
-			$match-&gt;name = $match-&gt;getName();
-			$match-&gt;meta = $this-&gt;parserlib-&gt;plugin_info($match-&gt;name);
-			$match-&gt;args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
-			$match-&gt;body = $match-&gt;getBody();
+		$fingerPrintsOld = array();
+		foreach ($oldMatches as $match) {
+			$name = $match-&gt;getName();
+			$meta = $this-&gt;parserlib-&gt;plugin_info($name);
+			$args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
+			$body = $match-&gt;getBody();
 
-			$fingerPrintsOld[] = $this-&gt;parserlib-&gt;plugin_fingerprint($match-&gt;name, $match-&gt;meta, $match-&gt;body, $match-&gt;args);
+			$fingerPrintsOld[] = $this-&gt;parserlib-&gt;plugin_fingerprint($name, $meta, $body, $args);
 		}
 
 		$fingerPrintsNew = array();
-		foreach ($this-&gt;matches as $match) {							// each plugin
-			$match-&gt;name = $match-&gt;getName();
-			$match-&gt;meta = $this-&gt;parserlib-&gt;plugin_info($match-&gt;name);
-			$match-&gt;args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
-			$match-&gt;plugin = (string) $match;
-			$match-&gt;key = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;					// by replace whole plugin with a guid
-			$data = str_replace($match-&gt;plugin, $match-&gt;key, $data);
+		foreach ($matches as $match) {							// each plugin
+			$name = $match-&gt;getName();
+			$meta = $this-&gt;parserlib-&gt;plugin_info($name);
+			$args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
+			$plugin = (string) $match;
+			$key = &#39;§&#39;.md5(TikiLib::genPass()).&#39;§&#39;;					// by replace whole plugin with a guid
+			$data = str_replace($plugin, $key, $data);
 
-			$match-&gt;body = $match-&gt;getBody();									// leave the bodies alone
-			$match-&gt;key2 = &#39;§&#39;.md5($tikilib-&gt;genPass()).&#39;§&#39;;					// by replacing it with a guid
-			$match-&gt;plugin = str_replace($match-&gt;body, $match-&gt;key2, $match-&gt;plugin);
+			$body = $match-&gt;getBody();									// leave the bodies alone
+			$key2 = &#39;§&#39;.md5(TikiLib::genPass()).&#39;§&#39;;					// by replacing it with a guid
+			$plugin = str_replace($body, $key2, $plugin);
 
 			//Here we detect if a plugin was double encoded and this is the second decode
-			if (preg_match(&#34;/&amp;amp;&amp;/i&#34;, $match-&gt;plugin) || preg_match(&#34;/&amp;quot;/i&#34;, $match-&gt;plugin)) { //try to detect double encoding
-				$match-&gt;plugin = htmlspecialchars_decode($match-&gt;plugin);				// decode entities in the plugin args (usually &amp;quot;)
+			if (preg_match(&#34;/&amp;amp;&amp;/i&#34;, $plugin) || preg_match(&#34;/&amp;quot;/i&#34;, $plugin)) { //try to detect double encoding
+				$plugin = htmlspecialchars_decode($plugin);				// decode entities in the plugin args (usually &amp;quot;)
 			}
 
-			$match-&gt;plugin = str_replace($match-&gt;key2, $match-&gt;body, $match-&gt;plugin);				// finally put the body back
+			$plugin = str_replace($key2, $body, $plugin);				// finally put the body back
 
-			$replaced[&#39;key&#39;][] = $match-&gt;key;
-			$replaced[&#39;data&#39;][] = $match-&gt;plugin;								// store the decoded-args plugin for replacement later
+			$replaced[&#39;key&#39;][] = $key;
+			$replaced[&#39;data&#39;][] = $plugin;								// store the decoded-args plugin for replacement later
 
-			$fingerPrintsNew[] = $this-&gt;parserlib-&gt;plugin_fingerprint($match-&gt;name, $match-&gt;meta, $match-&gt;body, $match-&gt;args);
+			$fingerPrintsNew[] = $this-&gt;parserlib-&gt;plugin_fingerprint($name, $meta, $body, $args);
 		}
 
-		$data = $this-&gt;parserlib-&gt;plugins_replace($data, $this-&gt;replaced);					// put the plugins back into the page
+		$this-&gt;parserlib-&gt;plugins_replace($data, $replaced);					// put the plugins back into the page
 
-		//if (!empty(array_diff($fingerPrintsOld, $fingerPrintsNew))) {
-			//here we find the old fingerprint and replace it with the new one
-		//}
-
 		return array(
 			&#34;data&#34;=&gt;$data,
-			&#34;oldPluginFingerPrints&#34;=&gt;$fingerPrintsOld,
-			&#34;newPluginFingerPrints&#34;=&gt;$fingerPrintsNew
+			&#34;fingerPrintsOld&#34;=&gt;$fingerPrintsOld,
+			&#34;fingerPrintsNew&#34;=&gt;$fingerPrintsNew
 		);
 	}
 }
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29161535">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29161535/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41017] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-21 15:22:42</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41017
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41017&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41017&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-21 15:22:34 +0000 (Sat, 21 Apr 2012)
Log Message:
-----------
[FIX] Getting command line tiki installer working with the new converter

Modified Paths:
--------------
    branches/9.x/lib/cache/cachelib.php
    branches/9.x/lib/cache/memcachelib.php
    branches/9.x/lib/cache/pagecache.php
    branches/9.x/lib/init/smarty.php
    branches/9.x/lib/perspectivelib.php
    branches/9.x/lib/setup/prefs.php
    branches/9.x/lib/tikilib.php
    branches/9.x/lib/tikisession-memcache.php
    branches/9.x/lib/wiki/wikilib.php
    branches/9.x/tiki-admin_metrics.php
    branches/9.x/tiki-setup_base.php

Modified: branches/9.x/lib/cache/cachelib.php
===================================================================
--- branches/9.x/lib/cache/cachelib.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/cache/cachelib.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -337,8 +337,7 @@
 
 	function cacheItem($key, $data, $type=&#39;&#39;)
 	{
-		global $memcachelib;
-		$memcachelib-&gt;set($this-&gt;getKey($key, $type), $data);
+		TikiLib::lib(&#34;memcache&#34;)-&gt;set($this-&gt;getKey($key, $type), $data);
 		return true;
 	}
 
@@ -349,20 +348,17 @@
 
 	function getCached($key, $type=&#39;&#39;, $lastModif = false)
 	{
-		global $memcachelib;
-		return $memcachelib-&gt;get($this-&gt;getKey($key, $type));
+		return TikiLib::lib(&#34;memcache&#34;)-&gt;get($this-&gt;getKey($key, $type));
 	}
 
 	function invalidate($key, $type=&#39;&#39;)
 	{
-		global $memcachelib;
-		return $memcachelib-&gt;delete($this-&gt;getKey($key, $type));
+		return TikiLib::lib(&#34;memcache&#34;)-&gt;delete($this-&gt;getKey($key, $type));
 	}
 
 	function empty_type_cache( $type )
 	{
-		global $memcachelib;
-		return $memcachelib-&gt;flush();
+		return TikiLib::lib(&#34;memcache&#34;)-&gt;flush();
 	}
 }
 

Modified: branches/9.x/lib/cache/memcachelib.php
===================================================================
--- branches/9.x/lib/cache/memcachelib.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/cache/memcachelib.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -91,7 +91,12 @@
 	 */
 	function isEnabled()
 	{
-		return $this-&gt;memcache &amp;&amp; $this-&gt;getOption(&#39;enabled&#39;, FALSE);
+		global $prefs;
+		if ( $prefs[&#39;memcache_enabled&#39;] == &#39;y&#39; ) {
+			return $this-&gt;memcache &amp;&amp; $this-&gt;getOption(&#39;enabled&#39;, FALSE);
+		} else {
+			return false;
+		}
 	}
 
 	/**
@@ -155,7 +160,9 @@
 		$expiration = ($expiration) ? 
 			$expiration : $this-&gt;getOption(&#39;expiration&#39;, 0);
 
-		return $this-&gt;memcache-&gt;set($key, $value, $flags, $expiration);
+		if (isset($this-&gt;memcache) &amp;&amp; method_exists($this-&gt;memcache, &#34;set&#34;)) {
+			return $this-&gt;memcache-&gt;set($key, $value, $flags, $expiration);
+		}
 	}
 
 	/**
@@ -210,3 +217,20 @@
 		}
 	} 
 }
+
+global $prefs, $memcachelib;
+
+if ( is_array($prefs[&#39;memcache_servers&#39;]) ) {
+	$servers = $prefs[&#39;memcache_servers&#39;];
+} else {
+	$servers = unserialize($prefs[&#39;memcache_servers&#39;]);
+}
+
+$memcachelib = new Memcachelib(
+	$servers, array(
+		&#39;enabled&#39; =&gt; true,
+		&#39;expiration&#39; =&gt; (int) $prefs[&#39;memcache_expiration&#39;],
+		&#39;key_prefix&#39; =&gt; $prefs[&#39;memcache_prefix&#39;],
+		&#39;compress&#39; =&gt; $prefs[&#39;memcache_compress&#39;],
+	)
+);
\ No newline at end of file

Modified: branches/9.x/lib/cache/pagecache.php
===================================================================
--- branches/9.x/lib/cache/pagecache.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/cache/pagecache.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -86,9 +86,9 @@
 	function applyCache()
 	{
 		if ( is_array($this-&gt;cacheData) ) {
-			global $memcachelib;
+			$memcachelib = TikiLib::lib(&#34;memcache&#34;);
 
-			if ( $memcachelib &amp;&amp; $memcachelib-&gt;isEnabled() ) {
+			if ( TikiLib::lib(&#34;memcache&#34;)-&gt;isEnabled() ) {
 				$this-&gt;key = $memcachelib-&gt;buildKey($this-&gt;cacheData);
 
 				if ( $this-&gt;meta ) {
@@ -122,16 +122,14 @@
 
 	function cleanUp()
 	{
-		global $memcachelib;
-
-		if ( $this-&gt;key &amp;&amp; $memcachelib ) {
+		if ( $this-&gt;key ) {
 			$cachedOutput = array(
 				&#39;timestamp&#39; =&gt; time(),
 				&#39;output&#39;    =&gt; ob_get_contents()
 			);
 
 			if ( $cachedOutput[&#39;output&#39;] ) {
-				$memcachelib-&gt;set($this-&gt;key, $cachedOutput);
+				TikiLib::lib(&#34;memcache&#34;)-&gt;set($this-&gt;key, $cachedOutput);
 			}
 
 			ob_end_flush();
@@ -144,10 +142,8 @@
 
 	function invalidate()
 	{
-		global $memcachelib;
-
-		if ( $this-&gt;meta &amp;&amp; $memcachelib ) {
-			$memcachelib-&gt;set($this-&gt;meta, time());
+		if ( $this-&gt;meta ) {
+			TikiLib::lib(&#34;memcache&#34;)-&gt;set($this-&gt;meta, time());
 		}
 	}
 

Modified: branches/9.x/lib/init/smarty.php
===================================================================
--- branches/9.x/lib/init/smarty.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/init/smarty.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -52,7 +52,10 @@
 		global $prefs, $style_base;
 
 		if (empty($style_base) &amp;&amp; class_exists(&#39;TikiLib&#39;)) {	// TikiLib doesn&#39;t exist in the installer
-			$style_base = TikiLib::lib(&#39;tiki&#39;)-&gt;get_style_base($prefs[&#39;style&#39;]);
+			$tikilib = TikiLib::lib(&#39;tiki&#39;);
+			if (method_exists($tikilib, &#34;get_style_base&#34;)) {
+				$style_base = TikiLib::lib(&#39;tiki&#39;)-&gt;get_style_base($prefs[&#39;style&#39;]);
+			}
 		}
 		if ($tikidomain) {
 			$tikidomain.= &#39;/&#39;;

Modified: branches/9.x/lib/perspectivelib.php
===================================================================
--- branches/9.x/lib/perspectivelib.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/perspectivelib.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -28,8 +28,10 @@
 			return (int) $_SESSION[&#39;current_perspective&#39;];
 		}
 
-		global $tikilib;
-		$ip = $tikilib-&gt;get_ip_address();
+		$tikilib = TikiLib::lib(&#34;tiki&#34;);
+		if (method_exists($tikilib, &#34;get_ip_address&#34;)) {
+			$ip = $tikilib-&gt;get_ip_address();
+		}
 
 		foreach ( $this-&gt;get_subnet_map($prefs) as $subnet =&gt; $perspective ) {
 			if ( $this-&gt;is_in_subnet($ip, $subnet) ) {

Modified: branches/9.x/lib/setup/prefs.php
===================================================================
--- branches/9.x/lib/setup/prefs.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/setup/prefs.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -341,7 +341,7 @@
 
 function initialize_prefs()
 {
-	global $prefs, $tikilib, $user_overrider_prefs, $in_installer, $section, $systemConfiguration;
+	global $prefs, $user_overrider_prefs, $in_installer, $section, $systemConfiguration;
 
 	if (!empty($in_installer)) {
 		$prefs = get_default_prefs();
@@ -364,7 +364,12 @@
 			}
 		}
 
-		$modified = $tikilib-&gt;getModifiedPreferences();
+		$tikilib = TikiLib::lib(&#34;tiki&#34;);
+		if (method_exists($tikilib, &#34;getModifiedPreferences&#34;)) {
+			$modified = TikiLib::lib(&#34;tiki&#34;)-&gt;getModifiedPreferences();
+		} else {
+			$modified = array();
+		}
 
 		// Unserialize serialized preferences
 		foreach ( $serializedPreferences as $serializedPreference ) {
@@ -408,8 +413,7 @@
  */ 
 function getCurrentEngine()
 {
-	global $tikilib;
-	return $tikilib-&gt;getCurrentEngine();
+	return TikiLib::lib(&#34;tiki&#34;)-&gt;getCurrentEngine();
 }
 
 /**
@@ -419,6 +423,5 @@
  */ 
 function isMySQLFulltextSearchSupported()
 {
-	global $tikilib;
-	return $tikilib-&gt;isMySQLFulltextSearchSupported();
+	return TikiLib::lib(&#34;tiki&#34;)-&gt;isMySQLFulltextSearchSupported();
 }

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/tikilib.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -87,6 +87,9 @@
 		case &#39;cache&#39;:
 			global $cachelib; include_once(&#39;lib/cache/cachelib.php&#39;);
 			return self::$libraries[$name] = $cachelib;
+		case &#39;memcache&#39;:
+				global $memcachelib; include_once(&#39;lib/cache/memcachelib.php&#39;);
+				return self::$libraries[$name] = $memcachelib;
 		case &#39;userprefs&#39;:
 			global $userprefslib; include_once(&#39;lib/userprefs/userprefslib.php&#39;);
 			return self::$libraries[$name] = $userprefslib;

Modified: branches/9.x/lib/tikisession-memcache.php
===================================================================
--- branches/9.x/lib/tikisession-memcache.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/tikisession-memcache.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -28,11 +28,8 @@
 						array( $this, &#39;gc&#39; )
 		);
 
-		global $memcachelib;
-		$this-&gt;enabled = isset( $memcachelib ) &amp;&amp;
-			$memcachelib-&gt;isEnabled();
-
-		$this-&gt;lib = $memcachelib;
+		$this-&gt;enabled = TikiLib::lib(&#34;memcache&#34;)-&gt;isEnabled();
+		$this-&gt;lib = TikiLib::lib(&#34;memcache&#34;);
 	}
 
 	/**

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -1222,8 +1222,6 @@
 
 	function __construct()
 	{
-		ini_set(&#39;error_reporting&#39;, E_ALL);
-		ini_set(&#39;display_errors&#39;, 1);
 		$this-&gt;parserlib = TikiLib::lib(&#39;parser&#39;);
 		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
 	}

Modified: branches/9.x/tiki-admin_metrics.php
===================================================================
--- branches/9.x/tiki-admin_metrics.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/tiki-admin_metrics.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -188,8 +188,9 @@
 }
 
 /* Clear cache for a tab */
-$use_memcache = $memcachelib &amp;&amp; $memcachelib-&gt;isEnabled()
-    &amp;&amp; $memcachelib-&gt;getOption(&#39;cache_metrics_output&#39;);
+$memcachelib = TikiLib::lib(&#34;memcache&#34;);
+
+$use_memcache = $memcachelib-&gt;isEnabled() &amp;&amp; $memcachelib-&gt;getOption(&#39;cache_metrics_output&#39;);
 $smarty-&gt;assign(&#39;use_memcache&#39;, $use_memcache);
 if (isset($_REQUEST[&#34;tab_clearcache&#34;])) {
 	if (!$use_memcache) {

Modified: branches/9.x/tiki-setup_base.php
===================================================================
--- branches/9.x/tiki-setup_base.php	2012-04-21 13:38:18 UTC (rev 41016)
+++ branches/9.x/tiki-setup_base.php	2012-04-21 15:22:34 UTC (rev 41017)
@@ -79,26 +79,6 @@
 global $logslib;
 require_once (&#39;lib/logs/logslib.php&#39;);
 include_once (&#39;lib/init/tra.php&#39;);
-
-if ( $prefs[&#39;memcache_enabled&#39;] == &#39;y&#39; ) {
-	require_once(&#39;lib/cache/memcachelib.php&#39;);
-	if ( is_array($prefs[&#39;memcache_servers&#39;]) ) {
-		$servers = $prefs[&#39;memcache_servers&#39;];
-	} else {
-		$servers = unserialize($prefs[&#39;memcache_servers&#39;]);
-	}
-
-	global $memcachelib;
-	$memcachelib = new MemcacheLib(
-					$servers, array(
-						&#39;enabled&#39; =&gt; true,
-						&#39;expiration&#39; =&gt; (int) $prefs[&#39;memcache_expiration&#39;],
-						&#39;key_prefix&#39; =&gt; $prefs[&#39;memcache_prefix&#39;],
-						&#39;compress&#39; =&gt; $prefs[&#39;memcache_compress&#39;],
-		)
-	);
-}
-
 require_once (&#39;lib/tikidate.php&#39;);
 $tikidate = new TikiDate();
 // set session lifetime
@@ -112,7 +92,7 @@
 	} elseif ($api_tiki == &#39;pdo&#39;) {
 		require_once (&#39;lib/tikisession-pdo.php&#39;);
 	}
-} elseif ( $prefs[&#39;session_storage&#39;] == &#39;memcache&#39; &amp;&amp; isset( $memcachelib ) &amp;&amp; $memcachelib-&gt;isEnabled() ) {
+} elseif ( $prefs[&#39;session_storage&#39;] == &#39;memcache&#39; &amp;&amp; TikiLib::lib(&#34;memcach&#34;)-&gt;isEnabled() ) {
 	require_once (&#39;lib/tikisession-memcache.php&#39;);
 }
 
@@ -168,8 +148,7 @@
 // Retrieve all preferences
 require_once (&#39;lib/setup/prefs.php&#39;);
 // Smarty needs session since 2.6.25
-require_once (&#39;lib/init/smarty.php&#39;);
-global $smarty;
+global $smarty; require_once (&#39;lib/init/smarty.php&#39;);
 
 // Define the special maxRecords global variable
 $maxRecords = $prefs[&#39;maxRecords&#39;];
@@ -575,7 +554,9 @@
 unset($GLOBALS[&#39;HTTP_POST_FILES&#39;]);
 // --------------------------------------------------------------
 if (isset($_REQUEST[&#39;highlight&#39;]) || (isset($prefs[&#39;feature_referer_highlight&#39;]) &amp;&amp; $prefs[&#39;feature_referer_highlight&#39;] == &#39;y&#39;)) {
-	$smarty-&gt;loadFilter(&#39;output&#39;, &#39;highlight&#39;);
+	if (method_exists($smarty, &#39;loadFilter&#39;)) {
+		$smarty-&gt;loadFilter(&#39;output&#39;, &#39;highlight&#39;);
+	}
 }
 if (function_exists(&#39;mb_internal_encoding&#39;)) {
 	mb_internal_encoding(&#34;UTF-8&#34;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29162898">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29162898/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41026] branches/9.x</a></b></div>
      
      <small>From: &lt;marclaporte@us...&gt; - 2012-04-22 02:53:04</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41026
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41026&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41026&amp;view=rev</a>
Author:   marclaporte
Date:     2012-04-22 02:52:56 +0000 (Sun, 22 Apr 2012)
Log Message:
-----------
fix prefs to corresponds to changes in r40326

Revision Links:
--------------
    <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40326&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=40326&amp;view=rev</a>

Modified Paths:
--------------
    branches/9.x/lib/prefs/feature.php
    branches/9.x/templates/admin/include_trackers.tpl

Modified: branches/9.x/lib/prefs/feature.php
===================================================================
--- branches/9.x/lib/prefs/feature.php	2012-04-22 01:38:15 UTC (rev 41025)
+++ branches/9.x/lib/prefs/feature.php	2012-04-22 02:52:56 UTC (rev 41026)
@@ -116,14 +116,11 @@
 		&#39;feature_reports&#39; =&gt; array(
 			&#39;name&#39; =&gt; tra(&#39;Reports&#39;),
 			&#39;description&#39; =&gt; tra(&#39;Reports Generator&#39;),
-			&#39;help&#39; =&gt; &#39;Trackers&#39;,
+			&#39;help&#39; =&gt; &#39;Reports&#39;,
 			&#39;type&#39; =&gt; &#39;flag&#39;,
-			&#39;keywords&#39; =&gt; &#39;report trackers logs&#39;,
+			&#39;keywords&#39; =&gt; &#39;report trackers logs builder&#39;,
 			&#39;default&#39; =&gt; &#39;n&#39;,
-			&#39;dependencies&#39; =&gt; array(&#39;feature_trackers&#39;),
-			&#39;permission&#39; =&gt; array(
-				&#39;permType&#39; =&gt; &#39;trackers&#39;,
-			),
+			&#39;view&#39; =&gt; &#39;tiki-edit_report.php&#39;,
 			&#39;warning&#39; =&gt; tra(&#39;Experimental&#39;),
 			&#39;tags&#39; =&gt; array(&#39;experimental&#39;),
 		),

Modified: branches/9.x/templates/admin/include_trackers.tpl
===================================================================
--- branches/9.x/templates/admin/include_trackers.tpl	2012-04-22 01:38:15 UTC (rev 41025)
+++ branches/9.x/templates/admin/include_trackers.tpl	2012-04-22 02:52:56 UTC (rev 41026)
@@ -14,7 +14,7 @@
 		&lt;legend&gt;{tr}Tracker settings{/tr}&lt;/legend&gt;
 		{preference name=user_selector_threshold}
 		{preference name=user_selector_realnames_tracker}
-		{preference name=feature_tracker_reports}
+		{preference name=feature_reports}
 		{preference name=&#34;tracker_remote_sync&#34;}
 	&lt;/fieldset&gt;
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29165139">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29165139/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41038] branches/9.x</a></b></div>
      
      <small>From: &lt;sylvieg@us...&gt; - 2012-04-22 20:08:47</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41038
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41038&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41038&amp;view=rev</a>
Author:   sylvieg
Date:     2012-04-22 20:08:41 +0000 (Sun, 22 Apr 2012)
Log Message:
-----------
[merge/r41036][FIX]mime_type can be longer thatn 64 chars

Revision Links:
--------------
    <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41036&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41036&amp;view=rev</a>

Modified Paths:
--------------
    branches/9.x/db/tiki.sql

Added Paths:
-----------
    branches/9.x/installer/schema/20120422_mime_tiki.sql

Modified: branches/9.x/db/tiki.sql
===================================================================
--- branches/9.x/db/tiki.sql	2012-04-22 20:07:55 UTC (rev 41037)
+++ branches/9.x/db/tiki.sql	2012-04-22 20:08:41 UTC (rev 41038)
@@ -2812,7 +2812,7 @@
 
 DROP TABLE IF EXISTS `tiki_file_handlers`;
 CREATE TABLE `tiki_file_handlers` (
-  `mime_type` varchar(64) default NULL,
+  `mime_type` varchar(128) default NULL,
   `cmd` varchar(238) default NULL
 ) ENGINE=MyISAM;
 

Added: branches/9.x/installer/schema/20120422_mime_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120422_mime_tiki.sql	                        (rev 0)
+++ branches/9.x/installer/schema/20120422_mime_tiki.sql	2012-04-22 20:08:41 UTC (rev 41038)
@@ -0,0 +1 @@
+alter table `tiki_file_handlers` modify `mime_type` varchar(128) default NULL;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29165371">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29165371/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41041] branches/9.x</a></b></div>
      
      <small>From: &lt;sylvieg@us...&gt; - 2012-04-22 21:48:30</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41041
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41041&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41041&amp;view=rev</a>
Author:   sylvieg
Date:     2012-04-22 21:48:23 +0000 (Sun, 22 Apr 2012)
Log Message:
-----------
[merge/r41040]FIX]fgal: duplicate show reallyteh fgal in the drop down

Revision Links:
--------------
    <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41040&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41040&amp;view=rev</a>

Modified Paths:
--------------
    branches/9.x/templates/duplicate_file_gallery.tpl
    branches/9.x/templates/list_file_gallery.tpl
    branches/9.x/tiki-list_file_gallery.php

Modified: branches/9.x/templates/duplicate_file_gallery.tpl
===================================================================
--- branches/9.x/templates/duplicate_file_gallery.tpl	2012-04-22 21:43:25 UTC (rev 41040)
+++ branches/9.x/templates/duplicate_file_gallery.tpl	2012-04-22 21:48:23 UTC (rev 41041)
@@ -8,7 +8,7 @@
 					&lt;label for=&#34;name&#34;&gt;{tr}Name:{/tr}&lt;/label&gt;
 				&lt;/td&gt;
 				&lt;td&gt;
-					&lt;input type=&#34;text&#34; size=&#34;50&#34; id=&#34;name&#34; name=&#34;name&#34; value=&#34;{$name|escape}&#34; /&gt;
+					&lt;input type=&#34;text&#34; size=&#34;50&#34; id=&#34;name&#34; name=&#34;name&#34; value=&#34;&#34; /&gt;
 				&lt;/td&gt;
 			&lt;/tr&gt;
 			&lt;tr&gt;
@@ -26,7 +26,7 @@
 				&lt;td&gt;
 					&lt;select id=&#34;galleryId&#34; name=&#34;galleryId&#34;{if $all_galleries|@count eq &#39;0&#39;} disabled=&#34;disabled&#34;{/if}&gt;
 						{section name=ix loop=$all_galleries}
-							&lt;option value=&#34;{$all_galleries[ix].id}&#34;&gt;{$all_galleries[ix].label|escape}&lt;/option&gt;
+							&lt;option value=&#34;{$all_galleries[ix].id}&#34;{if $galleryId eq $all_galleries[ix].id} selected=&#34;selected&#34;{/if}&gt;{$all_galleries[ix].label|escape}&lt;/option&gt;
 						{sectionelse}
 							&lt;option value=&#34;&#34;&gt;{tr}None{/tr}&lt;/option&gt;
 						{/section}

Modified: branches/9.x/templates/list_file_gallery.tpl
===================================================================
--- branches/9.x/templates/list_file_gallery.tpl	2012-04-22 21:43:25 UTC (rev 41040)
+++ branches/9.x/templates/list_file_gallery.tpl	2012-04-22 21:48:23 UTC (rev 41041)
@@ -114,7 +114,9 @@
 								{tr}Move to:{/tr}
 								&lt;select name=&#34;moveto&#34;&gt;
 									{section name=ix loop=$all_galleries}
-										&lt;option value=&#34;{$all_galleries[ix].id}&#34;&gt;{$all_galleries[ix].label|escape}&lt;/option&gt;
+										{if $all_galleries[ix].id ne $galleryId}
+											&lt;option value=&#34;{$all_galleries[ix].id}&#34;&gt;{$all_galleries[ix].label|escape}&lt;/option&gt;
+										{/if}
 									{/section}
 								&lt;/select&gt;
 								&lt;input type=&#39;submit&#39; name=&#39;movesel&#39; value=&#34;{tr}Move{/tr}&#34; /&gt;

Modified: branches/9.x/tiki-list_file_gallery.php
===================================================================
--- branches/9.x/tiki-list_file_gallery.php	2012-04-22 21:43:25 UTC (rev 41040)
+++ branches/9.x/tiki-list_file_gallery.php	2012-04-22 21:48:23 UTC (rev 41041)
@@ -923,9 +923,7 @@
 if ($prefs[&#39;fgal_show_explorer&#39;] == &#39;y&#39; || $prefs[&#39;fgal_show_path&#39;] == &#39;y&#39; || isset($_REQUEST[&#39;movesel_x&#39;]) || isset($_REQUEST[&#34;edit_mode&#34;])) {
 	$gals = array();
 	foreach ($subGalleries[&#39;data&#39;] as $gal) {
-		if ($gal[&#39;id&#39;] != $galleryId) {
-			$gals[] = array(&#39;label&#39; =&gt; $gal[&#39;parentName&#39;] . &#39; &gt; &#39; . $gal[&#39;name&#39;], &#39;id&#39; =&gt; $gal[&#39;id&#39;]);
-		}
+		$gals[] = array(&#39;label&#39; =&gt; $gal[&#39;parentName&#39;] . &#39; &gt; &#39; . $gal[&#39;name&#39;], &#39;id&#39; =&gt; $gal[&#39;id&#39;]);
 	}
 	sort($gals);
 	$smarty-&gt;assign_by_ref(&#39;all_galleries&#39;, $gals);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29169103">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29169103/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41055] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-23 18:15:24</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41055
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41055&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41055&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-23 17:27:48 +0000 (Mon, 23 Apr 2012)
Log Message:
-----------
[ENH] Added convertModules to follow same rules as wiki pages
[FIX] tra was calling tikilib that might not exist, switch from global to Zend naming convention

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/init/tra.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-23 16:54:54 UTC (rev 41054)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-23 17:27:48 UTC (rev 41055)
@@ -39,5 +39,6 @@
 
 	$converter = new convertPagesToTiki9();
 	$converter-&gt;convertPages();
+	$converter-&gt;convertModules();
 }
 

Modified: branches/9.x/lib/init/tra.php
===================================================================
--- branches/9.x/lib/init/tra.php	2012-04-23 16:54:54 UTC (rev 41054)
+++ branches/9.x/lib/init/tra.php	2012-04-23 17:27:48 UTC (rev 41055)
@@ -73,10 +73,9 @@
 		}
 
 		if ( isset( $prefs[&#39;lang_use_db&#39;] ) &amp;&amp; $prefs[&#39;lang_use_db&#39;] == &#39;y&#39; ) {
-			global $tikilib;
 
 			$query = &#34;select `source`, `tran` from `tiki_language` where `lang`=?&#34;;
-			$result = $tikilib-&gt;fetchAll($query, array($lg));
+			$result = TikiLib::fetchAll($query, array($lg));
 
 			foreach ( $result as $row ) {
 				$lang[ $row[&#39;source&#39;] ] = $row[&#39;tran&#39;];

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-23 16:54:54 UTC (rev 41054)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-23 17:27:48 UTC (rev 41055)
@@ -1241,6 +1241,11 @@
 		if (empty($statusExists)) {
 			TikiLib::query(&#34;ALTER TABLE tiki_history ADD status VARCHAR(60) default &#39;&#39; AFTER is_html;&#34;);
 		}
+
+		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_user_modules&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
+		if (empty($statusExists)) {
+			TikiLib::query(&#34;ALTER TABLE tiki_user_modules ADD status VARCHAR(60) default &#39;&#39; AFTER parse;&#34;);
+		}
 	}
 
 	function convertPages()
@@ -1296,6 +1301,24 @@
 		}
 	}
 
+	function convertModules()
+	{
+		$this-&gt;addStatus();
+
+		$infos = TikiLib::fetchAll(&#39;SELECT data, name FROM tiki_user_modules WHERE status &lt;&gt; &#34;conv9&#34; AND status &lt;&gt; &#34;new9+&#34;&#39;);
+
+		foreach($infos as $info) {
+			if (!empty($info[&#39;data&#39;])) {
+				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
+
+				print_r($converted);
+				$this-&gt;updatePlugins($converted[&#39;fingerPrintsOld&#39;], $converted[&#39;fingerPrintsNew&#39;]);
+
+				$this-&gt;saveModule($info[&#39;name&#39;], $converted[&#39;data&#39;]);
+			}
+		}
+	}
+
 	function savePage($id, $data)
 	{
 		TikiLib::query(&#34;
@@ -1314,6 +1337,16 @@
 			&#34;, array($data, $id));
 	}
 
+	function saveModule($name, $data)
+	{
+		print_r(array($data, $name));
+		TikiLib::query(&#34;
+			UPDATE tiki_user_modules
+			SET data = ?, status = &#39;conv9&#39;
+			WHERE name = ? AND status &lt;&gt; &#39;conv9&#39; AND status &lt;&gt; &#39;new9+&#39;
+			&#34;, array($data, $name));
+	}
+
 	function updatePlugins($fingerPrintsOld, $fingerPrintsNew)
 	{
 		//here we find the old fingerprint and replace it with the new one
@@ -1340,7 +1373,8 @@
 		$matches = WikiParser_PluginMatcher::match($data);
 
 		$replaced = array();
-
+		ini_set(&#39;error_reporting&#39;, E_ALL);
+		ini_set(&#39;display_errors&#39;, 1);
 		$fingerPrintsOld = array();
 		foreach ($oldMatches as $match) {
 			$name = $match-&gt;getName();
@@ -1350,7 +1384,7 @@
 
 			$fingerPrintsOld[] = $this-&gt;parserlib-&gt;plugin_fingerprint($name, $meta, $body, $args);
 		}
-
+		echo $data;
 		$fingerPrintsNew = array();
 		foreach ($matches as $match) {							// each plugin
 			$name = $match-&gt;getName();
@@ -1358,6 +1392,7 @@
 			$args = $this-&gt;argumentParser-&gt;parse($match-&gt;getArguments());
 			$plugin = (string) $match;
 			$key = &#39;§&#39;.md5(TikiLib::genPass()).&#39;§&#39;;					// by replace whole plugin with a guid
+
 			$data = str_replace($plugin, $key, $data);
 
 			$body = $match-&gt;getBody();									// leave the bodies alone

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29177794">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29177794/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41093] branches/9.x</a></b></div>
      
      <small>From: J&lt;yhem@us...&gt; - 2012-04-25 10:11:37</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41093
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41093&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41093&amp;view=rev</a>
Author:   Jyhem
Date:     2012-04-25 10:11:24 +0000 (Wed, 25 Apr 2012)
Log Message:
-----------
[FIX] Fix typo

Modified Paths:
--------------
    branches/9.x/lang/ar/language.php
    branches/9.x/lang/bg/language.php
    branches/9.x/lang/ca/language.php
    branches/9.x/lang/cn/language.php
    branches/9.x/lang/cs/language.php
    branches/9.x/lang/cy/language.php
    branches/9.x/lang/da/language.php
    branches/9.x/lang/de/language.php
    branches/9.x/lang/el/language.php
    branches/9.x/lang/en/language.js
    branches/9.x/lang/en/language.php
    branches/9.x/lang/en-uk/language.php
    branches/9.x/lang/es/language.php
    branches/9.x/lang/fa/language.php
    branches/9.x/lang/fi/language.php
    branches/9.x/lang/fj/language.php
    branches/9.x/lang/fr/language.php
    branches/9.x/lang/fy-NL/language.php
    branches/9.x/lang/gl/language.php
    branches/9.x/lang/he/language.php
    branches/9.x/lang/hr/language.php
    branches/9.x/lang/hu/language.php
    branches/9.x/lang/id/language.php
    branches/9.x/lang/is/language.php
    branches/9.x/lang/it/language.php
    branches/9.x/lang/iu/language.php
    branches/9.x/lang/ja/language.php
    branches/9.x/lang/ko/language.php
    branches/9.x/lang/lt/language.php
    branches/9.x/lang/nds/language.php
    branches/9.x/lang/nl/language.php
    branches/9.x/lang/no/language.php
    branches/9.x/lang/pl/language.php
    branches/9.x/lang/pt/language.php
    branches/9.x/lang/pt-br/language.php
    branches/9.x/lang/rm/language.php
    branches/9.x/lang/ro/language.php
    branches/9.x/lang/ru/language.php
    branches/9.x/lang/sb/language.php
    branches/9.x/lang/si/language.php
    branches/9.x/lang/sk/language.php
    branches/9.x/lang/sl/language.php
    branches/9.x/lang/sq/language.php
    branches/9.x/lang/sr-latn/language.php
    branches/9.x/lang/sv/language.php
    branches/9.x/lang/tr/language.php
    branches/9.x/lang/tv/language.php
    branches/9.x/lang/tw/language.php
    branches/9.x/lang/uk/language.php
    branches/9.x/lang/vi/language.php
    branches/9.x/lib/wiki-plugins/wikiplugin_tracker.php

Modified: branches/9.x/lang/ar/language.php
===================================================================
--- branches/9.x/lang/ar/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ar/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/bg/language.php
===================================================================
--- branches/9.x/lang/bg/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/bg/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/ca/language.php
===================================================================
--- branches/9.x/lang/ca/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ca/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6449,6 +6449,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Reescriure&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/cn/language.php
===================================================================
--- branches/9.x/lang/cn/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/cn/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;覆盖&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/cs/language.php
===================================================================
--- branches/9.x/lang/cs/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/cs/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6447,6 +6447,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Přepsat&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/cy/language.php
===================================================================
--- branches/9.x/lang/cy/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/cy/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/da/language.php
===================================================================
--- branches/9.x/lang/da/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/da/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6445,6 +6445,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Overskriv&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/de/language.php
===================================================================
--- branches/9.x/lang/de/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/de/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6451,6 +6451,7 @@
 &#34;Self&#34; =&gt; &#34;selbst&#34;,
 &#34;Values&#34; =&gt; &#34;Werte&#34;,
 &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Durch Doppelpunkt getrennt Liste von Standardwerten für die Felder. Der erste Werte entspricht dem ersten Feld, der zweite dem zweiten Feld usw&#34;,
+&#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Durch Doppelpunkt getrennt Liste von Standardwerten für die Felder. Der erste Werte entspricht dem ersten Feld, der zweite dem zweiten Feld usw&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Überschreiben&#34;,
 &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Überschreiben gegenwärtige Feldwerte des Eintrages mit den eingegebenen Werten&#34;,
 &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Zeigt Spalten in der Reihenfolge wie in den Feldparametern angegeben anstelle nach FeldID (FeldID Sortierung wird standardmäßig benutzt&#34;,

Modified: branches/9.x/lang/el/language.php
===================================================================
--- branches/9.x/lang/el/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/el/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/en/language.js
===================================================================
--- branches/9.x/lang/en/language.js	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/en/language.js	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6,6 +6,8 @@
  */
 
 lang = {
+&#34;Which Continent Do You Live In?&#34; : &#34;EN Dans quel continent habitez-vous ?&#34;,
+	&#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;,
 //	&#34;Very Secure&#34; : &#34;Very Secure&#34;,
 //	&#34;Secure&#34; : &#34;Secure&#34;,
 //	&#34;Very Strong&#34; : &#34;Very Strong&#34;,

Modified: branches/9.x/lang/en/language.php
===================================================================
--- branches/9.x/lang/en/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/en/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6442,6 +6442,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/en-uk/language.php
===================================================================
--- branches/9.x/lang/en-uk/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/en-uk/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 &#34;Self&#34; =&gt; &#34;Self&#34;,
 &#34;Values&#34; =&gt; &#34;Values&#34;,
 &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+&#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/es/language.php
===================================================================
--- branches/9.x/lang/es/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/es/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6447,6 +6447,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Sobrescribir&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/fa/language.php
===================================================================
--- branches/9.x/lang/fa/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/fa/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6446,6 +6446,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;روي اطلاعات قبلي بنويس&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/fi/language.php
===================================================================
--- branches/9.x/lang/fi/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/fi/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6449,6 +6449,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Päällekirjoita&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/fj/language.php
===================================================================
--- branches/9.x/lang/fj/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/fj/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/fr/language.php
===================================================================
--- branches/9.x/lang/fr/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/fr/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -879,7 +879,7 @@
 &#34;Blank&#34; =&gt; &#34;Blanc&#34;,
 &#34;Allows users to select only from a specified set of options&#34; =&gt; &#34;Autorise les utilisateurs à choisir seulement à partir d&#39;un ensemble spécifié d&#39;options&#34;,
 &#34;Option&#34; =&gt; &#34;Option&#34;,
-&#34;An option, if containing an equal sign, the prior part will be used as the value while the later as the label&#34; =&gt; &#34;Une option, si elle contient un signe égal, la première partie sera utilisée comme valeur tandis que la seconde sera l&#39;étiquette&#34;,
+&#34;An option, if containing an equal sign, the prior part will be used as the value while the later as the label&#34; =&gt; &#34;Si une option contient un signe égal, la première partie sera utilisée comme valeur tandis que la seconde sera l&#39;étiquette&#34;,
 &#34;Drop Down with Other field&#34; =&gt; &#34;Liste déroulante avec un champ &#39;Autre&#39;&#34;,
 &#34;Allows users to select from a specified set of options or to enter an alternate option&#34; =&gt; &#34;Autorise les utilisateurs à choisir à partir d&#39;un ensemble spécifié d&#39;options ou à entrer une autre option&#34;,
 &#34;Radio Buttons&#34; =&gt; &#34;Boutons radio&#34;,
@@ -6446,6 +6446,7 @@
 &#34;Self&#34; =&gt; &#34;Self&#34;,
 &#34;Values&#34; =&gt; &#34;Valeurs&#34;,
 &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Liste séparée par deux-points des valeurs par défaut. La première valeur correspond au permier champ, la seconde au second, etc.&#34;,
+&#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Liste séparée par deux-points des valeurs par défaut. La première valeur correspond au permier champ, la seconde au second, etc.&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Écraser&#34;,
 &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Écraser les valeurs actuelles des champs de la fiche par les valeurs saisies&#34;,
 &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Afficher les colonnes dans l&#39;ordre des paramètres des champs plutôt que par ID de champ (l&#39;ordre d&#39;ID de champ est la valeur par défaut)&#34;,

Modified: branches/9.x/lang/fy-NL/language.php
===================================================================
--- branches/9.x/lang/fy-NL/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/fy-NL/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/gl/language.php
===================================================================
--- branches/9.x/lang/gl/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/gl/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6447,6 +6447,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Sobrescribir&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/he/language.php
===================================================================
--- branches/9.x/lang/he/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/he/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/hr/language.php
===================================================================
--- branches/9.x/lang/hr/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/hr/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Pisanje preko&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/hu/language.php
===================================================================
--- branches/9.x/lang/hu/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/hu/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6451,6 +6451,7 @@
 &#34;Self&#34; =&gt; &#34;Self&#34;,
 &#34;Values&#34; =&gt; &#34;Értékek&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Felülírás&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/id/language.php
===================================================================
--- branches/9.x/lang/id/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/id/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/is/language.php
===================================================================
--- branches/9.x/lang/is/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/is/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/it/language.php
===================================================================
--- branches/9.x/lang/it/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/it/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/iu/language.php
===================================================================
--- branches/9.x/lang/iu/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/iu/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/ja/language.php
===================================================================
--- branches/9.x/lang/ja/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ja/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;上書き&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/ko/language.php
===================================================================
--- branches/9.x/lang/ko/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ko/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;덮어쓰기&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/lt/language.php
===================================================================
--- branches/9.x/lang/lt/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/lt/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/nds/language.php
===================================================================
--- branches/9.x/lang/nds/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/nds/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 &#34;Self&#34; =&gt; &#34;sülvst&#34;,
 &#34;Values&#34; =&gt; &#34;Weert&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Överschrieven&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/nl/language.php
===================================================================
--- branches/9.x/lang/nl/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/nl/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6447,6 +6447,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Overschrijf&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/no/language.php
===================================================================
--- branches/9.x/lang/no/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/no/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Overskriv&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/pl/language.php
===================================================================
--- branches/9.x/lang/pl/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/pl/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Nadpisz&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/pt/language.php
===================================================================
--- branches/9.x/lang/pt/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/pt/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Substituir&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/pt-br/language.php
===================================================================
--- branches/9.x/lang/pt-br/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/pt-br/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6448,6 +6448,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Sobrescrever&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/rm/language.php
===================================================================
--- branches/9.x/lang/rm/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/rm/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/ro/language.php
===================================================================
--- branches/9.x/lang/ro/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ro/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/ru/language.php
===================================================================
--- branches/9.x/lang/ru/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/ru/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Перезаписать&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sb/language.php
===================================================================
--- branches/9.x/lang/sb/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sb/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Raetovam&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/si/language.php
===================================================================
--- branches/9.x/lang/si/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/si/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sk/language.php
===================================================================
--- branches/9.x/lang/sk/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sk/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Prepísať&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sl/language.php
===================================================================
--- branches/9.x/lang/sl/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sl/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6448,6 +6448,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Prepiši&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sq/language.php
===================================================================
--- branches/9.x/lang/sq/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sq/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sr-latn/language.php
===================================================================
--- branches/9.x/lang/sr-latn/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sr-latn/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Prebrisavanje&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/sv/language.php
===================================================================
--- branches/9.x/lang/sv/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/sv/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6446,6 +6446,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Skriv över&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/tr/language.php
===================================================================
--- branches/9.x/lang/tr/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/tr/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/tv/language.php
===================================================================
--- branches/9.x/lang/tv/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/tv/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/tw/language.php
===================================================================
--- branches/9.x/lang/tw/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/tw/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;覆蓋&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/uk/language.php
===================================================================
--- branches/9.x/lang/uk/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/uk/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6444,6 +6444,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 &#34;Overwrite&#34; =&gt; &#34;Переписати&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lang/vi/language.php
===================================================================
--- branches/9.x/lang/vi/language.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lang/vi/language.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -6447,6 +6447,7 @@
 // &#34;Self&#34; =&gt; &#34;Self&#34;,
 // &#34;Values&#34; =&gt; &#34;Values&#34;,
 // &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
+// &#34;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc&#34; =&gt; &#34;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc&#34;,
 // &#34;Overwrite&#34; =&gt; &#34;Overwrite&#34;,
 // &#34;Overwrite current field values of the item with the input values&#34; =&gt; &#34;Overwrite current field values of the item with the input values&#34;,
 // &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34; =&gt; &#34;Display columns in the order listed in the fields parameter instead of by field ID (field ID order is used by default&#34;,

Modified: branches/9.x/lib/wiki-plugins/wikiplugin_tracker.php
===================================================================
--- branches/9.x/lib/wiki-plugins/wikiplugin_tracker.php	2012-04-25 09:30:39 UTC (rev 41092)
+++ branches/9.x/lib/wiki-plugins/wikiplugin_tracker.php	2012-04-25 10:11:24 UTC (rev 41093)
@@ -132,7 +132,7 @@
 			&#39;values&#39; =&gt; array(
 				&#39;required&#39; =&gt; false,
 				&#39;name&#39; =&gt; tra(&#39;Values&#39;),
-				&#39;description&#39; =&gt; tra(&#39;Colon-separated list of default values.for the fields. First value corresponds to first field, second value to second field, etc.&#39;),
+				&#39;description&#39; =&gt; tra(&#39;Colon-separated list of default values for the fields. First value corresponds to first field, second value to second field, etc.&#39;),
 				&#39;default&#39; =&gt; &#39;&#39;,
 			),
 			&#39;overwrite&#39; =&gt; array(

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29179618">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29179618/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41101] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-25 15:26:58</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41101
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41101&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41101&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-25 15:26:47 +0000 (Wed, 25 Apr 2012)
Log Message:
-----------
[FIX] Stopped all the conversion from taking place, html entities are now stored as they were in 6, they way they should be, and they are protected when they need to be. Will start testing in other parts of tiki next.

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/parser/parserlib.php
    branches/9.x/lib/tikilib.php
    branches/9.x/lib/wiki/histlib.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-25 15:06:39 UTC (rev 41100)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-25 15:26:47 UTC (rev 41101)
@@ -32,6 +32,7 @@
 
 function upgrade_999999991_decode_pages_sources_tiki($installer)
 {
+	/*
 	set_time_limit(60 * 60); //1 hours
 	include_once(&#39;tiki-setup_base.php&#39;);
 	include_once (&#39;lib/categories/categlib.php&#39;);	// needed for cat_jail fn in list_pages()
@@ -39,6 +40,6 @@
 
 	$converter = new convertPagesToTiki9();
 	$converter-&gt;convertPages();
-	$converter-&gt;convertModules();
+	$converter-&gt;convertModules();*/
 }
 

Modified: branches/9.x/lib/parser/parserlib.php
===================================================================
--- branches/9.x/lib/parser/parserlib.php	2012-04-25 15:06:39 UTC (rev 41100)
+++ branches/9.x/lib/parser/parserlib.php	2012-04-25 15:26:47 UTC (rev 41101)
@@ -28,24 +28,25 @@
 	private $pos_handlers = array();
 	private $postedit_handlers = array();
 
+	var $needDecoded = true;
 	var $isHtmlPurifying = false;
 	var $isEditMode = false;
 
 	//This var is used in both protectSpecialChars and unprotectSpecialChars to simplify the html ouput process
 	var $specialChars = array(
-		&#39;REAL_LT&#39; =&gt; array(
+		&#39;~REAL_LT~&#39; =&gt; array(
 			&#39;html&#39;=&gt;		&#39;&lt;&#39;,
 			&#39;nonHtml&#39;=&gt;		&#39;&amp;lt;&#39;
 		),
-		&#39;REAL_GT&#39; =&gt; array(
+		&#39;~REAL_GT~&#39; =&gt; array(
 			&#39;html&#39;=&gt;		&#39;&gt;&#39;,
 			&#39;nonHtml&#39;=&gt;		&#39;&amp;gt;&#39;
 		),
-		&#39;REAL_NBSP&#39; =&gt; array(
+		&#39;~REAL_NBSP~&#39; =&gt; array(
 			&#39;html&#39;=&gt;		&#39;&amp;nbsp;&#39;,
 			&#39;nonHtml&#39;=&gt;		&#39;&amp;nbsp;&#39;
 		),
-		&#39;REAL_AMP&#39; =&gt; array(
+		&#39;~REAL_AMP~&#39; =&gt; array(
 			&#39;html&#39;=&gt;		&#39;&amp; &#39;,
 			&#39;nonHtml&#39;=&gt;		&#39;&amp; &#39;
 		),
@@ -125,13 +126,31 @@
 		$data = preg_replace(&#34;/~([0-9]+)~/&#34;, &#34;&amp;#$1;&#34;, $data);
 	}
 
+	function prepDataFromDb($data)
+	{
+		if ($this-&gt;needDecoded == true) {
+			$data = htmlspecialchars_decode($data);
+		}
+		return $data;
+	}
+
+	function prepDataToDb($data)
+	{
+		if ($this-&gt;needDecoded == true) {
+			$data = htmlspecialchars($data);
+		}
+		return $data;
+	}
+
 	// This function handles the protection of html entities so that they are not mangled when
 	// parse_htmlchar runs, and as well so they can be properly seen, be it html or non-html
 	function protectSpecialChars($data, $is_html = false, $options = array())
 	{
+		$data = $this-&gt;prepDataFromDb($data);
+
 		if (($this-&gt;isHtmlPurifying == true || $options[&#39;is_html&#39;] != true) || !$options[&#39;ck_editor&#39;]) {
 			foreach($this-&gt;specialChars as $key =&gt; $specialChar) {
-				$data = str_replace($specialChar[&#39;html&#39;], &#34;~&#34; . $key . &#34;~&#34;, $data);
+				$data = str_replace($specialChar[&#39;html&#39;], $key, $data);
 			}
 		}
 		return $data;
@@ -142,11 +161,11 @@
 	{
 		if (($is_html != false || $options[&#39;is_html&#39;]) || $options[&#39;ck_editor&#39;]) {
 			foreach($this-&gt;specialChars as $key =&gt; $specialChar) {
-				$data = str_replace(&#34;~&#34; . $key . &#34;~&#34;, $specialChar[&#39;html&#39;], $data);
+				$data = str_replace($key, $specialChar[&#39;html&#39;], $data);
 			}
 		} else {
 			foreach($this-&gt;specialChars as $key =&gt; $specialChar) {
-				$data = str_replace(&#34;~&#34; . $key . &#34;~&#34;, $specialChar[&#39;nonHtml&#39;], $data);
+				$data = str_replace($key, $specialChar[&#39;nonHtml&#39;], $data);
 			}
 		}
 

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-25 15:06:39 UTC (rev 41100)
+++ branches/9.x/lib/tikilib.php	2012-04-25 15:26:47 UTC (rev 41101)
@@ -3581,7 +3581,7 @@
 		$insertData = array(
 			&#39;pageName&#39; =&gt; $name,
 			&#39;hits&#39; =&gt; (int) $hits,
-			&#39;data&#39; =&gt; $data,
+			&#39;data&#39; =&gt; $parser-&gt;prepDataToDb($data),
 			&#39;description&#39; =&gt; $description,
 			&#39;lastModif&#39; =&gt; (int) $lastModif,
 			&#39;comment&#39; =&gt; $comment,
@@ -3595,7 +3595,6 @@
 			&#39;created&#39; =&gt; empty($created) ? $this-&gt;now : $created,
 			&#39;wysiwyg&#39; =&gt; $wysiwyg,
 			&#39;wiki_authors_style&#39; =&gt; $wiki_authors_style,
-			&#39;status&#39; =&gt; &#39;new9+&#39;
 		);
 		if ($lang) {
 			$insertData[&#39;lang&#39;] = $lang;
@@ -3762,6 +3761,7 @@
 
 			// Be sure to have the correct character case (because DB is caseinsensitive)
 			$pageNameEncode = urlencode($row[&#39;pageName&#39;]);
+			$row[&#39;data&#39;] = TikiLib::lib(&#34;parser&#34;)-&gt;prepDataFromDb($row[&#39;data&#39;]);
 
 			// Limit memory usage of the page cache.  No 
 			// intelligence is attempted here whatsoever.  This was 
@@ -3916,8 +3916,8 @@
 			$edit_data = str_replace(&#39;&lt;x&gt;&#39;, &#39;&#39;, $edit_data);
 		}
 
+		$parserlib = TikiLib::lib(&#39;parser&#39;);
 		if ($html == 1 &amp;&amp; $prefs[&#39;feature_purifier&#39;] != &#39;n&#39;) {
-			$parserlib = TikiLib::lib(&#39;parser&#39;);
 			$parserlib-&gt;isHtmlPurifying = true;
 			$parserlib-&gt;isEditMode = true;
 			$noparsed = array();
@@ -3945,7 +3945,7 @@
 		
 		$queryData = array(
 			&#39;description&#39; =&gt; $edit_description,
-			&#39;data&#39; =&gt; $edit_data,
+			&#39;data&#39; =&gt; $parserlib-&gt;prepDataToDb($edit_data),
 			&#39;comment&#39; =&gt; $edit_comment,
 			&#39;lastModif&#39; =&gt; (int) $saveLastModif,
 			&#39;version&#39; =&gt; $version,

Modified: branches/9.x/lib/wiki/histlib.php
===================================================================
--- branches/9.x/lib/wiki/histlib.php	2012-04-25 15:06:39 UTC (rev 41100)
+++ branches/9.x/lib/wiki/histlib.php	2012-04-25 15:26:47 UTC (rev 41101)
@@ -155,9 +155,9 @@
 	function get_version($page, $version)
 	{
 		//fix for encoded slowly without doing it all at once in the installer upgrade script
-		require_once(&#34;lib/wiki/wikilib.php&#34;);
+		/*require_once(&#34;lib/wiki/wikilib.php&#34;);
 		$converter = new convertPagesToTiki9();
-		$converter-&gt;convertPageHistoryFromPageAndVersion($page, $version);
+		$converter-&gt;convertPageHistoryFromPageAndVersion($page, $version);*/
 
 		$query = &#34;select * from `tiki_history` where `pageName`=? and `version`=?&#34;;
 		$result = $this-&gt;query($query, array($page,$version));

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-25 15:06:39 UTC (rev 41100)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-25 15:26:47 UTC (rev 41101)
@@ -1214,7 +1214,7 @@
 global $wikilib;
 $wikilib = new WikiLib;
 
-
+/*
 class convertPagesToTiki9
 {
 	var $parserlib;
@@ -1420,4 +1420,4 @@
 			&#34;fingerPrintsNew&#34;=&gt;$fingerPrintsNew
 		);
 	}
-}
\ No newline at end of file
+}*/
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29183450">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29183450/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41120] branches/9.x</a></b></div>
      
      <small>From: &lt;xavidp@us...&gt; - 2012-04-26 10:13:34</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41120
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41120&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41120&amp;view=rev</a>
Author:   xavidp
Date:     2012-04-26 10:13:24 +0000 (Thu, 26 Apr 2012)
Log Message:
-----------
[FIX]Added missing link to edit perspectives under the admin menu

Modified Paths:
--------------
    branches/9.x/db/tiki.sql

Added Paths:
-----------
    branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql

Modified: branches/9.x/db/tiki.sql
===================================================================
--- branches/9.x/db/tiki.sql	2012-04-26 08:07:43 UTC (rev 41119)
+++ branches/9.x/db/tiki.sql	2012-04-26 10:13:24 UTC (rev 41120)
@@ -1459,6 +1459,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;, &#39;List Entries&#39;, &#39;tiki-list_kaltura_entries.php&#39;, 952, &#39;feature_kaltura&#39;, &#39;tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos&#39;, &#39;&#39;, 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;, &#39;Upload Media&#39;, &#39;tiki-kaltura_upload.php&#39;, 954, &#39;feature_kaltura&#39;, &#39;tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos&#39;, &#39;&#39;, 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,&#39;Permissions&#39;,&#39;tiki-objectpermissions.php&#39;,1077,&#39;&#39;,&#39;tiki_p_admin|tiki_p_admin_objects&#39;,&#39;&#39;,0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,&#39;Perspectives&#39;,&#39;tiki-edit_perspective.php&#39;,1081,&#39;feature_perspective&#39;,&#39;tiki_p_admin&#39;,&#39;&#39;,0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,&#39;Social networks&#39;,&#39;tiki-socialnetworks.php&#39;,115,&#39;feature_mytiki,feature_socialnetworks&#39;,&#39;tiki_p_socialnetworks|tiki_p_admin_socialnetworks&#39;,&#39;Registered&#39;,0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, &#39;r&#39;, &#39;Invoice&#39;, &#39;tiki-list_invoices.php&#39;, 790, &#39;feature_invoice&#39;, &#39;tiki_p_admin&#39;, &#39;&#39;, 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, &#39;o&#39;, &#39;New Invoice&#39;, &#39;tiki-edit_invoice.php&#39;, 791, &#39;feature_invoice&#39;, &#39;tiki_p_admin&#39;, &#39;&#39;, 0);

Added: branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql	                        (rev 0)
+++ branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql	2012-04-26 10:13:24 UTC (rev 41120)
@@ -0,0 +1 @@
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,&#39;Perspectives&#39;,&#39;tiki-edit_perspective.php&#39;,1081,&#39;feature_perspective&#39;,&#39;tiki_p_admin&#39;,&#39;&#39;,0);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29183949">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29183949/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41120] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@la...&gt; - 2012-04-26 12:13:30</small>
      <div class="attachments">
        <small>
          
            <b>Attachments:</b>
            <a href="/p/tikiwiki/mailman/attachment/CABd-ERG0xVN0gwL8p%2BLiV33P4XbmADa%3D25xsfAin5L28B_hSmQ%40mail.gmail.com/1/">Message as HTML</a>&nbsp;&nbsp;&nbsp;&nbsp;
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>good idea!
On 2012-04-26 6:13 AM, &lt;xavidp@...&gt; wrote:

&gt; Revision: 41120
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41120&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41120&amp;view=rev</a>
&gt; Author:   xavidp
&gt; Date:     2012-04-26 10:13:24 +0000 (Thu, 26 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX]Added missing link to edit perspectives under the admin menu
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/db/tiki.sql
&gt;
&gt; Added Paths:
&gt; -----------
&gt;    branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql
&gt;
&gt; Modified: branches/9.x/db/tiki.sql
&gt; ===================================================================
&gt; --- branches/9.x/db/tiki.sql    2012-04-26 08:07:43 UTC (rev 41119)
&gt; +++ branches/9.x/db/tiki.sql    2012-04-26 10:13:24 UTC (rev 41120)
&gt; @@ -1459,6 +1459,7 @@
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,
&gt; &#39;List Entries&#39;, &#39;tiki-list_kaltura_entries.php&#39;, 952, &#39;feature_kaltura&#39;,
&gt; &#39;tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos&#39;, &#39;&#39;, 0);
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,&#39;o&#39;,
&gt; &#39;Upload Media&#39;, &#39;tiki-kaltura_upload.php&#39;, 954, &#39;feature_kaltura&#39;,
&gt; &#39;tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos&#39;, &#39;&#39;, 0);
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES
&gt; (42,&#39;o&#39;,&#39;Permissions&#39;,&#39;tiki-objectpermissions.php&#39;,1077,&#39;&#39;,&#39;tiki_p_admin|tiki_p_admin_objects&#39;,&#39;&#39;,0);
&gt; +INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES
&gt; (42,&#39;o&#39;,&#39;Perspectives&#39;,&#39;tiki-edit_perspective.php&#39;,1081,&#39;feature_perspective&#39;,&#39;tiki_p_admin&#39;,&#39;&#39;,0);
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES
&gt; (42,&#39;o&#39;,&#39;Social
&gt; networks&#39;,&#39;tiki-socialnetworks.php&#39;,115,&#39;feature_mytiki,feature_socialnetworks&#39;,&#39;tiki_p_socialnetworks|tiki_p_admin_socialnetworks&#39;,&#39;Registered&#39;,0);
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, &#39;r&#39;,
&gt; &#39;Invoice&#39;, &#39;tiki-list_invoices.php&#39;, 790, &#39;feature_invoice&#39;,
&gt; &#39;tiki_p_admin&#39;, &#39;&#39;, 0);
&gt;  INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, &#39;o&#39;,
&gt; &#39;New Invoice&#39;, &#39;tiki-edit_invoice.php&#39;, 791, &#39;feature_invoice&#39;,
&gt; &#39;tiki_p_admin&#39;, &#39;&#39;, 0);
&gt;
&gt; Added:
&gt; branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql
&gt; ===================================================================
&gt; ---
&gt; branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql
&gt;                         (rev 0)
&gt; +++
&gt; branches/9.x/installer/schema/20120426_perspectives_menu_entry_tiki.sql
&gt; 2012-04-26 10:13:24 UTC (rev 41120)
&gt; @@ -0,0 +1 @@
&gt; +INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`,
&gt; `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES
&gt; (42,&#39;o&#39;,&#39;Perspectives&#39;,&#39;tiki-edit_perspective.php&#39;,1081,&#39;feature_perspective&#39;,&#39;tiki_p_admin&#39;,&#39;&#39;,0);
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform,
&gt; the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Live Security Virtual Conference
&gt; Exclusive live event will cover all the ways today&#39;s security and
&gt; threat landscape has changed and how IT managers can respond. Discussions
&gt; will include endpoint security, mobile security and the latest in malware
&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29185635">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29185635/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41125] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-26 18:00:32</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41125
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41125&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41125&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-26 18:00:25 +0000 (Thu, 26 Apr 2012)
Log Message:
-----------
[FIX] Reverting the revert for encoding entities, we&#39;ve gone too far to turn back now.

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/parser/parserlib.php
    branches/9.x/lib/tikilib.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-26 11:00:21 UTC (rev 41124)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-26 18:00:25 UTC (rev 41125)
@@ -32,7 +32,6 @@
 
 function upgrade_999999991_decode_pages_sources_tiki($installer)
 {
-	/*
 	set_time_limit(60 * 60); //1 hours
 	include_once(&#39;tiki-setup_base.php&#39;);
 	include_once (&#39;lib/categories/categlib.php&#39;);	// needed for cat_jail fn in list_pages()
@@ -40,6 +39,6 @@
 
 	$converter = new convertPagesToTiki9();
 	$converter-&gt;convertPages();
-	$converter-&gt;convertModules();*/
+	$converter-&gt;convertModules();
 }
 

Modified: branches/9.x/lib/parser/parserlib.php
===================================================================
--- branches/9.x/lib/parser/parserlib.php	2012-04-26 11:00:21 UTC (rev 41124)
+++ branches/9.x/lib/parser/parserlib.php	2012-04-26 18:00:25 UTC (rev 41125)
@@ -28,7 +28,6 @@
 	private $pos_handlers = array();
 	private $postedit_handlers = array();
 
-	var $needDecoded = true;
 	var $isHtmlPurifying = false;
 	var $isEditMode = false;
 
@@ -126,22 +125,6 @@
 		$data = preg_replace(&#34;/~([0-9]+)~/&#34;, &#34;&amp;#$1;&#34;, $data);
 	}
 
-	function prepDataFromDb($data)
-	{
-		if ($this-&gt;needDecoded == true) {
-			$data = htmlspecialchars_decode($data);
-		}
-		return $data;
-	}
-
-	function prepDataToDb($data)
-	{
-		if ($this-&gt;needDecoded == true) {
-			$data = htmlspecialchars($data);
-		}
-		return $data;
-	}
-
 	// This function handles the protection of html entities so that they are not mangled when
 	// parse_htmlchar runs, and as well so they can be properly seen, be it html or non-html
 	function protectSpecialChars($data, $is_html = false, $options = array())
@@ -1065,11 +1048,7 @@
 			// Tiki 7+ adds ~np~ to plugin output so remove them
 			$plugin_result = preg_replace(&#39;/~[\/]?np~/ms&#39;, &#39;&#39;, $plugin_result);
 
-			// pre-parse the output so nested plugins don&#39;t fall out all over the place
-			$tempNeedDecoded = $this-&gt;needDecoded;
-			$this-&gt;needDecoded = false; //here we are nesting the parser, and we know for sure that we no londer need to decode
 			$plugin_result = $this-&gt;parse_data($plugin_result, array(&#39;is_html&#39; =&gt; false, &#39;suppress_icons&#39; =&gt; true, &#39;ck_editor&#39; =&gt; true, &#39;noparseplugins&#39; =&gt; true));
-			$this-&gt;needDecoded = $tempNeedDecoded; //here decode may have been set to false, we restore it to what it was.
 
 			// remove hrefs and onclicks
 			$plugin_result = preg_replace(&#39;/\shref\=/i&#39;, &#39; tiki_href=&#39;, $plugin_result);
@@ -2686,10 +2665,7 @@
 							}
 						}
 
-						$tempNeedDecoded = $this-&gt;needDecoded;
-						$this-&gt;needDecoded = false; //here we know we no longer need decoded
 						$maketoc = $this-&gt;parse_data($maketoc, array(&#39;noparseplugins&#39; =&gt; true));
-						$this-&gt;needDecoded = $tempNeedDecoded;//here we revert it, it may have been false
 
 						if (preg_match(&#34;/^&lt;ul&gt;/&#34;, $maketoc)) {
 							$maketoc = preg_replace(&#34;/^&lt;ul&gt;/&#34;, &#39;&lt;ul class=&#34;toc&#34;&gt;&#39;, $maketoc);

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-26 11:00:21 UTC (rev 41124)
+++ branches/9.x/lib/tikilib.php	2012-04-26 18:00:25 UTC (rev 41125)
@@ -3581,7 +3581,7 @@
 		$insertData = array(
 			&#39;pageName&#39; =&gt; $name,
 			&#39;hits&#39; =&gt; (int) $hits,
-			&#39;data&#39; =&gt; $parserlib-&gt;prepDataToDb($data),
+			&#39;data&#39; =&gt; $data,
 			&#39;description&#39; =&gt; $description,
 			&#39;lastModif&#39; =&gt; (int) $lastModif,
 			&#39;comment&#39; =&gt; $comment,
@@ -3761,7 +3761,6 @@
 
 			// Be sure to have the correct character case (because DB is caseinsensitive)
 			$pageNameEncode = urlencode($row[&#39;pageName&#39;]);
-			$row[&#39;data&#39;] = TikiLib::lib(&#34;parser&#34;)-&gt;prepDataFromDb($row[&#39;data&#39;]);
 
 			// Limit memory usage of the page cache.  No 
 			// intelligence is attempted here whatsoever.  This was 
@@ -3945,7 +3944,7 @@
 		
 		$queryData = array(
 			&#39;description&#39; =&gt; $edit_description,
-			&#39;data&#39; =&gt; $parserlib-&gt;prepDataToDb($edit_data),
+			&#39;data&#39; =&gt; $edit_data,
 			&#39;comment&#39; =&gt; $edit_comment,
 			&#39;lastModif&#39; =&gt; (int) $saveLastModif,
 			&#39;version&#39; =&gt; $version,

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-26 11:00:21 UTC (rev 41124)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-26 18:00:25 UTC (rev 41125)
@@ -1214,7 +1214,7 @@
 global $wikilib;
 $wikilib = new WikiLib;
 
-/*
+
 class convertPagesToTiki9
 {
 	var $parserlib;
@@ -1222,6 +1222,9 @@
 
 	function __construct()
 	{
+		ini_set(&#39;error_reporting&#39;, E_ALL);
+		ini_set(&#39;display_errors&#39;, 1);
+
 		$this-&gt;parserlib = TikiLib::lib(&#39;parser&#39;);
 		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
 	}
@@ -1311,7 +1314,6 @@
 			if (!empty($info[&#39;data&#39;])) {
 				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
 
-				print_r($converted);
 				$this-&gt;updatePlugins($converted[&#39;fingerPrintsOld&#39;], $converted[&#39;fingerPrintsNew&#39;]);
 
 				$this-&gt;saveModule($info[&#39;name&#39;], $converted[&#39;data&#39;]);
@@ -1339,7 +1341,6 @@
 
 	function saveModule($name, $data)
 	{
-		print_r(array($data, $name));
 		TikiLib::query(&#34;
 			UPDATE tiki_user_modules
 			SET data = ?, status = &#39;conv9&#39;
@@ -1373,8 +1374,7 @@
 		$matches = WikiParser_PluginMatcher::match($data);
 
 		$replaced = array();
-		ini_set(&#39;error_reporting&#39;, E_ALL);
-		ini_set(&#39;display_errors&#39;, 1);
+
 		$fingerPrintsOld = array();
 		foreach ($oldMatches as $match) {
 			$name = $match-&gt;getName();
@@ -1384,7 +1384,7 @@
 
 			$fingerPrintsOld[] = $this-&gt;parserlib-&gt;plugin_fingerprint($name, $meta, $body, $args);
 		}
-		echo $data;
+
 		$fingerPrintsNew = array();
 		foreach ($matches as $match) {							// each plugin
 			$name = $match-&gt;getName();
@@ -1420,4 +1420,4 @@
 			&#34;fingerPrintsNew&#34;=&gt;$fingerPrintsNew
 		);
 	}
-}*/
\ No newline at end of file
+}
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29185925">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29185925/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41127] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-26 19:12:02</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41127
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41127&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41127&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-26 19:11:56 +0000 (Thu, 26 Apr 2012)
Log Message:
-----------
[ENH] Rather than adding a new column for tracking status, added a new table &#39;tiki_db_object_status&#39; this will affectivly allow us to track status of objects through the conversion cycle

Modified Paths:
--------------
    branches/9.x/db/tiki.sql
    branches/9.x/db/tiki_convert_myisam_to_innodb.sql
    branches/9.x/lib/wiki/wikilib.php

Added Paths:
-----------
    branches/9.x/installer/schema/20120426_tiki_db_status_tiki.sql

Modified: branches/9.x/db/tiki.sql
===================================================================
--- branches/9.x/db/tiki.sql	2012-04-26 18:09:37 UTC (rev 41126)
+++ branches/9.x/db/tiki.sql	2012-04-26 19:11:56 UTC (rev 41127)
@@ -3681,3 +3681,13 @@
     `perspectives` text,
     KEY `categId` (`categId`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS
+CREATE TABLE `tiki_db_status` (
+  `id` int(11) NOT NULL AUTO_INCREMENT,
+  `objectId` varchar(100) NOT NULL,
+  `tableName` varchar(100) NOT NULL,
+  `status` varchar(100) NOT NULL,
+  `other` varchar(100) DEFAULT NULL,
+  PRIMARY KEY (`id`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file

Modified: branches/9.x/db/tiki_convert_myisam_to_innodb.sql
===================================================================
--- branches/9.x/db/tiki_convert_myisam_to_innodb.sql	2012-04-26 18:09:37 UTC (rev 41126)
+++ branches/9.x/db/tiki_convert_myisam_to_innodb.sql	2012-04-26 19:11:56 UTC (rev 41127)
@@ -261,3 +261,4 @@
 ALTER TABLE `tiki_source_auth` ENGINE=InnoDB;
 ALTER TABLE `tiki_connect` ENGINE=InnoDB;
 ALTER TABLE `tiki_areas` ENGINE=InnoDB;
+ALTER TABLE `tiki_db_status` ENGINE=InnoDB;
\ No newline at end of file

Added: branches/9.x/installer/schema/20120426_tiki_db_status_tiki.sql
===================================================================
--- branches/9.x/installer/schema/20120426_tiki_db_status_tiki.sql	                        (rev 0)
+++ branches/9.x/installer/schema/20120426_tiki_db_status_tiki.sql	2012-04-26 19:11:56 UTC (rev 41127)
@@ -0,0 +1,8 @@
+CREATE TABLE IF NOT EXISTS `tiki_db_status` (
+  `id` int(11) NOT NULL AUTO_INCREMENT,
+  `objectId` varchar(100) NOT NULL,
+  `tableName` varchar(100) NOT NULL,
+  `status` varchar(100) NOT NULL,
+  `other` varchar(100) DEFAULT NULL,
+  PRIMARY KEY (`id`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-26 18:09:37 UTC (rev 41126)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-26 19:11:56 UTC (rev 41127)
@@ -1229,33 +1229,19 @@
 		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
 	}
 
-	function addStatus()
-	{
-		$dbs_tiki = &#39;&#39;;
 
-		require (&#39;db/local.php&#39;);
-
-		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_pages&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
-		if (empty($statusExists)) {
-			TikiLib::query(&#34;ALTER TABLE tiki_pages ADD status VARCHAR(60) default &#39;&#39; AFTER keywords;&#34;);
-		}
-
-		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_history&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
-		if (empty($statusExists)) {
-			TikiLib::query(&#34;ALTER TABLE tiki_history ADD status VARCHAR(60) default &#39;&#39; AFTER is_html;&#34;);
-		}
-
-		$statusExists = TikiLib::fetchAll(&#34;SELECT * FROM information_schema.COLUMNS WHERE table_schema = ? AND table_name = &#39;tiki_user_modules&#39; AND column_name = &#39;status&#39;&#34;, array($dbs_tiki));
-		if (empty($statusExists)) {
-			TikiLib::query(&#34;ALTER TABLE tiki_user_modules ADD status VARCHAR(60) default &#39;&#39; AFTER parse;&#34;);
-		}
-	}
-
+	//&lt;!--below methods are used for converting objects
+		//&lt;!--Start for converting pages
 	function convertPages()
 	{
-		$this-&gt;addStatus();
 		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
-		$infos = TikiLib::fetchAll(&#39;SELECT data, page_id FROM tiki_pages WHERE status &lt;&gt; &#34;conv9&#34; AND status &lt;&gt; &#34;new9+&#34;&#39;);
+		$infos = TikiLib::fetchAll(&#39;
+			SELECT data, page_id
+			FROM tiki_pages
+			LEFT JOIN tiki_db_status
+				ON tiki_db_status.objectId = tiki_pages.page_id
+			WHERE tiki_db_status.tableName = &#34;tiki_pages&#34; IS NULL
+		&#39;);
 
 		foreach($infos as $info) {
 			if (!empty($info[&#39;data&#39;])) {
@@ -1268,12 +1254,33 @@
 		}
 	}
 
+	function savePage($id, $data)
+	{
+		$status = $this-&gt;checkObjectStatus($id, &#39;tiki_pages&#39;);
+
+		if (empty($status)) {
+			TikiLib::query(&#34;UPDATE tiki_pages SET data = ? WHERE page_id = ?&#34;, array($data, $id));
+
+			$this-&gt;saveObjectStatus($id, &#39;tiki_pages&#39;);
+		}
+	}
+		//end for converting pages--&gt;
+
+
+
+		//&lt;!--start for converting histories
 	function convertPageHistoryFromPageAndVersion($page, $version)
 	{
-		$this-&gt;addStatus();
+		$infos = TikiLib::fetchAll(&#39;
+			SELECT data, historyId
+			FROM tiki_history
+			LEFT JOIN tiki_db_status
+				ON tiki_db_status.objectId = tiki_history.historyId
+			WHERE tiki_db_status.tableName = &#34;tiki_history&#34; IS NULL
+			AND pageName = ?
+			AND version = ?
+		&#39;, array($page, $version));
 
-		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history WHERE status &lt;&gt; &#34;conv9&#34; AND status &lt;&gt; &#34;new9+&#34; AND pageName = ? AND version = ?&#39;, array($page, $version));
-
 		foreach($infos as $info) {
 			if (!empty($info[&#39;data&#39;])) {
 				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
@@ -1288,10 +1295,14 @@
 
 	function convertPageHistories()
 	{
-		$this-&gt;addStatus();
-
 		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
-		$infos = TikiLib::fetchAll(&#39;SELECT data, historyId FROM tiki_history WHERE status &lt;&gt; &#34;conv9&#34; AND status &lt;&gt; &#34;new9+&#34;&#39;);
+		$infos = TikiLib::fetchAll(&#39;
+			SELECT data, historyId
+			FROM tiki_history
+			LEFT JOIN tiki_db_status
+				ON tiki_db_status.objectId = tiki_history.historyId
+			WHERE tiki_db_status.tableName = &#34;tiki_history&#34; IS NULL
+		&#39;);
 
 		foreach($infos as $info) {
 			if (!empty($info[&#39;data&#39;])) {
@@ -1304,12 +1315,35 @@
 		}
 	}
 
+	function savePageHistory($id, $data)
+	{
+		$status = $this-&gt;checkObjectStatus($id, &#39;tiki_history&#39;);
+
+		if (empty($status)) {
+			TikiLib::query(&#34;
+				UPDATE tiki_history
+				SET data = ?, status = &#39;conv9&#39;
+				WHERE historyId = ?
+				&#34;, array($data, $id));
+
+			$this-&gt;saveObjectStatus($id, &#39;tiki_history&#39;);
+		}
+	}
+		//end for converting histories--&gt;
+
+
+
+		//&lt;!--start for converting modules
 	function convertModules()
 	{
-		$this-&gt;addStatus();
+		$infos = TikiLib::fetchAll(&#39;
+			SELECT data, name
+			FROM tiki_user_modules
+			LEFT JOIN tiki_db_status
+				ON tiki_db_status.objectId = tiki_user_modules.name
+			WHERE tiki_db_status.tableName = &#34;tiki_user_modules&#34; IS NULL
+		&#39;);
 
-		$infos = TikiLib::fetchAll(&#39;SELECT data, name FROM tiki_user_modules WHERE status &lt;&gt; &#34;conv9&#34; AND status &lt;&gt; &#34;new9+&#34;&#39;);
-
 		foreach($infos as $info) {
 			if (!empty($info[&#39;data&#39;])) {
 				$converted = $this-&gt;convertData($info[&#39;data&#39;]);
@@ -1321,33 +1355,45 @@
 		}
 	}
 
-	function savePage($id, $data)
+	function saveModule($name, $data)
 	{
-		TikiLib::query(&#34;
-			UPDATE tiki_pages
-			SET data = ?, status = &#39;conv9&#39;
-			WHERE page_id = ? AND status &lt;&gt; &#39;conv9&#39; AND status &lt;&gt; &#39;new9+&#39;
-			&#34;, array($data, $id));
+		$status = $this-&gt;checkObjectStatus($name, &#39;tiki_user_modules&#39;);
+
+		if (empty($status)) {
+			TikiLib::query(&#34;UPDATE tiki_user_modules SET data = ?, status = &#39;conv9&#39; WHERE name = ?&#34;, array($data, $name));
+
+			$this-&gt;saveObjectStatus($name, &#39;tiki_user_modules&#39;);
+		}
 	}
+		//end for converting modules--&gt;
+	//end conversion of objects--&gt;
 
-	function savePageHistory($id, $data)
+
+
+	//&lt;!--below methods are used in tracking status of pages
+	function saveObjectStatus($objectId, $tableName, $status = &#39;new9+&#39;)
 	{
 		TikiLib::query(&#34;
-			UPDATE tiki_history
-			SET data = ?, status = &#39;conv9&#39;
-			WHERE historyId = ? AND status &lt;&gt; &#39;conv9&#39; AND status &lt;&gt; &#39;new9+&#39;
-			&#34;, array($data, $id));
+			INSERT INTO tiki_db_status
+			 		( objectId,	tableName,	status )
+			 VALUES (?,			?,			?)
+			&#34;, array(
+				$objectId, 	$tableName,	$status
+		));
 	}
 
-	function saveModule($name, $data)
+	function checkObjectStatus($objectId, $tableName)
 	{
-		TikiLib::query(&#34;
-			UPDATE tiki_user_modules
-			SET data = ?, status = &#39;conv9&#39;
-			WHERE name = ? AND status &lt;&gt; &#39;conv9&#39; AND status &lt;&gt; &#39;new9+&#39;
-			&#34;, array($data, $name));
+		return TikiLib::getOne(&#34;
+			SELECT status
+			FROM tiki_db_status
+			WHERE objectId = ? AND tableName = ?
+		&#34;,array($objectId, $tableName));
 	}
+	//end status methods--&gt;
 
+
+	//&lt;!--below methods are used for conversion of plugins and data
 	function updatePlugins($fingerPrintsOld, $fingerPrintsNew)
 	{
 		//here we find the old fingerprint and replace it with the new one
@@ -1420,4 +1466,6 @@
 			&#34;fingerPrintsNew&#34;=&gt;$fingerPrintsNew
 		);
 	}
+
+	//end conversion methods--&gt;
 }
\ No newline at end of file

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29186450">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29186450/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41131] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-26 21:22:10</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41131
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41131&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41131&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-26 21:22:04 +0000 (Thu, 26 Apr 2012)
Log Message:
-----------
[FIX] Changed name of class from convertPagesToTiki9 to convertToTiki9 to be more fitting, added a fix to how modules are updated and how statuses are updated, also added in a status updates to update_page and create_page

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/tikilib.php
    branches/9.x/lib/wiki/histlib.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-26 20:57:16 UTC (rev 41130)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-04-26 21:22:04 UTC (rev 41131)
@@ -37,7 +37,7 @@
 	include_once (&#39;lib/categories/categlib.php&#39;);	// needed for cat_jail fn in list_pages()
 	include_once(&#39;lib/wiki/wikilib.php&#39;);
 
-	$converter = new convertPagesToTiki9();
+	$converter = new convertToTiki9();
 	$converter-&gt;convertPages();
 	$converter-&gt;convertModules();
 }

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-26 20:57:16 UTC (rev 41130)
+++ branches/9.x/lib/tikilib.php	2012-04-26 21:22:04 UTC (rev 41131)
@@ -3627,6 +3627,11 @@
 		$pages = $this-&gt;table(&#39;tiki_pages&#39;);
 		$page_id = $pages-&gt;insert($insertData);
 
+		//update status, page storage was updated in tiki 9 to be non html encoded
+		require_once(&#39;lib/wiki/wikilib.php&#39;);
+		$converter = new convertToTiki9();
+		$converter-&gt;saveObjectStatus($page_id, &#39;tiki_pages&#39;);
+
 		$this-&gt;replicate_page_to_history($name);
 
 		$this-&gt;clear_links($name);
@@ -3989,6 +3994,11 @@
 
 		$this-&gt;table(&#39;tiki_pages&#39;)-&gt;update($queryData, array(&#39;pageName&#39; =&gt; $pageName));
 
+		//update status, page storage was updated in tiki 9 to be non html encoded
+        require_once(&#39;lib/wiki/wikilib.php&#39;);
+		$converter = new convertToTiki9();
+		$converter-&gt;saveObjectStatus($this-&gt;getOne(&#34;SELECT page_id FROM tiki_pages WHERE pageName = ?&#34;, array($pageName)), &#39;tiki_pages&#39;);
+
 		// Parse edit_data updating the list of links from this page
 		$this-&gt;clear_links($pageName);
 

Modified: branches/9.x/lib/wiki/histlib.php
===================================================================
--- branches/9.x/lib/wiki/histlib.php	2012-04-26 20:57:16 UTC (rev 41130)
+++ branches/9.x/lib/wiki/histlib.php	2012-04-26 21:22:04 UTC (rev 41131)
@@ -156,7 +156,7 @@
 	{
 		//fix for encoded slowly without doing it all at once in the installer upgrade script
 		require_once(&#34;lib/wiki/wikilib.php&#34;);
-		$converter = new convertPagesToTiki9();
+		$converter = new convertToTiki9();
 		$converter-&gt;convertPageHistoryFromPageAndVersion($page, $version);
 
 		$query = &#34;select * from `tiki_history` where `pageName`=? and `version`=?&#34;;

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-04-26 20:57:16 UTC (rev 41130)
+++ branches/9.x/lib/wiki/wikilib.php	2012-04-26 21:22:04 UTC (rev 41131)
@@ -1215,16 +1215,13 @@
 $wikilib = new WikiLib;
 
 
-class convertPagesToTiki9
+class convertToTiki9
 {
 	var $parserlib;
 	var $argumentParser;
 
 	function __construct()
 	{
-		ini_set(&#39;error_reporting&#39;, E_ALL);
-		ini_set(&#39;display_errors&#39;, 1);
-
 		$this-&gt;parserlib = TikiLib::lib(&#39;parser&#39;);
 		$this-&gt;argumentParser = new WikiParser_PluginArgumentParser();
 	}
@@ -1261,7 +1258,7 @@
 		if (empty($status)) {
 			TikiLib::query(&#34;UPDATE tiki_pages SET data = ? WHERE page_id = ?&#34;, array($data, $id));
 
-			$this-&gt;saveObjectStatus($id, &#39;tiki_pages&#39;);
+			$this-&gt;saveObjectStatus($id, &#39;tiki_pages&#39;, &#39;conv9.0&#39;);
 		}
 	}
 		//end for converting pages--&gt;
@@ -1322,11 +1319,11 @@
 		if (empty($status)) {
 			TikiLib::query(&#34;
 				UPDATE tiki_history
-				SET data = ?, status = &#39;conv9&#39;
+				SET data = ?
 				WHERE historyId = ?
 				&#34;, array($data, $id));
 
-			$this-&gt;saveObjectStatus($id, &#39;tiki_history&#39;);
+			$this-&gt;saveObjectStatus($id, &#39;tiki_history&#39;, &#39;conv9.0&#39;);
 		}
 	}
 		//end for converting histories--&gt;
@@ -1360,9 +1357,9 @@
 		$status = $this-&gt;checkObjectStatus($name, &#39;tiki_user_modules&#39;);
 
 		if (empty($status)) {
-			TikiLib::query(&#34;UPDATE tiki_user_modules SET data = ?, status = &#39;conv9&#39; WHERE name = ?&#34;, array($data, $name));
+			TikiLib::query(&#39;UPDATE tiki_user_modules SET data = ? WHERE name = ?&#39;, array($data, $name));
 
-			$this-&gt;saveObjectStatus($name, &#39;tiki_user_modules&#39;);
+			$this-&gt;saveObjectStatus($name, &#39;tiki_user_modules&#39;, &#39;conv9.0&#39;);
 		}
 	}
 		//end for converting modules--&gt;
@@ -1371,15 +1368,29 @@
 
 
 	//&lt;!--below methods are used in tracking status of pages
-	function saveObjectStatus($objectId, $tableName, $status = &#39;new9+&#39;)
+	function saveObjectStatus($objectId, $tableName, $status = &#39;new9.0+&#39;)
 	{
-		TikiLib::query(&#34;
-			INSERT INTO tiki_db_status
-			 		( objectId,	tableName,	status )
-			 VALUES (?,			?,			?)
+		$currentStatus = TikiLib::getOne(&#34;SELECT status FROM tiki_db_status WHERE objectId = ? AND tableName = ?&#34;, array($objectId, $tableName));
+
+		if (empty($currentStatus)) {
+			//Insert a status record if one doesn&#39;t exist
+			TikiLib::query(&#34;
+				INSERT INTO tiki_db_status
+				        ( objectId,	tableName,	status )
+				 VALUES (?,			?,			?)
+				&#34;, array(
+					$objectId, 	$tableName,	$status
+			));
+		} else {
+			//update a status record, it already exists
+			TikiLib::query(&#34;
+				UPDATE tiki_db_status
+				SET status = ?
+				WHERE objectId = ? AND tableName = ?
 			&#34;, array(
-				$objectId, 	$tableName,	$status
-		));
+				$status, $objectId, $tableName
+			));
+		}
 	}
 
 	function checkObjectStatus($objectId, $tableName)

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29196593">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29196593/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41177] branches/9.x</a></b></div>
      
      <small>From: &lt;lphuberdeau@us...&gt; - 2012-04-29 17:12:52</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41177
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41177&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41177&amp;view=rev</a>
Author:   lphuberdeau
Date:     2012-04-29 17:12:42 +0000 (Sun, 29 Apr 2012)
Log Message:
-----------
[FIX] Improve provisional password generation, uses the phpsec fork from <a href="https://github.com/ph-il/phpSec" rel="nofollow">https://github.com/ph-il/phpSec</a> until the last patch is integrated in mainline

Modified Paths:
--------------
    branches/9.x/lib/tikilib.php
    branches/9.x/lib/userslib.php
    branches/9.x/templates/mail/password_reminder.tpl

Added Paths:
-----------
    branches/9.x/lib/phpsec/
    branches/9.x/lib/phpsec/.gitignore
    branches/9.x/lib/phpsec/CHANGELOG.md
    branches/9.x/lib/phpsec/LICENSE
    branches/9.x/lib/phpsec/README.md
    branches/9.x/lib/phpsec/phpsec/
    branches/9.x/lib/phpsec/phpsec/phpsec.cache.php
    branches/9.x/lib/phpsec/phpsec/phpsec.crypt.php
    branches/9.x/lib/phpsec/phpsec/phpsec.filter.php
    branches/9.x/lib/phpsec/phpsec/phpsec.hash.php
    branches/9.x/lib/phpsec/phpsec/phpsec.otp.php
    branches/9.x/lib/phpsec/phpsec/phpsec.otpcard.php
    branches/9.x/lib/phpsec/phpsec/phpsec.pw.php
    branches/9.x/lib/phpsec/phpsec/phpsec.rand.php
    branches/9.x/lib/phpsec/phpsec/phpsec.session.php
    branches/9.x/lib/phpsec/phpsec/phpsec.store.filesystem.php
    branches/9.x/lib/phpsec/phpsec/phpsec.store.pdo.php
    branches/9.x/lib/phpsec/phpsec/phpsec.store.php
    branches/9.x/lib/phpsec/phpsec/phpsec.token.php
    branches/9.x/lib/phpsec/phpsec/phpsec.yubikey.php
    branches/9.x/lib/phpsec/phpsec.class.php

Added: branches/9.x/lib/phpsec/.gitignore
===================================================================
--- branches/9.x/lib/phpsec/.gitignore	                        (rev 0)
+++ branches/9.x/lib/phpsec/.gitignore	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,5 @@
+/data
+/logs
+/.project
+/examples.php
+/nbproject
\ No newline at end of file

Added: branches/9.x/lib/phpsec/CHANGELOG.md
===================================================================
--- branches/9.x/lib/phpsec/CHANGELOG.md	                        (rev 0)
+++ branches/9.x/lib/phpsec/CHANGELOG.md	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,105 @@
+phpSec changelog
+================
+
+beta-0.4
+--------
+* [#83] Added class phpsecOtpcard and moved PS OTP functionality from phpsecOtp
+   to it.
+* [#84, #85] Improvements to phpsecOtp.
+
+beta-0.3: January 4. 2012 - xqus
+--------------------------------
+* [#66] phpSec can now run without storage configured.
+* [#58] phpsecCrypt now pads data by default.
+* [#81] phpsecPw now supports PBKDF2, and uses it as default.
+* Added new password hashing class: phpsecHash. phpsecPw should not be used
+  anymore.
+* Fixed phpsecFilter::f().
+
+beta-0.2: December 21. 2011 - xqus
+----------------------------------
+* [#43] Implemented PKCS7 padding in phpsecCrypt.
+* [#62] Added phpsec::arrayCheck().
+* [#63] Improved checking of json data passed to phpSec.
+* Fixed call to error method in phpsecPw::check()
+* [#51] phpsecPw now uses a binary salts.
+* phpsecPw::age() removed.
+* [#50] Session handler now uses a binary key to encrypt session data.
+* [#42] Added mySQL support.
+* Yubikey integration not considered experimental anymore.
+  * [#48, #49] Improvements of the Yubikey integration.
+  * [#75] Fixed: phpsecYubikey::getYubikeyId() could retrive wrong ID.
+  * [#76] Fixed: phpsecYubikey::validOtp() to strict.
+  * [#74] Fixed: phpsecYubikey::getResponse(): Number of attempts and timeout
+          should be possible to configure.
+
+
+beta-0.1: November 7. 2011 - xqus
+---------------------------------
+* [#33, #34]phpsec::f() is now phpsec::t(), and phpsec::f() is a simple XSS
+  filter method.
+* Removed the examples.php from source. See the online manual for examples:
+  <a href="http://phpsec.xqus.com/manual" rel="nofollow">http://phpsec.xqus.com/manual</a>
+* Don&#39;t use session_regenerate_id() anymore, since it causes many bugs.
+* Generate a stronger PHP session ID.
+* [#30] Improve session hijacking protection.
+* Improved the password hashing methods.
+* Changed default encryption algorithm to RIJNDAEL-256.
+* Added implemention of PBKDF2 as described in RFC 2898.
+* Create a PBKDF2 MAC to ensure message integrity in phpsecCrypt. This breaks
+  compability with older versions of phpSec.
+* [#37] phpsecCrypt don&#39;t modify the encryption key anymore.
+* Regenerate session ID in custom session handler.
+* Stronger keys for encryption of session.
+* Better error handling in phpSecCrypt.
+* [#38] Storage class for general data storage for all sub-classes.
+* [#41] Separate password, token and filter methods from core.
+* Many minor fixes..
+
+alpha-0.0.5: August 14. 2011 - xqus
+-----------------------------------
+* Added phpsecRand::arrayRand(): Method to select random keys from an array.
+* Fixed bug in key generation method in phpsecCrypt().
+  This means that data encrypted with phpSec alpha-0.0.4 and older will not
+  decrypt in this version.
+
+alpha-0.0.4: July 11. 2011 - xqus
+---------------------------------
+* [#25] Empty CSRF token creates hickups.
+* Added initial GPG/PGP support. Still experimental.
+* Added phpsecLog class to add better logging support.
+  This means that phpsec::init() has to be called before setting the log dir:
+  phpsecLog::$_logdir = &#39;filesystem:/var/www/phpSec/logs&#39;;
+  Also phpsec::log() is now phpsecLog::log().
+* Added syslog support to phpsecLog.
+* phpsec::f() now accepts strings a array of data to filter.
+* Improved error handling.
+* phpsecCrypt::encrypt() performance improvements.
+* Greatly improved key generation security in phpsecCrypt().
+  This means that data encrypted with phpSec alpha-0.0.3 and older will not
+  decrypt in this version.
+
+alpha-0.0.3: March 9. 2011 - xqus
+---------------------------------
+* [#21] Use of phpSec session handler is now optional.
+* [#17] phpsec::pwHash() now returns a JSON encoded array.
+* Added Yubikey integration. See <a href="https://github.com/xqus/phpSec/wiki/Yubikey" rel="nofollow">https://github.com/xqus/phpSec/wiki/Yubikey</a>
+* Added &amp;type variables to phpsec::f().
+* Many minor fixes..
+
+alpha-0.0.2: February 5. 2011 - xqus
+------------------------------------
+* The library is no longer automatically initialized.
+  You now need to call phpsec::init().
+* Added encryption functions.
+* Added random functions.
+* Separated the library into smaller files.
+* Added session encryption.
+* Many minor changes..
+
+Prealpha 0.0.1: January 16. 2011 - xqus
+---------------------------------------
+
+January 8. 2011 - xqus
+----------------------
+* First code written.

Added: branches/9.x/lib/phpsec/LICENSE
===================================================================
--- branches/9.x/lib/phpsec/LICENSE	                        (rev 0)
+++ branches/9.x/lib/phpsec/LICENSE	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,19 @@
+Copyright (c) 2011 Audun Larsen &lt;larsen@...&gt;
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the &#34;Software&#34;), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
\ No newline at end of file

Added: branches/9.x/lib/phpsec/README.md
===================================================================
--- branches/9.x/lib/phpsec/README.md	                        (rev 0)
+++ branches/9.x/lib/phpsec/README.md	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,38 @@
+phpSec - PHP security library
+=============================
+* phpSec is a open-source [PHP](<a href="http://php.net" rel="nofollow">http://php.net</a>) security library that takes care
+  of the common security tasks a web developer faces.
+
+Features
+--------
+* Data encryption
+* XSS filter
+* Password hashing
+* Secure session handler
+* CSRF protection
+* Yubikey integration
+* Random data generator
+
+
+Getting started
+---------------
+For more information on installation and usage, please check out the
+[phpSec manual](<a href="http://phpseclib.com/manual" rel="nofollow">http://phpseclib.com/manual</a>).
+
+System requirements
+-------------------
+PHP 5.3.0 or greater with the following extensions is required to use phpSec:
+
+* Mcrypt
+* Hash
+
+
+Getting help
+------------
+If you need any help with using phpSec or need to report a bug/security issue or you
+want to request a new feature please use the [phpSec issues](<a href="https://github.com/phpsec/phpSec/issues" rel="nofollow">https://github.com/phpsec/phpSec/issues</a>).
+
+Support phpSec
+--------------
+If you like phpSec please consider a small donation of [bitcoins](<a href="http://bitcoin.org" rel="nofollow">http://bitcoin.org</a>) to:
+173kCNeud3BrTY4mQnAiC6jqsTfvbpXfhM
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.cache.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.cache.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.cache.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,102 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides us with simple cahce engine.
+ * Only intended for use by phpSec, but feel free to use
+ * it if you want.
+ */
+class phpsecCache {
+
+  const GC_PROB   = 0.2;
+  const HASH_TYPE = &#39;sha256&#39;;
+
+  /**
+   * Save data to the cache.
+   *
+   * @param string $name
+   *   String containing the name of the data to save.
+   *
+   * @param mixed $data
+   *   Data to save. Can be any dataform.
+   *
+   * @param integer $ttl
+   *   Time to live in seconds.
+   */
+  public static function cacheSet($name, $data, $ttl = 3600) {
+    $saveData[&#39;data&#39;] = serialize($data);
+    $saveData[&#39;ttl&#39;]  = time() + $ttl;
+
+    return phpsec::$store-&gt;write(&#39;cache&#39;, self::cacheId($name), $saveData);
+
+  }
+
+  /**
+   * Get data from the cache.
+   *
+   * @param string $name
+   *   String containing the name of the data to get.
+   *
+   * @return mixed
+   *   Returns data in it&#39;s original form, or false if no data stored.
+   */
+  public static function cacheGet($name) {
+    /* Do cache garbage collection. */
+    self::cacheGc();
+
+    $data = phpsec::$store-&gt;read(&#39;cache&#39;, self::cacheId($name));
+    if($data ==! false) {
+      if($data[&#39;ttl&#39;] &gt; time()) {
+        return unserialize($data[&#39;data&#39;]);
+      } else {
+        phpsec::$store-&gt;delete(&#39;cache&#39;, self::cacheId($name));
+      }
+    }
+    return false;
+  }
+
+  /**
+   * Remove data from the cache.
+   *
+   * @param string $name
+   *   String containing the name of the data to remove.
+   *
+   * @return boolean
+   *   True on success, false otherwise.
+   */
+  public static function cacheRem($name) {
+    return phpsec::$store-&gt;delete(&#39;cache&#39;, self::cacheId($name));
+  }
+
+  /**
+   * Do garbage collection on cached data.
+   */
+  private static function cacheGc() {
+    $probMax = 1 / self::GC_PROB;
+    $do = rand(1, $probMax);
+    if($do &gt; 1) {
+      /* Skipping GC this time. */
+      return false;
+    }
+    $cahceIds = phpsec::$store-&gt;listIds(&#39;cache&#39;);
+    foreach($cahceIds as $cahceId) {
+      $data = phpsec::$store-&gt;read(&#39;cache&#39;, $cahceId);
+      if($data[&#39;ttl&#39;] &lt; time()) {
+        phpsec::$store-&gt;delete(&#39;cache&#39;, $cahceId);
+      }
+    }
+    return true;
+  }
+
+  private static function cacheId($name) {
+    return $name.&#39;_&#39;.hash(self::HASH_TYPE, phpsec::$uid);
+  }
+}

Added: branches/9.x/lib/phpsec/phpsec/phpsec.crypt.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.crypt.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.crypt.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,232 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides methods for encrypting data.
+ */
+class phpsecCrypt {
+  public static $_algo    = &#39;rijndael-256&#39;;
+  public static $_mode    = &#39;ctr&#39;;
+  public static $_padding = true;
+
+
+  const HASH_TYPE = &#39;sha256&#39;;
+
+  /**
+   * Encrypt data returning a JSON encoded array safe for storage in a database
+   * or file. The array has the following structure before it is encoded:
+   * array(
+   *   &#39;cdata&#39; =&gt; &#39;Encrypted data, Base 64 encoded&#39;,
+   *   &#39;iv&#39;    =&gt; &#39;Base64 encoded IV&#39;,
+   *   &#39;algo&#39;  =&gt; &#39;Algorythm used&#39;,
+   *   &#39;mode&#39;  =&gt; &#39;Mode used&#39;,
+   *   &#39;mac&#39;   =&gt; &#39;Message Authentication Code&#39;
+   * )
+   *
+   * @param mixed $data
+   *   Data to encrypt.
+   *
+   * @param string $key
+   *   Key to encrypt data with.
+   *
+   * @return string
+   *   Serialized array containing the encrypted data along with some meta data.
+   */
+  public static function encrypt($data, $key) {
+
+    $td = mcrypt_module_open(self::$_algo, &#39;&#39;, self::$_mode, &#39;&#39;);
+
+    /* Check key size. */
+    $keySize = strlen($key);
+    $keySizes = mcrypt_enc_get_supported_key_sizes($td);
+    if(count($keySizes) &gt; 0) {
+      /* Encryption method requires a specific key size. */
+      if(!in_array($keySize, $keySizes)) {
+        phpsec::error(&#39;Key is out of range. Should be one of: &#39;. var_export($keySizes ,1));
+        return false;
+      }
+    } else {
+      /* No spsecific size is needed. */
+      if($keySize == 0 || $keySize &gt; mcrypt_enc_get_key_size($td)) {
+        phpsec::error(&#39;Key is out of range. Should be: 1 - &#39; . mcrypt_enc_get_key_size($td).&#39; bytes.&#39;);
+        return false;
+      }
+    }
+
+    /* Create IV. */
+    $iv = phpsecRand::bytes(mcrypt_enc_get_iv_size($td));
+
+    /* Init mcrypt. */
+    mcrypt_generic_init($td, $key, $iv);
+
+    /* Prepeare the array with data. */
+    $serializedData = serialize($data);
+
+    /* Add padding if enabled. */
+    if(self::$_padding === true) {
+      $block = mcrypt_enc_get_block_size($td);
+      $serializedData = self::pad($block, $serializedData);
+    }
+
+    $encrypted[&#39;algo&#39;]  = self::$_algo;                                        /* Algorithm used to encrypt. */
+    $encrypted[&#39;mode&#39;]  = self::$_mode;                                        /* Algorithm mode. */
+    $encrypted[&#39;iv&#39;]    = base64_encode($iv);                                  /* Initialization vector, just a bunch of randomness. */
+    $encrypted[&#39;cdata&#39;] = base64_encode(mcrypt_generic($td, $serializedData)); /* The encrypted data. */
+    $encrypted[&#39;mac&#39;]   = base64_encode(                                       /* The message authentication code. Used to make sure the */
+                            self::pbkdf2($encrypted[&#39;cdata&#39;], $key, 1000, 32)  /* message is valid when decrypted. */
+                          );
+
+    return json_encode($encrypted);
+  }
+
+  /**
+   * Strip PKCS7 padding and decrypt
+   * data encrypted by encrypt().
+   *
+   * @param string $data
+   *   JSON string containing the encrypted data and meta information in the
+   *   excact format as returned by encrypt().
+   *
+   * @return mixed
+   *   Decrypted data in it&#39;s original form.
+   */
+  public static function decrypt($data, $key) {
+
+    /* Decode the JSON string */
+    $data = json_decode($data, true);
+
+    $dataStructure = array(
+      &#39;algo&#39;  =&gt; true,
+      &#39;mode&#39;  =&gt; true,
+      &#39;iv&#39;    =&gt; true,
+      &#39;cdata&#39; =&gt; true,
+      &#39;mac&#39;   =&gt; true,
+    );
+
+    if($data === NULL || phpsec::arrayCheck($data, $dataStructure) !== true) {
+      phpsec::error(&#39;Invalid data passed to decrypt()&#39;);
+      return false;
+    }
+    /* Everything looks good so far. Let&#39;s continue.*/
+    $td = mcrypt_module_open($data[&#39;algo&#39;], &#39;&#39;, $data[&#39;mode&#39;], &#39;&#39;);
+    $block = mcrypt_enc_get_block_size($td);
+
+    /* Check MAC. */
+    if(base64_decode($data[&#39;mac&#39;]) != self::pbkdf2($data[&#39;cdata&#39;], $key, 1000, 32)) {
+      phpsec::error(&#39;Message authentication code invalid&#39;);
+      return false;
+    }
+
+    /* Init mcrypt. */
+    mcrypt_generic_init($td, $key, base64_decode($data[&#39;iv&#39;]));
+
+    $decrypted = rtrim(mdecrypt_generic($td, base64_decode(self::stripPadding($block, $data[&#39;cdata&#39;]))));
+
+    /* Close up. */
+    mcrypt_generic_deinit($td);
+    mcrypt_module_close($td);
+
+    /*Return decrypted data. */
+    return unserialize($decrypted);
+
+  }
+
+  /**
+   * Implement PBKDF2 as described in RFC 2898.
+   *
+   * @param string $p
+   *   Password to protect.
+   *
+   * @param string $s
+   *   Salt.
+   *
+   * @param integer $c
+   *   Iteration count.
+   *
+   * @param integer $dkLen
+   *   Derived key length.
+   *
+   * @param string $a
+   *   A hash algorithm.
+   *
+   * @return binary
+   *   Derived key.
+   */
+  public static function pbkdf2($p, $s, $c, $dkLen, $a = &#39;sha256&#39;) {
+    $hLen = strlen(hash($a, null, true)); /* Hash length. */
+    $l    = ceil($dkLen / $hLen);         /* Length in blocks of derived key. */
+    $dk   = &#39;&#39;;                           /* Derived key. */
+
+    /* Step 1. Check dkLen. */
+    if($dkLen &gt; (2^32-1) * $hLen) {
+      phpsec::error(&#39;Derived key too long&#39;);
+      return false;
+    }
+
+    for ($block = 1; $block&lt;=$l; $block ++) {
+      /* Initial hash for this block. */
+      $ib = $b = hash_hmac($a, $s . pack(&#39;N&#39;, $block), $p, true);
+      /* Do block iterations. */
+      for ($i = 1; $i&lt;$c; $i ++) {
+        /* XOR iteration. */
+        $ib ^= ($b = hash_hmac($a, $b, $p, true));
+      }
+      /* Append iterated block. */
+      $dk .= $ib;
+    }
+    /* Returned derived key. */
+    return substr($dk, 0, $dkLen);
+  }
+
+  /**
+   * PKCS7-pad data.
+   * Add bytes of data to fill up the last block.
+   * PKCS7 padding adds bytes with the same value that the number of bytes that are added.
+   * @see <a href="http://tools.ietf.org/html/rfc5652#section-6.3" rel="nofollow">http://tools.ietf.org/html/rfc5652#section-6.3</a>
+   *
+   * @param integer $block
+   *   Block size.
+   *
+   * @param string $data
+   *   Data to pad.
+   *
+   * @return string
+   *   Padded data.
+   */
+  public static function pad($block, $data) {
+    $pad = $block - (strlen($data) % $block);
+    $data .= str_repeat(chr($pad), $pad);
+
+    return $data;
+  }
+
+  /**
+   * Strip PKCS7-padding.
+   *
+   * @param integer $block
+   *   Block size.
+   *
+   * @param string $data
+   *   Padded data.
+   *
+   * @return string
+   *   Original data.
+   */
+  public static function stripPadding($block, $data) {
+    $pad = ord($data[($len = strlen($data)) - 1]);
+
+    /* Check that what we have at the end of the string really is padding, and if it is remove it. */
+    if ($pad &amp;&amp; $pad &lt; $block &amp;&amp; preg_match(&#39;/&#39; . chr($pad) . &#39;{&#39; . $pad . &#39;}$/&#39;, $data)) {
+      return substr($data, 0, -$pad);
+    }
+    return $data;
+  }
+}

Added: branches/9.x/lib/phpsec/phpsec/phpsec.filter.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.filter.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.filter.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,117 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides methods for XSS filtering.
+ */
+class phpsecFilter {
+
+  /**
+   * XSS text filter. Returns a string that is safe to use on the page.
+   *
+   * There are three types of variables:
+   * %variables: stip mode of phpsec::f() is used.
+   * !variables: escapeAll mode of phpsec::f() is used.
+   * @variables: escape mode of phpsec::f() is used.
+   * &amp;variables: url mode of phpsec::f() is used.
+   *
+   * @see phpsec::f()
+   * @see <a href="https://phpseclib.com/manual/filter" rel="nofollow">https://phpseclib.com/manual/filter</a>
+   * @see <a href="http://www.faqs.org/rfcs/rfc3986" rel="nofollow">http://www.faqs.org/rfcs/rfc3986</a>
+   *
+   * @param string $str
+   *   A string containing the &#39;glue&#39; used to compose the filtered parts
+   *   from the $args array.
+   *
+   * @param mixed $args
+   *   An associative array containing data to filter.
+   *   The array keys should be preceeded with %, ! or @ defining what filter
+   *   to apply.
+   */
+  public static function t($str, $args) {
+    /* Loop trough the args and apply the filters. */
+    while(list($name, $data) = each($args)) {
+      $safeData = false;
+      $filterType = mb_substr($name, 0, 1);
+      switch($filterType) {
+        case &#39;%&#39;:
+          /* %variables: HTML tags are stripped of from the string
+             before it is in inserted. */
+          $safeData = self::f($data, &#39;strip&#39;);
+          break;
+        case &#39;!&#39;:
+          /* !variables: HTML and special characters are escaped from the string
+             before it is used. */
+          $safeData = self::f($data, &#39;escapeAll&#39;);
+          break;
+        case &#39;@&#39;:
+          /* @variables: Only HTML is escaped from the string. Special characters
+             is kept as it is. */
+          $safeData = self::f($data, &#39;escape&#39;);
+          break;
+        case &#39;&amp;&#39;:
+          /* Encode a string according to RFC 3986 for use in a URL. */
+          $safeData = self::f($data, &#39;url&#39;);
+          break;
+        default:
+          phpsec::error(&#39;Unknown variable type&#39;, E_USER_NOTICE);
+          break;
+      }
+      if($safeData !== false) {
+        $str = str_replace($name, $safeData, $str);
+      }
+    }
+    return $str;
+  }
+
+  /**
+   * XSS filter. Returns a string that is safe to use on the page.
+   *
+   * There are three modes:
+   * strip: HTML is stripped from the string
+   * before it is inserted.
+   * escapeAll: HTML and special characters is escaped from the string
+   * before it is inserted.
+   * escape: Only HTML is escaped from the string. Special characters
+   * is kept as is.
+   * url: Encode a string according to RFC 3986 for use in a URL.
+   *
+   * @see <a href="https://phpseclib.com/manual/filter" rel="nofollow">https://phpseclib.com/manual/filter</a>
+   * @see <a href="http://www.faqs.org/rfcs/rfc3986" rel="nofollow">http://www.faqs.org/rfcs/rfc3986</a>
+   *
+   * @param string $str
+   *   String to filter
+   *
+   * @param string $mode
+   *   String defining what filter to apply.
+   */
+  public static function f($str, $mode = &#39;escape&#39;) {
+    switch($mode) {
+      case &#39;strip&#39;:
+        /* HTML tags are stripped from the string
+           before it is used. */
+        return strip_tags($str);
+      case &#39;escapeAll&#39;:
+        /* HTML and special characters are escaped from the string
+           before it is used. */
+        return htmlentities($str, ENT_QUOTES, phpSec::$_charset);
+      case &#39;escape&#39;:
+        /* Only HTML tags are escaped from the string. Special characters
+           is kept as is. */
+        return htmlspecialchars($str, ENT_NOQUOTES, phpSec::$_charset);
+      case &#39;url&#39;:
+        /* Encode a string according to RFC 3986 for use in a URL. */
+        return rawurlencode($str);
+      default:
+        phpsec::error(&#39;Unknown variable type&#39;, E_USER_NOTICE);
+    }
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.hash.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.hash.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.hash.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,140 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Implements password hashing using crypt() with PBKDF2 support.
+ */
+class phpsecHash {
+
+  const PBKDF2 = &#39;$pbkdf2$&#39;;
+  const BCRYPT = &#39;$2a$&#39;;
+  const SHA256 = &#39;$5$&#39;;
+  const SHA512 = &#39;$6$&#39;;
+
+  /**
+   * Default hashing method.
+   */
+  public static $_method = self::PBKDF2;
+
+  /**
+   * PBKDF2: Iteration count.
+   */
+  public static $_pbkdf2_c = 8192;
+
+  /**
+   * PBKDF2: Derived key length.
+   */
+  public static $_pbkdf2_dkLen = 128;
+
+  /**
+   * PBKDF2: Underlying hash method.
+   */
+  public static $_pbkdf2_prf = &#39;sha256&#39;;
+
+  /**
+   * Bcrypt: Work factor.
+   */
+  public static $_bcrypt_cost = 12;
+
+  /**
+   * SHA2: Number of rounds.
+   */
+  public static $_sha2_c = 6000;
+
+  /**
+   * Salt charsets.
+   */
+  public static $charsets = array(
+    &#39;itoa64&#39; =&gt; &#39;./abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;,
+  );
+
+  /**
+   * Creates a salted hash from a string.
+   *
+   *   @param string $str
+   *     String to hash.
+   *
+   *   @return string
+   *     Returns hashed string, or false on error.
+   */
+  public static function create($str) {
+
+    switch(self::$_method) {
+      case self::BCRYPT:
+        $saltRnd = phpsecRand::str(22, self::$charsets[&#39;itoa64&#39;]);
+        $salt = sprintf(&#39;$2a$%s$%s&#39;, self::$_bcrypt_cost, $saltRnd);
+        $hash = crypt($str, $salt);
+      break;
+
+      case self::PBKDF2:
+        $salt = phpsecRand::bytes(64);
+        $hash = phpsecCrypt::pbkdf2($str, $salt, self::$_pbkdf2_c, self::$_pbkdf2_dkLen, self::$_pbkdf2_prf);
+
+        $hash = sprintf(&#39;$pbkdf2$c=%s&amp;dk=%s&amp;f=%s$%s$%s&#39;,
+                       self::$_pbkdf2_c,
+                       self::$_pbkdf2_dkLen,
+                       self::$_pbkdf2_prf,
+                       base64_encode($hash),
+                       base64_encode($salt)
+                       );
+      break;
+
+      case self::SHA256:
+      case self::SHA512:
+        $saltRnd = phpsecRand::str(16, self::$charsets[&#39;itoa64&#39;]);
+        $salt = sprintf(&#39;%srounds=%s$%s&#39;, self::$_method, self::$_sha2_c, $saltRnd);
+        $hash = crypt($str, $salt);
+      break;
+    }
+
+    if(strlen($hash) &gt; 13) {
+      return $hash;
+    }
+    return false;
+  }
+
+  /**
+   * Check a string against a hash.
+   *
+   * @param string $str
+   *   String to check.
+   *
+   * @param string $hash
+   *   The hash to check the string against.
+   *
+   * @return bool
+   *   Returns true on match.
+   */
+  public static function check($str, $hash) {
+    $regex_pattern = &#39;/^\$[a-z, 1-6]{1,6}\$/i&#39;;
+    preg_match($regex_pattern, $hash, $matches);
+    list($method) = $matches;
+    switch($method) {
+      case self::PBKDF2:
+        $param = array();
+        list( , , $params, $hash, $salt) = explode(&#39;$&#39;, $hash);
+        parse_str($params, $param);
+
+        if(base64_decode($hash) === phpsecCrypt::pbkdf2($str, base64_decode($salt), $param[&#39;c&#39;], $param[&#39;dk&#39;], $param[&#39;f&#39;])) {
+          return true;
+        }
+        return false;
+      break;
+
+      default:
+        if(crypt($str, $hash) === $hash) {
+          return true;
+        }
+        return false;
+      break;
+    }
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.otp.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.otp.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.otp.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,83 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides one time password functionality.
+ */
+class phpsecOtp {
+  /**
+   * Generate a one-time-password (OTP). The password is only valid for a given time,
+   * and must be delivered to the user instantly. The password is also only valid
+   * for the current session.
+   *
+   * @param string $action
+   *   The action to generate a OTP for. This should be as specific as possible.
+   *   Used to ensure that the OTP is used for the intended action.
+   *
+   * @param array $data
+   *   Optional array of data that belongs to $action. Used to ensure that the action
+   *   is performed with the same data as when the OTP was generated.
+   *
+   * @param integer $length
+   *   OTP length.
+   *
+   * @param integer $ttl
+   *   Time to live for the OTP. In seconds.
+   *
+   * @return string
+   *   One time password that should be delivered to the user by for example email or SMS.
+   *
+   */
+  public static function generate($action, $data = &#39;&#39;, $length = 6, $ttl = 480) {
+    $pw = phpsecRand::str($length);
+
+    $otp[&#39;pw&#39;] = phpsecHash::create($pw);
+
+    if($data !== null) {
+     $otp[&#39;data&#39;] = phpsecHash::create(serialize($data));
+    } else {
+      $otp[&#39;data&#39;] = $data;
+    }
+
+    phpsecCache::cacheSet(&#39;otp-&#39;.$action, $otp, $ttl);
+
+    return $pw;
+  }
+
+  /**
+   * Validate a one-time-password.
+   *
+   * @param strgin $otp
+   *   OTP supplied by user.
+   *
+   * @param string $action
+   *   See phpsecOtp::generate().
+   *
+   * @param array $data
+   *   See phpsecOtp::generate().
+   *
+   */
+  public static function validate($otp, $action, $data = &#39;&#39;) {
+    $cache = phpsecCache::cacheGet(&#39;otp-&#39;.$action);
+
+    if($cache !== false) {
+      if(!phpsecHash::check($otp, $cache[&#39;pw&#39;])) {
+        return false;
+      } elseif(!phpsecHash::check(serialize($data), $cache[&#39;data&#39;])) {
+        return false;
+      }
+      phpsecCache::cacheRem(&#39;otp-&#39;.$action);
+      return true;
+    }
+    return false;
+  }
+
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.otpcard.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.otpcard.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.otpcard.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,156 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Providees pre shared one-time-password functionality. Experimental.
+ */
+class phpsecOtpcard {
+  const HASH_TYPE = &#39;sha256&#39;;
+
+  /**
+   * Create a list of 64 pre shared one-time-passwords,
+   * or a so called password card.
+   *
+   * This differs from phpsecOtp::generate() because passwords generated by
+   * this function is saved permanent and can be validated on a later time.
+   */
+  public static function create($length = 6, $num = 32) {
+    $card[&#39;list&#39;] = array();
+    for($i = 0; $i &lt; $num; $i++) {
+      $card[&#39;list&#39;][$i]   = phpsecRand::str($length);
+      $card[&#39;usable&#39;][$i] = true;
+    }
+
+    $card = self::save($card);
+
+    return $card[&#39;id&#39;];
+  }
+
+  /**
+   * Validates a pre shared one-time-password.
+   *
+   * @param string $cardId
+   *   Card ID.
+   *
+   * @param integer $selected
+   *   OTP ID the user is expected to use. Usually
+   *   provided by phpsecOtp::cardSelect().
+   *
+   * @param string $otp
+   *   The password provided by the user.
+   *
+   * @return bolean
+   */
+  public static function validate($cardId, $selected, $otp) {
+    $card = self::load($cardId);
+    if(isset($card[&#39;usable&#39;][$selected]) &amp;&amp; $card[&#39;usable&#39;][$selected] === true) {
+      if($card[&#39;list&#39;][$selected] == $otp) {
+        unset($card[&#39;usable&#39;][$selected]);
+
+        self::save($card);
+        return true;
+      }
+    }
+    return false;
+  }
+
+  /**
+   * Select a pre shared OTP from a list that a user can use.
+   *
+   * @param string $cardId
+   *   Card ID to select a OTP from.
+   *
+   * @return integer
+   *   OTP ID of a available OTP.
+   */
+  public static function select($cardId) {
+    $card = self::load($cardId);
+
+    $available = array_keys($card[&#39;usable&#39;]);
+    $selected  = phpsecRand::int(0, count($available)-1);
+
+    return $available[$selected];
+  }
+  /**
+   * Load a password card.
+   *
+   * @param string $cardId
+   *   Card ID.
+   *
+   * @return array
+   *   A array containing the card data.
+   */
+  public static function load($cardId) {
+    $card = phpsec::$store-&gt;read(&#39;otp-card&#39;, $cardId);
+    if($card !== false) {
+      if($card[&#39;hash&#39;] !== hash(self::HASH_TYPE, $card[&#39;list&#39;])) {
+        return false;
+      }
+      $card[&#39;list&#39;] = json_decode(base64_decode($card[&#39;list&#39;]), true);
+      return $card;
+    }
+    return false;
+  }
+
+  /**
+   * Get the number of unused OTPs on a password card.
+   *
+   * @param string $cardId
+   *   Card ID.
+   *
+   * @return integer
+   *   Number of unused OTPs.
+   */
+  public static function remaining($cardId) {
+    $card = self::load($cardId);
+
+    return count($card[&#39;usable&#39;]);
+  }
+
+  /**
+   * Save a password card.
+   *
+   * @param array $card
+   *   Array containing a already hashed card.
+   *
+   * @return mixed
+   *   Returns card arryar on success and false on error.
+   */
+  private static function save($card) {
+    $card = self::hash($card);
+
+    /* TODO: Encrypt before saving. */
+    if(phpsec::$store-&gt;write(&#39;otp-card&#39;, $card[&#39;id&#39;], $card)) {
+      return $card;
+    }
+    return false;
+  }
+
+  /**
+   * Prepeare the password card for saving.
+   *
+   * @param array $card
+   *   Array containing the card data to hash.
+   *
+   * @return array
+   *   Array containing hashed card data. Ready for phpsecOtpcard::save().
+   */
+  private static function hash($card) {
+    /* We are encoding the password list just because we want to make
+     * the file look nice, and to avoid bugs with special characters. */
+    $card[&#39;list&#39;] = base64_encode(json_encode($card[&#39;list&#39;]));
+    $card[&#39;hash&#39;] = hash(self::HASH_TYPE, $card[&#39;list&#39;]);
+    $card[&#39;id&#39;]   = substr($card[&#39;hash&#39;], 0, 12);
+
+    return $card;
+  }
+
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.pw.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.pw.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.pw.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,180 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ *  Provides methods for hashing and salting of passwords. Note: This class is deprecated. Use phpsecHash instead.
+ *  @see phpsecHash
+ */
+class phpsecPw {
+  const phpsecPw_PBKDF2 = &#39;pbkdf2&#39;;
+  const phpsecPw_BCRYPT = &#39;bcrypt&#39;;
+  const phpsecPw_SHA256 = &#39;sha256&#39;;
+  const phpsecPw_SHA512 = &#39;sha512&#39;;
+
+  public static $_method       = self::phpsecPw_PBKDF2;
+
+  /**
+   * Iteration count that PBKDF2 will use.
+   * 8192 is just a little slower than a work load of 11 when using bcrypt.
+   * Oh, slow is good.
+   */
+  public static $_pbkdf2_c     = 8192;
+  public static $_pbkdf2_dkLen = 256;
+  public static $_pbkdf2_prf   = self::phpsecPw_SHA512;
+
+  /**
+   * Create a hashed version of a password, safe for storage in a database.
+   * This function return a json encoded array that can be stored directly
+   * into a database. The array has the following layout:
+   * array(
+   *   &#39;hash&#39;      =&gt; The hash created from the password and a salt.
+   *   &#39;salt&#39;      =&gt; The salt that was used along with the password to create the hash.
+   *   &#39;algo&#39;      =&gt; The hashing algorithm used.
+   * )
+   *
+   * @param string $password
+   *   The password to hash.
+   *
+   * @return string
+   *   Returns a json encoded array containing the password hash, salt and
+   *   some meta data.
+   */
+  public static function hash($password) {
+    $salt     = phpsecRand::bytes(64);
+    switch(self::$_method) {
+      case self::phpsecPw_PBKDF2:
+        $hash = phpsecCrypt::pbkdf2($password, $salt, self::$_pbkdf2_c, self::$_pbkdf2_dkLen, self::$_pbkdf2_prf);
+        /* phpsecCrypt::pbkdf2() returns a binary string. So let&#39;s base64 encode it.*/
+        $hash = base64_encode($hash);
+        /* We append the iteration count, derived key length and PRF as we need this later. */
+        $algo = &#39;pbkdf2:&#39;.self::$_pbkdf2_c.&#39;:&#39;.self::$_pbkdf2_dkLen.&#39;:&#39;.self::$_pbkdf2_prf;
+      break;
+      default:
+        $injected = self::inject($password, $salt);
+        $hash     = hash(self::$_method, $injected);
+        $algo     = self::$_method;
+    }
+
+
+    $return = array(
+      &#39;hash&#39;      =&gt; $hash,
+      &#39;salt&#39;      =&gt; base64_encode($salt),
+      &#39;algo&#39;      =&gt; $algo,
+    );
+    return json_encode($return);
+  }
+
+  /**
+   * Validate a user-supplied password against a stored password generated
+   * using the phpsecPw::hash() method.
+   *
+   * @param string $password
+   *   The password supplied by the user in the login form.
+   *
+   * @param string $dbPassword
+   *   The json string fetched from the database, in the exact format
+   *   as created by phpsecPw::hash().
+   *
+   * @return boolean
+   *   True on password match, false otherwise.
+   */
+  public static function check($password, $dbPassword) {
+    /**
+     * Unserialize registered password array and validate it to ensure
+     * we got a valid array.
+     */
+    $data = json_decode($dbPassword, true);
+
+    $dataStructure = array(
+      &#39;hash&#39;  =&gt; true,
+      &#39;salt&#39;  =&gt; true,
+      &#39;algo&#39;  =&gt; true,
+    );
+
+    /* Check structure of array. */
+    if($data !== null &amp;&amp; phpsec::arrayCheck($data, $dataStructure)) {
+
+      /* Try to Base64 decode the salt.  base64_decode() will return false
+       * if the string passed is not Base64 encoded. This way we can separate
+       * binary salts from the old type of salts. */
+      $decodedSalt = base64_decode($data[&#39;salt&#39;], true);
+      if($decodedSalt !== false) {
+        /* The salt was Base64 encoded. Use the decoded version. */
+        $data[&#39;salt&#39;] = $decodedSalt;
+      }
+
+      /**
+       * We do a switch on the 6 first characters on the used hashing method.
+       * This way we are able to catch when pbkdf2 is used, since this has
+       * it&#39;s iteration count, derived key length and PRF attached to it:
+       * &#34;pbkdf2:iteration count:derived key length:PRF&#34;
+       */
+      switch(substr($data[&#39;algo&#39;], 0, 6)) {
+        case self::phpsecPw_PBKDF2:
+          /* As described above, we need to seperate out the iteration count
+           * and derived key length. */
+          list($method, $iterationCount, $dkLen, $prf) = explode(&#39;:&#39;, $data[&#39;algo&#39;]);
+          /* Just to make sure anything fishy isn&#39;t going on. */
+          if(!is_numeric($iterationCount) || !is_numeric($dkLen)) {
+            return false;
+          }
+
+          /* Create a new derived key, with the iteration count and derived key length
+           * that were used when generating the original dk. */
+          $dk = phpsecCrypt::pbkdf2($password, $data[&#39;salt&#39;], $iterationCount, $dkLen, $prf);
+
+          /* Check the new dk against the old base64 encoded dk. */
+          if($dk === base64_decode($data[&#39;hash&#39;])) {
+            return true;
+          }
+        break;
+
+        default:
+          /* If not pbkdf2, we assume normal hash. */
+          $pwInjected = self::inject($password, $data[&#39;salt&#39;]);
+          /* Create a hash and see if it matches. */
+          if(hash($data[&#39;algo&#39;], $pwInjected) == $data[&#39;hash&#39;]) {
+            return true;
+          }
+      }
+    } else {
+      /* Invalid array supplied. */
+      phpsec::error(&#39;Invalid data supplied. Expected serialized array as returned by pwHash()&#39;);
+    }
+    return false;
+  }
+
+  /**
+   * Inject a salt into a password to create the string to be hashed.
+   * What we really do is to create an hash from the password, and retrieve
+   * the first character from this hash. This is then converted to its decimal value.
+   * We now have a number between 0 and 15. We use this to calculate where to place the salt.
+   * We take the length of the password and dividing it by 16, and then we multiply this by the
+   * number we got from the hash.
+   *
+   * @param string $password
+   *   Plain-text password.
+   *
+   * @param string $salt
+   *   Well, the salt to inject into the password.
+   *
+   * @return string
+   *   Returns the salted password, ready to be hashed.
+   *
+   */
+  private static function inject($password, $salt) {
+    $hex = hexdec(substr(hash(phpsec::HASH_TYPE, $password), 0, 1));
+    $len = strlen($password);
+    $pos = floor($hex*($len/16));
+
+    return substr($password, 0, $pos).$salt.substr($password, $pos);
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.rand.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.rand.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.rand.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,127 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides methods for generating random data.
+ */
+class phpsecRand {
+  public static $_charset = &#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;;
+
+  /**
+   * Generate random data.
+   *
+   * @param integer $len
+   * @return binary
+   */
+  public static function bytes($len) {
+    /* Code inspired by this blogpost by Enrico Zimuel
+     * <a href="http://www.zimuel.it/en/strong-cryptography-in-php/" rel="nofollow">http://www.zimuel.it/en/strong-cryptography-in-php/</a> */
+    $strong = false;
+    if(function_exists(&#39;openssl_random_pseudo_bytes&#39;)) {
+      $rnd = openssl_random_pseudo_bytes($len, $strong);
+      if($strong === true) {
+        return $rnd;
+      }
+    }
+    
+    /* Either we dont have the OpenSSL library or the data returned was not
+     * considered secure. Fall back on this less secure code. */
+    if(function_exists(&#39;mcrypt_create_iv&#39;)) {
+      $rnd = mcrypt_create_iv($len, MCRYPT_RAND);
+      return $rnd;
+    }
+    
+    /* Either we dont have the MCrypt library and OpenSSL library or the data returned was not
+     * considered secure. Fall back on this less secure code. */
+    $rnd = &#39;&#39;;
+    for ($i=0;$i&lt;$len;$i++) {
+      $sha = hash(&#39;sha256&#39;, mt_rand());
+      $char = mt_rand(0,30);
+      $rnd .= chr(hexdec($sha[$char].$sha[$char+1]));
+    }
+    return (binary) $rnd;
+  }
+
+  /**
+   * Generate a random integer.
+   *
+   * @param integer $min
+   * @param integer $max
+   * @return integer
+   */
+  public static function int($min, $max) {
+    $delta = $max-$min;
+    $bytes = ceil($delta/256);
+    $rnd = self::bytes($bytes);
+    $add = 0;
+    for ($i = 0; $i &lt; $bytes; $i++) {
+      $add += ord($rnd[$i]);
+    }
+    $add = $add % ($delta + 1);
+    return $min + $add;
+  }
+
+  /**
+   * Generate a random string.
+   *
+   * @param integer $len
+   * @param string $_charset
+   * @return string
+   */
+  public static function str($len, $_charset = null) {
+    if($_charset == null) {
+      $_charset = self::$_charset;
+    }
+
+    $str = &#39;&#39;;
+    for ($i = 0; $i &lt; $len; $i++) {
+      $pos = self::int(0,strlen($_charset)-1);
+      $str .= $_charset[$pos];
+    }
+    return $str;
+  }
+
+  /**
+   * Return random hexadecimal data.
+   *
+   * @param integer $len
+   * @return string
+   */
+  public static function hex($len) {
+    return bin2hex(self::bytes($len));
+  }
+
+  /**
+   * Return one or more random random keys from an array.
+   *
+   * @param array $array
+   *   Input array.
+   *
+   * @param integer $num
+   *   Number of keys to pick.
+   *
+   * @return mixed
+   *   String with the key, or array containing multiple keys.
+   */
+  public static function arrayRand($array, $num = 1) {
+    $keys = array_keys($array);
+    $numKeys = sizeof($keys);
+    if($num == 1) {
+      return $keys[self::int(0, $numKeys-1)];
+    } else {
+      for($i=0; $i &lt; $num; $i++) {
+        $picked[] = $keys[self::int(0, $numKeys-1)];
+      }
+      return $picked;
+    }
+  }
+}
+

Added: branches/9.x/lib/phpsec/phpsec/phpsec.session.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.session.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.session.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,160 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Implements a session handler to save session data encrypted.
+ */
+class phpsecSession {
+  private static $_savePath;
+  private static $_name;
+  private static $_keyCookie;
+  private static $_secret;
+  private static $_currID;
+  private static $_newID;
+
+  /**
+   * Open a session.
+   *
+   * @param string $path
+   * @param string $name
+   * @return bool
+   */
+  public static function open($path, $name) {
+    /* Set some variables we need later. */
+    self::$_savePath  = $path;
+    self::$_name      = $name;
+    self::$_keyCookie = $name.&#39;_secret&#39;;
+
+    /* Set current and new ID. */
+    if(isset($_COOKIE[$name])) {
+      self::$_currID = $_COOKIE[$name];
+    } else {
+      self::$_currID = null;
+    }
+    self::$_newID  = phpsecRand::str(128);
+
+    /* Set cookie with new session ID. */
+    $cookieParam = session_get_cookie_params();
+    setcookie(
+      $name,
+      self::$_newID,
+      $cookieParam[&#39;lifetime&#39;],
+      $cookieParam[&#39;path&#39;],
+      $cookieParam[&#39;domain&#39;],
+      $cookieParam[&#39;secure&#39;],
+      $cookieParam[&#39;httponly&#39;]
+    );
+
+    /* If we don&#39;t have a encryption key, create one. */
+    if(!isset($_COOKIE[self::$_keyCookie])) {
+      /* Create a secret used for encryption of session. */
+      self::setSecret();
+    } else {
+      self::$_secret = base64_decode($_COOKIE[self::$_keyCookie]);
+    }
+    return true;
+  }
+
+  /**
+   * Close a session.
+   *
+   * @return bool
+   */
+  public static function close() {
+    return true;
+  }
+
+  /**
+   * Read and decrypt a session.
+   *
+   * @param string $id
+   * @return mixed
+   */
+  public static function read($id) {
+    /* If no cookie is set, just dropi it! */
+    if(!isset($_COOKIE[self::$_name])) {
+      return false;
+    }
+
+    /* Read from store and decrypt. */
+    $sessData = phpsec::$store-&gt;read(&#39;session&#39;, $_COOKIE[self::$_name]);
+    if($sessData !== false ) {
+      $return = phpsecCrypt::decrypt($sessData, self::$_secret);
+    } else {
+      $return = false;
+    }
+    return $return;
+  }
+
+  /**
+   * Encrypt and save a session.
+   *
+   * @param string $id
+   * @param string $data
+   * @return bool
+   */
+  public static function write($id, $data) {
+    /* Encrypt session. */
+    $encrypted = phpsecCrypt::encrypt($data, self::$_secret);
+
+    /* Destroy old session. */
+    self::destroy(self::$_currID);
+
+    /* Write new session, with new ID. */
+    return phpsec::$store-&gt;write(&#39;session&#39;, self::$_newID, $encrypted);
+
+  }
+  /**
+   * Destroy/remove a session.
+   *
+   * @param string $id
+   * @return bool
+   */
+  public static function destroy($id) {
+    return phpsec::$store-&gt;delete(&#39;session&#39;, $id);
+  }
+  /**
+   * Do garbage collection.
+   *
+   * @param integer $ttl
+   * @return bool
+   */
+  public static function gc($ttl) {
+    $Ids = phpsec::$store-&gt;listIds(&#39;session&#39;);
+    foreach($Ids as $Id) {
+      $data = phpsec::$store-&gt;meta(&#39;session&#39;, $Id);
+      if($data-&gt;time + $ttl &lt; time()) {
+        phpsec::$store-&gt;delete(&#39;session&#39;, $Id);
+      }
+    }
+    return true;
+  }
+
+  /**
+   * Set the cookie with the secret.
+   *
+   * @return true
+   */
+  private static function setSecret() {
+    self::$_secret = phpsecRand::bytes(32);
+    $cookieParam = session_get_cookie_params();
+    setcookie(
+      self::$_keyCookie,
+      base64_encode(self::$_secret),
+      $cookieParam[&#39;lifetime&#39;],
+      $cookieParam[&#39;path&#39;],
+      $cookieParam[&#39;domain&#39;],
+      $cookieParam[&#39;secure&#39;],
+      $cookieParam[&#39;httponly&#39;]
+    );
+    return true;
+  }
+}

Added: branches/9.x/lib/phpsec/phpsec/phpsec.store.filesystem.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.store.filesystem.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.store.filesystem.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,136 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ *  Class for handling flat file storage.
+ */
+class phpsecStoreFilesystem extends phpsecStore {
+
+  private $_dataDir  = null;
+  public  $_hashType = &#39;sha256&#39;;
+
+  /**
+   * @see phpsecStore::__construct()
+   */
+  public function __construct($loc) {
+    if(!is_writeable($loc)) {
+      phpsec::error(&#39;Storage directory(&#39;.$loc.&#39;) not writeable&#39;, E_USER_ERROR);
+      return false;
+    }
+    $this-&gt;_dataDir = $loc;
+    return true;
+  }
+
+  /**
+   * @see phpsecStore::read()
+   */
+  public function read($type, $id) {
+    $fileName = $this-&gt;fileName($type, $id);
+    if(!file_exists($fileName)) {
+      return false;
+    }
+    $data = file_get_contents($fileName);
+    list($meta, $data) = explode(&#34;\n\n&#34;, $data, 2);
+    $jsonData = json_decode($meta);
+
+    $mac = phpsecCrypt::pbkdf2($data, $id, 1000, 32);
+
+    if($mac != base64_decode($jsonData-&gt;mac)) {
+      phpsec::error(&#39;Message authentication code invalid while reading store&#39;);
+      return false;
+    }
+    return unserialize($data);
+  }
+
+  /**
+   * @see phpsecStore::write()
+   */
+  public function write($type, $id, $data) {
+    $fileName =  $this-&gt;fileName($type, $id);
+
+    $data = serialize($data);
+    $saveData[&#39;id&#39;]   = base64_encode($id);
+    $saveData[&#39;mac&#39;]  = base64_encode(phpsecCrypt::pbkdf2($data, $id, 1000, 32));
+    $saveData[&#39;time&#39;] = time();
+
+    $jsonData = json_encode($saveData);
+    $fp = fopen($fileName, &#39;w&#39;);
+    if($fp !== false) {
+      if(flock($fp, LOCK_EX)) {
+        fwrite($fp, $jsonData.&#34;\n\n&#34;);
+        fwrite($fp, $data);
+        flock($fp, LOCK_UN);
+        fclose($fp);
+        return true;
+      } else {
+        phpsec::error(&#39;Could not lock file while writing to store&#39;);
+      }
+    }
+    return false;
+  }
+
+  /**
+   * @see phpsecStore::delete()
+   */
+  public function delete($type, $id) {
+    @unlink(self::fileName($type, $id));
+  }
+
+  /**
+   * @see phpsecStore::listIds()
+   */
+  public function listIds($type) {
+    $ids = array();
+    $files = glob($this-&gt;_dataDir.&#39;/store_&#39;.$type.&#39;_*&#39;);
+    foreach($files as $file) {
+      $data = file_get_contents($file);
+
+      list($meta, $data) = explode(&#34;\n\n&#34;, $data, 2);
+      $jsonData = json_decode($meta);
+      $ids[] = base64_decode($jsonData-&gt;id);
+
+    }
+    return $ids;
+  }
+
+  /**
+   * @see phpsecStore::meta()
+   */
+  public function meta($type, $id) {
+    $fileName = $this-&gt;fileName($type, $id);
+    if(!file_exists($fileName)) {
+      return false;
+    }
+    $data = file_get_contents($fileName);
+    list($meta, $data) = explode(&#34;\n\n&#34;, $data, 2);
+
+    $data = json_decode($meta);
+    $data-&gt;id  = base64_decode($data-&gt;id);
+    $data-&gt;mac = base64_decode($data-&gt;mac);
+    return $data;
+  }
+
+  /**
+   * Generate a unique filename.
+   *
+   * @param string $type
+   *   Type of data.
+   *
+   * @param string $id
+   *   Id of the storage object.
+   *
+   * @return string
+   *   Filename.
+   */
+  private function fileName($type, $id) {
+    return $this-&gt;_dataDir.&#39;/store_&#39;.$type.&#39;_&#39;.hash($this-&gt;_hashType, $id);
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.store.pdo.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.store.pdo.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.store.pdo.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,271 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ *  Class for handling database storage.
+ */
+class phpsecStorePdo extends phpsecStore {
+
+  public  $_hashType = &#39;sha256&#39;;
+  private $dbh       = null;
+  private $table     = null;
+
+  /**
+   * @see phpsecStore::__construct()
+   */
+  public function __construct($loc) {
+    /* Separate username and password from DSN */
+    $parts = phpsecStorePdo::parseDsn($loc);
+    $loc   = &#39;mysql:dbname=&#39;.$parts[&#39;dbname&#39;].&#39;;host=&#39;.$parts[&#39;host&#39;];
+
+    /* We try to connect to the database. If this fails throw an error. */
+    try {
+      $this-&gt;dbh = new PDO($loc, $parts[&#39;username&#39;], $parts[&#39;password&#39;]);
+    } catch(PDOException $e) {
+      phpsec::error(&#39;Database connection failed: &#39; . $e-&gt;getMessage(), E_USER_ERROR);
+      return false;
+    }
+
+    /* Cool, we connected to the databse with no problems.
+     * Now let&#39;s try to find the table we want. */
+    $this-&gt;table = $parts[&#39;table&#39;];
+    /* Got it!! No just kidding. */
+
+    /* This is the expected structure of the table. Neat eh? */
+    $storeTable = array(
+      array(
+        &#39;Field&#39;   =&gt; &#39;type&#39;,
+        &#39;Type&#39;    =&gt; &#39;varchar(255)&#39;,
+        &#39;Null&#39;    =&gt; &#39;NO&#39;,
+        &#39;Key&#39;     =&gt; &#39;MUL&#39;,
+        &#39;Default&#39; =&gt; NULL,
+        &#39;Extra&#39;   =&gt; &#39;&#39;,
+      ),
+      array(
+        &#39;Field&#39;   =&gt; &#39;id&#39;,
+        &#39;Type&#39;    =&gt; &#39;varchar(255)&#39;,
+        &#39;Null&#39;    =&gt; &#39;NO&#39;,
+        &#39;Key&#39;     =&gt; &#39;PRI&#39;,
+        &#39;Default&#39; =&gt; NULL,
+        &#39;Extra&#39;   =&gt; &#39;&#39;,
+      ),
+      array(
+        &#39;Field&#39;   =&gt; &#39;mac&#39;,
+        &#39;Type&#39;    =&gt; &#39;binary(32)&#39;,
+        &#39;Null&#39;    =&gt; &#39;NO&#39;,
+        &#39;Key&#39;     =&gt; &#39;&#39;,
+        &#39;Default&#39; =&gt; NULL,
+        &#39;Extra&#39;   =&gt; &#39;&#39;,
+      ),
+      array(
+        &#39;Field&#39;   =&gt; &#39;time&#39;,
+        &#39;Type&#39;    =&gt; &#39;int(11) unsigned&#39;,
+        &#39;Null&#39;    =&gt; &#39;NO&#39;,
+        &#39;Key&#39;     =&gt; &#39;&#39;,
+        &#39;Default&#39; =&gt; NULL,
+        &#39;Extra&#39;   =&gt; &#39;&#39;,
+      ),
+      array(
+        &#39;Field&#39;   =&gt; &#39;data&#39;,
+        &#39;Type&#39;    =&gt; &#39;text&#39;,
+        &#39;Null&#39;    =&gt; &#39;NO&#39;,
+        &#39;Key&#39;     =&gt; &#39;&#39;,
+        &#39;Default&#39; =&gt; NULL,
+        &#39;Extra&#39;   =&gt; &#39;&#39;,
+      ),
+    );
+
+    /* Ok, so. Let&#39;s get the structure of the table that&#39;s configured. Since PDO obviously
+     * don&#39;t expect people to have nothing else than hard coded table names there is no
+     * proper escape function for table/column names. We will do as suggested here
+     * <a href="http://stackoverflow.com/questions/1542627/escaping-field-names-in-pdo-statements" rel="nofollow">http://stackoverflow.com/questions/1542627/escaping-field-names-in-pdo-statements</a>
+     * by bobince and dissallow backquote, backslash and the nul character.
+     * We will only do this here since we will verify the existence of the table later.
+     * Oh.. I almost forgot. This fix is mySQL only! */
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;DESCRIBE `&#39;.str_replace(array(&#39;\\&#39;,&#34;\0&#34; ,&#39;`&#39;), &#39;&#39;, $this-&gt;table).&#39;`&#39;
+    );
+
+    $sth-&gt;execute(array());
+    $currentStructure = $sth-&gt;fetchAll(PDO::FETCH_ASSOC);
+
+    /* First we just match number of columns to make sure everything looks good, and to avoid
+     * total disaster in the next part. Oh.. I almost forgot. If this fails everything explodes
+     * in a nice old USER_ERROR! */
+    if(sizeof($currentStructure) !== sizeof($storeTable)) {
+      phpsec::error(&#39;Invalid table (&#39;.$parts[&#39;dbname&#39;].&#39;.&#39;.$this-&gt;table.&#39;) structure&#39;, E_USER_ERROR);
+      return false;
+    }
+
+    /* Cool. The number is good. Check that the fields and stuff are all right. */
+    for($i=0; $i &lt; sizeof($storeTable); $i++) {
+      $diff = array_diff_assoc($currentStructure[$i], $storeTable[$i]);
+      if(sizeof($diff) &gt; 0) {
+        phpsec::error(&#39;Invalid table (&#39;.$parts[&#39;dbname&#39;].&#39;.&#39;.$this-&gt;table.&#39;) structure. &#39;.var_export($diff, true), E_USER_ERROR);
+        return false;
+      }
+    }
+
+    /* Cool. No wait.. It was cool 10 lines ago. Supercool! We got this far. All is good. Go pary! */
+    return true;
+  }
+
+  /**
+   * @see phpsecStore::read()
+   */
+  public function read($type, $id) {
+
+    /* The first part is prettu basic. Get stuff from databse. */
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;SELECT * FROM &#39;.$this-&gt;table.&#39; WHERE type = :type AND id = :id LIMIT 1&#39;
+    );
+
+    $data = array(
+      &#39;id&#39;    =&gt; $id,
+      &#39;type&#39;  =&gt; $type,
+    );
+    $sth-&gt;execute($data);
+
+    $data = $sth-&gt;fetch(PDO::FETCH_ASSOC);
+    if($data === false) {
+      return false;
+    }
+
+    /* Calculate expected MAC. */
+    $mac = phpsecCrypt::pbkdf2($data[&#39;data&#39;], $id, 1000, 32);
+
+    /* Compare MAC */
+    if($mac != $data[&#39;mac&#39;]) {
+      phpsec::error(&#39;Message authentication code invalid while reading store&#39;);
+      return false;
+    }
+
+    /* And success! */
+    return unserialize($data[&#39;data&#39;]);
+  }
+
+  /**
+   * @see phpsecStore::write()
+   */
+  public function write($type, $id, $data) {
+    /* Delete existing data first, to prevent a huge database. */
+    $this-&gt;delete($type, $id);
+
+    /* Prepeare query. */
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;INSERT INTO &#39;.$this-&gt;table.&#39; (`id`, `mac`, `time`, `type`, `data`)&#39; .
+      &#39;VALUES(:id, :mac, :time, :type, :data)&#39;
+    );
+
+    /* Serialize data, and create a MAC. */
+    $data = serialize($data);
+    $mac  = phpsecCrypt::pbkdf2($data, $id, 1000, 32);
+
+    /* We use this array to say what data goes where in the query. */
+    $data = array(
+      &#39;id&#39;   =&gt; $id,
+      &#39;mac&#39;  =&gt; $mac,
+      &#39;time&#39; =&gt; time(),
+      &#39;type&#39; =&gt; $type,
+      &#39;data&#39; =&gt; $data,
+    );
+
+    /* And, insert. */
+    return $sth-&gt;execute($data);
+  }
+
+  /**
+   * @see phpsecStore::delete()
+   */
+  public function delete($type, $id){
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;DELETE FROM &#39;.$this-&gt;table.&#39; WHERE type = :type AND id = :id&#39;
+    );
+
+    $data = array(
+      &#39;id&#39;   =&gt; $id,
+      &#39;type&#39; =&gt; $type,
+    );
+
+    return $sth-&gt;execute($data);
+  }
+
+  /**
+   * @see phpsecStore::listIds()
+   */
+  public function listIds($type) {
+    $ids = array();
+
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;SELECT * FROM &#39;.$this-&gt;table.&#39; WHERE type = :type&#39;
+    );
+
+    $data = array(
+      &#39;type&#39; =&gt; $type,
+    );
+
+    $sth-&gt;execute($data);
+
+    while($row = $sth-&gt;fetch(PDO::FETCH_ASSOC)) {
+      $ids[] = $row[&#39;id&#39;];
+    }
+
+    return $ids;
+  }
+
+  /**
+   * @see phpsecStore::meta()
+   */
+  public function meta($type, $id) {
+    $sth = $this-&gt;dbh-&gt;prepare(
+      &#39;SELECT * FROM &#39;.$this-&gt;table.&#39; WHERE type = :type AND id = :id LIMIT 1&#39;
+    );
+
+    $data = array(
+      &#39;id&#39;   =&gt; $id,
+      &#39;type&#39; =&gt; $type,
+    );
+
+    $sth-&gt;execute($data);
+
+    $meta = $sth-&gt;fetch(PDO::FETCH_ASSOC);
+    if($meta === false) {
+      return false;
+    }
+
+    $obj-&gt;id   = $meta[&#39;id&#39;];
+    $obj-&gt;mac  = $meta[&#39;mac&#39;];
+    $obj-&gt;time = $meta[&#39;time&#39;];
+
+    return $obj;
+  }
+
+  /**
+   * Extract configuration variables from the DSN.
+   *
+   * @param string $dsn
+   *   DSN to extract variables from.
+   *
+   * @return array
+   *   Returns an array with variable names as keys with corresponding values.
+   */
+  private static function parseDsn($dsn) {
+    $parsed = array();
+    $parts = explode(&#39;;&#39;, $dsn);
+
+    foreach($parts as $part) {
+      list($key, $val) = explode(&#39;=&#39;, $part);
+      $parsed[$key] = $val;
+    }
+
+    return $parsed;
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.store.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.store.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.store.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,105 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Abstract class describing the phpSec storage interface class.
+ */
+abstract class phpsecStore {
+
+  /**
+   * Open/prepare the storage.
+   *
+   * @param string $target
+   *   Storage location.
+   *
+   * @return bool
+   *   Returns true on success and false on error.
+   */
+  abstract public function __construct($loc);
+
+  /**
+   * Read object from storage.
+   *
+   * @param string $type
+   *   Type of data (session, cache, etc.).
+   *
+   * @param string $id
+   *   Unique identifier.
+   *
+   * @return mixed
+   *   Returns data.
+   */
+  abstract public function read($type, $id);
+
+  /**
+   * Write object to storage.
+   *
+   * @param string $type
+   *   Type of data (session, cache, etc.).
+   *
+   * @param string $id
+   *   Unique identifier.
+   *
+   * @param mixed $data
+   *   Data to write.
+   *
+   * @return bool
+   *   Returns true on success and false on error.
+   */
+  abstract public function write($type, $id, $data);
+
+  /**
+   * Delete object from storage.
+   *
+   * @param string $type
+   *   Type of data (session, cache, etc.).
+   *
+   * @param string $id
+   *   Unique identifier.
+   *
+   * @return bool
+   *   Returns true on success, false on error.
+   */
+  abstract public function delete($type, $id);
+
+  /**
+   * List existing object IDs for a store type.
+   *
+   * This method should return an array with all id&#39;s of the
+   * selected type.
+   *
+   * @param string $type
+   *   Type of data (session, cache, etc.).
+   *
+   * @return array
+   */
+  abstract public function listIds($type);
+
+  /**
+   * Read metadata for object in store.
+   *
+   * The object returned should have the following structure:
+   *   obj-&gt;id    Id of the object.
+   *   obj-&gt;mac   Message authentication code.
+   *   obj-&gt;time  A Unix timestamp telling when the object was created.
+   *
+   * @param string $type
+   *   Type of data (session, cache, etc.).
+   *
+   * @param string $id
+   *   Unique identifier.
+   *
+   * @return obj
+   *   Return object with metadata.
+   */
+  abstract public function meta($type, $id);
+
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.token.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.token.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.token.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,60 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Provides CSRF protection methods.
+ */
+class phpsecToken {
+  /**
+   * Generate and save a one-time-token for a form. Used to protect against
+   * CSRF attacks.
+   *
+   * @param string $name
+   *   Name of the form to generate a token for.
+   *
+   * @param integer $ttl
+   *   How long the token should be valid in seconds.
+   *
+   * @return string
+   *   The token to supply with the form data.
+   */
+  public static function set($name, $ttl = 3600) {
+    $token = phpsecRand::str(32);
+    /* Save the token to the cahce. */
+    phpsecCache::cacheSet(&#39;token-&#39;.$name, $token, $ttl);
+    return $token;
+  }
+
+  /**
+   * Validate a one-time-token generated with setToken();
+   * This function should be called before accepting data from a user-submitted form.
+   * @see phpsecToken::setToken();
+   *
+   * @param string $name
+   *   Name of the form to validate the token for.
+   *
+   * @return boolean
+   *   Returns true if the token is valid. Returns false otherwise.
+   */
+  public static function validate($name, $token) {
+    if(strlen($token) == 0) {
+      return false;
+    }
+    $cacheToken = phpsecCache::cacheGet(&#39;token-&#39;.$name);
+    /* Check if the provided token matches the token in the cache. */
+    if($cacheToken == $token) {
+      /* Remove the token from the cahche so it can&#39;t be reused. */
+      phpsecCache::cacheRem(&#39;token-&#39;.$name);
+      return true;
+    }
+    return false;
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec/phpsec.yubikey.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec/phpsec.yubikey.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec/phpsec.yubikey.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,261 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * Implements validation of Yubikey against Yubico servers.
+ */
+class phpsecYubikey {
+  /**
+   * Yubico client Id.
+   * @see <a href="https://upgrade.yubico.com/getapikey/" rel="nofollow">https://upgrade.yubico.com/getapikey/</a>
+   */
+  public static $_clientId = null;
+
+  /**
+   * Yubico client shared secret.
+   * @see <a href="https://upgrade.yubico.com/getapikey/" rel="nofollow">https://upgrade.yubico.com/getapikey/</a>
+   */
+  public static $_clientSecret = null;
+
+  /**
+   * Number of servers to try before giving up.
+   */
+  public static $_numServers = 3;
+
+  /**
+   * Timeout in seconds for each server.
+   */
+  public static $_serverTimeout = 3;
+
+  /**
+   * Last error produced by phpsecYubikey::verify().
+   * @see <a href="http://phpseclib.com/manual/yubikey/errors" rel="nofollow">http://phpseclib.com/manual/yubikey/errors</a>
+   */
+  public static $lastError = null;
+
+  /**
+   * Yubico authentication servers.
+   */
+  private static $_servers = array(
+    &#39;<a href="http://api.yubico.com/wsapi/2.0/verify&#39" rel="nofollow">http://api.yubico.com/wsapi/2.0/verify&#39</a>;,
+    &#39;<a href="http://api2.yubico.com/wsapi/2.0/verify&#39" rel="nofollow">http://api2.yubico.com/wsapi/2.0/verify&#39</a>;,
+    &#39;<a href="http://api3.yubico.com/wsapi/2.0/verify&#39" rel="nofollow">http://api3.yubico.com/wsapi/2.0/verify&#39</a>;,
+    &#39;<a href="http://api4.yubico.com/wsapi/2.0/verify&#39" rel="nofollow">http://api4.yubico.com/wsapi/2.0/verify&#39</a>;,
+    &#39;<a href="http://api5.yubico.com/wsapi/2.0/verify&#39" rel="nofollow">http://api5.yubico.com/wsapi/2.0/verify&#39</a>;,
+  );
+
+  /**
+   * Verify Yubikey one time password against the Yubico servers.
+   *
+   * @param string $otp
+   *   One time password to verify.
+   *
+   * @return boolean
+   *   True on valid OTP, false on invalid. If this method returns false
+   *   phpsecYubikey::$lastError will contain details.
+   *
+   * @see <a href="http://phpseclib.com/manual/yubikey/errors" rel="nofollow">http://phpseclib.com/manual/yubikey/errors</a>
+   */
+  public static function verify($otp) {
+    if(self::$_clientId === null || self::$_clientSecret === null) {
+      self::$lastError = &#39;YUBIKEY_CLIENT_DATA_NEEDED&#39;;
+      return false;
+    }
+
+    if(!self::validOtp($otp)) {
+      self::$lastError = &#39;YUBIKEY_INVALID_OTP&#39;;
+      return false;
+    }
+    /* Setup the data needed to make the request. */
+    $data[&#39;otp&#39;]       = $otp;
+    $data[&#39;id&#39;]        = self::$_clientId;
+    $data[&#39;nonce&#39;]     = phpsecRand::str(20);
+    $data[&#39;timestamp&#39;] = 1;
+    $data[&#39;h&#39;]         = self::sign($data);
+
+    /* Do the request. */
+    $response = self::getResponse($data);
+    if($response === false) {
+      self::$lastError = &#39;YUBIKEY_SERVER_ERROR&#39;;
+      return false;
+    }
+
+    /* Check status of response. If not OK return false. */
+    if($response[&#39;status&#39;] != &#39;OK&#39;) {
+      switch($response[&#39;status&#39;]) {
+        case &#39;REPLAYED_OTP&#39;:
+          self::$lastError = &#39;YUBIKEY_SERVER_REPLAYED_OTP&#39;;
+          break;
+        case &#39;REPLAYED_REQUEST&#39;:
+          self::$lastError = &#39;YUBIKEY_SERVER_REPLAYED_REQUEST&#39;;
+          break;
+        case &#39;BAD_OTP&#39;:
+          self::$lastError = &#39;YUBIKEY_SERVER_BAD_OTP&#39;;
+          break;
+        case &#39;NO_SUCH_CLIENT&#39;:
+          self::$lastError = &#39;YUBIKEY_SERVER_NO_SUCH_CLIENT&#39;;
+          break;
+        case &#39;BAD_SIGNATURE&#39;:
+          self::$lastError = &#39;YUBIKEY_SERVER_BAD_SIGNATURE&#39;;
+          break;
+        default:
+          self::$lastError = &#39;YUBIKEY_SERVER_SAYS_NO&#39;;
+          break;
+      }
+      return false;
+    }
+
+    /* If tokens don&#39;t match return false. */
+    if($response[&#39;otp&#39;] != $otp) {
+      self::$lastError = &#39;YUBIKEY_NO_MATCH&#39;;
+      return false;
+    }
+
+    /* Sign the request to see if it matches signature from server. */
+    $signature = self::sign($response);
+    if($signature !== $response[&#39;h&#39;]) {
+      self::$lastError = &#39;YUBIKEY_BAD_SERVER_SIGNATURE&#39;;
+      return false;
+    }
+    return true;
+  }
+
+  /**
+   * Sign data using shared secret.
+   *
+   * @param array $data
+   *   Data to sign.
+   *
+   * @return string
+   *   Base64 encoded HMAC hash.
+   */
+  private static function sign($data) {
+    /* Remove signature from server. */
+    unset($data[&#39;h&#39;]);
+
+    /* Sort keys alphabetically. */
+    ksort($data);
+
+    /* Build query string to sign. */
+    $n = count($data);
+    $query = &#39;&#39;;
+    $i = 0;
+    while(list($key, $val) = each($data)) {
+      $i++;
+      $query .= $key.&#39;=&#39;.$val;
+      if($i &lt; $n) {
+        $query.= &#39;&amp;&#39;;
+      }
+    }
+
+    /* Sign. */
+    $sign = hash_hmac(&#39;sha1&#39;, utf8_encode($query), base64_decode(self::$_clientSecret), true);
+    return base64_encode($sign);
+  }
+
+  /**
+   * Make a request to the Yubico servers and get the response.
+   *
+   * @param array $data
+   *   Array containing the key/values for the request.
+   *
+   * @return array
+   *   Array containing key/values from the response.
+   */
+  private static function getResponse($data) {
+    /* Convert the array with data to a request string. */
+    $query = http_build_query($data);
+
+    /* Set up array with options for the context used by file_get_contents(). */
+    $opts = array(
+      &#39;http&#39;=&gt;array(
+        &#39;method&#39;  =&gt; &#39;GET&#39;,
+        &#39;timeout&#39; =&gt; self::$_serverTimeout,
+        &#39;header&#39;  =&gt; &#34;Accept-language: en\r\n&#34; .
+                     &#34;User-Agent: phpSec (<a href="http://phpseclib.com)\r\n&#34" rel="nofollow">http://phpseclib.com)\r\n&#34</a>;
+      )
+    );
+
+    /* Create context. Allowing us to specify User-Agent. */
+    $context = stream_context_create($opts);
+
+    /* Try to get response from Yubico server. */
+    $attempts = 0;
+    $response = false;
+    while($response === false &amp;&amp; $attempts &lt; self::$_numServers) {
+      /* select a Yubico API server. */
+      $server = array_rand(self::$_servers);
+      $response = @file_get_contents(self::$_servers[$server].&#39;?&#39;.$query, null, $context);
+      $attempts++;
+    }
+
+    if($response === false) {
+      /* Could not make request. */
+      return false;
+    }
+
+    /* Parse response and create an array with the data. */
+    $lines = explode(&#34;\r\n&#34;, $response);
+     foreach($lines as $line) {
+       if(trim($line) != &#39;&#39;) {
+         list($key, $val) = explode(&#34;=&#34;, $line, 2);
+         $rdata[$key] = trim($val);
+       }
+    }
+
+    /* All done. */
+    return $rdata;
+  }
+
+  /**
+   * Validate a string as a one-time-password.
+   * A valid OTP should consist of 32-48 printable characters.
+   *
+   * @param string $otp
+   *   String to Validate
+   *
+   * @return boolean
+   *   True if the OTP is valid, false on error.
+   */
+  private static function validOtp($otp) {
+    $length  = strlen($otp);
+
+    /* Check length. */
+    if($length &gt; 48 || $length &lt; 32) {
+      return false;
+    }
+
+    /* Check for printable charcters (no whitespace). */
+    return ctype_graph($otp);
+  }
+
+  /**
+   * Get the identity of a Yubikey OTP.
+   * The identity part is the same for every OTP, and it is the initial 2-16 modhex characters of the OTP.
+   * Since the rest of the OTP is always 32 characters, the method to extract the identity is to remove
+   * 32 characters from the end and then use the remaining string, which should be 2-16 characters,
+   * as the YubiKey identity.
+   *
+   * @param string $otp
+   *   The one time password to get the identity from.
+   *
+   * @return string
+   *   Returns the Yubikey identity, or false on failure.
+   */
+  public static function getYubikeyId($otp) {
+    if(!self::validOtp($otp)) {
+      return false;
+    }
+
+    $idLen = strlen($otp) - 32;
+    return substr($otp, 0, $idLen);
+  }
+}
\ No newline at end of file

Added: branches/9.x/lib/phpsec/phpsec.class.php
===================================================================
--- branches/9.x/lib/phpsec/phpsec.class.php	                        (rev 0)
+++ branches/9.x/lib/phpsec/phpsec.class.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -0,0 +1,298 @@
+&lt;?php
+/**
+  phpSec - A PHP security library
+
+  @author    Audun Larsen &lt;larsen@...&gt;
+  @copyright Copyright (c) Audun Larsen, 2011, 2012
+  @link      <a href="https://github.com/phpsec/phpSec" rel="nofollow">https://github.com/phpsec/phpSec</a>
+  @license   <a href="http://opensource.org/licenses/mit-license.php" rel="nofollow">http://opensource.org/licenses/mit-license.php</a> The MIT License
+  @package   phpSec
+ */
+
+/**
+ * phpSec core functionality.
+ */
+class phpsec {
+
+  /**
+   * Config: Charset used for filter methods.
+   */
+  public static $_charset = &#39;utf-8&#39;;
+
+  /**
+   * Config: Database Source Name.
+   */
+  public static $_dsn = null;
+
+  /**
+   * Config: Enable phpSec session handler.
+   */
+  public static $_sessenable = true;
+
+  /**
+   * Config: Enable phpSec secure cookies.
+   */
+  public static $_cookieenable = false;
+
+  /**
+   * User identifier.
+   */
+  public static $uid = null;
+
+  /**
+   * Storage object.
+   */
+  public static $store = null;
+
+  /**
+   * Constant: Hash method to use.
+   * This is on it&#39;s way to be deprecated.
+   */
+  const HASH_TYPE = &#39;sha256&#39;;
+
+  /**
+   * Constant: Version number. Isn&#39;t really
+   * used for something... yet.
+   */
+  const VERSION = &#39;0.3-beta&#39;;
+
+  /**
+   * Autoload methos to load required files when needed.
+   *
+   * @param string $class
+   *   Class that PHP is looking for.
+   *
+   * @return bool
+   *   True on success, false on error.
+   */
+  public static function load($class) {
+    $basePath = dirname(__FILE__);
+
+    $classes[&#39;stateless&#39;] = array(
+      &#39;phpsecCrypt&#39;           =&gt; &#39;phpsec.crypt.php&#39;,
+      &#39;phpsecFilter&#39;          =&gt; &#39;phpsec.filter.php&#39;,
+      &#39;phpsecPw&#39;              =&gt; &#39;phpsec.pw.php&#39;,
+      &#39;phpsecHash&#39;            =&gt; &#39;phpsec.hash.php&#39;,
+      &#39;phpsecRand&#39;            =&gt; &#39;phpsec.rand.php&#39;,
+      &#39;phpsecYubikey&#39;         =&gt; &#39;phpsec.yubikey.php&#39;,
+    );
+
+    $classes[&#39;stateful&#39;] = array(
+      &#39;phpsecCache&#39;           =&gt; &#39;phpsec.cache.php&#39;,
+      &#39;phpsecOtp&#39;             =&gt; &#39;phpsec.otp.php&#39;,
+      &#39;phpsecOtpcard&#39;         =&gt; &#39;phpsec.otpcard.php&#39;,
+      &#39;phpsecSession&#39;         =&gt; &#39;phpsec.session.php&#39;,
+      &#39;phpsecStore&#39;           =&gt; &#39;phpsec.store.php&#39;,
+      &#39;phpsecStoreFilesystem&#39; =&gt; &#39;phpsec.store.filesystem.php&#39;,
+      &#39;phpsecStorePdo&#39;        =&gt; &#39;phpsec.store.pdo.php&#39;,
+      &#39;phpsecToken&#39;           =&gt; &#39;phpsec.token.php&#39;,
+    );
+
+    /* If we don&#39;t have a DSN, only get the parts of phpSec that don&#39;t need storage.  */
+    if(self::$_dsn === null) {
+      $classes = $classes[&#39;stateless&#39;];
+    } else {
+      $classes = array_merge($classes[&#39;stateful&#39;], $classes[&#39;stateless&#39;]);
+    }
+
+    /* Check if we know about the class, and if the file exists. */
+    if(isset($classes[$class]) &amp;&amp; file_exists($basePath.&#39;/phpsec/&#39;.$classes[$class])) {
+      require_once $basePath.&#39;/phpsec/&#39;.$classes[$class];
+      return true;
+    }
+    return false;
+  }
+
+  /**
+   * Initialize the library.
+   * This method actually does several things:
+   * 1. Registers the phpsec::load() method as autoload function.
+   * 2. Opens the store. (connect to database etc.)
+   * 3. Set charset for multibyte functions.
+   * 4. Enable the phpSec session handler and starts a session (if session handler is enabled).
+   * 5. Set&#39;s or get a UID that is used by phpsecCache.
+   * 6. Decrypts cookies (if enabled).
+   *
+   * If no DSN (storage method) is configured. This method will stop after completing step 1.
+   *
+   * @return bool true
+   *   Will always return true.
+   */
+  public static function init() {
+    /* First of all, register the autoloading function.
+     * If we have one set from somewhere else, keep it. */
+     $autoLoadFunctions   = spl_autoload_functions();
+     $autoLoadFunctions[] = &#39;phpsec::load&#39;;
+     foreach($autoLoadFunctions as $autoLoadFunction) {
+       spl_autoload_register($autoLoadFunction);
+     }
+
+    /* Autoloader all good to go. If we don&#39;t have a storage set
+     * we can skip the rest of this method. */
+    if(self::$_dsn === null) {
+      return true;
+    }
+    /* Open store. */
+    list($storeType, $storeDest) = explode(&#39;:&#39;, self::$_dsn);
+    switch($storeType) {
+      case &#39;filesystem&#39;:
+        self::$store = new phpsecStoreFilesystem($storeDest);
+      break;
+      case &#39;mysql&#39;:
+        self::$store = new phpsecStorePdo($storeDest);
+      break;
+      default:
+      self::error(&#39;Store type(&#39;.$storeType.&#39;) invalid&#39;, E_USER_ERROR);
+    }
+
+    /* Set the charset of the multibyte functions in PHP. */
+    mb_internal_encoding(self::$_charset);
+    mb_regex_encoding(self::$_charset);
+
+    /* Enable the custom session handler if enabled. */
+    if(self::$_sessenable === true) {
+      ini_set(&#39;session.save_handler&#39;, &#39;user&#39;);
+      session_set_save_handler(
+        &#39;phpsecSession::open&#39;,
+        &#39;phpsecSession::close&#39;,
+        &#39;phpsecSession::read&#39;,
+        &#39;phpsecSession::write&#39;,
+        &#39;phpsecSession::destroy&#39;,
+        &#39;phpsecSession::gc&#39;
+      );
+
+      /* Since we set a session cookie on our session handler, disable the built-in cookies. */
+      ini_set(&#39;session.use_cookies&#39;, 0);
+
+      /* Start a new session. */
+      session_start();
+
+      /* Check the fingerprint to see if it matches, if not clear session data. */
+      $fingerprint = hash(self::HASH_TYPE, &#39;phpSec-fingerprint&#39;.$_SERVER[&#39;HTTP_USER_AGENT&#39;]);
+      if(!isset($_SESSION[&#39;phpSec-fingerprint&#39;])) {
+        $_SESSION[&#39;phpSec-fingerprint&#39;] = $fingerprint;
+      }
+      if($fingerprint != $_SESSION[&#39;phpSec-fingerprint&#39;]) {
+        $_SESSION = array();
+      }
+    }
+
+    /* Create a random token for each visitor and store it the users session.
+       This is for example used to identify owners of cache data. */
+    if(!isset($_SESSION[&#39;phpSec-uid&#39;])) {
+      self::$uid = self::genUid();
+      $_SESSION[&#39;phpSec-uid&#39;] = self::$uid;
+    } else {
+      self::$uid = $_SESSION[&#39;phpSec-uid&#39;];
+    }
+
+    /* If the phpSec secure cookie monster is enabled detect encrypted cookies. */
+    if(self::$_cookieenable === true) {
+      phpsecCookie::detect();
+    }
+    return true;
+  }
+
+  /**
+   * Provides the library a simple way of reporting errors to the developer using PHPs error
+   * handler.
+   *
+   * @param string $msg
+   *   String containing the error message
+   *
+   * @param constant $level
+   *   Error level (optional).
+   *   If none is specified E_USER_WARNING is used.
+   */
+  public static function error($msg, $level = E_USER_WARNING) {
+    $callee = next(debug_backtrace());
+    trigger_error($msg.&#39;. (Called from &lt;strong&gt;&#39;.$callee[&#39;file&#39;].&#39; line &#39;.$callee[&#39;line&#39;].&#39;&lt;/strong&gt;)&#39;, $level);
+  }
+
+  /**
+   * Returns a unique identifier in the format spsecified in
+   * OpenID Authentication 2.0 protocol.
+   * For example: 2005-05-15T17:11:51ZUNIQUE
+   * This function is used to generate all unique tokens used by
+   * phpSec.
+   * @see <a href="http://openid.net/specs/openid-authentication-2_0.html" rel="nofollow">http://openid.net/specs/openid-authentication-2_0.html</a>
+   *
+   * @param integer $length
+   *   The total length of the uid. Must be above 25.
+   */
+  public static function genUid($length = 50) {
+    if($length &lt; 25) {
+      self::error(&#39;Length must be longer than 25&#39;);
+      return false;
+    }
+    $timeStamp = gmdate(&#39;Y-m-d\TH:i:se&#39;);
+    $randLength = $length-strlen($timeStamp);
+    return $timeStamp.phpsecRand::str($randLength);
+  }
+
+  /**
+   * Check structure of an array.
+   * This method checks the structure of an array (only the first layer of it) against
+   * a defined set of rules.
+   *
+   * @param array $array
+   *   Array to check.
+   *
+   * @param array $structure
+   *   Expected array structure. Defined for example like this:
+   *   array(
+   *     &#39;string&#39; =&gt; array(
+   *       &#39;callback&#39; =&gt; &#39;strlen&#39;,
+   *       &#39;params&#39;   =&gt; array(&#39;%val&#39;),
+   *       &#39;match&#39;    =&gt; 3,
+   *     ),
+   *     &#39;not allowed&#39; = false, // Only makes sense with $strict = false
+   *     &#39;needed&#39;      = true,
+   *   ),
+   *
+   * @param bool $strict
+   *   If strict is set to false we will allow keys that&#39;s not defined in the structure.
+   */
+  public static function arrayCheck($array, $structure, $strict = true) {
+    $success = true;
+    /* First compare the size of the two arrays. Return error if strict is enabled. */
+    if(sizeof($array) != sizeof($structure) &amp;&amp; $strict === true) {
+      self::error(&#39;Array does not match defined structure&#39;);
+      return false;
+    }
+
+    /* Loop trough all the defined keys defined in the structure. */
+    foreach($structure as $key =&gt; $callbackArray) {
+      if(isset($array[$key])) {
+        /* The key exists in the array we are checking. */
+
+        if(is_array($callbackArray) &amp;&amp; isset($callbackArray[&#39;callback&#39;])) {
+          /* We have a callback. */
+
+          /* Replace %val with the acutal value of the key. */
+          $callbackArray[&#39;params&#39;] = str_replace(&#39;%val&#39;, $array[$key], $callbackArray[&#39;params&#39;]);
+
+          if(call_user_func_array($callbackArray[&#39;callback&#39;], $callbackArray[&#39;params&#39;]) !== $callbackArray[&#39;match&#39;]) {
+            /* Call the *duh* callback. If this returns false throw error, or an axe. */
+            self::error(&#39;Array does not match defined structure. The &#39;.$key.&#39; key did not pass the &#39;.$callbackArray[&#39;callback&#39;].&#39; callback&#39;);
+            $success = false;
+          }
+        } elseif($callbackArray === false) {
+          /* We don&#39;t have a callback, but we have found a disallowed key. */
+          self::error(&#39;Array does not match defined structure. &#39;.$key.&#39; is not allowed&#39;);
+          $success = false;
+        }
+      } else {
+        /* The key don&#39;t exist in the array we are checking. */
+
+        if($callbackArray !== false) {
+          /* As long as this is not a disallowed key, sound the general alarm. */
+          self::error(&#39;Array does not match defined structure. &#39;.$key.&#39; not defined&#39;);
+          $success = false;
+        }
+      }
+    }
+    return $success;
+  }
+}
+

Modified: branches/9.x/lib/tikilib.php
===================================================================
--- branches/9.x/lib/tikilib.php	2012-04-29 16:29:01 UTC (rev 41176)
+++ branches/9.x/lib/tikilib.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -257,6 +257,21 @@
 		return $eventManager;
 	}
 
+	public function get_site_hash()
+	{
+		global $prefs;
+
+		if (! isset($prefs[&#39;internal_site_hash&#39;])) {
+			require_once &#39;lib/phpsec/phpsec/phpsec.rand.php&#39;;
+
+			$hash = phpsecRand::bytes(100);
+
+			$this-&gt;set_preference(&#39;internal_site_hash&#39;, $hash);
+		}
+
+		return $prefs[&#39;internal_site_hash&#39;];
+	}
+
 	// DB param left for interface compatibility, although not considered
 	function __construct( $db = null )
 	{

Modified: branches/9.x/lib/userslib.php
===================================================================
--- branches/9.x/lib/userslib.php	2012-04-29 16:29:01 UTC (rev 41176)
+++ branches/9.x/lib/userslib.php	2012-04-29 17:12:42 UTC (rev 41177)
@@ -5946,7 +5946,7 @@
 
 	function renew_user_password($user)
 	{
-		$pass = $this-&gt;genPass();
+		$pass = $this-&gt;generate_provisional_password();
 		// Note that tiki-generated passwords are due inmediatley
 		// Note: ^ not anymore. old pw is usable until the URL in the password reminder mail is clicked
 		$query = &#39;update `users_users` set `provpass` = ? where `login`=?&#39;;
@@ -5954,6 +5954,18 @@
 		return $pass;
 	}
 
+	private function generate_provisional_password()
+	{
+		global $tikilib;
+		require_once &#39;lib/phpsec/phpsec/phpsec.rand.php&#39;;
+
+		$site_hash = $tikilib-&gt;get_site_hash();
+
+		$random_value = phpsecRand::bytes(40);
+
+		return base64_encode(sha1($random_value . $site_hash, true));
+	}
+
 	function activate_password($user, $actpass)
 	{
 		// move provpass to password and generate new hash, afterwards clean provpass

Modified: branches/9.x/templates/mail/password_reminder.tpl
===================================================================
--- branches/9.x/templates/mail/password_reminder.tpl	2012-04-29 16:29:01 UTC (rev 41176)
+++ branches/9.x/templates/mail/password_reminder.tpl	2012-04-29 17:12:42 UTC (rev 41177)
@@ -6,7 +6,7 @@
 	{tr}Since this is your registered email address we inform that the password for this account is{/tr} {$mail_pass}
 {else}
 	{tr}Please click on the following link to confirm you wish to reset your password and go to the screen where you must enter a new &#34;permanent&#34; password. Please pick a password only you will know, and don&#39;t share it with anyone else.{/tr}
-{$mail_machine}/tiki-change_password.php?user={$mail_user|escape:&#39;url&#39;}&amp;actpass={$mail_apass}
+{$mail_machine}/tiki-change_password.php?user={$mail_user|escape:&#39;url&#39;}&amp;actpass={$mail_apass|escape:&#39;url&#39;}
 
 	{tr}Important: Username &amp; password are CaSe SenSitiVe{/tr}
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29197583">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29197583/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41200] branches/9.x</a></b></div>
      
      <small>From: &lt;lindonb@us...&gt; - 2012-04-30 00:44:28</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41200
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41200&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41200&amp;view=rev</a>
Author:   lindonb
Date:     2012-04-30 00:44:22 +0000 (Mon, 30 Apr 2012)
Log Message:
-----------
Notices

Modified Paths:
--------------
    branches/9.x/templates/tiki.tpl
    branches/9.x/tiki-login_scr.php

Modified: branches/9.x/templates/tiki.tpl
===================================================================
--- branches/9.x/templates/tiki.tpl	2012-04-29 22:22:08 UTC (rev 41199)
+++ branches/9.x/templates/tiki.tpl	2012-04-30 00:44:22 UTC (rev 41200)
@@ -130,7 +130,7 @@
 								{/if}
 							&lt;/div&gt;{* -- END of #c1c2 -- *}
 							{if $prefs.feature_fullscreen != &#39;y&#39; or $smarty.session.fullscreen != &#39;y&#39;}
-								{if  $prefs.feature_right_column eq &#39;fixed&#39; or ($prefs.feature_right_column ne &#39;n&#39; &amp;&amp; $right_modules|@count &gt; 0 &amp;&amp; $show_columns.right_modules ne &#39;n&#39;) or $module_pref_errors}
+								{if  $prefs.feature_right_column eq &#39;fixed&#39; or ($prefs.feature_right_column ne &#39;n&#39; &amp;&amp; $right_modules|@count &gt; 0 &amp;&amp; $show_columns.right_modules ne &#39;n&#39;) or (isset($module_pref_errors) and $module_pref_errors)}
 									&lt;div class=&#34;clearfix&#34; id=&#34;col3&#34;{if $prefs.feature_right_column eq &#39;user&#39;} style=&#34;display:{if isset($cookie.show_col3) and $cookie.show_col3 ne &#39;y&#39;} none{elseif isset($ie6)} block{else} table-cell{/if};&#34;{/if}{if $prefs.feature_bidi eq &#39;y&#39;} dir=&#34;rtl&#34;{/if}&gt;
 										&lt;div id=&#34;right_modules&#34; class=&#34;content modules&#34;&gt;
 											{if $module_pref_errors}

Modified: branches/9.x/tiki-login_scr.php
===================================================================
--- branches/9.x/tiki-login_scr.php	2012-04-29 22:22:08 UTC (rev 41199)
+++ branches/9.x/tiki-login_scr.php	2012-04-30 00:44:22 UTC (rev 41200)
@@ -26,9 +26,17 @@
 $smarty-&gt;assign(&#39;headtitle&#39;, tra(&#39;Log In&#39;));
 $module_params = array(
 	&#39;mode&#39; =&gt; &#39;module&#39;,
-	&#39;show_register&#39; =&gt; &#39;y&#39;,
-	&#39;show_forgot&#39; =&gt; &#39;y&#39;,
+	&#39;show_register&#39;		=&gt; &#39;y&#39;,
+	&#39;show_forgot&#39;		=&gt; &#39;y&#39;,
+	&#39;error&#39;				=&gt; &#39;&#39;,
+	&#39;flip&#39;				=&gt; &#39;&#39;,
+	&#39;decorations&#39;		=&gt; &#39;&#39;,
+	&#39;nobox&#39;				=&gt; &#39;&#39;,
+	&#39;notitle&#39;			=&gt; &#39;&#39;,
+	&#39;style&#39;				=&gt; &#39;&#39;,
 );
+$smarty-&gt;assign(&#39;mode&#39;, &#39;&#39;);
+$smarty-&gt;assign(&#39;section&#39;, &#39;&#39;);
 $smarty-&gt;assign(&#39;module_params&#39;, $module_params);
 $smarty-&gt;assign(&#39;mid&#39;, &#39;tiki-login.tpl&#39;);
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29197804">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29197804/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41204] branches/9.x</a></b></div>
      
      <small>From: &lt;lindonb@us...&gt; - 2012-04-30 02:50:00</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41204
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41204&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41204&amp;view=rev</a>
Author:   lindonb
Date:     2012-04-30 02:49:54 +0000 (Mon, 30 Apr 2012)
Log Message:
-----------
Notices - setting variables and checking if variables are set

Modified Paths:
--------------
    branches/9.x/templates/categorize.tpl
    branches/9.x/tiki-admin_calendars.php

Modified: branches/9.x/templates/categorize.tpl
===================================================================
--- branches/9.x/templates/categorize.tpl	2012-04-30 02:25:54 UTC (rev 41203)
+++ branches/9.x/templates/categorize.tpl	2012-04-30 02:49:54 UTC (rev 41204)
@@ -2,9 +2,9 @@
 {if !isset($notable) || $notable neq &#39;y&#39;}
 &lt;tr&gt;
  &lt;td&gt;{tr}Categorize{/tr}&lt;/td&gt;
- &lt;td{if $colsCategorize} colspan=&#34;{$colsCategorize}&#34;{/if}&gt;
+ &lt;td{if isset($colsCategorize)} colspan=&#34;{$colsCategorize}&#34;{/if}&gt;
 {/if}
-{if $mandatory_category &gt;= 0 or $prefs.javascript_enabled neq &#39;y&#39; or $auto eq &#39;y&#39;}
+{if $mandatory_category &gt;= 0 or $prefs.javascript_enabled neq &#39;y&#39; or (isset($auto) and $auto eq &#39;y&#39;)}
   &lt;div id=&#34;categorizator&#34;&gt;
 {else}
 {if !isset($notable) || $notable neq &#39;y&#39;}{button href=&#34;#&#34; _flip_id=&#39;categorizator&#39; _class=&#39;link&#39; _text=&#34;{tr}Select Categories{/tr}&#34; _flip_default_open=&#39;n&#39;}{/if}

Modified: branches/9.x/tiki-admin_calendars.php
===================================================================
--- branches/9.x/tiki-admin_calendars.php	2012-04-30 02:25:54 UTC (rev 41203)
+++ branches/9.x/tiki-admin_calendars.php	2012-04-30 02:49:54 UTC (rev 41204)
@@ -147,10 +147,13 @@
 	$info[&#34;show_participants&#34;] = &#39;n&#39;;
 	$info[&#34;show_url&#34;] = &#39;n&#39;;
 	$info[&#39;show_status&#39;] = &#39;n&#39;;
+	$info[&#39;show_status_calview&#39;] = &#39;&#39;;
 	$info[&#34;user&#34;] = &#34;$user&#34;;
 	$info[&#34;personal&#34;] = &#39;n&#39;;
 	$info[&#34;startday&#34;] = &#39;25200&#39;;
 	$info[&#34;endday&#34;] = &#39;72000&#39;;
+	$info[&#34;allday&#34;] = &#39;&#39;;
+	$info[&#34;nameoneachday&#34;] = &#39;&#39;;
 	$info[&#34;defaulteventstatus&#34;] = 1;
 	$info[&#39;viedays&#39;] = $prefs[&#39;calendar_view_days&#39;];
 	if (!empty($_REQUEST[&#39;show&#39;]) &amp;&amp; $_REQUEST[&#39;show&#39;] == &#39;mod&#39;) {

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29200622">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29200622/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41213] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-04-30 17:56:25</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41213
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev</a>
Author:   robertplummer
Date:     2012-04-30 17:56:17 +0000 (Mon, 30 Apr 2012)
Log Message:
-----------
[FIX] Minify was failing for tablesorter, use their min file as external which passes min fine; found a syntax issue

Modified Paths:
--------------
    branches/9.x/lang/en/language.js
    branches/9.x/tiki-setup.php

Modified: branches/9.x/lang/en/language.js
===================================================================
--- branches/9.x/lang/en/language.js	2012-04-30 16:54:21 UTC (rev 41212)
+++ branches/9.x/lang/en/language.js	2012-04-30 17:56:17 UTC (rev 41213)
@@ -7,56 +7,56 @@
 
 lang = {
 &#34;Which Continent Do You Live In?&#34; : &#34;EN Dans quel continent habitez-vous ?&#34;,
-	&#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;,
-//	&#34;Very Secure&#34; : &#34;Very Secure&#34;,
-//	&#34;Secure&#34; : &#34;Secure&#34;,
-//	&#34;Very Strong&#34; : &#34;Very Strong&#34;,
-//	&#34;Strong&#34; : &#34;Strong&#34;,
-//	&#34;Average&#34; : &#34;Average&#34;,
-//	&#34;Weak&#34; : &#34;Weak&#34;,
-//	&#34;Very Weak&#34; : &#34;Very Weak&#34;,
-//	&#34;Strength&#34; : &#34;Strength&#34;,
-//	&#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
-//	&#34;Passwords match&#34; : &#34;Passwords match&#34;,
-//	&#34;Valid Email&#34; : &#34;Valid Email&#34;,
-//	&#34;Close&#34; : &#34;Close&#34;,
-//	&#34;Submit&#34; : &#34;Submit&#34;,
-//	&#34;Insert&#34; : &#34;Insert&#34;,
-//	&#34;Replace&#34; : &#34;Replace&#34;,
-//	&#34;Match&#34; : &#34;Match&#34;,
-//	&#34;Do not match&#34; : &#34;Do not match&#34;,
-//	&#34;Advanced options&#34; : &#34;Advanced options&#34;,
-//	&#34;Pick a file.&#34; : &#34;Pick a file.&#34;
-//	&#34;Add Field&#34; : &#34;Add Field&#34;,
-//	&#34;Edit Field&#34; : &#34;Edit Field&#34;,
-//	&#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
-//	&#34;Save&#34; : &#34;Save&#34;,
-//	&#34;Cancel&#34; : &#34;Cancel&#34;,
-//	&#34;Delete&#34; : &#34;Delete&#34;,	
-//	&#34;Unassign module&#34; : &#34;Unassign module&#34;,
-//	&#34;Edit module&#34; : &#34;Edit module&#34;,
-//	&#34;Edit module:&#34; : &#34;Edit module:&#34;,
-//	&#34;Favorite&#34; : &#34;Favorite&#34;,
-//	&#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
-//	&#34;Filter:&#34; : &#34;Filter:&#34;,
-//	&#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
-//	&#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
-//	&#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
+	&#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;/*,
+	&#34;Very Secure&#34; : &#34;Very Secure&#34;,
+	&#34;Secure&#34; : &#34;Secure&#34;,
+	&#34;Very Strong&#34; : &#34;Very Strong&#34;,
+	&#34;Strong&#34; : &#34;Strong&#34;,
+	&#34;Average&#34; : &#34;Average&#34;,
+	&#34;Weak&#34; : &#34;Weak&#34;,
+	&#34;Very Weak&#34; : &#34;Very Weak&#34;,
+	&#34;Strength&#34; : &#34;Strength&#34;,
+	&#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
+	&#34;Passwords match&#34; : &#34;Passwords match&#34;,
+	&#34;Valid Email&#34; : &#34;Valid Email&#34;,
+	&#34;Close&#34; : &#34;Close&#34;,
+	&#34;Submit&#34; : &#34;Submit&#34;,
+	&#34;Insert&#34; : &#34;Insert&#34;,
+	&#34;Replace&#34; : &#34;Replace&#34;,
+	&#34;Match&#34; : &#34;Match&#34;,
+	&#34;Do not match&#34; : &#34;Do not match&#34;,
+	&#34;Advanced options&#34; : &#34;Advanced options&#34;,
+	&#34;Pick a file.&#34; : &#34;Pick a file.&#34;
+	&#34;Add Field&#34; : &#34;Add Field&#34;,
+	&#34;Edit Field&#34; : &#34;Edit Field&#34;,
+	&#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
+	&#34;Save&#34; : &#34;Save&#34;,
+	&#34;Cancel&#34; : &#34;Cancel&#34;,
+	&#34;Delete&#34; : &#34;Delete&#34;,
+	&#34;Unassign module&#34; : &#34;Unassign module&#34;,
+	&#34;Edit module&#34; : &#34;Edit module&#34;,
+	&#34;Edit module:&#34; : &#34;Edit module:&#34;,
+	&#34;Favorite&#34; : &#34;Favorite&#34;,
+	&#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
+	&#34;Filter:&#34; : &#34;Filter:&#34;,
+	&#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
+	&#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
+	&#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
 	// remember the IE does not support ending comma on last item
-//	&#34;Add Field&#34; : &#34;Add Field&#34;,
-//	&#34;Edit Field&#34; : &#34;Edit Field&#34;,
-//	&#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
-//	&#34;Save&#34; : &#34;Save&#34;,
-//	&#34;Cancel&#34; : &#34;Cancel&#34;,
-//	&#34;Delete&#34; : &#34;Delete&#34;,	
-//	&#34;Unassign module&#34; : &#34;Unassign module&#34;,
-//	&#34;Edit module&#34; : &#34;Edit module&#34;,
-//	&#34;Edit module:&#34; : &#34;Edit module:&#34;,
-//	&#34;Favorite&#34; : &#34;Favorite&#34;,
-//	&#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
-//	&#34;Filter:&#34; : &#34;Filter:&#34;,
-//	&#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
-//	&#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
-//	&#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
-	// remember the IE does not support ending comma on last item
+	&#34;Add Field&#34; : &#34;Add Field&#34;,
+	&#34;Edit Field&#34; : &#34;Edit Field&#34;,
+	&#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
+	&#34;Save&#34; : &#34;Save&#34;,
+	&#34;Cancel&#34; : &#34;Cancel&#34;,
+	&#34;Delete&#34; : &#34;Delete&#34;,
+	&#34;Unassign module&#34; : &#34;Unassign module&#34;,
+	&#34;Edit module&#34; : &#34;Edit module&#34;,
+	&#34;Edit module:&#34; : &#34;Edit module:&#34;,
+	&#34;Favorite&#34; : &#34;Favorite&#34;,
+	&#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
+	&#34;Filter:&#34; : &#34;Filter:&#34;,
+	&#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
+	&#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
+	&#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
+	// remember the IE does not support ending comma on last item*/
 };

Modified: branches/9.x/tiki-setup.php
===================================================================
--- branches/9.x/tiki-setup.php	2012-04-30 16:54:21 UTC (rev 41212)
+++ branches/9.x/tiki-setup.php	2012-04-30 17:56:17 UTC (rev 41213)
@@ -335,8 +335,14 @@
 		}
 		if ( $prefs[&#39;feature_jquery_tablesorter&#39;] == &#39;y&#39; ) {
 			$headerlib-&gt;add_cssfile(&#39;lib/jquery_tiki/tablesorter/themes/tiki/style.css&#39;);
-			$headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.js&#39;);
-			$headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
+			$headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.min.js&#39;);
+
+			if ( $prefs[&#39;tiki_minify_javascript&#39;] === &#39;y&#39; ) {
+				//tablesorter has bad syntax in the non-min file, however the min file seems to work fine when double minned :)
+				$headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.min.js&#39;, &#39;external&#39;);
+			} else {
+				$headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
+			}
 		}
 		if ( $prefs[&#39;feature_shadowbox&#39;] == &#39;y&#39; ) {
 			$headerlib-&gt;add_jsfile(&#39;lib/jquery/colorbox/jquery.colorbox.js&#39;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29200788">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29200788/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41213] branches/9.x</a></b></div>
      
      <small>From: Marc Laporte &lt;marc@ma...&gt; - 2012-04-30 18:37:36</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Thanks for minify fix

are branches/9.x/lang/en/language.js changes intentional?

Thanks!


On Mon, Apr 30, 2012 at 1:56 PM,  &lt;robertplummer@...&gt; wrote:
&gt; Revision: 41213
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev</a>
&gt; Author:   robertplummer
&gt; Date:     2012-04-30 17:56:17 +0000 (Mon, 30 Apr 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] Minify was failing for tablesorter, use their min file as external which passes min fine; found a syntax issue
&gt;
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lang/en/language.js
&gt;    branches/9.x/tiki-setup.php
&gt;
&gt; Modified: branches/9.x/lang/en/language.js
&gt; ===================================================================
&gt; --- branches/9.x/lang/en/language.js    2012-04-30 16:54:21 UTC (rev 41212)
&gt; +++ branches/9.x/lang/en/language.js    2012-04-30 17:56:17 UTC (rev 41213)
&gt; @@ -7,56 +7,56 @@
&gt;
&gt;  lang = {
&gt;  &#34;Which Continent Do You Live In?&#34; : &#34;EN Dans quel continent habitez-vous ?&#34;,
&gt; -       &#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;,
&gt; -//     &#34;Very Secure&#34; : &#34;Very Secure&#34;,
&gt; -//     &#34;Secure&#34; : &#34;Secure&#34;,
&gt; -//     &#34;Very Strong&#34; : &#34;Very Strong&#34;,
&gt; -//     &#34;Strong&#34; : &#34;Strong&#34;,
&gt; -//     &#34;Average&#34; : &#34;Average&#34;,
&gt; -//     &#34;Weak&#34; : &#34;Weak&#34;,
&gt; -//     &#34;Very Weak&#34; : &#34;Very Weak&#34;,
&gt; -//     &#34;Strength&#34; : &#34;Strength&#34;,
&gt; -//     &#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
&gt; -//     &#34;Passwords match&#34; : &#34;Passwords match&#34;,
&gt; -//     &#34;Valid Email&#34; : &#34;Valid Email&#34;,
&gt; -//     &#34;Close&#34; : &#34;Close&#34;,
&gt; -//     &#34;Submit&#34; : &#34;Submit&#34;,
&gt; -//     &#34;Insert&#34; : &#34;Insert&#34;,
&gt; -//     &#34;Replace&#34; : &#34;Replace&#34;,
&gt; -//     &#34;Match&#34; : &#34;Match&#34;,
&gt; -//     &#34;Do not match&#34; : &#34;Do not match&#34;,
&gt; -//     &#34;Advanced options&#34; : &#34;Advanced options&#34;,
&gt; -//     &#34;Pick a file.&#34; : &#34;Pick a file.&#34;
&gt; -//     &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt; -//     &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt; -//     &#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt; -//     &#34;Save&#34; : &#34;Save&#34;,
&gt; -//     &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt; -//     &#34;Delete&#34; : &#34;Delete&#34;,
&gt; -//     &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt; -//     &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt; -//     &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt; -//     &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt; -//     &#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
&gt; -//     &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt; -//     &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt; -//     &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt; -//     &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
&gt; +       &#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;/*,
&gt; +       &#34;Very Secure&#34; : &#34;Very Secure&#34;,
&gt; +       &#34;Secure&#34; : &#34;Secure&#34;,
&gt; +       &#34;Very Strong&#34; : &#34;Very Strong&#34;,
&gt; +       &#34;Strong&#34; : &#34;Strong&#34;,
&gt; +       &#34;Average&#34; : &#34;Average&#34;,
&gt; +       &#34;Weak&#34; : &#34;Weak&#34;,
&gt; +       &#34;Very Weak&#34; : &#34;Very Weak&#34;,
&gt; +       &#34;Strength&#34; : &#34;Strength&#34;,
&gt; +       &#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
&gt; +       &#34;Passwords match&#34; : &#34;Passwords match&#34;,
&gt; +       &#34;Valid Email&#34; : &#34;Valid Email&#34;,
&gt; +       &#34;Close&#34; : &#34;Close&#34;,
&gt; +       &#34;Submit&#34; : &#34;Submit&#34;,
&gt; +       &#34;Insert&#34; : &#34;Insert&#34;,
&gt; +       &#34;Replace&#34; : &#34;Replace&#34;,
&gt; +       &#34;Match&#34; : &#34;Match&#34;,
&gt; +       &#34;Do not match&#34; : &#34;Do not match&#34;,
&gt; +       &#34;Advanced options&#34; : &#34;Advanced options&#34;,
&gt; +       &#34;Pick a file.&#34; : &#34;Pick a file.&#34;
&gt; +       &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt; +       &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt; +       &#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt; +       &#34;Save&#34; : &#34;Save&#34;,
&gt; +       &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt; +       &#34;Delete&#34; : &#34;Delete&#34;,
&gt; +       &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt; +       &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt; +       &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt; +       &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt; +       &#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
&gt; +       &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt; +       &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt; +       &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt; +       &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
&gt;        // remember the IE does not support ending comma on last item
&gt; -//     &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt; -//     &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt; -//     &#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt; -//     &#34;Save&#34; : &#34;Save&#34;,
&gt; -//     &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt; -//     &#34;Delete&#34; : &#34;Delete&#34;,
&gt; -//     &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt; -//     &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt; -//     &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt; -//     &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt; -//     &#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
&gt; -//     &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt; -//     &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt; -//     &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt; -//     &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
&gt; -       // remember the IE does not support ending comma on last item
&gt; +       &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt; +       &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt; +       &#34;Removing the field will result in data loss. Are you sure?&#34; : &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt; +       &#34;Save&#34; : &#34;Save&#34;,
&gt; +       &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt; +       &#34;Delete&#34; : &#34;Delete&#34;,
&gt; +       &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt; +       &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt; +       &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt; +       &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt; +       &#34;What address are you looking for?&#34; : &#34;What address are you looking for?&#34;,
&gt; +       &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt; +       &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt; +       &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt; +       &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure you want to unassign this module?&#34;
&gt; +       // remember the IE does not support ending comma on last item*/
&gt;  };
&gt;
&gt; Modified: branches/9.x/tiki-setup.php
&gt; ===================================================================
&gt; --- branches/9.x/tiki-setup.php 2012-04-30 16:54:21 UTC (rev 41212)
&gt; +++ branches/9.x/tiki-setup.php 2012-04-30 17:56:17 UTC (rev 41213)
&gt; @@ -335,8 +335,14 @@
&gt;                }
&gt;                if ( $prefs[&#39;feature_jquery_tablesorter&#39;] == &#39;y&#39; ) {
&gt;                        $headerlib-&gt;add_cssfile(&#39;lib/jquery_tiki/tablesorter/themes/tiki/style.css&#39;);
&gt; -                       $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.js&#39;);
&gt; -                       $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
&gt; +                       $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.min.js&#39;);
&gt; +
&gt; +                       if ( $prefs[&#39;tiki_minify_javascript&#39;] === &#39;y&#39; ) {
&gt; +                               //tablesorter has bad syntax in the non-min file, however the min file seems to work fine when double minned :)
&gt; +                               $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.min.js&#39;, &#39;external&#39;);
&gt; +                       } else {
&gt; +                               $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
&gt; +                       }
&gt;                }
&gt;                if ( $prefs[&#39;feature_shadowbox&#39;] == &#39;y&#39; ) {
&gt;                        $headerlib-&gt;add_jsfile(&#39;lib/jquery/colorbox/jquery.colorbox.js&#39;);
&gt;
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt;
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Live Security Virtual Conference
&gt; Exclusive live event will cover all the ways today&#39;s security and
&gt; threat landscape has changed and how IT managers can respond. Discussions
&gt; will include endpoint security, mobile security and the latest in malware
&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>



-- 
Marc Laporte

<a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
<a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
<a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 60px">
  

<table id="msg29201257">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29201257/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41213] branches/9.x</a></b></div>
      
      <small>From: Jean-Marc Libs &lt;jeanmarc.libs@gm...&gt; - 2012-04-30 20:48:22</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Not his fault.
Fixed in 41224.

Good catch !

On 4/30/12, Marc Laporte &lt;marc@...&gt; wrote:
&gt; Thanks for minify fix
&gt;
&gt; are branches/9.x/lang/en/language.js changes intentional?
&gt;
&gt; Thanks!
&gt;
&gt;
&gt; On Mon, Apr 30, 2012 at 1:56 PM,  &lt;robertplummer@...&gt;
&gt; wrote:
&gt;&gt; Revision: 41213
&gt;&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41213&amp;view=rev</a>
&gt;&gt; Author:   robertplummer
&gt;&gt; Date:     2012-04-30 17:56:17 +0000 (Mon, 30 Apr 2012)
&gt;&gt; Log Message:
&gt;&gt; -----------
&gt;&gt; [FIX] Minify was failing for tablesorter, use their min file as external
&gt;&gt; which passes min fine; found a syntax issue
&gt;&gt;
&gt;&gt; Modified Paths:
&gt;&gt; --------------
&gt;&gt;    branches/9.x/lang/en/language.js
&gt;&gt;    branches/9.x/tiki-setup.php
&gt;&gt;
&gt;&gt; Modified: branches/9.x/lang/en/language.js
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/lang/en/language.js    2012-04-30 16:54:21 UTC (rev
&gt;&gt; 41212)
&gt;&gt; +++ branches/9.x/lang/en/language.js    2012-04-30 17:56:17 UTC (rev
&gt;&gt; 41213)
&gt;&gt; @@ -7,56 +7,56 @@
&gt;&gt;
&gt;&gt;  lang = {
&gt;&gt;  &#34;Which Continent Do You Live In?&#34; : &#34;EN Dans quel continent
&gt;&gt; habitez-vous ?&#34;,
&gt;&gt; -       &#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;,
&gt;&gt; -//     &#34;Very Secure&#34; : &#34;Very Secure&#34;,
&gt;&gt; -//     &#34;Secure&#34; : &#34;Secure&#34;,
&gt;&gt; -//     &#34;Very Strong&#34; : &#34;Very Strong&#34;,
&gt;&gt; -//     &#34;Strong&#34; : &#34;Strong&#34;,
&gt;&gt; -//     &#34;Average&#34; : &#34;Average&#34;,
&gt;&gt; -//     &#34;Weak&#34; : &#34;Weak&#34;,
&gt;&gt; -//     &#34;Very Weak&#34; : &#34;Very Weak&#34;,
&gt;&gt; -//     &#34;Strength&#34; : &#34;Strength&#34;,
&gt;&gt; -//     &#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
&gt;&gt; -//     &#34;Passwords match&#34; : &#34;Passwords match&#34;,
&gt;&gt; -//     &#34;Valid Email&#34; : &#34;Valid Email&#34;,
&gt;&gt; -//     &#34;Close&#34; : &#34;Close&#34;,
&gt;&gt; -//     &#34;Submit&#34; : &#34;Submit&#34;,
&gt;&gt; -//     &#34;Insert&#34; : &#34;Insert&#34;,
&gt;&gt; -//     &#34;Replace&#34; : &#34;Replace&#34;,
&gt;&gt; -//     &#34;Match&#34; : &#34;Match&#34;,
&gt;&gt; -//     &#34;Do not match&#34; : &#34;Do not match&#34;,
&gt;&gt; -//     &#34;Advanced options&#34; : &#34;Advanced options&#34;,
&gt;&gt; -//     &#34;Pick a file.&#34; : &#34;Pick a file.&#34;
&gt;&gt; -//     &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt;&gt; -//     &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt;&gt; -//     &#34;Removing the field will result in data loss. Are you sure?&#34; :
&gt;&gt; &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt;&gt; -//     &#34;Save&#34; : &#34;Save&#34;,
&gt;&gt; -//     &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt;&gt; -//     &#34;Delete&#34; : &#34;Delete&#34;,
&gt;&gt; -//     &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt;&gt; -//     &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt;&gt; -//     &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt;&gt; -//     &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt;&gt; -//     &#34;What address are you looking for?&#34; : &#34;What address are you
&gt;&gt; looking for?&#34;,
&gt;&gt; -//     &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt;&gt; -//     &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt;&gt; -//     &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt;&gt; -//     &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure
&gt;&gt; you want to unassign this module?&#34;
&gt;&gt; +       &#34;Very Secure&#34; : &#34;EN Très sécurisé&#34;/*,
&gt;&gt; +       &#34;Very Secure&#34; : &#34;Very Secure&#34;,
&gt;&gt; +       &#34;Secure&#34; : &#34;Secure&#34;,
&gt;&gt; +       &#34;Very Strong&#34; : &#34;Very Strong&#34;,
&gt;&gt; +       &#34;Strong&#34; : &#34;Strong&#34;,
&gt;&gt; +       &#34;Average&#34; : &#34;Average&#34;,
&gt;&gt; +       &#34;Weak&#34; : &#34;Weak&#34;,
&gt;&gt; +       &#34;Very Weak&#34; : &#34;Very Weak&#34;,
&gt;&gt; +       &#34;Strength&#34; : &#34;Strength&#34;,
&gt;&gt; +       &#34;Valid User Name&#34; : &#34;Valid User Name&#34;,
&gt;&gt; +       &#34;Passwords match&#34; : &#34;Passwords match&#34;,
&gt;&gt; +       &#34;Valid Email&#34; : &#34;Valid Email&#34;,
&gt;&gt; +       &#34;Close&#34; : &#34;Close&#34;,
&gt;&gt; +       &#34;Submit&#34; : &#34;Submit&#34;,
&gt;&gt; +       &#34;Insert&#34; : &#34;Insert&#34;,
&gt;&gt; +       &#34;Replace&#34; : &#34;Replace&#34;,
&gt;&gt; +       &#34;Match&#34; : &#34;Match&#34;,
&gt;&gt; +       &#34;Do not match&#34; : &#34;Do not match&#34;,
&gt;&gt; +       &#34;Advanced options&#34; : &#34;Advanced options&#34;,
&gt;&gt; +       &#34;Pick a file.&#34; : &#34;Pick a file.&#34;
&gt;&gt; +       &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt;&gt; +       &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt;&gt; +       &#34;Removing the field will result in data loss. Are you sure?&#34; :
&gt;&gt; &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt;&gt; +       &#34;Save&#34; : &#34;Save&#34;,
&gt;&gt; +       &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt;&gt; +       &#34;Delete&#34; : &#34;Delete&#34;,
&gt;&gt; +       &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt;&gt; +       &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt;&gt; +       &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt;&gt; +       &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt;&gt; +       &#34;What address are you looking for?&#34; : &#34;What address are you
&gt;&gt; looking for?&#34;,
&gt;&gt; +       &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt;&gt; +       &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt;&gt; +       &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt;&gt; +       &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure
&gt;&gt; you want to unassign this module?&#34;
&gt;&gt;        // remember the IE does not support ending comma on last item
&gt;&gt; -//     &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt;&gt; -//     &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt;&gt; -//     &#34;Removing the field will result in data loss. Are you sure?&#34; :
&gt;&gt; &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt;&gt; -//     &#34;Save&#34; : &#34;Save&#34;,
&gt;&gt; -//     &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt;&gt; -//     &#34;Delete&#34; : &#34;Delete&#34;,
&gt;&gt; -//     &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt;&gt; -//     &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt;&gt; -//     &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt;&gt; -//     &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt;&gt; -//     &#34;What address are you looking for?&#34; : &#34;What address are you
&gt;&gt; looking for?&#34;,
&gt;&gt; -//     &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt;&gt; -//     &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt;&gt; -//     &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt;&gt; -//     &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure
&gt;&gt; you want to unassign this module?&#34;
&gt;&gt; -       // remember the IE does not support ending comma on last item
&gt;&gt; +       &#34;Add Field&#34; : &#34;Add Field&#34;,
&gt;&gt; +       &#34;Edit Field&#34; : &#34;Edit Field&#34;,
&gt;&gt; +       &#34;Removing the field will result in data loss. Are you sure?&#34; :
&gt;&gt; &#34;Removing the field will result in data loss. Are you sure?&#34;,
&gt;&gt; +       &#34;Save&#34; : &#34;Save&#34;,
&gt;&gt; +       &#34;Cancel&#34; : &#34;Cancel&#34;,
&gt;&gt; +       &#34;Delete&#34; : &#34;Delete&#34;,
&gt;&gt; +       &#34;Unassign module&#34; : &#34;Unassign module&#34;,
&gt;&gt; +       &#34;Edit module&#34; : &#34;Edit module&#34;,
&gt;&gt; +       &#34;Edit module:&#34; : &#34;Edit module:&#34;,
&gt;&gt; +       &#34;Favorite&#34; : &#34;Favorite&#34;,
&gt;&gt; +       &#34;What address are you looking for?&#34; : &#34;What address are you
&gt;&gt; looking for?&#34;,
&gt;&gt; +       &#34;Filter:&#34; : &#34;Filter:&#34;,
&gt;&gt; +       &#34;Please enter a page name&#34; : &#34;Please enter a page name&#34;,
&gt;&gt; +       &#34;Change Highlighter&#34; : &#34;Change Highlighter&#34;,
&gt;&gt; +       &#34;Are you sure you want to unassign this module?&#34; : &#34;Are you sure
&gt;&gt; you want to unassign this module?&#34;
&gt;&gt; +       // remember the IE does not support ending comma on last item*/
&gt;&gt;  };
&gt;&gt;
&gt;&gt; Modified: branches/9.x/tiki-setup.php
&gt;&gt; ===================================================================
&gt;&gt; --- branches/9.x/tiki-setup.php 2012-04-30 16:54:21 UTC (rev 41212)
&gt;&gt; +++ branches/9.x/tiki-setup.php 2012-04-30 17:56:17 UTC (rev 41213)
&gt;&gt; @@ -335,8 +335,14 @@
&gt;&gt;                }
&gt;&gt;                if ( $prefs[&#39;feature_jquery_tablesorter&#39;] == &#39;y&#39; ) {
&gt;&gt;
&gt;&gt;  $headerlib-&gt;add_cssfile(&#39;lib/jquery_tiki/tablesorter/themes/tiki/style.css&#39;);
&gt;&gt; -
&gt;&gt; $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.js&#39;);
&gt;&gt; -
&gt;&gt; $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
&gt;&gt; +
&gt;&gt; $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/jquery.tablesorter.min.js&#39;);
&gt;&gt; +
&gt;&gt; +                       if ( $prefs[&#39;tiki_minify_javascript&#39;] === &#39;y&#39; ) {
&gt;&gt; +                               //tablesorter has bad syntax in the
&gt;&gt; non-min file, however the min file seems to work fine when double minned
&gt;&gt; :)
&gt;&gt; +
&gt;&gt; $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.min.js&#39;,
&gt;&gt; &#39;external&#39;);
&gt;&gt; +                       } else {
&gt;&gt; +
&gt;&gt; $headerlib-&gt;add_jsfile(&#39;lib/jquery/tablesorter/addons/pager/jquery.tablesorter.pager.js&#39;);
&gt;&gt; +                       }
&gt;&gt;                }
&gt;&gt;                if ( $prefs[&#39;feature_shadowbox&#39;] == &#39;y&#39; ) {
&gt;&gt;
&gt;&gt;  $headerlib-&gt;add_jsfile(&#39;lib/jquery/colorbox/jquery.colorbox.js&#39;);
&gt;&gt;
&gt;&gt; This was sent by the SourceForge.net collaborative development platform,
&gt;&gt; the world&#39;s largest Open Source development site.
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------------------------------------------------------
&gt;&gt; Live Security Virtual Conference
&gt;&gt; Exclusive live event will cover all the ways today&#39;s security and
&gt;&gt; threat landscape has changed and how IT managers can respond. Discussions
&gt;&gt; will include endpoint security, mobile security and the latest in malware
&gt;&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt;&gt; _______________________________________________
&gt;&gt; Tikiwiki-cvs mailing list
&gt;&gt; Tikiwiki-cvs@...
&gt;&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;
&gt;
&gt;
&gt; --
&gt; Marc Laporte
&gt;
&gt; <a href="http://MarcLaporte.com" rel="nofollow">http://MarcLaporte.com</a>
&gt; <a href="http://Tiki.org/MarcLaporte" rel="nofollow">http://Tiki.org/MarcLaporte</a>
&gt; <a href="http://AvanTech.net" rel="nofollow">http://AvanTech.net</a>
&gt;
&gt; ------------------------------------------------------------------------------
&gt; Live Security Virtual Conference
&gt; Exclusive live event will cover all the ways today&#39;s security and
&gt; threat landscape has changed and how IT managers can respond. Discussions
&gt; will include endpoint security, mobile security and the latest in malware
&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt;


</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29203922">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29203922/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41255] branches/9.x</a></b></div>
      
      <small>From: &lt;lphuberdeau@us...&gt; - 2012-05-01 15:12:28</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41255
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41255&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41255&amp;view=rev</a>
Author:   lphuberdeau
Date:     2012-05-01 15:12:22 +0000 (Tue, 01 May 2012)
Log Message:
-----------
[MOD] Adding configuration options to the tracker_input module

Modified Paths:
--------------
    branches/9.x/lib/jquery_tiki/tiki-maps.js
    branches/9.x/modules/mod-func-tracker_input.php
    branches/9.x/templates/modules/mod-tracker_input.tpl

Modified: branches/9.x/lib/jquery_tiki/tiki-maps.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-maps.js	2012-05-01 15:11:53 UTC (rev 41254)
+++ branches/9.x/lib/jquery_tiki/tiki-maps.js	2012-05-01 15:12:22 UTC (rev 41255)
@@ -78,6 +78,10 @@
 		return null;
 	}
 
+	function writeCoordinates(lonlat, map) {
+		return lonlat.lon + &#39;,&#39; + lonlat.lat + &#39;,&#39; + map.getZoom();
+	}
+
 	$.fn.createMap = function () {
 		this.each(function () {
 			var id = $(this).attr(&#39;id&#39;), container = this, desiredControls;
@@ -699,7 +703,7 @@
 			if (! field.attr(&#39;disabled&#39;)) {
 				$(container).bind(&#39;selectionChange&#39;, function (e, lonlat) {
 					if (lonlat) {
-						field.val(lonlat.lon + &#39;,&#39; + lonlat.lat + &#39;,&#39; + map.getZoom()).change();
+						field.val(writeCoordinates(lonlat, map)).change();
 					} else {
 						field.val(&#39;&#39;).change();
 					}
@@ -771,5 +775,19 @@
 
 		return this;
 	};
+
+	$.fn.getMapCenter = function () {
+		var val;
+
+		this.each(function () {
+			var lonlat = this.map.getCenter().transform(
+				this.map.getProjectionObject(),
+				new OpenLayers.Projection(&#34;EPSG:4326&#34;)
+			);
+			val = writeCoordinates(lonlat, this.map);
+		});
+
+		return val;
+	};
 })();
 

Modified: branches/9.x/modules/mod-func-tracker_input.php
===================================================================
--- branches/9.x/modules/mod-func-tracker_input.php	2012-05-01 15:11:53 UTC (rev 41254)
+++ branches/9.x/modules/mod-func-tracker_input.php	2012-05-01 15:12:22 UTC (rev 41255)
@@ -34,7 +34,7 @@
 			),
 			&#39;location&#39; =&gt; array(
 				&#39;name&#39; =&gt; tr(&#39;Location Field&#39;),
-				&#39;description&#39; =&gt; tr(&#39;Obtain the coordinates from a nearby map and send them to the location field.&#39;),
+				&#39;description&#39; =&gt; tr(&#39;Obtain the coordinates from a nearby map and send them to the location field. In addition to the field name, :marker or :viewport can be used as the suffix. Default is :marker.&#39;),
 				&#39;filter&#39; =&gt; &#39;text&#39;,
 			),
 			&#39;streetview&#39; =&gt; array(
@@ -42,6 +42,11 @@
 				&#39;description&#39; =&gt; tr(&#39;Include a button on the StreetView interface to create tracker items from the location. Requires upload image from URL and location parameter.&#39;),
 				&#39;filter&#39; =&gt; &#39;text&#39;,
 			),
+			&#39;submit&#39; =&gt; array(
+				&#39;name&#39; =&gt; tr(&#39;Button Label&#39;),
+				&#39;description&#39; =&gt; tr(&#39;Alter the submit button label.&#39;),
+				&#39;filter&#39; =&gt; &#39;text&#39;,
+			),
 		),
 	);
 }
@@ -77,8 +82,15 @@
 	}
 
 	$location = null;
+	$locationMode = null;
 	if (isset($module_params[&#39;location&#39;])) {
-		$location = $module_params[&#39;location&#39;];
+		$parts = explode(&#39;:&#39;, $module_params[&#39;location&#39;], 2);
+		$location = array_shift($parts);
+		$locationMode = array_shift($parts);
+		if (! $locationMode) {
+			$locationMode = &#39;marker&#39;;
+		}
+
 		$hiddeninput .= &#34; $location()&#34;;
 	}
 
@@ -106,8 +118,10 @@
 						&#39;textInput&#39; =&gt; $text,
 						&#39;hiddenInput&#39; =&gt; $hidden,
 						&#39;location&#39; =&gt; $location,
+						&#39;locationMode&#39; =&gt; $locationMode,
 						&#39;streetview&#39; =&gt; $streetview,
 						&#39;galleryId&#39; =&gt; $galleryId,
+						&#39;submit&#39; =&gt; isset($module_params[&#39;submit&#39;]) ? $module_params[&#39;submit&#39;] : tr(&#39;Create&#39;),
 					)
 	);
 }

Modified: branches/9.x/templates/modules/mod-tracker_input.tpl
===================================================================
--- branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-01 15:11:53 UTC (rev 41254)
+++ branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-01 15:12:22 UTC (rev 41255)
@@ -1,6 +1,6 @@
 {if $tracker_input.trackerId}
 {tikimodule error=$module_params.error title=$tpl_module_title name=&#34;tracker_input&#34; flip=$module_params.flip decorations=$module_params.decorations nobox=$module_params.nobox notitle=$module_params.notitle}
-	&lt;form class=&#34;mod-tracker-input simple&#34; method=&#34;get&#34; action=&#34;{service controller=tracker action=insert_item}&#34; data-location=&#34;{$tracker_input.location|escape}&#34; data-streetview=&#34;{$tracker_input.streetview|escape}&#34;&gt;
+	&lt;form class=&#34;mod-tracker-input simple&#34; method=&#34;get&#34; action=&#34;{service controller=tracker action=insert_item}&#34; data-location=&#34;{$tracker_input.location|escape}&#34; data-location-mode=&#34;{$tracker_input.locationMode|escape}&#34; data-streetview=&#34;{$tracker_input.streetview|escape}&#34;&gt;
 		{foreach from=$tracker_input.textInput key=token item=label}
 			&lt;label&gt;
 				{$label|escape}
@@ -11,7 +11,7 @@
 			&lt;input type=&#34;hidden&#34; name=&#34;trackerId&#34; value=&#34;{$tracker_input.trackerId|escape}&#34;/&gt;
 			&lt;input type=&#34;hidden&#34; name=&#34;controller&#34; value=&#34;tracker&#34;/&gt;
 			&lt;input type=&#34;hidden&#34; name=&#34;action&#34; value=&#34;insert_item&#34;/&gt;
-			&lt;input type=&#34;submit&#34; name=&#34;create&#34; value=&#34;{tr}Create{/tr}&#34;/&gt;
+			&lt;input type=&#34;submit&#34; name=&#34;create&#34; value=&#34;{$tracker_input.submit|escape}&#34;/&gt;
 			{foreach from=$tracker_input.hiddenInput key=f item=v}
 				&lt;input id=&#34;{$f|escape}&#34; type=&#34;hidden&#34; name=&#34;forced~{$f|escape}&#34; value=&#34;{$v|escape}&#34;/&gt;
 			{/foreach}
@@ -50,6 +50,7 @@
 	}).each(function () {
 		var form = this
 			, location = $(this).data(&#39;location&#39;)
+			, locationMode = $(this).data(&#39;location-mode&#39;)
 			, streetview = $(this).data(&#39;streetview&#39;);
 
 		if (location ) {
@@ -58,22 +59,29 @@
 			$(map).one(&#39;initialized&#39;, function () {
 				var control, button, modeManager, newMode;
 				modeManager = map.modeManager;
-				control = $(map).setupMapSelection({
-					field: $(&#39;#&#39; + location),
-					click: function () {
-						$(form).submit();
-					}
-				});
-				control.deactivate();
 
-				modeManager.addMode({name: newMode = &#34;{{$tpl_module_title}}&#34;, controls: [control]});
+				if (locationMode === &#39;marker&#39;) {
+					control = $(map).setupMapSelection({
+						field: $(&#39;#&#39; + location),
+						click: function () {
+							$(form).submit();
+						}
+					});
+					control.deactivate();
 
+					modeManager.addMode({name: newMode = &#34;{{$tpl_module_title}}&#34;, controls: [control]});
+				}
+
 				button = $(&#39;&lt;input type=&#34;submit&#34;/&gt;&#39;)
-					.val(&#39;{tr}Add Marker{/tr}&#39;)
+					.val($(&#39;:submit&#39;, form).val())
 					.button()
 					.click(function () {
-						modeManager.switchTo(newMode);
-						return false;
+						if (newMode) {
+							modeManager.switchTo(newMode);
+							return false;
+						}
+
+						$(&#39;#&#39; + location).val($(map).getMapCenter())
 					})
 					.appendTo(form);
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29204088">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29204088/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41258] branches/9.x</a></b></div>
      
      <small>From: &lt;eromneg@us...&gt; - 2012-05-01 16:02:24</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41258
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41258&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41258&amp;view=rev</a>
Author:   eromneg
Date:     2012-05-01 16:02:18 +0000 (Tue, 01 May 2012)
Log Message:
-----------
[FIX] error reporting &#39;leak&#39; to main page content for particular E_USER_NOTICE. Add extra logic to error_reporting.php and additional conditions for showing the error button in footer.tpl

Modified Paths:
--------------
    branches/9.x/lib/setup/error_reporting.php
    branches/9.x/templates/footer.tpl

Modified: branches/9.x/lib/setup/error_reporting.php
===================================================================
--- branches/9.x/lib/setup/error_reporting.php	2012-05-01 15:40:11 UTC (rev 41257)
+++ branches/9.x/lib/setup/error_reporting.php	2012-05-01 16:02:18 UTC (rev 41258)
@@ -25,9 +25,9 @@
 
 // Handle Smarty Notices
 if (!empty($prefs[&#39;smarty_notice_reporting&#39;]) and $prefs[&#39;smarty_notice_reporting&#39;] === &#39;y&#39; ) {
-		$errorHandlerReportingLevel = $errorReportingLevel | E_NOTICE;
+		$errorHandlerReportingLevel = $errorReportingLevel | E_NOTICE | E_USER_NOTICE ;
 } else {
-		$errorHandlerReportingLevel = $errorReportingLevel;
+		$errorHandlerReportingLevel = $errorReportingLevel | E_USER_NOTICE ;
 }
 
 set_error_handler(&#39;tiki_error_handling&#39;, $errorHandlerReportingLevel);

Modified: branches/9.x/templates/footer.tpl
===================================================================
--- branches/9.x/templates/footer.tpl	2012-05-01 15:40:11 UTC (rev 41257)
+++ branches/9.x/templates/footer.tpl	2012-05-01 16:02:18 UTC (rev 41258)
@@ -2,6 +2,7 @@
 {* ==&gt; put in this file what is not displayed in the layout (javascript, debug..)*}
 {if (! isset($display) or $display eq &#39;&#39;)}
 	{if count($phpErrors)}
+		{if ($prefs.error_reporting_adminonly eq &#39;y&#39; and $tiki_p_admin eq &#39;y&#39;) or $prefs.error_reporting_adminonly eq &#39;n&#39;}
 		{button _ajax=&#34;n&#34; _id=&#34;show-errors-button&#34; _onclick=&#34;flip(&#39;errors&#39;);return false;&#34; _text=&#34;{tr}Show php error messages{/tr}&#34;}
 		&lt;div id=&#34;errors&#34; class=&#34;rbox warning&#34; style=&#34;display:{if (isset($smarty.session.tiki_cookie_jar.show_errors) and $smarty.session.tiki_cookie_jar.show_errors eq &#39;y&#39;) or $prefs.javascript_enabled ne &#39;y&#39;}block{else}none{/if};&#34;&gt;
 			&amp;nbsp;{listfilter selectors=&#39;#errors&gt;div&#39;}
@@ -9,6 +10,7 @@
 				{$err}
 			{/foreach}
 		&lt;/div&gt;
+		{/if}
 	{/if}
 
 	{if $tiki_p_admin eq &#39;y&#39; and $prefs.feature_debug_console eq &#39;y&#39;}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 40px">
  

<table id="msg29204116">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29204116/">Re: [Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41258] branches/9.x</a></b></div>
      
      <small>From: Jonny Bradley &lt;svnupdates@no...&gt; - 2012-05-01 16:08:38</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>
Yay, that&#39;s the sort of thing i was imagining it would be, well done G!

jb


On 1 May 2012, at 17:02, eromneg@... wrote:

&gt; Revision: 41258
&gt;          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41258&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41258&amp;view=rev</a>
&gt; Author:   eromneg
&gt; Date:     2012-05-01 16:02:18 +0000 (Tue, 01 May 2012)
&gt; Log Message:
&gt; -----------
&gt; [FIX] error reporting &#39;leak&#39; to main page content for particular E_USER_NOTICE. Add extra logic to error_reporting.php and additional conditions for showing the error button in footer.tpl
&gt; 
&gt; Modified Paths:
&gt; --------------
&gt;    branches/9.x/lib/setup/error_reporting.php
&gt;    branches/9.x/templates/footer.tpl
&gt; 
&gt; Modified: branches/9.x/lib/setup/error_reporting.php
&gt; ===================================================================
&gt; --- branches/9.x/lib/setup/error_reporting.php	2012-05-01 15:40:11 UTC (rev 41257)
&gt; +++ branches/9.x/lib/setup/error_reporting.php	2012-05-01 16:02:18 UTC (rev 41258)
&gt; @@ -25,9 +25,9 @@
&gt; 
&gt; // Handle Smarty Notices
&gt; if (!empty($prefs[&#39;smarty_notice_reporting&#39;]) and $prefs[&#39;smarty_notice_reporting&#39;] === &#39;y&#39; ) {
&gt; -		$errorHandlerReportingLevel = $errorReportingLevel | E_NOTICE;
&gt; +		$errorHandlerReportingLevel = $errorReportingLevel | E_NOTICE | E_USER_NOTICE ;
&gt; } else {
&gt; -		$errorHandlerReportingLevel = $errorReportingLevel;
&gt; +		$errorHandlerReportingLevel = $errorReportingLevel | E_USER_NOTICE ;
&gt; }
&gt; 
&gt; set_error_handler(&#39;tiki_error_handling&#39;, $errorHandlerReportingLevel);
&gt; 
&gt; Modified: branches/9.x/templates/footer.tpl
&gt; ===================================================================
&gt; --- branches/9.x/templates/footer.tpl	2012-05-01 15:40:11 UTC (rev 41257)
&gt; +++ branches/9.x/templates/footer.tpl	2012-05-01 16:02:18 UTC (rev 41258)
&gt; @@ -2,6 +2,7 @@
&gt; {* ==&gt; put in this file what is not displayed in the layout (javascript, debug..)*}
&gt; {if (! isset($display) or $display eq &#39;&#39;)}
&gt; 	{if count($phpErrors)}
&gt; +		{if ($prefs.error_reporting_adminonly eq &#39;y&#39; and $tiki_p_admin eq &#39;y&#39;) or $prefs.error_reporting_adminonly eq &#39;n&#39;}
&gt; 		{button _ajax=&#34;n&#34; _id=&#34;show-errors-button&#34; _onclick=&#34;flip(&#39;errors&#39;);return false;&#34; _text=&#34;{tr}Show php error messages{/tr}&#34;}
&gt; 		&lt;div id=&#34;errors&#34; class=&#34;rbox warning&#34; style=&#34;display:{if (isset($smarty.session.tiki_cookie_jar.show_errors) and $smarty.session.tiki_cookie_jar.show_errors eq &#39;y&#39;) or $prefs.javascript_enabled ne &#39;y&#39;}block{else}none{/if};&#34;&gt;
&gt; 			&amp;nbsp;{listfilter selectors=&#39;#errors&gt;div&#39;}
&gt; @@ -9,6 +10,7 @@
&gt; 				{$err}
&gt; 			{/foreach}
&gt; 		&lt;/div&gt;
&gt; +		{/if}
&gt; 	{/if}
&gt; 
&gt; 	{if $tiki_p_admin eq &#39;y&#39; and $prefs.feature_debug_console eq &#39;y&#39;}
&gt; 
&gt; This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.
&gt; 
&gt; 
&gt; ------------------------------------------------------------------------------
&gt; Live Security Virtual Conference
&gt; Exclusive live event will cover all the ways today&#39;s security and 
&gt; threat landscape has changed and how IT managers can respond. Discussions 
&gt; will include endpoint security, mobile security and the latest in malware 
&gt; threats. <a href="http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/" rel="nofollow">http://www.accelacomm.com/jaw/sfrnl04242012/114/50122263/</a>
&gt; _______________________________________________
&gt; Tikiwiki-cvs mailing list
&gt; Tikiwiki-cvs@...
&gt; <a href="https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs" rel="nofollow">https://lists.sourceforge.net/lists/listinfo/tikiwiki-cvs</a>
&gt; 



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29204217">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29204217/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41260] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-05-01 16:37:57</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41260
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41260&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41260&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-05-01 16:37:50 +0000 (Tue, 01 May 2012)
Log Message:
-----------
[FIX] preview: Fix preview display in popup window for html/non-html pages in both editors. Also fix url_decode for page names

Modified Paths:
--------------
    branches/9.x/lib/ajax/autosave.js
    branches/9.x/tiki-auto_save.php

Modified: branches/9.x/lib/ajax/autosave.js
===================================================================
--- branches/9.x/lib/ajax/autosave.js	2012-05-01 16:05:51 UTC (rev 41259)
+++ branches/9.x/lib/ajax/autosave.js	2012-05-01 16:37:50 UTC (rev 41260)
@@ -167,9 +167,7 @@
 function ajax_preview(editorId, autoSaveId, inPage) {
 	if (editorId) {
 		syntaxHighlighter.sync($(&#39;#&#39; + editorId));
-		var allowHtml = $(&#39;#allowhtml:checked&#39;).length;
-		var wysiwyg = $(&#39;input[name=&#34;wysiwyg&#34;]&#39;).val();
-		if (wysiwyg == &#39;y&#39;) allowHtml=1;
+		var allowHtml = $(&#39;#allowhtml:checked&#39;).length || $(&#34;#allowhtml[type=hidden]&#34;).val();
 		if (!ajaxPreviewWindow) {
 			if (inPage) {
 				var $prvw = $(&#34;#autosave_preview:visible&#34;);
@@ -195,7 +193,7 @@
 				}
 			} else {
 				var features = &#39;menubar=no,toolbar=no,location=no,directories=no,fullscreen=no,titlebar=no,hotkeys=no,status=no,scrollbars=yes,resizable=yes,width=600&#39;;
-				ajaxPreviewWindow = window.open(&#39;tiki-auto_save.php?editor_id=&#39; + editorId + &#39;&amp;autoSaveId=&#39; + tiki_encodeURIComponent(autoSaveId), &#39;_blank&#39;, features);
+				ajaxPreviewWindow = window.open(&#39;tiki-auto_save.php?editor_id=&#39; + editorId + &#39;&amp;autoSaveId=&#39; + tiki_encodeURIComponent(autoSaveId) + &#39;&amp;allowHtml=&#39; + allowHtml, &#39;_blank&#39;, features);
 			}
 		} else {
 			if (typeof ajaxPreviewWindow.get_new_preview === &#39;function&#39;) {

Modified: branches/9.x/tiki-auto_save.php
===================================================================
--- branches/9.x/tiki-auto_save.php	2012-05-01 16:05:51 UTC (rev 41259)
+++ branches/9.x/tiki-auto_save.php	2012-05-01 16:37:50 UTC (rev 41260)
@@ -66,10 +66,19 @@
 	} else if (isset($_REQUEST[&#39;autoSaveId&#39;])) {	// wiki page previews
 		
 		$autoSaveIdParts = explode(&#39;:&#39;, $_REQUEST[&#39;autoSaveId&#39;]);	// user, section, object id
+		foreach ($autoSaveIdParts as &amp; $part) {
+			$part = urldecode($part);
+		}
 		
+		$page = $autoSaveIdParts[2];	// plugins use global $page for approval
+		$info = $tikilib-&gt;get_page_info($page, false);
+		if (empty($info) || isset($_REQUEST[&#39;allowHtml&#39;])) {
+			$info[&#39;is_html&#39;] = !empty($_REQUEST[&#39;allowHtml&#39;])? 1 : 0;
+		}
+		$options = array(&#39;is_html&#39; =&gt; ($info[&#39;is_html&#39;] == 1), &#39;preview_mode&#39; =&gt; true, &#39;process_wiki_paragraphs&#39; =&gt; ($prefs[&#39;wysiwyg_htmltowiki&#39;] === &#39;y&#39; || $info[&#39;wysiwyg&#39;] == &#39;n&#39;), &#39;page&#39; =&gt; $autoSaveIdParts[2]);
+
 		if (count($autoSaveIdParts) === 3 &amp;&amp; !empty($user) &amp;&amp; $user === $autoSaveIdParts[0] &amp;&amp; $autoSaveIdParts[1] === &#39;wiki_page&#39;) {
 			
-			$page = $autoSaveIdParts[2];	// plugins use global $page for approval
 			$editlib; include_once &#39;lib/wiki/editlib.php&#39;;
 			if (isset($_REQUEST[&#39;inPage&#39;])) {
 				if (!isset($_REQUEST[&#39;diff_style&#39;])) {	// use previously set diff_style
@@ -110,11 +119,7 @@
 						$data = $smarty-&gt;fetch(&#39;pagehistory.tpl&#39;);
 					}
 				} else {
-					$info = $tikilib-&gt;get_page_info($page, false);
-					if (empty($info)) {
-						$info[&#39;is_html&#39;] = isset($_REQUEST[&#39;allowHtml&#39;])?$_REQUEST[&#39;allowHtml&#39;]:0;
-					}
-					$data = $tikilib-&gt;parse_data($data, array(&#39;is_html&#39; =&gt; ($info[&#39;is_html&#39;] == 1), &#39;preview_mode&#39;=&gt;true, &#39;process_wiki_paragraphs&#39; =&gt; ($prefs[&#39;wysiwyg_htmltowiki&#39;] === &#39;y&#39; || $info[&#39;wysiwyg&#39;] == &#39;n&#39;), &#39;page&#39; =&gt; $autoSaveIdParts[2]));
+					$data = $tikilib-&gt;parse_data($data, $options);
 				}
 				echo $data;
 				
@@ -138,7 +143,7 @@
 				$data = &#39;&lt;div id=&#34;c1c2&#34;&gt;&lt;div id=&#34;wrapper&#34;&gt;&lt;div id=&#34;col1&#34;&gt;&lt;div id=&#34;tiki-center&#34; class=&#34;wikitext&#34;&gt;&#39;;
 				if (has_autosave($_REQUEST[&#39;editor_id&#39;], $_REQUEST[&#39;autoSaveId&#39;])) {
 					$parserlib = TikiLib::lib(&#39;parser&#39;);
-					$data .= $parserlib-&gt;parse_data_raw($editlib-&gt;partialParseWysiwygToWiki(get_autosave($_REQUEST[&#39;editor_id&#39;], $_REQUEST[&#39;autoSaveId&#39;])));
+					$data .= $parserlib-&gt;parse_data($editlib-&gt;partialParseWysiwygToWiki(get_autosave($_REQUEST[&#39;editor_id&#39;], $_REQUEST[&#39;autoSaveId&#39;])), $options);
 				} else {
 					if ($autoSaveIdParts[1] == &#39;wiki_page&#39;) {
 						global $wikilib; include_once(&#39;lib/wiki/wikilib.php&#39;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29204234">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29204234/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41261] branches/9.x</a></b></div>
      
      <small>From: &lt;lphuberdeau@us...&gt; - 2012-05-01 16:42:40</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41261
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41261&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41261&amp;view=rev</a>
Author:   lphuberdeau
Date:     2012-05-01 16:42:34 +0000 (Tue, 01 May 2012)
Log Message:
-----------
[MOD] Allowing to redirect upon successful insert

Modified Paths:
--------------
    branches/9.x/lib/core/Services/Tracker/Controller.php
    branches/9.x/lib/core/Services/Tracker/Utilities.php
    branches/9.x/modules/mod-func-tracker_input.php
    branches/9.x/templates/modules/mod-tracker_input.tpl

Modified: branches/9.x/lib/core/Services/Tracker/Controller.php
===================================================================
--- branches/9.x/lib/core/Services/Tracker/Controller.php	2012-05-01 16:37:50 UTC (rev 41260)
+++ branches/9.x/lib/core/Services/Tracker/Controller.php	2012-05-01 16:42:34 UTC (rev 41261)
@@ -498,6 +498,8 @@
 
 			if ($itemId) {
 				TikiLib::lib(&#39;unifiedsearch&#39;)-&gt;processUpdateQueue();
+
+				return $this-&gt;utilities-&gt;getItem($trackerId, $itemId);
 			} else {
 				throw new Services_Exception(tr(&#39;Item could not be created.&#39;), 400);
 			}

Modified: branches/9.x/lib/core/Services/Tracker/Utilities.php
===================================================================
--- branches/9.x/lib/core/Services/Tracker/Utilities.php	2012-05-01 16:37:50 UTC (rev 41260)
+++ branches/9.x/lib/core/Services/Tracker/Utilities.php	2012-05-01 16:42:34 UTC (rev 41261)
@@ -159,6 +159,10 @@
 			$conditions[&#39;lastModif&#39;] = $table-&gt;greaterThan($conditions[&#39;modifiedSince&#39;]);
 		}
 
+		if (! empty($conditions[&#39;itemId&#39;])) {
+			$conditions[&#39;itemId&#39;] = $table-&gt;in((array) $conditions[&#39;itemId&#39;]);
+		}
+
 		unset($conditions[&#39;modifiedSince&#39;]);
 
 		$items = $table-&gt;fetchAll(array(&#39;itemId&#39;, &#39;status&#39;), $conditions, $maxRecords, $offset);
@@ -170,6 +174,17 @@
 		return $items;
 	}
 
+	function getItem($trackerId, $itemId)
+	{
+		$items = $this-&gt;getItems(array(
+			&#39;trackerId&#39; =&gt; $trackerId,
+			&#39;itemId&#39; =&gt; $itemId,
+		), 1, 0);
+		$item = reset($items);
+
+		return $item;
+	}
+
 	function processValues($definition, $item)
 	{
 		$trklib = TikiLib::lib(&#39;trk&#39;);

Modified: branches/9.x/modules/mod-func-tracker_input.php
===================================================================
--- branches/9.x/modules/mod-func-tracker_input.php	2012-05-01 16:37:50 UTC (rev 41260)
+++ branches/9.x/modules/mod-func-tracker_input.php	2012-05-01 16:42:34 UTC (rev 41261)
@@ -47,6 +47,11 @@
 				&#39;description&#39; =&gt; tr(&#39;Alter the submit button label.&#39;),
 				&#39;filter&#39; =&gt; &#39;text&#39;,
 			),
+			&#39;success&#39; =&gt; array(
+				&#39;name&#39; =&gt; tr(&#39;Operation to perform on success&#39;),
+				&#39;description&#39; =&gt; tr(&#39;Operation to perform in the following format: operationName(argument). Current operations are redirect with the URL template as the argument. @valueName@ will be replaced by the appropriate value where valueName is itemId, status or a permanent name&#39;),
+				&#39;filter&#39; =&gt; &#39;text&#39;,
+			),
 		),
 	);
 }
@@ -76,6 +81,7 @@
 	$hiddeninput = isset($module_params[&#39;hiddeninput&#39;]) ? $module_params[&#39;hiddeninput&#39;] : &#39;&#39;;
 	$streetview = isset($module_params[&#39;streetview&#39;]) ? $module_params[&#39;streetview&#39;] : &#39;&#39;;
 	$streetViewField = $definition-&gt;getFieldFromPermName($streetview);
+	$success = isset($module_params[&#39;success&#39;]) ? $module_params[&#39;success&#39;] : &#39;&#39;;
 
 	if (! $streetview || $prefs[&#39;fgal_upload_from_source&#39;] != &#39;y&#39; || ! $streetViewField) {
 		$streetview = &#39;&#39;;
@@ -111,6 +117,13 @@
 		$galleryId = $streetViewField[&#39;options_array&#39;][0];
 	}
 
+	$operation = null;
+	$operationArgument = null;
+	if (preg_match(&#34;/(\w+)\(([^\)]*)\)/&#34;, $success, $parts)) {
+		$operation = $parts[1];
+		$operationArgument = $parts[2];
+	}
+
 	$smarty-&gt;assign(
 					&#39;tracker_input&#39;,
 					array(
@@ -122,6 +135,10 @@
 						&#39;streetview&#39; =&gt; $streetview,
 						&#39;galleryId&#39; =&gt; $galleryId,
 						&#39;submit&#39; =&gt; isset($module_params[&#39;submit&#39;]) ? $module_params[&#39;submit&#39;] : tr(&#39;Create&#39;),
+						&#39;success&#39; =&gt; array(
+							&#39;operation&#39; =&gt; $operation,
+							&#39;argument&#39; =&gt; $operationArgument,
+						),
 					)
 	);
 }

Modified: branches/9.x/templates/modules/mod-tracker_input.tpl
===================================================================
--- branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-01 16:37:50 UTC (rev 41260)
+++ branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-01 16:42:34 UTC (rev 41261)
@@ -1,6 +1,6 @@
 {if $tracker_input.trackerId}
 {tikimodule error=$module_params.error title=$tpl_module_title name=&#34;tracker_input&#34; flip=$module_params.flip decorations=$module_params.decorations nobox=$module_params.nobox notitle=$module_params.notitle}
-	&lt;form class=&#34;mod-tracker-input simple&#34; method=&#34;get&#34; action=&#34;{service controller=tracker action=insert_item}&#34; data-location=&#34;{$tracker_input.location|escape}&#34; data-location-mode=&#34;{$tracker_input.locationMode|escape}&#34; data-streetview=&#34;{$tracker_input.streetview|escape}&#34;&gt;
+	&lt;form class=&#34;mod-tracker-input simple&#34; method=&#34;get&#34; action=&#34;{service controller=tracker action=insert_item}&#34; data-location=&#34;{$tracker_input.location|escape}&#34; data-location-mode=&#34;{$tracker_input.locationMode|escape}&#34; data-streetview=&#34;{$tracker_input.streetview|escape}&#34; data-success=&#34;{$tracker_input.success|json_encode|escape}&#34;&gt;
 		{foreach from=$tracker_input.textInput key=token item=label}
 			&lt;label&gt;
 				{$label|escape}
@@ -39,8 +39,8 @@
 		$(this).serviceDialog({
 			title: $(&#39;:submit&#39;, form).val(),
 			data: $(form).serialize(),
-			success: function () {
-				$(form).trigger(&#39;insert&#39;);
+			success: function (data) {
+				$(form).trigger(&#39;insert&#39;, [ data ]);
 			},
 			close: function () {
 				$(form).trigger(&#39;cancel&#39;);
@@ -51,8 +51,24 @@
 		var form = this
 			, location = $(this).data(&#39;location&#39;)
 			, locationMode = $(this).data(&#39;location-mode&#39;)
-			, streetview = $(this).data(&#39;streetview&#39;);
+			, streetview = $(this).data(&#39;streetview&#39;)
+			, success = $(this).data(&#39;success&#39;)
+			;
 
+		if (success.operation === &#39;redirect&#39;) {
+			$(form).bind(&#39;insert&#39;, function (e, data) {
+				var url = success.argument;
+
+				data.fields.itemId = data.itemId;
+				data.fields.status = data.status;
+				$.each(data.fields, function (k, v) {
+					url = url.replace(&#39;@&#39; + k + &#39;@&#39;, escape(v));
+				});
+
+				document.location.href = url;
+			});
+		}
+
 		if (location ) {
 			var map = $(form).closest(&#39;.tab, #appframe, body&#39;).find(&#39;.map-container&#39;)[0];
 			$(&#39;:submit&#39;, form).hide();

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29210375">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29210375/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41290] branches/9.x</a></b></div>
      
      <small>From: &lt;chealer@us...&gt; - 2012-05-02 20:36:30</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41290
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41290&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41290&amp;view=rev</a>
Author:   chealer
Date:     2012-05-02 20:36:23 +0000 (Wed, 02 May 2012)
Log Message:
-----------
Fix outdated/unparseable comments

Modified Paths:
--------------
    branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
    branches/9.x/lib/wiki/wikilib.php

Modified: branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php
===================================================================
--- branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-05-02 19:57:55 UTC (rev 41289)
+++ branches/9.x/installer/schema/999999991_decode_pages_sources_tiki.php	2012-05-02 20:36:23 UTC (rev 41290)
@@ -19,20 +19,14 @@
  *
  * -----
  *
- * Second attempt at decoding entities but only in plugin args instead of whole pages as in old version of this script (pre r40858)
- * 				(see <a href="http://info.tiki.org/HTMLentities" rel="nofollow">http://info.tiki.org/HTMLentities</a> for an example)
- *
- * Sometimes entities had been &#34;double&#34; encoded so &#34;&amp;quot;&#34; appeared as &#34;&amp;amp;quot;&#34; - seems mostly in plugin args?
- * 		(leaving others alone so entities that were supposed to appear still do)
- *
- * As seen here: <a href="https://trunkinfo.tiki.org/tiki-pagehistory.php?page=ダウンロード&amp;history_offset=1&amp;diff_style=sidediff&amp;show_all_versions=y&amp;compare=Compare&amp;newver=5&amp;oldver=4&amp;bothver_idx=4" rel="nofollow">https://trunkinfo.tiki.org/tiki-pagehistory.php?page=ダウンロード&amp;history_offset=1&amp;diff_style=sidediff&amp;show_all_versions=y&amp;compare=Compare&amp;newver=5&amp;oldver=4&amp;bothver_idx=4</a>
+ * 				see <a href="http://info.tiki.org/HTMLentities" rel="nofollow">http://info.tiki.org/HTMLentities</a> for examples of HTML entities
  */
 
 
 
 function upgrade_999999991_decode_pages_sources_tiki($installer)
 {
-	set_time_limit(60 * 60); //1 hours
+	set_time_limit(60 * 60); // Set maximum execution time to 1 hour since this runs on all pages
 	include_once(&#39;tiki-setup_base.php&#39;);
 	include_once (&#39;lib/categories/categlib.php&#39;);	// needed for cat_jail fn in list_pages()
 	include_once(&#39;lib/wiki/wikilib.php&#39;);

Modified: branches/9.x/lib/wiki/wikilib.php
===================================================================
--- branches/9.x/lib/wiki/wikilib.php	2012-05-02 19:57:55 UTC (rev 41289)
+++ branches/9.x/lib/wiki/wikilib.php	2012-05-02 20:36:23 UTC (rev 41290)
@@ -1231,7 +1231,6 @@
 		//&lt;!--Start for converting pages
 	function convertPages()
 	{
-		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
 		$infos = TikiLib::fetchAll(&#39;
 			SELECT data, page_id
 			FROM tiki_pages
@@ -1292,7 +1291,6 @@
 
 	function convertPageHistories()
 	{
-		//we want to limit how much we have in memory, so here we count the pages that have plugins so we have can then offset threw them
 		$infos = TikiLib::fetchAll(&#39;
 			SELECT data, historyId
 			FROM tiki_history
@@ -1413,7 +1411,7 @@
 				//Remove any that may conflict with the new fingerprint, not sure how to fix this yet
 				TikiLib::query(&#34;DELETE FROM tiki_plugin_security WHERE fingerprint = ?&#34;, array($fingerPrintsNew[$i]));
 
-				//Now add in new fingerprints
+				// Now update fingerprint (if it exists)
 				TikiLib::query(&#34;UPDATE tiki_plugin_security SET fingerprint = ? WHERE fingerprint = ?&#34;, array($fingerPrintsNew[$i], $fingerPrintsOld[$i]));
 			}
 		}
@@ -1424,7 +1422,7 @@
 		//we store the original matches because we are about to change and update them, we need to get their fingerprint
 		$oldMatches = WikiParser_PluginMatcher::match($data);
 
-		//We know the page was single encoded, but plugin possibly double?
+		// HTML-decode pages
 		$data =  htmlspecialchars_decode($data);
 
 		// find the plugins

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29213781">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29213781/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41296] branches/9.x</a></b></div>
      
      <small>From: &lt;nkoth@us...&gt; - 2012-05-03 15:02:28</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41296
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41296&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41296&amp;view=rev</a>
Author:   nkoth
Date:     2012-05-03 15:02:17 +0000 (Thu, 03 May 2012)
Log Message:
-----------
[ENH] Add daterange filter interface for customsearch (part 2)

Modified Paths:
--------------
    branches/9.x/lib/core/Services/Tracker/SearchController.php
    branches/9.x/lib/wiki-plugins/wikiplugin_list.php

Added Paths:
-----------
    branches/9.x/backups/

Modified: branches/9.x/lib/core/Services/Tracker/SearchController.php
===================================================================
--- branches/9.x/lib/core/Services/Tracker/SearchController.php	2012-05-03 14:12:29 UTC (rev 41295)
+++ branches/9.x/lib/core/Services/Tracker/SearchController.php	2012-05-03 15:02:17 UTC (rev 41296)
@@ -110,6 +110,8 @@
 					$filter = &#39;type&#39;;
 				} elseif ($config[&#39;_filter&#39;] == &#39;categories&#39; || $name == &#39;categories&#39;) {
 					$filter = &#39;categories&#39;;
+				} elseif ($name == &#39;daterange&#39;) {
+					$filter = &#39;daterange&#39;;
 				} else {
 					$filter = &#39;content&#39;; //default
 				}

Modified: branches/9.x/lib/wiki-plugins/wikiplugin_list.php
===================================================================
--- branches/9.x/lib/wiki-plugins/wikiplugin_list.php	2012-05-03 14:12:29 UTC (rev 41295)
+++ branches/9.x/lib/wiki-plugins/wikiplugin_list.php	2012-05-03 15:02:17 UTC (rev 41296)
@@ -205,6 +205,18 @@
 
 function wpquery_filter_range($query, $value, array $arguments)
 {
+	if ($arguments[&#39;from&#39;] == &#39;now&#39;) {
+		$arguments[&#39;from&#39;] = TikiLib::lib(&#39;tiki&#39;)-&gt;now;
+	}
+	if ($arguments[&#39;to&#39;] == &#39;now&#39;) {
+		$arguments[&#39;to&#39;] = TikiLib::lib(&#39;tiki&#39;)-&gt;now;
+	}
+	if (! isset($arguments[&#39;from&#39;]) &amp;&amp; isset($arguments[&#39;to&#39;], $arguments[&#39;gap&#39;])) {
+		$arguments[&#39;from&#39;] = $arguments[&#39;to&#39;] - $arguments[&#39;gap&#39;];
+	}
+	if (! isset($arguments[&#39;to&#39;]) &amp;&amp; isset($arguments[&#39;from&#39;], $arguments[&#39;gap&#39;])) {
+		$arguments[&#39;to&#39;] = $arguments[&#39;from&#39;] + $arguments[&#39;gap&#39;];
+	}
 	if (! isset($arguments[&#39;from&#39;], $arguments[&#39;to&#39;])) {
 		TikiLib::lib(&#39;errorreport&#39;)-&gt;report(tr(&#39;Missing from or to for range filter.&#39;));
 	} 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29214587">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29214587/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41301] branches/9.x</a></b></div>
      
      <small>From: &lt;robertplummer@us...&gt; - 2012-05-03 20:25:27</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41301
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41301&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41301&amp;view=rev</a>
Author:   robertplummer
Date:     2012-05-03 17:48:12 +0000 (Thu, 03 May 2012)
Log Message:
-----------
[FIX] export sheet, a few problems and call to non-exiting global sheetlib

Modified Paths:
--------------
    branches/9.x/lib/sheet/grid.php
    branches/9.x/tiki-export_sheet.php

Modified: branches/9.x/lib/sheet/grid.php
===================================================================
--- branches/9.x/lib/sheet/grid.php	2012-05-03 16:04:03 UTC (rev 41300)
+++ branches/9.x/lib/sheet/grid.php	2012-05-03 17:48:12 UTC (rev 41301)
@@ -899,7 +899,7 @@
  */
 class TikiSheetCSVHandler extends TikiSheetDataHandler
 {
-	var $file;
+	var $file = &#39;<a href="php://stdout&#39" rel="nofollow">php://stdout&#39</a>;;
 	var $lineLen;
 	
 	/** Constructor {{{2
@@ -949,7 +949,7 @@
 	function _save( &amp;$sheet )
 	{
 		$total = array();
-        
+
         ksort ($sheet-&gt;dataGrid);
 		foreach( $sheet-&gt;dataGrid as $row )
 			if ( is_array( $row ) )
@@ -960,7 +960,7 @@
 
 		if ( is_array( $total ) )
 			$total = implode( &#34;\n&#34;, $total );
-            
+
         $total = $this-&gt;encoding-&gt;convert_encoding ($total);
 
 		if ( $this-&gt;file == &#34;<a href="php://stdout&#34" rel="nofollow">php://stdout&#34</a>; )
@@ -970,7 +970,7 @@
 			header(&#34;Expires: 0&#34;);
 			header(&#34;Cache-Control: must-revalidate, post-check=0,pre-check=0&#34;);
 			header(&#34;Pragma: public&#34;);
-			
+
 			$this-&gt;output = $total;
 
 			return true;
@@ -1222,15 +1222,16 @@
     // _save {{{2
     function _save( &amp;$sheet )
     {
-        $total = array(); 
-        foreach( $sheet-&gt;data as $row ) 
+        $total = array();
+
+        foreach( $sheet-&gt;dataGrid as $row )
         {
-            $total[] = $this-&gt;fputcsvexcel( $row ,&#39;;&#39;,&#39;&#34;&#39;, $sheet-&gt;metadata-&gt;columns);
+            $total[] = implode(&#39;;&#39;, $row);
         }
         
         if ( is_array( $total ) )
             $total = implode( &#34;\n&#34;, $total );
-            
+
         $total = $this-&gt;encoding-&gt;convert_encoding ($total);
 
         if ( $this-&gt;file == &#34;<a href="php://stdout&#34" rel="nofollow">php://stdout&#34</a>; )

Modified: branches/9.x/tiki-export_sheet.php
===================================================================
--- branches/9.x/tiki-export_sheet.php	2012-05-03 16:04:03 UTC (rev 41300)
+++ branches/9.x/tiki-export_sheet.php	2012-05-03 17:48:12 UTC (rev 41301)
@@ -15,7 +15,7 @@
 
 $access-&gt;check_feature(&#39;feature_sheet&#39;);
 
-$info = $sheetlib-&gt;get_sheet_info($_REQUEST[&#39;sheetId&#39;]);
+$info = TikiLib::lib(&#34;sheet&#34;)-&gt;get_sheet_info($_REQUEST[&#39;sheetId&#39;]);
 if (empty($info)) {
 	$smarty-&gt;assign(&#39;msg&#39;, tra(&#39;Incorrect parameter&#39;));
 	$smarty-&gt;display(&#39;error.tpl&#39;);
@@ -61,6 +61,7 @@
 
 	$handler = new $handler(&#34;<a href="php://stdout&#34" rel="nofollow">php://stdout&#34</a>; , &#39;UTF-8&#39;, $_REQUEST[&#39;encoding&#39;]);
 	$grid-&gt;export($handler);
+	echo $handler-&gt;output;
 	exit;
 } else {
 	$list = array();

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29215572">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29215572/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41315] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-05-03 23:05:22</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41315
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41315&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41315&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-05-03 23:05:16 +0000 (Thu, 03 May 2012)
Log Message:
-----------
[FIX] tracker: Display warning if tracker events are not being logged (history doesn&#39;t work if not)

Modified Paths:
--------------
    branches/9.x/templates/tiki-tracker_view_history.tpl
    branches/9.x/tiki-tracker_view_history.php

Modified: branches/9.x/templates/tiki-tracker_view_history.tpl
===================================================================
--- branches/9.x/templates/tiki-tracker_view_history.tpl	2012-05-03 22:47:02 UTC (rev 41314)
+++ branches/9.x/templates/tiki-tracker_view_history.tpl	2012-05-03 23:05:16 UTC (rev 41315)
@@ -3,6 +3,12 @@
 	 {button _keepall=&#39;y&#39; href=&#34;tiki-view_tracker_item.php&#34; itemId=$item_info.itemId _text=&#34;{tr}View Tracker Item{/tr}&#34;}
 &lt;/div&gt;
 
+{if $logging eq 0}
+	{remarksbox title=&#34;{tr}Not logging{/tr}&#34; type=&#34;warning&#34;}
+		{tr}Tracker changes are not being logged: Go to &lt;a href=&#34;tiki-admin_actionlog.php?action_log_type=trackeritem&#34; &gt;Action log admin&lt;/a&gt; to enable{/tr}
+	{/remarksbox}
+{/if}
+
 &lt;div class=&#34;clearfix&#34;&gt;
 	 &lt;form method=&#34;post&#34;&gt;
 	 &lt;label class=&#34;findtitle&#34;&gt;{tr}Version{/tr}&lt;input type=&#34;text&#34; name=&#34;version&#34; value=&#34;{if !empty($filter.version)}{$filter.version|escape}{/if}&#34; /&gt;&lt;/label&gt;

Modified: branches/9.x/tiki-tracker_view_history.php
===================================================================
--- branches/9.x/tiki-tracker_view_history.php	2012-05-03 22:47:02 UTC (rev 41314)
+++ branches/9.x/tiki-tracker_view_history.php	2012-05-03 23:05:16 UTC (rev 41315)
@@ -45,5 +45,13 @@
 	$smarty-&gt;assign_by_ref(&#39;item_info&#39;, $item_info);
 	$smarty-&gt;assign_by_ref(&#39;field_option&#39;, $field_option);
 }
+
+$tiki_actionlog_conf = TikiDb::get()-&gt;table(&#39;tiki_actionlog_conf&#39;);
+$logging = $tiki_actionlog_conf-&gt;fetchCount(array(
+	&#39;objectType&#39; =&gt; &#39;trackeritem&#39;,
+	&#39;status&#39; =&gt; &#39;y&#39;
+));
+$smarty-&gt;assign(&#39;logging&#39;, $logging);
+
 $smarty-&gt;assign(&#39;mid&#39;, &#39;tiki-tracker_view_history.tpl&#39;);
 $smarty-&gt;display(&#39;tiki.tpl&#39;);

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29215657">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29215657/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41316] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-05-03 23:33:29</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41316
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41316&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41316&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-05-03 23:33:22 +0000 (Thu, 03 May 2012)
Log Message:
-----------
[FIX] tracker: Display warning if tracker events are being reported not just recorded (thanks marclaporte), ignore view action and show correct tab on link

Modified Paths:
--------------
    branches/9.x/templates/tiki-tracker_view_history.tpl
    branches/9.x/tiki-tracker_view_history.php

Modified: branches/9.x/templates/tiki-tracker_view_history.tpl
===================================================================
--- branches/9.x/templates/tiki-tracker_view_history.tpl	2012-05-03 23:05:16 UTC (rev 41315)
+++ branches/9.x/templates/tiki-tracker_view_history.tpl	2012-05-03 23:33:22 UTC (rev 41316)
@@ -5,7 +5,7 @@
 
 {if $logging eq 0}
 	{remarksbox title=&#34;{tr}Not logging{/tr}&#34; type=&#34;warning&#34;}
-		{tr}Tracker changes are not being logged: Go to &lt;a href=&#34;tiki-admin_actionlog.php?action_log_type=trackeritem&#34; &gt;Action log admin&lt;/a&gt; to enable{/tr}
+		{tr}Tracker changes are not being logged: Go to &lt;a href=&#34;tiki-admin_actionlog.php?action_log_type=trackeritem&amp;cookietab=2&#34; &gt;Action log admin&lt;/a&gt; to enable{/tr}
 	{/remarksbox}
 {/if}
 

Modified: branches/9.x/tiki-tracker_view_history.php
===================================================================
--- branches/9.x/tiki-tracker_view_history.php	2012-05-03 23:05:16 UTC (rev 41315)
+++ branches/9.x/tiki-tracker_view_history.php	2012-05-03 23:33:22 UTC (rev 41316)
@@ -49,7 +49,8 @@
 $tiki_actionlog_conf = TikiDb::get()-&gt;table(&#39;tiki_actionlog_conf&#39;);
 $logging = $tiki_actionlog_conf-&gt;fetchCount(array(
 	&#39;objectType&#39; =&gt; &#39;trackeritem&#39;,
-	&#39;status&#39; =&gt; &#39;y&#39;
+	&#39;action&#39; =&gt;  $tiki_actionlog_conf-&gt;in(array(&#39;Created&#39;,&#39;Updated&#39;)),
+	&#39;status&#39; =&gt;  $tiki_actionlog_conf-&gt;in(array(&#39;y&#39;,&#39;v&#39;)),
 ));
 $smarty-&gt;assign(&#39;logging&#39;, $logging);
 

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29218997">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29218997/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41333] branches/9.x</a></b></div>
      
      <small>From: &lt;lphuberdeau@us...&gt; - 2012-05-04 16:39:33</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41333
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41333&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41333&amp;view=rev</a>
Author:   lphuberdeau
Date:     2012-05-04 16:39:24 +0000 (Fri, 04 May 2012)
Log Message:
-----------
[FIX] Refresh the index when item link target gets modified

Modified Paths:
--------------
    branches/9.x/lib/core/Tracker/Field/Abstract.php
    branches/9.x/lib/core/Tracker/Field/ItemLink.php
    branches/9.x/lib/prefs/tracker.php
    branches/9.x/lib/setup/events.php
    branches/9.x/lib/trackers/trackerlib.php
    branches/9.x/templates/admin/include_trackers.tpl

Modified: branches/9.x/lib/core/Tracker/Field/Abstract.php
===================================================================
--- branches/9.x/lib/core/Tracker/Field/Abstract.php	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/lib/core/Tracker/Field/Abstract.php	2012-05-04 16:39:24 UTC (rev 41333)
@@ -13,6 +13,10 @@
 
 	function __construct($fieldInfo, $itemData, $trackerDefinition)
 	{
+		if (! isset($fieldInfo[&#39;options_array&#39;])) {
+			$fieldInfo[&#39;options_array&#39;] = preg_split(&#39;/\s*,\s*/&#39;, trim($fieldInfo[&#39;options&#39;]));
+		}
+
 		$this-&gt;definition = $fieldInfo;
 		$this-&gt;itemData = $itemData;
 		$this-&gt;trackerDefinition = $trackerDefinition;

Modified: branches/9.x/lib/core/Tracker/Field/ItemLink.php
===================================================================
--- branches/9.x/lib/core/Tracker/Field/ItemLink.php	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/lib/core/Tracker/Field/ItemLink.php	2012-05-04 16:39:24 UTC (rev 41333)
@@ -477,9 +477,9 @@
 		$remoteField = $this-&gt;getOption(9);
 		$method = $this-&gt;getOption(10);
 		$localTrackerId = $this-&gt;getConfiguration(&#39;trackerId&#39;);
-                $remoteTrackerId = $this-&gt;getOption(0);
+		$remoteTrackerId = $this-&gt;getOption(0);
 
-            	$localValue = $trklib-&gt;get_item_value($localTrackerId, $this-&gt;getItemId(), $localField);
+		$localValue = $trklib-&gt;get_item_value($localTrackerId, $this-&gt;getItemId(), $localField);
 
 		if ($method == &#39;domain&#39;) {
 			if (! preg_match(&#39;@^(?:<a href="http://)?([^/]+)@i&#39" rel="nofollow">http://)?([^/]+)@i&#39</a>;, $localValue, $matches)) {
@@ -517,5 +517,22 @@
 			&#39;value&#39; =&gt; $value,
 		);
 	}
+
+	function itemsRequireRefresh($trackerId, $modifiedFields)
+	{
+		if ($this-&gt;getOption(&#39;trackerId&#39;) != $trackerId) {
+			return false;
+		}
+
+		$usedFields = array_merge(
+			array($this-&gt;getOption(&#39;fieldId&#39;)),
+			explode(&#39;|&#39;, $this-&gt;getOption(&#39;indexRemote&#39;)),
+			explode(&#39;|&#39;, $this-&gt;getOption(&#39;displayFieldsList&#39;))
+		);
+
+		$intersect = array_intersect($usedFields, $modifiedFields);
+
+		return count($intersect) &gt; 0;
+	}
 }
 

Modified: branches/9.x/lib/prefs/tracker.php
===================================================================
--- branches/9.x/lib/prefs/tracker.php	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/lib/prefs/tracker.php	2012-05-04 16:39:24 UTC (rev 41333)
@@ -14,5 +14,11 @@
 			&#39;type&#39; =&gt; &#39;flag&#39;,
 			&#39;default&#39; =&gt; &#39;n&#39;,
 		),
+		&#39;tracker_refresh_itemlink_detail&#39; =&gt; array(
+			&#39;name&#39; =&gt; tr(&#39;Refresh item link items when master is modified&#39;),
+			&#39;description&#39; =&gt; tr(&#39;To be used when item link is used in trackers so that the index remains in good shape when data on the master that is indexed with the detail is modified and used to search on.&#39;),
+			&#39;type&#39; =&gt; &#39;flag&#39;,
+			&#39;default&#39; =&gt; &#39;n&#39;,
+		),
 	);
 }

Modified: branches/9.x/lib/setup/events.php
===================================================================
--- branches/9.x/lib/setup/events.php	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/lib/setup/events.php	2012-05-04 16:39:24 UTC (rev 41333)
@@ -65,6 +65,10 @@
 
 		$events-&gt;bind(&#39;tiki.trackeritem.save&#39;, Event_Lib::defer(&#39;trk&#39;, &#39;update_tracker_summary&#39;));
 		$events-&gt;bind(&#39;tiki.trackeritem.save&#39;, Event_Lib::defer(&#39;trk&#39;, &#39;invalidate_item_cache&#39;));
+
+		if ($prefs[&#39;tracker_refresh_itemlink_detail&#39;] == &#39;y&#39;) {
+			$events-&gt;bind(&#39;tiki.trackeritem.update&#39;, Event_Lib::defer(&#39;trk&#39;, &#39;refresh_index_on_master_update&#39;));
+		}
 	}
 
 	if ($prefs[&#39;feature_search&#39;] == &#39;y&#39; &amp;&amp; $prefs[&#39;unified_incremental_update&#39;] == &#39;y&#39;) {

Modified: branches/9.x/lib/trackers/trackerlib.php
===================================================================
--- branches/9.x/lib/trackers/trackerlib.php	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/lib/trackers/trackerlib.php	2012-05-04 16:39:24 UTC (rev 41333)
@@ -1318,6 +1318,8 @@
 		global $user, $prefs, $tiki_p_admin_trackers, $tiki_p_admin_users;
 		$final_event = &#39;tiki.trackeritem.update&#39;;
 
+		$transaction = $this-&gt;begin();
+
 		$categlib = TikiLib::lib(&#39;categ&#39;);
 		$cachelib = TikiLib::lib(&#39;cache&#39;);
 		$smarty = TikiLib::lib(&#39;smarty&#39;);
@@ -1522,6 +1524,8 @@
 						)
 		);
 
+		$transaction-&gt;commit();
+
 		return $currentItemId;
 	}
 
@@ -4254,6 +4258,45 @@
 			return $r;
 		}
 	}
+
+	function refresh_index_on_master_update($args)
+	{
+		// Event handler
+		// See pref tracker_refresh_itemlink_detail
+
+		$modifiedFields = array();
+		foreach ($args[&#39;old_values&#39;] as $key =&gt; $old) {
+			if (! isset($args[&#39;values&#39;][$key]) || $args[&#39;values&#39;][$key] != $old) {
+				$modifiedFields[] = $key;
+			}
+		}
+
+		$fields = $this-&gt;table(&#39;tiki_tracker_fields&#39;);
+		$list = $fields-&gt;fetchAll($fields-&gt;all(), array(
+			&#39;type&#39; =&gt; &#39;r&#39;,
+		));
+
+		$toConsider = array();
+
+		foreach ($list as $field) {
+			$handler = $this-&gt;get_field_handler($field);
+
+			if ($handler-&gt;itemsRequireRefresh($args[&#39;trackerId&#39;], $modifiedFields)) {
+				$toConsider[] = $field[&#39;fieldId&#39;];
+			}
+		}
+
+		$itemFields = $this-&gt;table(&#39;tiki_tracker_item_fields&#39;);
+		$searchlib = TikiLib::lib(&#39;unifiedsearch&#39;);
+		$items = $itemFields-&gt;fetchColumn(&#39;itemId&#39;, array(
+			&#39;fieldId&#39; =&gt; $itemFields-&gt;in($toConsider),
+			&#39;value&#39; =&gt; $args[&#39;object&#39;],
+		));
+
+		foreach (array_unique($items) as $itemId) {
+			$searchlib-&gt;invalidateObject(&#39;trackeritem&#39;, $itemId);
+		}
+	}
 }
 
 global $trklib;

Modified: branches/9.x/templates/admin/include_trackers.tpl
===================================================================
--- branches/9.x/templates/admin/include_trackers.tpl	2012-05-04 14:41:44 UTC (rev 41332)
+++ branches/9.x/templates/admin/include_trackers.tpl	2012-05-04 16:39:24 UTC (rev 41333)
@@ -16,6 +16,7 @@
 		{preference name=user_selector_realnames_tracker}
 		{preference name=feature_reports}
 		{preference name=&#34;tracker_remote_sync&#34;}
+		{preference name=&#34;tracker_refresh_itemlink_detail&#34;}
 	&lt;/fieldset&gt;
 
 	&lt;fieldset class=&#34;admin&#34;&gt;

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29219134">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29219134/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41336] branches/9.x</a></b></div>
      
      <small>From: &lt;lphuberdeau@us...&gt; - 2012-05-04 17:18:31</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41336
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41336&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41336&amp;view=rev</a>
Author:   lphuberdeau
Date:     2012-05-04 17:18:22 +0000 (Fri, 04 May 2012)
Log Message:
-----------
[ENH] Enable basic navigation controls on map when inserting markers

Modified Paths:
--------------
    branches/9.x/lib/jquery_tiki/tiki-maps.js
    branches/9.x/templates/modules/mod-tracker_input.tpl

Modified: branches/9.x/lib/jquery_tiki/tiki-maps.js
===================================================================
--- branches/9.x/lib/jquery_tiki/tiki-maps.js	2012-05-04 17:00:16 UTC (rev 41335)
+++ branches/9.x/lib/jquery_tiki/tiki-maps.js	2012-05-04 17:18:22 UTC (rev 41336)
@@ -506,7 +506,7 @@
 
 					container.modeManager.addMode({
 						name: &#39;StreetView&#39;,
-						controls: [ new StreetViewHandler() ]
+						controls: [ new StreetViewHandler(), new OpenLayers.Control.Navigation() ]
 					});
 
 					container.streetview.addButton = function (label, callback) {

Modified: branches/9.x/templates/modules/mod-tracker_input.tpl
===================================================================
--- branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-04 17:00:16 UTC (rev 41335)
+++ branches/9.x/templates/modules/mod-tracker_input.tpl	2012-05-04 17:18:22 UTC (rev 41336)
@@ -85,7 +85,7 @@
 					});
 					control.deactivate();
 
-					modeManager.addMode({name: newMode = &#34;{{$tpl_module_title}}&#34;, controls: [control]});
+					modeManager.addMode({name: newMode = &#34;{{$tpl_module_title}}&#34;, controls: [control, new OpenLayers.Control.Navigation()]});
 				}
 
 				button = $(&#39;&lt;input type=&#34;submit&#34;/&gt;&#39;)

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29219350">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29219350/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41337] branches/9.x</a></b></div>
      
      <small>From: &lt;jonnybradley@us...&gt; - 2012-05-04 18:25:39</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41337
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41337&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41337&amp;view=rev</a>
Author:   jonnybradley
Date:     2012-05-04 18:25:33 +0000 (Fri, 04 May 2012)
Log Message:
-----------
[FIX] structures: Display errors from XML structure export and add feed back if ZipArchive class not found (thanks Geoff)

Modified Paths:
--------------
    branches/9.x/lib/wiki/xmllib.php
    branches/9.x/templates/tiki-admin_structures.tpl

Modified: branches/9.x/lib/wiki/xmllib.php
===================================================================
--- branches/9.x/lib/wiki/xmllib.php	2012-05-04 17:18:22 UTC (rev 41336)
+++ branches/9.x/lib/wiki/xmllib.php	2012-05-04 18:25:33 UTC (rev 41337)
@@ -29,7 +29,7 @@
 			if (is_array($this-&gt;errorsArgs[$i])) {
 				$str .= &#39;: &#39;.implode(&#39;, &#39;, $this-&gt;errorsArgs[$i]);
 			} else {
-				$str .= $this-&gt;errorsArgs[$i];
+				$str .= &#39;: &#39; . $this-&gt;errorsArgs[$i];
 			}
 		}
 		return $str;
@@ -40,7 +40,7 @@
 	{
 		if (! class_exists(&#39;ZipArchive&#39;)) {
 			$this-&gt;errors[] = &#39;Problem zip initialisation&#39;;
-			$this-&gt;errorsArgs[] = &#39;&#39;;
+			$this-&gt;errorsArgs[] = &#39;ZipArchive class not found&#39;;
 			return false;
 		}
 

Modified: branches/9.x/templates/tiki-admin_structures.tpl
===================================================================
--- branches/9.x/templates/tiki-admin_structures.tpl	2012-05-04 17:18:22 UTC (rev 41336)
+++ branches/9.x/templates/tiki-admin_structures.tpl	2012-05-04 18:25:33 UTC (rev 41337)
@@ -59,6 +59,12 @@
 	{/remarksbox}
 {/if}
 
+{if !empty($error)}
+	{remarksbox type=&#39;warning&#39; title=&#34;{tr}Error{/tr}&#34;}
+		{$error|escape}
+	{/remarksbox}
+{/if}
+
 {tabset}
 	{tab name=&#34;{tr}Structures{/tr}&#34;}
 		{if $channels or ($find ne &#39;&#39;)}

This was sent by the SourceForge.net collaborative development platform, the world&#39;s largest Open Source development site.



</pre></td>
</tr>
</table>
</div>

<div class="thread-message" style="margin-left: 20px">
  

<table id="msg29220647">
<tr>
  <td class="email-header">
    <div>
      <div><b><a href="/p/tikiwiki/mailman/message/29220647/">[Tikiwiki-cvs/svn] SF.net SVN: tikiwiki:[41350] branches/9.x</a></b></div>
      
      <small>From: &lt;chibaguy@us...&gt; - 2012-05-05 02:08:11</small>
      <div class="attachments">
        <small>
          
        </small>
      </div>
    </div>
  </td>
</tr>
<tr>
  <td class="email-body"><pre>Revision: 41350
          <a href="http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41350&amp;view=rev" rel="nofollow">http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=41350&amp;view=rev</a>
Author:   chibaguy
Date:     2012-05-05 02:07:59 +0000 (Sat, 05 May 2012)
Log Message:
-----------
[FIX] Spelling error (&#39;occured&#39;) in error messages.

Modified Paths:
--------------
    branches/9.x/admin/include_gal.php
    branches/9.x/doc/devtools/svnbranchupdate.php
    branches/9.x/doc/devtools/svnmerge.php
    branches/9.x/lang/ar/language.php
    branches/9.x/lang/bg/language.php
    branches/9.x/lang/ca/language.php
    branches/9.x/lang/cn/language.php
    branches/9.x/lang/cs/language.php
    branches/9.x/lang/cy/language.php
    branches/9.x/lang/da/language.php
    branches/9.x/lang/de/language.php
    branches/9.x/lang/el/language.php
    branches/9.x/lang/en/language.php
    branches/9.x/lang/en-uk/language.php
    branches/9.x/lang/es/language.php
    branches/9.x/lang/fa/language.php
    branches/9.x/lang/fi/language.php
    branches/9.x/lang/fj/language.php
    branches/9.x/lang/fr/language.php
    branches/9.x/lang/fy-NL/language.php
    branches/9.x/lang/gl/language.php
    branches/9.x/lang/he/language.php
    branches/9.x/lang/hr/language.php
    branches/9.x/lang/hu/language.php
    branches/9.x/lang/id/language.php
    branches/9.x/lang/is/language.php
    branches/9.x/lang/it/language.php
    branches/9.x/lang/iu/language.php
    branches/9.x/lang/ja/language.php
    branches/9.x/lang/ko/language.php
    branches/9.x/lang/lt/language.php
    branches/9.x/lang/nds/language.php
    branches/9.x/lang/nl/language.php
    branches/9.x/lang/no/language.php
    branches/9.x/lang/pl/language.php
    branches/9.x/lang/pt/language.php
    branches/9.x/lang/pt-br/language.php
    branches/9.x/lang/rm/language.php
    branches/9.x/lang/ro/language.php
    branches/9.x/lang/ru/language.php
    branches/9.x/lang/sb/language.php
    branches/9.x/lang/si/language.php
    branches/9.x/lang/sk/language.php
    branches/9.x/lang/sl/language.php
    branches/9.x/lang/sq/language.php
    branches/9.x/lang/sr-latn/language.php
    branches/9.x/lang/sv/language.php
    branches/9.x/lang/tr/language.php
    branches/9.x/lang/tv/language.php
    branches/9.x/lang/tw/language.php
    branches/9.x/lang/uk/language.php
    branches/9.x/lang/vi/language.php
    branches/9.x/lib/TikiWebdav/Backend/File.php
    branches/9.x/lib/smarty_tiki/function.rating.php
    branches/9.x/lib/structures/structlib.php
    branches/9.x/templates/admin/include_profiles.tpl
    branches/9.x/templates/database-connection-error.tpl
    branches/9.x/templates/tiki-admin_actionlog.tpl
    branches/9.x/tiki-directory_add_site.php
    branches/9.x/tiki-map.php
    branches/9.x/tiki-send_newsletters.php

Modified: branches/9.x/admin/include_gal.php
===================================================================
--- branches/9.x/admin/include_gal.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/admin/include_gal.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -67,9 +67,9 @@
 			|| ($_REQUEST[&#39;mvimg&#39;] == &#39;to_db&#39; &amp;&amp; $prefs[&#39;gal_use_db&#39;] == &#39;y&#39;)
 	) {
 		$mvresult = $imagegallib-&gt;move_gallery_store($_REQUEST[&#39;move_gallery&#39;], $_REQUEST[&#39;mvimg&#39;]);
-		$mvmsg = sprintf(tra(&#39;moved %d images, %d errors occured.&#39;), $mvresult[&#39;moved_images&#39;], $mvresult[&#39;errors&#39;]);
+		$mvmsg = sprintf(tra(&#39;moved %d images, %d errors occurred.&#39;), $mvresult[&#39;moved_images&#39;], $mvresult[&#39;errors&#39;]);
 		if ($mvresult[&#39;timeout&#39;]) {
-			$mvmsg.= &#39; &#39; . tra(&#39;a timeout occured. Hit the reload button to move the rest&#39;);
+			$mvmsg.= &#39; &#39; . tra(&#39;a timeout occurred. Hit the reload button to move the rest&#39;);
 		}
 		$tikifeedback[][&#39;mes&#39;] = $mvmsg;
 	}
@@ -105,9 +105,9 @@
 			|| ($_REQUEST[&#39;mvimg&#39;] == &#39;to_db&#39; &amp;&amp; $prefs[&#39;gal_use_db&#39;] == &#39;y&#39;)
 	) {
 		$mvresult = $imagegallib-&gt;move_gallery_store($_REQUEST[&#39;move_gallery&#39;], $_REQUEST[&#39;mvimg&#39;]);
-		$mvmsg = sprintf(tra(&#39;moved %d images, %d errors occured.&#39;), $mvresult[&#39;moved_images&#39;], $mvresult[&#39;errors&#39;]);
+		$mvmsg = sprintf(tra(&#39;moved %d images, %d errors occurred.&#39;), $mvresult[&#39;moved_images&#39;], $mvresult[&#39;errors&#39;]);
 		if ($mvresult[&#39;timeout&#39;]) {
-			$mvmsg .= &#39; &#39; . tra(&#39;a timeout occured. Hit the reload button to move the rest&#39;);
+			$mvmsg .= &#39; &#39; . tra(&#39;a timeout occurred. Hit the reload button to move the rest&#39;);
 		}
 		$tikifeedback[][&#39;mes&#39;] = $mvmsg;
 	}

Modified: branches/9.x/doc/devtools/svnbranchupdate.php
===================================================================
--- branches/9.x/doc/devtools/svnbranchupdate.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/doc/devtools/svnbranchupdate.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -48,7 +48,7 @@
 
 $conflicts = get_conflicts(&#39;.&#39;);
 if ($conflicts-&gt;length &gt; 0) {
-	$message = &#34;Conflicts occured during the merge. Fix the conflicts and start again.&#34;;
+	$message = &#34;Conflicts occurred during the merge. Fix the conflicts and start again.&#34;;
 	foreach ($conflicts as $path) {
 		$path = $path-&gt;parentNode-&gt;getAttribute(&#39;path&#39;);
 		$message .= &#34;\n\t$path&#34;;

Modified: branches/9.x/doc/devtools/svnmerge.php
===================================================================
--- branches/9.x/doc/devtools/svnmerge.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/doc/devtools/svnmerge.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -51,7 +51,7 @@
 
 $conflicts = get_conflicts(&#39;.&#39;);
 if ($conflicts-&gt;length &gt; 0) {
-	$message = &#34;Conflicts occured during the merge. Fix the conflicts and start again.&#34;;
+	$message = &#34;Conflicts occurred during the merge. Fix the conflicts and start again.&#34;;
 	foreach ($conflicts as $path) {
 		$path = $path-&gt;parentNode-&gt;getAttribute(&#39;path&#39;);
 		$message .= &#34;\n\t$path&#34;;

Modified: branches/9.x/lang/ar/language.php
===================================================================
--- branches/9.x/lang/ar/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/ar/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 // &#34;Owner&#34; =&gt; &#34;Owner&#34;,
 // &#34;Description&#34; =&gt; &#34;Description&#34;,
 // &#34;ID&#34; =&gt; &#34;ID&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 // &#34;Detected, Version&#34; =&gt; &#34;Detected, Version&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 // &#34;Not detected&#34; =&gt; &#34;Not detected&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 // &#34;Invert Sort&#34; =&gt; &#34;Invert Sort&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8627,7 +8627,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 // &#34;Current URL&#34; =&gt; &#34;Current URL&#34;,
 // &#34;Command&#34; =&gt; &#34;Command&#34;,
 // &#34;exec&#34; =&gt; &#34;exec&#34;,
@@ -9565,7 +9565,7 @@
 // &#34;Weeks&#34; =&gt; &#34;Weeks&#34;,
 // &#34;Setting&#34; =&gt; &#34;Setting&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13808,7 +13808,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;تحرير&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 // &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Maps feature is not correctly setup : Maps path is missing&#34;,
@@ -13882,7 +13882,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/bg/language.php
===================================================================
--- branches/9.x/lang/bg/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/bg/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 // &#34;Owner&#34; =&gt; &#34;Owner&#34;,
 // &#34;Description&#34; =&gt; &#34;Description&#34;,
 // &#34;ID&#34; =&gt; &#34;ID&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 // &#34;Detected, Version&#34; =&gt; &#34;Detected, Version&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 // &#34;Not detected&#34; =&gt; &#34;Not detected&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 // &#34;Invert Sort&#34; =&gt; &#34;Invert Sort&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8627,7 +8627,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 // &#34;Current URL&#34; =&gt; &#34;Current URL&#34;,
 // &#34;Command&#34; =&gt; &#34;Command&#34;,
 // &#34;exec&#34; =&gt; &#34;exec&#34;,
@@ -9565,7 +9565,7 @@
 // &#34;Weeks&#34; =&gt; &#34;Weeks&#34;,
 // &#34;Setting&#34; =&gt; &#34;Setting&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13807,7 +13807,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 // &#34;edit&#34; =&gt; &#34;edit&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 // &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Maps feature is not correctly setup : Maps path is missing&#34;,
@@ -13881,7 +13881,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/ca/language.php
===================================================================
--- branches/9.x/lang/ca/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/ca/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 &#34;Owner&#34; =&gt; &#34;Propietari&#34;,
 &#34;Description&#34; =&gt; &#34;Descripció&#34;,
 &#34;ID&#34; =&gt; &#34;ID&#34;,
-&#34;moved %d images, %d errors occured.&#34; =&gt; &#34;mogudes: %d imatges; han ocorregut %d errors.&#34;,
-&#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;ha ocorregut una desconnexió. Prem el botó Actualitza per moure la resta&#34;,
+&#34;moved %d images, %d errors occurred.&#34; =&gt; &#34;mogudes: %d imatges; han ocorregut %d errors.&#34;,
+&#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;ha ocorregut una desconnexió. Prem el botó Actualitza per moure la resta&#34;,
 &#34;Detected, Version:&#34; =&gt; &#34;Detectat/da, Versió:&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 &#34;Not detected.&#34; =&gt; &#34;No detectat/da.&#34;,
@@ -3865,7 +3865,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 &#34;Invert Sort&#34; =&gt; &#34;Inverteix l&#39;ordre&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8647,7 +8647,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 &#34;Current URL&#34; =&gt; &#34;Actual URL&#34;,
 &#34;Command&#34; =&gt; &#34;Comanda&#34;,
 &#34;exec&#34; =&gt; &#34;executa&#34;,
@@ -9601,7 +9601,7 @@
 &#34;Weeks&#34; =&gt; &#34;Setmanes&#34;,
 &#34;Setting&#34; =&gt; &#34;Configuració&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 &#34;Wiki page actions except viewed will always be recorded but can be not reported.&#34; =&gt; &#34;Les accions en pàgines wiki (excepte les de visualització) sempre es registren però es pot selecionar que no es mostrin als informes.&#34;,
 &#34;Recorded&#34; =&gt; &#34;Registrat&#34;,
 &#34;Reported&#34; =&gt; &#34;Mostrat a l&#39;informe&#34;,
@@ -13878,7 +13878,7 @@
 &#34;Sorry, you can&#39;t use this feature.&#34; =&gt; &#34;Disculpa, no pots fer servir aquesta funcionalitat.&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;editar&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 &#34;Maps feature is not correctly setup : Maps path is missing.&#34; =&gt; &#34;L&#39;opció de mapes no està correctament configurada: la ruta dels Mapes falta.&#34;,
@@ -13952,7 +13952,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/cn/language.php
===================================================================
--- branches/9.x/lang/cn/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/cn/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 &#34;Owner&#34; =&gt; &#34;所属者&#34;,
 &#34;Description&#34; =&gt; &#34;描述&#34;,
 &#34;ID&#34; =&gt; &#34;编号&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 // &#34;Detected, Version&#34; =&gt; &#34;Detected, Version&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 // &#34;Not detected&#34; =&gt; &#34;Not detected&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 // &#34;Invert Sort&#34; =&gt; &#34;Invert Sort&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8634,7 +8634,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 &#34;Current URL&#34; =&gt; &#34;当前的 URL&#34;,
 &#34;Command&#34; =&gt; &#34;命令&#34;,
 &#34;exec&#34; =&gt; &#34;执行&#34;,
@@ -9581,7 +9581,7 @@
 &#34;Weeks&#34; =&gt; &#34;周&#34;,
 &#34;Setting&#34; =&gt; &#34;设置&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13835,7 +13835,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 &#34;You must first setup MapServer&#34; =&gt; &#34;你必须首先创建地图服务器&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;编辑&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 // &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Maps feature is not correctly setup : Maps path is missing&#34;,
@@ -13909,7 +13909,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/cs/language.php
===================================================================
--- branches/9.x/lang/cs/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/cs/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 &#34;Owner&#34; =&gt; &#34;Vlastník&#34;,
 &#34;Description&#34; =&gt; &#34;Popisek&#34;,
 &#34;ID&#34; =&gt; &#34;ID&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 &#34;Detected, Version:&#34; =&gt; &#34;Detekován(a/o), verze:&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 &#34;Not detected.&#34; =&gt; &#34;Nezjištěno.&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 &#34;Invert Sort&#34; =&gt; &#34;Změnit řazení&#34;,
 &#34;No rows found&#34; =&gt; &#34;Nebyly nalezeny žádné výsledky&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8638,7 +8638,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 &#34;Current URL&#34; =&gt; &#34;Současná URL&#34;,
 &#34;Command&#34; =&gt; &#34;Příkaz&#34;,
 &#34;exec&#34; =&gt; &#34;Spustit&#34;,
@@ -9592,7 +9592,7 @@
 &#34;Weeks&#34; =&gt; &#34;týdnů&#34;,
 // &#34;Setting&#34; =&gt; &#34;Setting&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13855,7 +13855,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;Upravit&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 &#34;Maps feature is not correctly setup : Maps path is missing.&#34; =&gt; &#34;Funkce pro zobrazení map není správně nastavena : cesta k mapám chybí.&#34;,
@@ -13929,7 +13929,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/cy/language.php
===================================================================
--- branches/9.x/lang/cy/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/cy/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 // &#34;Owner&#34; =&gt; &#34;Owner&#34;,
 &#34;Description&#34; =&gt; &#34;Disgrifiad&#34;,
 // &#34;ID&#34; =&gt; &#34;ID&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 // &#34;Detected, Version&#34; =&gt; &#34;Detected, Version&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 // &#34;Not detected&#34; =&gt; &#34;Not detected&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 // &#34;Invert Sort&#34; =&gt; &#34;Invert Sort&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8627,7 +8627,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 // &#34;Current URL&#34; =&gt; &#34;Current URL&#34;,
 // &#34;Command&#34; =&gt; &#34;Command&#34;,
 // &#34;exec&#34; =&gt; &#34;exec&#34;,
@@ -9568,7 +9568,7 @@
 &#34;Weeks&#34; =&gt; &#34;Wythnosau&#34;,
 // &#34;Setting&#34; =&gt; &#34;Setting&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13818,7 +13818,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;golygu&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 // &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Maps feature is not correctly setup : Maps path is missing&#34;,
@@ -13892,7 +13892,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/da/language.php
===================================================================
--- branches/9.x/lang/da/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/da/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 &#34;Owner&#34; =&gt; &#34;Ejer&#34;,
 &#34;Description&#34; =&gt; &#34;Beskrivelse&#34;,
 &#34;ID&#34; =&gt; &#34;ID&#34;,
-// &#34;moved %d images, %d errors occured&#34; =&gt; &#34;moved %d images, %d errors occured&#34;,
-// &#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occured. Hit the reload button to move the rest&#34;,
+// &#34;moved %d images, %d errors occurred&#34; =&gt; &#34;moved %d images, %d errors occurred&#34;,
+// &#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;a timeout occurred. Hit the reload button to move the rest&#34;,
 // &#34;Detected, Version&#34; =&gt; &#34;Detected, Version&#34;,
 // &#34;Test Image&#34; =&gt; &#34;Test Image&#34;,
 // &#34;Not detected&#34; =&gt; &#34;Not detected&#34;,
@@ -3864,7 +3864,7 @@
 // &#34;Preference %0 is not defined&#34; =&gt; &#34;Preference %0 is not defined&#34;,
 // &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Drag this out of the perspective and resave it&#34;,
 // &#34;No object information provided for rating&#34; =&gt; &#34;No object information provided for rating&#34;,
-// &#34;An error occured&#34; =&gt; &#34;An error occured&#34;,
+// &#34;An error occurred&#34; =&gt; &#34;An error occurred&#34;,
 // &#34;Invert Sort&#34; =&gt; &#34;Invert Sort&#34;,
 // &#34;No rows found&#34; =&gt; &#34;No rows found&#34;,
 // &#34;Toggle sections&#34; =&gt; &#34;Toggle sections&#34;,
@@ -8633,7 +8633,7 @@
 // &#34;The built query was likely&#34; =&gt; &#34;The built query was likely&#34;,
 // &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 // &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki is unable to connect to the database&#34;,
-// &#34;An error occured while performing the request&#34; =&gt; &#34;An error occured while performing the request&#34;,
+// &#34;An error occurred while performing the request&#34; =&gt; &#34;An error occurred while performing the request&#34;,
 &#34;Current URL&#34; =&gt; &#34;Nuværende URL&#34;,
 &#34;Command&#34; =&gt; &#34;Kommando&#34;,
 &#34;exec&#34; =&gt; &#34;udfør&#34;,
@@ -9580,7 +9580,7 @@
 &#34;Weeks&#34; =&gt; &#34;Uger&#34;,
 // &#34;Setting&#34; =&gt; &#34;Setting&#34;,
 // &#34;How&#34; =&gt; &#34;How&#34;,
-// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded&#34;,
+// &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34; =&gt; &#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded&#34;,
 // &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34; =&gt; &#34;Wiki page actions except viewed will always be recorded but can be not reported&#34;,
 // &#34;Recorded&#34; =&gt; &#34;Recorded&#34;,
 // &#34;Reported&#34; =&gt; &#34;Reported&#34;,
@@ -13830,7 +13830,7 @@
 // &#34;Sorry, you can&#39;t use this feature&#34; =&gt; &#34;Sorry, you can&#39;t use this feature&#34;,
 // &#34;You must first setup MapServer&#34; =&gt; &#34;You must first setup MapServer&#34;,
 // &#34;invalid mapfile name&#34; =&gt; &#34;invalid mapfile name&#34;,
-// &#34;An error as occured with the mapfile&#34; =&gt; &#34;An error as occured with the mapfile&#34;,
+// &#34;An error as occurred with the mapfile&#34; =&gt; &#34;An error as occurred with the mapfile&#34;,
 &#34;edit&#34; =&gt; &#34;rediger&#34;,
 // &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Please create a directory named %0 to hold your map files&#34;,
 // &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Maps feature is not correctly setup : Maps path is missing&#34;,
@@ -13904,7 +13904,7 @@
 // &#34;Page updated: &#34; =&gt; &#34;Page updated: &#34;,
 // &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Results for \&#34;%1\&#34;&#34;,
 // &#34;Searchindex&#34; =&gt; &#34;Searchindex&#34;,
-// &#34;A problem occured during file uploading&#34; =&gt; &#34;A problem occured during file uploading&#34;,
+// &#34;A problem occurred during file uploading&#34; =&gt; &#34;A problem occurred during file uploading&#34;,
 // &#34;File which was causing trouble was at rank&#34; =&gt; &#34;File which was causing trouble was at rank&#34;,
 // &#34;The error was&#34; =&gt; &#34;The error was&#34;,
 // &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34; =&gt; &#34;Error: You can&#39;t send the same newsletter by refreshing this frame content&#34;,

Modified: branches/9.x/lang/de/language.php
===================================================================
--- branches/9.x/lang/de/language.php	2012-05-04 23:16:52 UTC (rev 41349)
+++ branches/9.x/lang/de/language.php	2012-05-05 02:07:59 UTC (rev 41350)
@@ -30,8 +30,8 @@
 &#34;Owner&#34; =&gt; &#34;Besitzer&#34;,
 &#34;Description&#34; =&gt; &#34;Beschreibung&#34;,
 &#34;ID&#34; =&gt; &#34;ID&#34;,
-&#34;moved %d images, %d errors occured&#34; =&gt; &#34;%d Bilder verschoben, %d Fehler aufgetreten&#34;,
-&#34;a timeout occured. Hit the reload button to move the rest&#34; =&gt; &#34;eine Zeitüberschreitung ist eingetreten. Klicke auf neu laden um den Rest zu verschieben&#34;,
+&#34;moved %d images, %d errors occurred&#34; =&gt; &#34;%d Bilder verschoben, %d Fehler aufgetreten&#34;,
+&#34;a timeout occurred. Hit the reload button to move the rest&#34; =&gt; &#34;eine Zeitüberschreitung ist eingetreten. Klicke auf neu laden um den Rest zu verschieben&#34;,
 &#34;Detected, Version:&#34; =&gt; &#34;Gefunden, Version:&#34;,
 &#34;Test Image&#34; =&gt; &#34;Testbild&#34;,
 &#34;Not detected.&#34; =&gt; &#34;Nicht gefunden.&#34;,
@@ -3868,7 +3868,7 @@
 &#34;Preference %0 is not defined&#34; =&gt; &#34;Einstellung %0 ist nicht definiert&#34;,
 &#34;Drag this out of the perspective and resave it&#34; =&gt; &#34;Ziehe dies auf der Perspektive und speichere es erneut&#34;,
 &#34;No object information provided for rating&#34; =&gt; &#34;Keine Objektinformationen für Bewertung angegeben&#34;,
-&#34;An error occured&#34; =&gt; &#34;Ein Fehler ist aufgetreten&#34;,
+&#34;An error occurred&#34; =&gt; &#34;Ein Fehler ist aufgetreten&#34;,
 &#34;Invert Sort&#34; =&gt; &#34;Sortierungsreihenfolge ändern&#34;,
 &#34;No rows found&#34; =&gt; &#34;Keine Zeilen gefunden&#34;,
 &#34;Toggle sections&#34; =&gt; &#34;Auswahl umschalten&#34;,
@@ -8644,7 +8644,7 @@
 &#34;The built query was likely&#34; =&gt; &#34;Die Abfrage lautete wahrscheinlich&#34;,
 &#34;Stacktrace&#34; =&gt; &#34;Stacktrace&#34;,
 &#34;Tiki is unable to connect to the database&#34; =&gt; &#34;Tiki kann sich nicht mit der Datenbank verbinden&#34;,
-&#34;An error occured while performing the request&#34; =&gt; &#34;Ein Fehler ist aufgetreten, als die Anfrage bearbeitet wurde&#34;,
+&#34;An error occurred while performing the request&#34; =&gt; &#34;Ein Fehler ist aufgetreten, als die Anfrage bearbeitet wurde&#34;,
 &#34;Current URL&#34; =&gt; &#34;Aktuelle URL&#34;,
 &#34;Command&#34; =&gt; &#34;Befehle&#34;,
 &#34;exec&#34; =&gt; &#34;Ausführen&#34;,
@@ -9601,7 +9601,7 @@
 &#34;Weeks&#34; =&gt; &#34;Wochen&#34;,
 &#34;Setting&#34; =&gt; &#34;Einstellung&#34;,
 &#34;How&#34; =&gt; &#34;Wie es geht&#34;,
-&#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occured since the action type has been set to recorded.&#34; =&gt; &#34;Du musst das Feld &#39;aufgezeichnet&#39; für jeden Aktionstyp daraufhin prüfen, ob Du hierüber später einen Bericht haben willst. Um einen Bericht von einigen Aktionstypen zu erhalten klicke das &#39;berichtet&#39;-Feld dieser Aktionstypen, gehe auf den Tab Bericht und wähle zusätzliche Filter. Der Bericht wird nur die Aktionen beinhalten, die entstanden sind, nachdem der Aktionstyp auf &#39;aufgezeichnet&#39; gesetzt wurde.&#34;,
+&#34;You need to check out the recorded box for each action type we may be interested to have some report later. To see a report of some action types, select the reported checkboxes of these action types, goto the Report tab and select additional filters. The report will only contains the actions that occurred since the action type has been set to recorded.&#34; =&gt; &#34;Du musst das Feld &#39;aufgezeichnet&#39; für jeden Aktionstyp daraufhin prüfen, ob Du hierüber später einen Bericht haben willst. Um einen Bericht von einigen Aktionstypen zu erhalten klicke das &#39;berichtet&#39;-Feld dieser Aktionstypen, gehe auf den Tab Bericht und wähle zusätzliche Filter. Der Bericht wird nur die Aktionen beinhalten, die entstanden sind, nachdem der Aktionstyp auf &#39;aufgezeichnet&#39; gesetzt wurde.&#34;,
 &#34;Wiki page actions except viewed will always be recorded but can be not reported.&#34; =&gt; &#34;Wiki-Aktionen außer &#39;hat angesehen&#39; werden immer gespeichert, gehen aber nicht in Berichte ein.&#34;,
 &#34;Recorded&#34; =&gt; &#34;Aufgezeichnet&#34;,
 &#34;Reported&#34; =&gt; &#34;Berichtet&#34;,
@@ -13868,7 +13868,7 @@
 &#34;Sorry, you can&#39;t use this feature.&#34; =&gt; &#34;Keine Berechtigung zur Nutzung dieser Funktion&#34;,
 &#34;You must first setup MapServer&#34; =&gt; &#34;Du musst zuerst den MapServer konfigurieren&#34;,
 &#34;invalid mapfile name&#34; =&gt; &#34;Ungültiger Kartendateiname&#34;,
-&#34;An error as occured with the mapfile&#34; =&gt; &#34;Mit der Kartendatei ist ein Fehler aufgetreten&#34;,
+&#34;An error as occurred with the mapfile&#34; =&gt; &#34;Mit der Kartendatei ist ein Fehler aufgetreten&#34;,
 &#34;edit&#34; =&gt; &#34;bearbeiten&#34;,
 &#34;Please create a directory named %0 to hold your map files&#34; =&gt; &#34;Bitte erstelle ein Verzeichnis mit dem Namen %0 um Deine Kartendateien aufzunehmen&#34;,
 &#34;Maps feature is not correctly setup : Maps path is missing&#34; =&gt; &#34;Die Kartenfunktion wurde nicht richtig konfiguriert: Der Kartenpfad fehlt&#34;,
@@ -13942,7 +13942,7 @@
 &#34;Page updated: &#34; =&gt; &#34;Seite aktualisiert: &#34;,
 &#34;%0: Results for \&#34;%1\&#34;&#34; =&gt; &#34;%0: Ergebnis für \&#34;%1\&#34;&#34;,
 &#34;Searchindex&#34; =&gt; &#34;Suchindex&#34;,
-&#34;A problem occured during file uploading&#34; =&gt; &#34;Ein Problem ist beim Datei hochladen aufgetreten&#34;,
+&#34;A problem occurred during file uploading&#34; =&gt; &#34;Ein Problem ist beim Datei hochladen aufgetreten&#34;,
 &#34;File which was causing trouble was at rank&#34; =&gt; &#34;Der Rang der problematischen Datei war&#34;,
 &#34;The error was&#34; =&gt; &#34;Der Fehler war&#3
