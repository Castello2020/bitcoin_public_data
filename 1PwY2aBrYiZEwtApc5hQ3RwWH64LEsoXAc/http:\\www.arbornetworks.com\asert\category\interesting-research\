http://www.arbornetworks.com/asert/category/interesting-research/
HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
Date: Wed, 23 Jul 2014 05:17:48 GMT
Server: Apache/2.2.26 (Amazon)
Set-Cookie: bb2_screener_=1406092668+50.17.27.205+50.17.27.205; path=/asert/
X-Pingback: http://www.arbornetworks.com/asert/xmlrpc.php
X-Powered-By: PHP/5.3.28
Connection: Close

<!doctype html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js gt-ie8" lang="en-US"><!--<![endif]-->
<head>
	<!-- character encoding utf-8 -->
	<meta charset="UTF-8">
	<!-- google chrome frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<!-- title -->
	<title>DDoS &amp; Security Reports  &raquo; Interesting Research</title>
	<!-- search engine robots meta instructions -->
			<meta name="robots" content="all">
		<!-- index search meta data -->
			<meta name="description" content="DDoS &amp; Security Reports Archives">
		<!-- Mobile viewport optimized: h5bp.com/viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<!-- Sets whether a web application runs in full-screen mode -->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<!-- pingback url -->
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://www.arbornetworks.com/asert/xmlrpc.php">
	<!-- RSS Feed -->
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://www.arbornetworks.com/asert/feed/">
	<!-- Modernizr -->
	<script src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/js/vendor/modernizr-2.6.2.min.js"></script>
	<!-- required for comment functionality -->
		<!-- required for all wordpress themes and placed at the end of the head tag element -->
	<link rel="alternate" type="application/rss+xml" title="DDoS &amp; Security Reports &raquo; Feed" href="http://www.arbornetworks.com/asert/feed/" />
<link rel="alternate" type="application/rss+xml" title="DDoS &amp; Security Reports &raquo; Comments Feed" href="http://www.arbornetworks.com/asert/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="DDoS &amp; Security Reports &raquo; Interesting Research Category Feed" href="http://www.arbornetworks.com/asert/category/interesting-research/feed/" />
<link rel='stylesheet' id='style-css'  href='http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/style.css?ver=1.0.6' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
<script type='text/javascript' src='http://www.arbornetworks.com/asert/wp-content/plugins/gigpress/scripts/gigpress.js?ver=3.8.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.arbornetworks.com/asert/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.arbornetworks.com/asert/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.8.2" />

<!-- Bad Behavior 2.2.15 run time: 6.069 ms -->
<script type="text/javascript">
<!--
function bb2_addLoadEvent(func) {
	var oldonload = window.onload;
	if (typeof window.onload != 'function') {
		window.onload = func;
	} else {
		window.onload = function() {
			oldonload();
			func();
		}
	}
}

bb2_addLoadEvent(function() {
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1406092668 50.17.27.205 50.17.27.205';
			document.forms[i].appendChild(myElement);
		}
	}
});
// --></script>
		<link href="http://www.arbornetworks.com/asert/?feed=gigpress" rel="alternate" type="application/rss+xml" title="Upcoming events" />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
	<script type='text/javascript'>
	(function (d, t) {
	  var bh = d.createElement(t), s = d.getElementsByTagName(t)[0];
	  bh.type = 'text/javascript';
	  bh.src = '//www.bugherd.com/sidebarv2.js?apikey=h946gx3b40epcrdhx6yn7w';
	  s.parentNode.insertBefore(bh, s);
	  })(document, 'script');
	</script>
</head>

<body class="archive category category-interesting-research category-19">
	<!--[if lt IE 7]>
		<p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
	<![endif]-->
	<div class="l-full">
		<header class="l-wrapper l-wrapper-banner clearfix" role="banner">
			<div class="l-column-left">
				<h1 class="brand">
																<a href="http://www.arbornetworks.com/asert" id="header-image"><img src="/asert/wp-content/uploads/2013/07/copy-logo1.png" height="45" width="153" alt="DDoS &amp; Security Reports"></a>
										<span class="description"><b class="description-title">DDoS &amp; Security Reports</b><b class="description-subtitle">The Arbor Networks IT Security Blog</b></span>
				</h1>
			</div>

			<div class="l-column-right">
				<nav class="menu-primary-container"><ul id="nav" class="menu-list"><li id="menu-item-5042" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5042"><a href="/asert/">Home</a></li>
<li id="menu-item-5610" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5610"><a href="http://www.arbornetworks.com/asert/map/">Attack Map</a></li>
<li id="menu-item-5043" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5043"><a href="http://www.arbornetworks.com/asert/archives/">Archives</a></li>
<li id="menu-item-5044" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5044"><a href="http://www.arbornetworks.com/asert/about/">About</a></li>
<li id="menu-item-5067" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5067"><a href="/asert/feed/">RSS</a></li>
</ul></nav>				<!-- <article><a href="http://www.arbornetworks.com/asert/feed/">RSS Feed</a></article> -->
								<form action="http://www.arbornetworks.com/asert" method="get" id="search-form" role="search">
	<label for="s" class="visuallyhidden">Search</label>
	<input type="search" value="" name="s" id="s" placeholder="Search">
	<button type="submit" id="searchsubmit">Submit</button>
</form>
			</div>
		</header>
	</div><div class="l-full l-full-content">
	<div class="l-wrapper l-wrapper-content clearfix">
		<div class="l-column-left">
			<section class="clearfix" id="content" role="main">
									<article class="post-6954 post type-post status-publish format-standard hentry category-botnets category-interesting-research category-malware category-p2p category-threat-analysis" id="post-6954">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2014/06/the-citadel-and-gameover-campaigns-of-5cb682c10440b2ebaf9f28c1fe438468/" rel="bookmark tag" title="The Citadel and Gameover Campaigns of 5CB682C10440B2EBAF9F28C1FE438468 blog post entry">The Citadel and Gameover Campaigns of 5CB682C10440B2EBAF9F28C1FE438468</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/dschwarz">Dennis Schwarz</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2014/06/the-citadel-and-gameover-campaigns-of-5cb682c10440b2ebaf9f28c1fe438468/">06/24/2014</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>As the infosec community waits for the researchers involved to present their Zeus Gameover <a href="http://www.justice.gov/opa/gameover-zeus.html">take down</a> spoils at the next big conference; ASERT wanted to profile a threat actor that uses both Citadel, “<a href="http://botnetlegalnotice.com/citadel/files/Brief_ms_supp_tro.pdf">a particularly sophisticated and destructive botnet</a>”, and Gameover, “<a href="http://www.justice.gov/opa/documents/dgzc/declaration.pdf">one of the most sophisticated computer viruses in operation today</a>”, to steal banking credentials.</p>
<p><b>Citadel Campaign</b></p>
<p>When a threat actor decides that they would like to start a Citadel campaign they: buy the builder software, build the malware, distribute it to the wild, and then, unfortunately, usually profit. A “login key” in Citadel parlance identifies a specific copy of the builder. This key is also copied into the generated binaries so a link between malware builder and malware is formed. Login keys are supposed to be unique, but due to builders being leaked to the public, some aren’t. For all intents and purposes though, malware researchers use login keys to distinguish between distinct Citadel campaigns.</p>
<p>On October 29, 2013, security researcher Xylitol <a href="https://twitter.com/Xylit0l/status/395269972710014976">tweeted</a> that login key 5CB682C10440B2EBAF9F28C1FE438468 was not associated with any of the defendants in Microsoft’s Citadel botnet <a href="http://botnetlegalnotice.com/citadel">lawsuit</a>:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/06/tweet.png"><img class="alignnone size-full wp-image-6955" alt="tweet" src="/asert/wp-content/uploads/2014/06/tweet-e1402423511212.png" width="295" height="113" /></a></p>
<p>ASERT has the following command and control (C2) URLs linked with that campaign. Most of these were hosted in the 46.30.41.0/24 netblock—owned by EuroByte:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="165"><b>MD5</b></td>
<td valign="top" width="221"><b>Command and Control URL</b></td>
</tr>
<tr>
<td valign="top" width="165">280ffd0653d150906a65cd513fcafc27</td>
<td valign="top" width="221">http://46.30.41.118/QHasdHJsadbnMQWe/file.php</td>
</tr>
<tr>
<td valign="top" width="165">02968192220a94996ac20ae78f8714a2</td>
<td valign="top" width="221">http://46.30.41.217/street/file.php</td>
</tr>
<tr>
<td valign="top" width="165">f1c8cc93d4e0aabd4713621fe271abc8</td>
<td valign="top" width="221">http://<span style="color: #0000ff;">46.30.41.23</span>/AshjkyuiHKJLuhjka/file.php</td>
</tr>
<tr>
<td valign="top" width="165">80ec7b373282bbaaca52851a46dfcf0b</td>
<td valign="top" width="221">http://46.30.41.51/WBHJSAKJghasjkdJHAGSDAu8/file.php</td>
</tr>
<tr>
<td valign="top" width="165">8c8c69ea9c84c68743368cc66c0962f3</td>
<td valign="top" width="221">http://46.30.41.98/werqfGADSHAJWe/file.php</td>
</tr>
<tr>
<td valign="top" width="165">8d484829fbbfff9aacf94f7d89949ee7</td>
<td valign="top" width="221">http://46.30.43.93/WhjyyuqwvbnqwjhERW/file.php</td>
</tr>
<tr>
<td valign="top" width="165">6646b55acb84ad05f57247e7aaa51b86</td>
<td valign="top" width="221">http://delprizmanet.com/hjkl123678qwe12lkj012/file.php</td>
</tr>
<tr>
<td valign="top" width="165">9c18247e6394f3d07ce9fcc43eb27a35</td>
<td valign="top" width="221">http://sdspropro.co.ua/1123asdASdqeqwoijlkj/file.php</td>
</tr>
<tr>
<td valign="top" width="165">6646b55acb84ad05f57247e7aaa51b86</td>
<td valign="top" width="221">http://sdspropro.co.ua/rrrguudness/file.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using archived copies of the campaign’s configuration files from <a href="http://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=1465&amp;p=21272#p21274">KernelMode.info</a> and <a href="https://zeustracker.abuse.ch/monitor.php?host=sdspropro.co.ua">ZeuS Tracker</a> it can be seen that the threat actor was using 28 webinjects to target 14 financial institutions in the Netherlands and Germany:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="443">set_url: *abnamro.nl/nl/ideal/identification.do*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *abnamro.nl/nl/logon/identification*html*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *accessonline.abnamro.com/fss/open/welcome.do*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *banking.berliner-bank.de/trxm/bb*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *banking.postbank.de/rai/login*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *icscards.nl/nlic/portal/ics/login*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *ideal.ing.nl/internetbankieren/SesamLoginServlet*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *ideal.snsreaal.nl/secure/sns/Pages/Payment*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *ideal.snsreaal.nl/secure/srb/Pages/Payment*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *meine.norisbank.de/trxm/noris*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *mijn*.ing.nl/internetbankieren/SesamLoginServlet*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *regiobank.nl/internetbankieren/homepage/secure/homepage/homepage.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *regiobank.nl/internetbankieren/secure/login.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *regiobank.nl/internetbankieren/secure/login.html*action_prepareStepTwo=Inloggen</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *regiobank.nl/internetbankieren/secure/logout/logoutConfirm.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/bankieren/secure/betalen/overschrijvenbinnenland.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/bankieren/secure/verzendlijst/verzendlijst.html*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/homepage/secure/homepage/homepage.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/secure/login.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/secure/login.html*action_prepareStepTwo=Inloggen</td>
</tr>
<tr>
<td valign="top" width="443">set_url: *snsbank.nl/mijnsns/secure/logout/logoutConfirm.html</td>
</tr>
<tr>
<td valign="top" width="443">set_url: http://www.rabobank.nl/bedrijven/uitgelogd/*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: http://www.rabobank.nl/particulieren/uitgelogd*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: https*abnamro.nl*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: https*de*portal/portal*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: https*paypal*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: https://bankieren.rabobank.nl/klanten*</td>
</tr>
<tr>
<td valign="top" width="443">set_url: https://betalen.rabobank.nl/ideal-betaling*</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>As an example and reference for later, here are a few snippets of one of the webinjects:</p>
<pre><a href="http://alkali.arbornetworks.com/asert/wp-content/uploads/2014/06/webinject1.png"><img class="alignnone size-full wp-image-6956" alt="webinject1" src="/asert/wp-content/uploads/2014/06/webinject1-e1402423848995.png" width="475" height="491" />

</a></pre>
<p>Per ZeuS Tracker and VirusTotal passive DNS data, it seems as if this particular campaign started fizzling out around the end of 2013.</p>
<p><b>Zeus Gameover Campaign</b></p>
<p>As noted by security researcher Brian Krebs, the “<a href="http://krebsonsecurity.com/2014/06/operation-tovar-targets-gameover-zeus-botnet-cryptolocker-scourge/">curators of Gameover also have reportedly loaned out sections of their botnet to vetted third-parties who have used them for a variety of purposes</a>.” Analyzing webinject data from the global configuration file that was being distributed on the peer-to-peer network shortly before its takedown on June 2, 2014; it looks as if the threat actor behind Citadel login key 5CB682C10440B2EBAF9F28C1FE438468 had joined the ranks of Gameover’s coveted third party. Checking historical versions of the config show that this collaboration goes back to at least January 2014.</p>
<p>In the analyzed configuration, there was 1324 total web injects targeting many financial institutions. 12 of these were associated with the profiled actor and will be focused on here.  First, the banking credentials extracted by this group of injects were being exfiltrated to IP address <span style="color: #0000ff;">46.30.41.23</span>. This IP had previously hosted a C2 panel of the above Citadel campaign. Second, there were eight financial institutions targeted; seven of which were a subset of the previous campaign:<span style="line-height: 1.5em;"> </span></p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="443">match: ^https.*?de.*?portal/portal.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?regiobank.nl/internetbankieren/secure/login.html</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?regiobank.nl/internetbankieren/homepage/secure/homepage/homepage.html</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?bankieren.rabobank.nl/klanten.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?meine.deutsche-bank.de/trxm/db.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?meine.norisbank.de/trxm/noris.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?banking.berliner-bank.de/trxm/bb.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?banking.postbank.de/rai/login.*?</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?snsbank.nl/mijnsns/secure/login.html</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?snsbank.nl/mijnsns/homepage/secure/homepage/homepage.html</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?snsbank.nl/mijnsns/bankieren/secure/betalen/overschrijvenbinnenland.html</td>
</tr>
<tr>
<td valign="top" width="443">match: ^https://.*?snsbank.nl/mijnsns/bankieren/secure/verzendlijst/verzendlijst.html.*?</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Finally, the coding style, function/variable naming, and formatting of the webinjects themselves were akin to the above and looked to have been retrofitted from Citadel to work with Gameover:</p>
<p><a href="http://alkali.arbornetworks.com/asert/wp-content/uploads/2014/06/webinject2.png"><img class="alignnone size-full wp-image-6957" alt="webinject2" src="/asert/wp-content/uploads/2014/06/webinject2-e1402424135905.png" width="473" height="271" /></a></p>
<p>The drop site itself is a Ruby on Rails application that logs and displays the data sent from infected hosts:</p>
<p><a href="http://alkali.arbornetworks.com/asert/wp-content/uploads/2014/06/bots.png"><img class="alignnone size-full wp-image-6958" alt="bots" src="/asert/wp-content/uploads/2014/06/bots-e1402424325152.png" width="759" height="428" /></a></p>
<p>&nbsp;</p>
<p>Each entry can be formatted a bit better by clicking “Show”:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/06/bot_detail.png"><img class="alignnone size-full wp-image-6959" alt="bot_detail" src="/asert/wp-content/uploads/2014/06/bot_detail-e1402424437609.png" width="740" height="687" /></a></p>
<p>Some of the logging text seen in these screenshots—for example: “Wait tan from holder”—can be correlated back to the earlier snippets of the webinjects.</p>
<p>The initial entries in the list are dated from around March and June of 2012, but these entries may be old or in error as there is a jump to December 2013 and then consistent logging from there. At the time of this writing there were approximately 1089 entries.</p>
<p>In addition, up to five Jabber IDs can be configured in the application and then messaged on receipt of freshly stolen credentials:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/06/jabber.png"><img class="alignnone size-full wp-image-6960" alt="jabber" src="/asert/wp-content/uploads/2014/06/jabber-e1402424529913.png" width="653" height="188" /></a></p>
<p>At the time of writing, the configured Jabber IDs were:</p>
<ul>
<li>bro2@jabbim.cz</li>
<li>airhan@jabbim.cz</li>
<li>fapache@jabber.me</li>
</ul>
<p>But, there wasn’t much open source intelligence on these.</p>
<p><b>Conclusion</b></p>
<p>Pondering on the data available…this threat actor ran a fairly targeted Citadel campaign focusing on a small set of banks in the Netherlands and Germany. Based on ZeuS Tracker data, most of the Citadel C2s became active after the start of Microsoft’s lawsuit on June 5, 2013, so this likely explains the exclusion of 5CB682C10440B2EBAF9F28C1FE438468 from the legal notices.</p>
<p>The Citadel campaign looks like it closed up shop at the end of 2013. In December 2013, logging on the out-of-band Gameover drop site started in earnest, so this might be when the threat actor moved to stealing banking credentials via Gameover.</p>
<p>So far, it seems as if this threat actor has escaped the clutches of the great Citadel take-down and, since the drop site is still receiving stolen credentials, has evaded the Zeus Gameover take-down as well. In the spirit of &#8220;see something, say something&#8221; and with the recency of the legal action, ASERT has provided the data available to our law enforcement contacts.</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2014/06/the-citadel-and-gameover-campaigns-of-5cb682c10440b2ebaf9f28c1fe438468/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/p2p/" title="View all posts in P2P" rel="category tag">P2P</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/threat-analysis/" title="View all posts in threat analysis" rel="category tag">threat analysis</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-6901 post type-post status-publish format-standard hentry category-backdoors category-botnets category-encryption category-interesting-research category-malware category-phishing category-reverse-engineering category-threat-analysis category-uncategorized" id="post-6901">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/" rel="bookmark tag" title="Illuminating The Etumbot APT Backdoor blog post entry">Illuminating The Etumbot APT Backdoor</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/arbor-networks">Arbor Networks</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/">06/06/2014</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p align="left">The Arbor Security Engineering Response Team (ASERT) has released a research paper concerning the Etumbot malware.</p>
<p align="left"><span style="line-height: 1.5em;">Etumbot is a backdoor used in targeted attacks since at least March 2011. Indicators suggest that Etumbot is associated with the Numbered Panda group, also known as IXEHSE, DynCalc, and APT12.  </span><span style="line-height: 1.5em;">Although previous research has covered related malware, little has been publicly discussed regarding Etumbot’s capabilities. </span></p>
<p align="left">Indicators suggest that the Etumbot dropper is delivered via spear phishing and is contained inside an archive file intended to be of interest to the target. The attackers use the Unicode Right to Left Override technique and document icons to disguise malicious executable content as document files. Once the dropper is executed, the backdoor is activated and a distraction file of interest to the target is opened for viewing.  <span style="line-height: 1.5em;">ASERT has observed several Etumbot samples using distraction documents involving Taiwanese and Japanese topics of interest, and has also observed recent development activity which indicates that attack campaigns are ongoing.</span></p>
<p align="left">Once installed, the backdoor connects to it&#8217;s Command &amp; Control server and receives an encryption key. RC4 encryption, along with HTTP transactions intended to blend in with typical traffic are used for backdoor communications. Etumbot&#8217;s core functionality allows for the execution of commands and the capability to upload and download files.</p>
<p align="left">Attackers attempt to obfuscate the malware by using a technique known as &#8220;byte strings&#8221;, also known as &#8220;string stacking&#8221;. Through the use of ASERT tools, these byte strings are deobfuscated and revealed herein.</p>
<p align="left">A timeline containing distraction documents along with backdoor and dropper indicators to include MD5 hashes, Command &amp; Control server information, file system and process artifacts are included herein. Some use of the HTran connection bouncer has been observed, indicating that selected C&amp;C&#8217;s were simply compromised sites used to relay traffic elsewhere.</p>
<p align="left"><span style="line-height: 1.5em;">It is our aim to assist incident response and security teams and to provide meaningful insight into this threat.</span></p>
<h1 align="left">Download the full report: <a href="/asert/wp-content/uploads/2014/06/ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-Etumbot-APT.pdf">ASERT Threat Intelligence Brief 2014-07: Illuminating the Etumbot APT Backdoor</a></h1>
<h1 align="left"></h1>
<p align="left">
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/malware/backdoors/" title="View all posts in Backdoors" rel="category tag">Backdoors</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/encryption/" title="View all posts in Encryption" rel="category tag">Encryption</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/phishing/" title="View all posts in Phishing" rel="category tag">Phishing</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/reverse-engineering/" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/threat-analysis/" title="View all posts in threat analysis" rel="category tag">threat analysis</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-6817 post type-post status-publish format-standard hentry category-ddos-attacks category-backdoors category-botnets category-forensics category-interesting-research category-kill-chain category-malware category-threat-analysis category-trojan-horses category-viruses category-vulnerabilities tag-alina tag-blackpos tag-bruteforce tag-chewbacca tag-jackpos tag-point-of-sale tag-pos tag-poscardstealer tag-retail tag-tor tag-vnc tag-vskimmer" id="post-6817">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2014/05/into-the-light-of-day-uncovering-ongoing-and-historical-point-of-sale-malware-and-attack-campaigns/" rel="bookmark tag" title="Into the Light of Day: Uncovering Ongoing and Historical Point of Sale Malware and Attack Campaigns blog post entry">Into the Light of Day: Uncovering Ongoing and Historical Point of Sale Malware and Attack Campaigns</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/cwilson">cwilson</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2014/05/into-the-light-of-day-uncovering-ongoing-and-historical-point-of-sale-malware-and-attack-campaigns/">05/12/2014</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p><span style="font-size: 14px; line-height: 1.5em;">Point of Sale systems that process debit and credit cards are still being attacked with an increasing variety of malware. Over the last several years PoS attack campaigns have evolved from opportunistic attacks involving crude theft of card data with no centralized Command &amp; Control, through memory scraping PoS botnets with centralized C&amp;C and most recently to highly targeted attacks that require a substantial amount of lateral movement and custom malware created to blend in with the target organization.</span></p>
<p align="left">While contemporary PoS attackers are still successful in using older tools and methodologies that continue to bring results due to poor security, the more ambitious threat actors have moved rapidly, penetrating organizational defenses with targeted attack campaigns. Considering the substantial compromise lifespans within organizations that have active security teams and managed infrastructure, indicators shared herein will be useful to detect active as well as historical compromise.</p>
<p align="left">Organizations of all sizes are encouraged to seriously consider a significant security review of any PoS deployment infrastructure to detect existing compromises as well as to strengthen defenses against an adversary that continues to proliferate and expand attack capabilities.</p>
<p><span style="font-size: 14px; line-height: 1.5em;">In addition to recent publications discussing Dexter and Project Hook malware activity, Arbor ASERT is currently tracking other PoS malware to include Alina, Chewbacca, Vskimmer, JackPoS and other less popular malware such as variants of POSCardStealer and others. Attack tactics shall also be explored through analysis of an attackers toolkit.</span></p>
<p><span style="line-height: 1.5em;">The longevity and extent of attack campaigns is a serious concern. In organizations with security teams and well managed network infrastructure, point of sale compromises have proliferated for months prior to detection. If attackers are able to launch long-running campaigns in such enterprise retail environments, one can conclude that many other organizations with less mature network and infrastructure management are also at serious risk. A sample of high-profile incident timelines, showing the date of the initial compromise, compromise timespan and compromise scope (number stores in this context) is included to highlight this point.</span></p>
<h1>Download the full report: <a href="http://pages.arbornetworks.com/rs/arbor/images/Uncovering_PoS_Malware.pdf" target="_blank">ASERT Threat Intelligence Brief 2014-06 Uncovering PoS Malware and Attack Campaigns</a><a href="http://alkali.arbornetworks.com/asert/wp-content/uploads/2014/05/ASERT-Threat-Intelligence-Brief-2014-6-Uncovering-PoS.pdf"><br />
</a></h1>
<p>ASERT Threat Intelligence would like to thank fellow ASERT team members Dave Loftus, Alison Goodrich, Kirk Soluk and Matt Bing and also wishes to thank David Dunn of FIS Global and the Shadowserver Foundation for providing additional information.</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2014/05/into-the-light-of-day-uncovering-ongoing-and-historical-point-of-sale-malware-and-attack-campaigns/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li><li><a href="http://www.arbornetworks.com/asert/tag/alina/" rel="tag">Alina</a>, <a href="http://www.arbornetworks.com/asert/tag/blackpos/" rel="tag">BlackPoS</a>, <a href="http://www.arbornetworks.com/asert/tag/bruteforce/" rel="tag">bruteforce</a>, <a href="http://www.arbornetworks.com/asert/tag/chewbacca/" rel="tag">Chewbacca</a>, <a href="http://www.arbornetworks.com/asert/tag/jackpos/" rel="tag">JackPOS</a>, <a href="http://www.arbornetworks.com/asert/tag/point-of-sale/" rel="tag">Point of Sale</a>, <a href="http://www.arbornetworks.com/asert/tag/pos/" rel="tag">POS</a>, <a href="http://www.arbornetworks.com/asert/tag/poscardstealer/" rel="tag">PoSCardStealer</a>, <a href="http://www.arbornetworks.com/asert/tag/retail/" rel="tag">retail</a>, <a href="http://www.arbornetworks.com/asert/tag/tor/" rel="tag">tor</a>, <a href="http://www.arbornetworks.com/asert/tag/vnc/" rel="tag">VNC</a>, <a href="http://www.arbornetworks.com/asert/tag/vskimmer/" rel="tag">vSkimmer</a></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/backdoors/" title="View all posts in Backdoors" rel="category tag">Backdoors</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/forensics/" title="View all posts in Forensics" rel="category tag">Forensics</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/kill-chain/" title="View all posts in kill chain" rel="category tag">kill chain</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/threat-analysis/" title="View all posts in threat analysis" rel="category tag">threat analysis</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/trojan-horses/" title="View all posts in Trojan Horses" rel="category tag">Trojan Horses</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/viruses/" title="View all posts in Viruses" rel="category tag">Viruses</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/vulnerabilities/" title="View all posts in Vulnerabilities" rel="category tag">Vulnerabilities</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-6725 post type-post status-publish format-standard hentry category-analysis category-ddos-attacks category-botnets category-interesting-research category-malware category-reverse-engineering" id="post-6725">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2014/04/trojan-eclipse-a-bad-moon-rising/" rel="bookmark tag" title="Trojan.Eclipse &#8212; A Bad Moon Rising? blog post entry">Trojan.Eclipse &#8212; A Bad Moon Rising?</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/dschwarz">Dennis Schwarz</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2014/04/trojan-eclipse-a-bad-moon-rising/">04/22/2014</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>ASERT’s malware collection and processing system has automatic heuristics that bubble up potentially new and interesting DDoS malware samples into a “for human analysis” queue. A recent member of this queue was Trojan.Eclipse and this post is my analysis of the malware and its associated campaigns.</p>
<p>Analysis was performed on the sample with an MD5 of 0cdd10cd3393d3fe916a55b946c10ad6.</p>
<p>The name Eclipse comes from two places: a mutex named “eclipseddos” and a hardcoded Cookie value used in the command and control (C2) phone home. We’ll see in the Campaign section below that this threat is also known as: shadowbot, gbot3, eclipsebot, Rhubot, and Trojan-Spy.Win32.Zbot.qgxi.</p>
<p>Based on the C2 domain names, GeoIP of the C2 IP addresses, and a social media profile of the owner of one of the C2 domains, I suspect this malware to be Russian in origin. In addition, Eclipse is written in Delphi and empirically Russian malware coders have a certain fondness for this language.</p>
<p><b>Command and Control</b></p>
<p>The analyzed binary has a hardcoded C2 domain string. This string is protected from modification by running it through a simple hashing algorithm and comparing it against a hardcoded hash at certain points of the code. The following Python function replicates this algorithm:</p>
<pre><span style="color: #888888;"> def decrypt(string):
</span><span style="color: #888888;">    table1 = "qwertyuiopasdfghjklzxcvbnm.1234567890"
</span><span style="color: #888888;">    table2 = "asdfghjklqwertyuiopnbmcvxzeasdfghjklv" 
</span><span style="color: #888888;">    out = ""</span></pre>
<pre><span style="color: #888888;">    for orig_char in string:
</span><span style="color: #888888;">        index = table1.find(orig_char)
</span><span style="color: #888888;">        if index == -1:
</span><span style="color: #888888;">            char = orig_char
</span><span style="color: #888888;">        else:
</span><span style="color: #888888;">            char = table2[index]
</span><span style="color: #888888;">        while char in table1[index:]:
</span><span style="color: #888888;">            index = table1.find(char)
</span><span style="color: #888888;">            char = table2[index]
</span><span style="color: #888888;">        out += char

</span><span style="color: #888888;">    print out</span></pre>
<p>For example, the domain “milfsdeasing.com” hashes to “zopterrweoxyezpz.”</p>
<p>An example phone home request looks like this:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/03/phonehome.png"><img class="alignnone size-full wp-image-6728" alt="phonehome" src="/asert/wp-content/uploads/2014/03/phonehome-e1395670775555.png" width="500" height="381" /></a></p>
<p>It is a HTTP GET based C2 protocol where the query string breaks down into the following parameters:</p>
<ul>
<li>bot – 15 random lowercase letters and digits</li>
<li>botkey – possibly a hardcoded campaign key</li>
<li>os – OS name</li>
<li>ram – amount of RAM</li>
<li>user – username</li>
<li>cpu – estimated CPU speed</li>
<li>number of CPUs</li>
</ul>
<p>After the Host line, the remaining headers are static—note the aforementioned Cookie value. An example phone home response looks like this:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/03/response.png"><img class="alignnone size-full wp-image-6729" alt="response" src="/asert/wp-content/uploads/2014/03/response-e1395670855782.png" width="500" height="381" /></a></p>
<p>The returned content is a single &lt;base&gt; tag containing base64-encoded data. Once decoded, an XML-like configuration file emerges (newlines added for clarity):</p>
<pre>&lt;cmd&gt;stop;&lt;/cmd&gt;&lt;tcp&gt;GET /index.php HTTP 1.1
Host: $RANDOM$.net
User-agent: $RANDOM$
&lt;/tcp&gt;&lt;cnfg&gt;control-timeout=1;
control-path=/par/;
control-domain=milfsdeasing.com;
stream-timeout=10;&lt;/cnfg&gt;</pre>
<p>Another example:</p>
<pre>&lt;cmd&gt;type=slow-post; threads=10; timeout=1;
 target=www.victim.com; script=/contact-us.php;
port=80;&lt;/cmd&gt;&lt;tcp&gt;GET /index.php HTTP 1.1
Host: $RANDOM$.net
User-agent: $RANDOM$
&lt;/tcp&gt;&lt;cnfg&gt;control-timeout=1;
control-path=/par/;
control-domain=milfsdeasing.com;
stream-timeout=10;&lt;/cnfg&gt;</pre>
<p>Relatively speaking, for a DDoS bot, Eclipse has a fairly rich configuration mechanism. Starting with the &lt;cnfg&gt; tag, it has four possible options:</p>
<ul>
<li>control-timeout – set C2 poll time</li>
<li>control-path – set C2 pathname</li>
<li>control-domain – set C2 domain</li>
<li>stream-timeout – minimum wait time between attack packets, in milliseconds</li>
</ul>
<p>The &lt;cmd&gt; tag can contain multiple commands delimited by a “\r\n”, and each command has three possible formats: standalone command, command requiring parameters, and a shortcut command. An example of the first format is:</p>
<pre>&lt;cmd&gt;stop;&lt;/cmd&gt;</pre>
<p>Identified commands in this category are:</p>
<ul>
<li>stop – stop attacks</li>
<li>wait – sleep for one day</li>
<li>die – exit process</li>
</ul>
<p>An example of the second format:</p>
<pre>&lt;cmd&gt;type=slow-post; threads=10; timeout=1; target=www.victim.com; script=/contact-us.php; port=80;&lt;/cmd&gt;</pre>
<p>There are a bunch of types, here are the ones identified:</p>
<ul>
<li>update – update self</li>
<li>execute – download and execute</li>
<li>tcpint – custom TCP flood</li>
<li>browser – HTTP GET flood, look like a web browser</li>
<li>dirtjumper – HTTP GET flood</li>
<li>sincere – TCP flood</li>
<li>http – HTTP GET/POST flood</li>
<li>httpspoof – HTTP GET flood with spoofed X-Forwarded-For header</li>
<li>slowloris – broken Slowloris attempt</li>
<li>tcp – TCP flood</li>
<li>udp – UDP flood</li>
<li>http-data – HTTP POST flood</li>
<li>slow-post – broken slow HTTP POST flood</li>
<li>connect – TCP connect flood</li>
<li>tcp-oneconnect – TCP flood</li>
<li>icmp – broken ICMP echo request flood</li>
<li>http-post – referenced in the code, but not implemented</li>
</ul>
<p>Command parameters depend on the type and include:</p>
<ul>
<li>threads – number of attack threads, defaults to 30</li>
<li>timeout – wait time between attack packets, in milliseconds</li>
<li>target – target host</li>
<li>script – URI path and file</li>
<li>port – target port, defaults to 80</li>
<li>connint – unknown, defaults to 1</li>
<li>dataint – unknown, defaults to 1</li>
<li>data – referenced, but unused</li>
<li>template – template attacks</li>
</ul>
<p>Two interesting features here. First, the script parameter can contain variables: $RANDOM$ is replaced with 15 random lowercase letters and digits and $INTEGER$ is replaced with a random integer between 0 and 998.</p>
<p>Second, the template option configures various attacks based on hardcoded templates. They include:</p>
<ul>
<li>nginx – slowloris attack, 30 threads, 10 ms timeout</li>
<li>ssh – tcp attack, 45 threads, 10 ms timeout, destination port 22</li>
<li>ftp – tcp attack, 45 threads, 10 ms timeout, destination port 21</li>
<li>https – tcp attack, 70 threads, 10 ms timeout, destination port 443</li>
<li>dns – udp attack, 10 threads, 10 ms timeout, destination port 53</li>
</ul>
<p>Finally, the shortcut command format looks like this:</p>
<pre>&lt;cmd&gt;#http://www.shortcut-victim.com#&lt;/cmd&gt;</pre>
<p>This launches an http attack with 100 threads and a timeout of 10 ms.</p>
<p>The &lt;tcp&gt; tag is used in conjunction with the tcpint command and defines a custom TCP flood payload template. The template supports $RANDOM$ variables which are replaced with 15 random lowercase letters and digits.</p>
<p><b>Campaigns</b></p>
<p>Campaign-wise, Eclipse can be broken down into roughly four groups: shadowbot, gbot3, eclipsebot, and eclipseddos. The malware implementation used in each campaign varies a bit from what was describe above, but I feel that they’re earlier development versions and warrant being categorized under the same family name.</p>
<p><i>shadowbot Campaign</i></p>
<p><i></i>The shadowbot campaign was active from July 21, 2013 to August 10, 2013 (using VirusTotal’s first submission timestamp). Its name comes from the use of the shadowbot mutex. Other notable differences include:</p>
<ul>
<li>Use of a shortened query string, “index.php?bot=”, in the C2 phone home</li>
<li>Missing Referer and Cookie headers in the C2 phone home</li>
<li>Does not use the &lt;base&gt; tag or base64 encoding</li>
<li>The &lt;cmd&gt; tag is much simpler and is delimited by “#”s</li>
<li>Does not use &lt;cnfg&gt; or &lt;tcp&gt; tags</li>
<li>Uses !random instead of $RANDOM$ variables</li>
<li>Smaller command set: connect, slow-post, http-data, cs, udp, tcp, and http</li>
</ul>
<p>Some sample MD5s and C2 URLs:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="221">4c76ed5155b2ee388bd770941a3c0473</td>
<td valign="top" width="221">http://aktualisieren-soft.ru/blizzer-kidala/index.php</td>
</tr>
<tr>
<td valign="top" width="221">0af74a0029b248b7c4b5129a1a0e5e3b</td>
<td valign="top" width="221">http://teleon2.ru/paranoik/index.php</td>
</tr>
<tr>
<td valign="top" width="221">2596d7b324599240c723429a01ad7310</td>
<td valign="top" width="221">http://teleon2.ru/paranoik/index.php</td>
</tr>
<tr>
<td valign="top" width="221">dd384ead636a7bd9bf7aa870ae712963</td>
<td valign="top" width="221">http://teleon2.ru/new/index.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The last entry in this table is the sample that Microsoft documented at <a href="http://www.microsoft.com/security/portal/threat/encyclopedia/Entry.aspx?Name=Trojan%3AWin32%2FRhubot.A" target="_blank">http://www.microsoft.com/security/portal/threat/encyclopedia/Entry.aspx?Name=Trojan%3AWin32%2FRhubot.A</a>. They have named the malware “Win32/Rhubot.A”, but to be honest I couldn’t figure out why or find any good source material on “Rhubot”.</p>
<p><i>gbot3 Campaign</i></p>
<p>Next is the gbot3 campaign, which was active from August 9, 2013 to January 1, 2014 VirusTotal time. Its name also comes from the mutex that it sets. The distinguishing features of this version are:</p>
<ul>
<li>As with shadowbot, uses shortened C2 phone home query string, “index.php?bot=”</li>
<li>Does not use base64 encoding, but does contain &lt;cmd&gt;, &lt;cnfg&gt;, and &lt;tcp&gt; tags</li>
<li>&lt;cmd&gt; is space delimited and still fairly basic</li>
<li>Implements “#” shortcut command</li>
<li>Implements tcpint command with &lt;tcp&gt; template. The template supports !randomchar, !random-ug, !random-lang, !random-encoding, !random-ac, !random-accept variables instead of $RANDOM$</li>
<li>Supports !random instead of $RANDOM$ in URI</li>
<li>Command set includes the more novel tcpint, browser, dirtjumper, slow-post, and tcp-oneconnect commands</li>
</ul>
<p>Some sample MD5s and C2 URLs:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="221">08f89357dc85b9155600a45e2a7a8e7b</td>
<td valign="top" width="221">http://91.226.127.175/test1/index.php</td>
</tr>
<tr>
<td valign="top" width="221">1720907230f0d4e4b6cda96dd52322dc</td>
<td valign="top" width="221">http://91.226.127.175/test1/index.php</td>
</tr>
<tr>
<td valign="top" width="221">ad8ac73540708d5cd6738a5d5f23a1d5</td>
<td valign="top" width="221">http://tryboots.ru/asdfgh/index.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The last entry in this table is the sample referenced in SourceFire VRT’s “MALWARE-CNC Win.Trojan.Rhubot variant outbound connection” rule.</p>
<p><i>eclipsebot campaign</i></p>
<p>Third is the eclipsebot campaign, which was active from September 12, 2013 to November 4, 2013. Naming is based on the mutex. Sans some minor changes, this version is very similar to the eclipseddos analyzed in the beginning of the post. Notable features are:</p>
<ul>
<li>Introduction of C2 domain hash check</li>
<li>Still uses shortened C2 query string, “index.php?bot=”</li>
<li>Introduction of rich &lt;cmd&gt; configuration via type, threads, timeout, target, script, etc. options</li>
<li>Has support for attack templates</li>
<li>Uses $RANDOM$ and $INTEGER$ variables</li>
</ul>
<p>Some sample MD5s and C2 URLs:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="221">ab6d483b2d6adf510e07395ceea5b980</td>
<td valign="top" width="221">http://blog32.ru/wp-admin/dark/index.php</td>
</tr>
<tr>
<td valign="top" width="221">b4e55f09ba681c10c20c50453c85652f</td>
<td valign="top" width="221">http://blog32.ru/wp-admin/dark/index.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><i>eclipseddos campaign</i></p>
<p>The eclipseddos campaign has been active since November 28, 2013 VirusTotal time.</p>
<p>Some sample MD5s and C2 URLs:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="221">c6cdd4876771f18efade928c50cf81fa</td>
<td valign="top" width="221">http://milfsdeasing.com/par/index.php</td>
</tr>
<tr>
<td valign="top" width="221">548fbf4dde27e725c0a1544f61362b50</td>
<td valign="top" width="221">http://vsehnahuy.com/huy/index.php</td>
</tr>
<tr>
<td valign="top" width="221">0b450a92f29181065bc6601333f01b07</td>
<td valign="top" width="221">http:// test.crack-zone.ru/index.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The last two samples in the above table are referenced in the Emerging Threats rule called “ETPRO TROJAN Trojan-Spy.Win32.Zbot.qgxi Checkin”. As with Microsoft’s AV detection, I couldn’t find any source material on why they decided to name it this way.</p>
<p><b>The Trojan.BlackRev Connection</b></p>
<p>Back in May 2013, I released a blog post titled “<a href="http://www.arbornetworks.com/asert/2013/05/the-revolution-will-be-written-in-delphi/" target="_blank">The Revolution Will Be Written in Delphi</a>” that profiled a DDoS bot named Trojan.BlackRev. Since that post, there have been a few updates that provide for a preamble to a possible relationship between Eclipse and BlackRev. On June 5, 2013 the author of BlackRev, going by the handle “silence”, posted to an underground forum saying that he had sold the project:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/03/blackrev_sold.png"><img class="alignnone size-full wp-image-6731" alt="blackrev_sold" src="/asert/wp-content/uploads/2014/03/blackrev_sold-e1395671292621.png" width="500" height="135" /></a></p>
<p>A few months later on October 4, 2013 on another underground forum, somebody going by the handle “chef” leaked the BlackRev source code:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/03/leak.png"><img class="alignnone size-full wp-image-6732" alt="leak" src="/asert/wp-content/uploads/2014/03/leak-e1395671329949.png" width="500" height="196" /></a></p>
<p>While tracing one of the Eclipse C2 URLs from the shadowbox campaign:</p>
<p><em>http://aktualisieren-soft.ru/<span style="color: #ff0000;">blizzer</span>-kidala/index.php</em></p>
<p>I came across a C2 URL with a similar URI pathname:</p>
<p><em>http://aktualisieren-soft.ru/<span style="color: #ff0000;">blizzer</span>/panel/gate.php</em></p>
<p>The complete C2 protocol looks like this:</p>
<p><a href="http://arbornetworks.com/asert/wp-content/uploads/2014/03/blackrev-eclipse-c2.png"><img class="alignnone size-full wp-image-6733" alt="blackrev-eclipse-c2" src="/asert/wp-content/uploads/2014/03/blackrev-eclipse-c2-e1395671396380.png" width="500" height="381" /></a></p>
<p>This traffic came from a binary with an MD5 of 8da35de6083aa9aa3859ce65e0e816df and I believe this sample to be a “missing link” between the BlackRev and Eclipse code bases.</p>
<p>In addition to the timeline proximity and the feeling of “code sameness” while reversing engineering, some of the major pieces linking this variant to BlackRev are:</p>
<ul>
<li>The query string used in the phone home</li>
<li>Comparison against the “|stop|” string</li>
<li>Bot command is pipe “|” delimited</li>
<li>Launches the same “bot killer” code in a thread</li>
<li>Launches the same “memory reduction” code in a thread</li>
<li>Uses a similar random character generator</li>
<li>HTTP header overlap in some of the attacks</li>
<li>Names a command “antiddos”, which is fairly novel</li>
</ul>
<p>The major pieces linking it to Eclipse (shadowbot specifically) are:</p>
<ul>
<li>Shared C2 infrastructure</li>
<li>HTTP header overlap in the C2 phone home</li>
<li>Use of XML-like tags in the phone home response</li>
<li>Names a command “nginx”, which is a fairly novel</li>
<li>Eclipse variants also contain the same bot killer, memory reduction, and similar random character generation code</li>
<li>Name overlap in some of the attacks</li>
<li>HTTP header overlap in some of the attacks</li>
</ul>
<p>With silence’s claim of selling the project and the leak of the source code to the public, it is unclear how or if the threat actors behind the Eclipse and BlackRev campaigns are related. I do feel strongly though that Eclipse is a descendant of the BlackRev code base.</p>
<p><b>Conclusion</b></p>
<p>This post has been an analysis of the Trojan.Eclipse family of DDoS bots. This malware is interesting because it has a fairly rich configuration mechanism, some novel attack types, and a nice development trail leading back to the either the Trojan.BlackRev code leak or sale of the project by the author.</p>
<p>ASERT is just ramping up attack monitoring of this family. So far we’ve seen a handful of attacks on a consumer complaint website, a venture capital company, a forum for a Russian town, and a rating site for Russian apartment repairs. Monitoring of the attacks and family continue.</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2014/04/trojan-eclipse-a-bad-moon-rising/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/analysis/" title="View all posts in analysis" rel="category tag">analysis</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/reverse-engineering/" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-6777 post type-post status-publish format-standard hentry category-analysis category-ddos-attacks category-critical-infrastructure category-exploit-code category-interesting-research category-internet-traffic-and-trends category-other category-secure-coding category-software-development category-ssl category-vulnerabilities tag-heartbleed tag-openssl" id="post-6777">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2014/04/heartbleed/" rel="bookmark tag" title="The Heartburn Over Heartbleed: OpenSSL Memory Leak Burns Slowly blog post entry">The Heartburn Over Heartbleed: OpenSSL Memory Leak Burns Slowly</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/arbor-networks">Arbor Networks</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2014/04/heartbleed/">04/14/2014</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>Marc Eisenbarth, Alison Goodrich, Roland Dobbins, Curt Wilson</p>
<p><strong>Background</strong><br />
A very serious vulnerability present in OpenSSL 1.0.1 for two years has been disclosed (CVE-2014-0160). This &#8220;Heartbleed&#8221; vulnerability allows an attacker to reveal up to 64kb of memory to a connected client or server. This buffer-over-read vulnerability can be used in rapid succession to exfiltration larger sections of memory, potentially exposing private keys, usernames and passwords, cookies, session tokens, email, or any other data that resides in the affected memory region. This flaw does not affect versions of OpenSSL prior to 1.0.1.  This is an extremely serious situation, which highlights the manual nature of the tasks required to secure critical Internet services such as basic encryption and privacy protection.</p>
<p>As the vulnerability has been present for over two years, many modern operating systems and applications have deployed vulnerable versions of <a href="https://www.openssl.org" target="_blank">OpenSSL</a>. OpenSSL is the default cryptographic library for Apache and nginx Web server applications, which together account for an estimated two-thirds of all Web servers. OpenSSL is also used in a variety of operating systems, including BSD variants such as FreeBSD, and Linux distributions such as Ubuntu, CENTOS, Fedora and more. Other networking gear such as load-balancers, reverse proxies, VPN concentrators, and various types of embedded devices are also potentially vulnerable if they rely on OpenSSL, which many do. Additionally, since the vulnerability&#8217;s disclosure, several high-profile sites such as Yahoo Mail, Lastpass, and the main FBI site have reportedly leaked information. Others have discussed the impact on underground economy crime forums, which were reportedly vulnerable to the matter and were attacked.</p>
<p>A key lesson is that OpenSSL, which is a vital component of the confidentiality and integrity of uncounted systems, applications and sites across the Internet, is an underfunded, volunteer-run project, which is desperately in need of major sponsorship and attendant allocation of resources.</p>
<p><strong>Mitigation</strong><br />
Anyone running OpenSSL on a server should upgrade to version 1.0.1g. For earlier versions, re-compiling with the OPENSSL_NO_HEARTBEATS flag enabled will mitigate this vulnerability. For OpenSSL 1.0.2, the vulnerability will be fixed in 1.0.2-beta2. In terms of remediation, there&#8217;s a huge amount of work that must be done, not only for servers, but also for load-balancers, reverse proxies, VPN concentrators, various types of embedded devices, etc.  Applications which were statically compiled against vulnerable versions of the underlying OpenSSL libraries must be re-complied; private keys must be invalidated, re-generated, and re-issued; certificates must be invalidated, re-generated, and re-issued &#8211; and there are a whole host of problems and operational challenges associated with these vital procedures. Some systems may be difficult to patch, so network access control restrictions or the deployment of non-vulnerable proxies may be considered where possible to reduce the attack surface.</p>
<p><strong>Exploitation</strong><br />
In most cases, exploitation of this vulnerability leaves no sign in server logs, making it difficult for organizations to know if they have been compromised. In addition, even after applying the OpenSSL patch, private keys, passwords, authentication credentials or any other data that was stored in heap memory used by OpenSSL may have already been compromised by attackers, potentially going as far back as two years. Of significant concern is the compromise of private key material, and one security organization reported that they were able to obtain this material during testing. Others reported difficulty in obtaining certificate material but were able to discover significant amounts of other sensitive data. Considering how easy it is for attackers to hammer this vulnerability over and over again in a very quick sequence, the amount of memory being disclosed can be quite substantial. Memory contents will vary depending on program state and controlling what is returned and what position in memory the contents are read from is much like a game of roulette.</p>
<p><strong>Risk to Private Key Material</strong><br />
Security researchers in a Twitter exchange starting on April 8 2014 indicate that private keys have been extracted in testing scenarios, and other researchers suggest that attacking the servers during or just after log rotation and restart scripts run could expose private key material. This allegation has not been tested by ASERT.</p>
<p>For further details, please see the Twitter thread at<a href=" https://twitter.com/1njected/status/453781230593769472"> https://twitter.com/1njected/status/453781230593769472</a></p>
<p><a href="/asert/wp-content/uploads/2014/04/image002.png"><img class="alignnone size-full wp-image-6796" alt="image002" src="/asert/wp-content/uploads/2014/04/image002.png" width="434" height="346" /></a></p>
<p><strong>Incident Response and Attack Tools</strong><br />
While there has been some call to avoid over-reaction, organizations should strongly consider revoking and reissue certificates and private keys; otherwise, attackers can continue to use private keys they may have obtained to impersonate Websites and/or launch man-in-the-middle attacks. Users should change usernames and passwords as well, but should not enter login credentials on Websites with vulnerable OpenSSL deployments. To do so could invite attackers to compromise both the old and new credentials if they were exposed in memory.</p>
<p>Many tools have been made available to test for the vulnerability and these same tools are available for attackers to use as well. It is also reasonable to consider that the password reuse problem will again cause additional suffering, because the same passwords shared across multiple systems create an extension of attack surface. A shared password that provides access to a sensitive system, or to an e-mail account used for password resets, can be all that an attacker needs to infiltrate an organizations defenses along multiple fronts.</p>
<p>Multiple proof-of-concept exploits have already been published, and a Metasploit module has been published. Attackers of all shapes and sizes have already started using these tools or are developing their own to target vulnerable OpenSSL servers. There have been reports that scanning for vulnerable OpenSSL servers began before the disclosure of the bug was made public, although other reports suggest that these scans may not have been specifically targeting the Heartbleed vulnerability.</p>
<p><strong>ATLAS Indicates Scanning Activity</strong><br />
ASERT has observed an increase in <a href="http://atlas.arbor.net/service/tcp/443" target="_blank">scanning activity on tcp/443</a> from our darknet monitoring infrastructure, over the past several days, most notably from Chinese IP addresses (Figure 1, below). Two IP addresses (220.181.158.174 and 183.63.86.154) observed<a href="http://atlas.arbor.net/service/tcp/443" target="_blank"> scanning tcp/443</a> have been blacklisted by Spamhaus for exploit activity. Scans from Chinese sources are predominately coming from AS4143 (CHINANET-BACKBONE) and AS23724 (CHINANET-IDC-BJ-AP).</p>
<p><b>Figure 1:       </b>TCP/443 scans, Tuesday – Wednesday (April 8-9)</p>
<p><a href="/asert/wp-content/uploads/2014/04/image003.png"><img class="alignnone  wp-image-6795" alt="image003" src="/asert/wp-content/uploads/2014/04/image003.png" width="707" height="136" /></a></p>
<p><a href="/asert/wp-content/uploads/2014/04/image005.png"><img class="alignnone  wp-image-6793" alt="image005" src="/asert/wp-content/uploads/2014/04/image005.png" width="194" height="154" /></a></p>
<p>Attacks observed by ASERT decreased by Thursday as of this report writing. China still accounted for the largest percentage of <a href="http://atlas.arbor.net/service/tcp/443" target="_blank">detected scan activity</a>:</p>
<p><b>Figure 2:       </b>TCP/443 scans, Thursday (April 10)</p>
<p><a href="/asert/wp-content/uploads/2014/04/image007.png"><img class="alignnone  wp-image-6791" alt="image007" src="/asert/wp-content/uploads/2014/04/image007.png" width="463" height="162" /></a></p>
<p><a href="/asert/wp-content/uploads/2014/04/image010.png"><img class="alignnone size-full wp-image-6788" alt="image010" src="/asert/wp-content/uploads/2014/04/image010.png" width="398" height="179" /></a></p>
<p><strong>Pravail Security Analytics Detection Capabilities</strong></p>
<p><a href="http://www.pravail.com" target="_blank">Arbors Pravail Security Analytics </a>system provides detection for this vulnerability using the following rules:</p>
<p>2018375 ­ ET CURRENT_EVENTS TLS HeartBeat Request (Server Intiated)</p>
<p>2018376 ­ ET CURRENT_EVENTS TLS HeartBeat Request (Client Intiated)</p>
<p>2018377 ­ ET CURRENT_EVENTS Possible OpenSSL HeartBleed Large HeartBeat<br />
Response (Client Init Vuln Server)</p>
<p>2018378 ­ ET CURRENT_EVENTS Possible OpenSSL HeartBleed Large HeartBeat<br />
Response (Server Init Vuln Client)</p>
<p>Examples of detection capabilities are reproduced below.</p>
<p>&nbsp;</p>
<p><a href="http://pravail.com" target="_blank"><img class="alignnone size-full wp-image-6786" alt="Heartbleed detection tool screenshot" src="/asert/wp-content/uploads/2014/04/image012.png" width="434" height="191" /></a></p>
<p><a href="http://www.pravail.com" target="_blank"><img class="alignnone size-full wp-image-6784" alt="Heartbleed detection tool screenshot" src="/asert/wp-content/uploads/2014/04/image014.png" width="434" height="191" /></a></p>
<p>&nbsp;</p>
<p><strong>Analysis of Historical Packet Captures Using New Indicators</strong><br />
In the event of this, and other security threats that are highly emergent, organizations may wish to consider implementing analysis capabilities on archived packet captures in order to detect first signs of attack activity. Granular analysis using fresh indicators can help pinpoint where and when a targeted attack (or a commodity malware attack, for that matter) may have first entered the network, or when such attackers may have exfiltrated data using a technique that was not yet being detected on the wire during the time of the initial attack and infiltration. The capabilities of Pravail Security Analytics will give organizations the means to accomplish such an analysis. A free account is available at <a href="https://www.pravail.com/">https://www.pravail.com/</a> and rest assured that this site is using the latest non-vulnerable OpenSSl version.</p>
<p><strong>Longer-Term Implications and Lessons Learned</strong><br />
Serious questions have been raised regarding the notification process surrounding this vulnerability.  The operational community at large have voiced serious disapproval surrounding the early notification of a single content delivery network (CDN) provider, while operating system vendors and distribution providers, not to mention the governmental and financial sectors, were left in the dark and discovered this issue only after it was publicly disclosed via a marketing-related weblog post by the CDN vendor in question.  It has been suggested that the responsible disclosure best practices developed and broadly adopted by the industry over the last decade were in fact bypassed in this case, and concerns have been voiced regarding the propriety and integrity of the disclosure process in this instance.</p>
<p>Recent indications that a significant number of client applications may be utilizing vulnerable versions of <a href="http://www.openssl.org" target="_blank">OpenSSL</a> as well has broad implications, given the propensity of non-specialist users to ignore software updates and to continue unheedingly running older versions of code.</p>
<p>Furthermore, only ~6% of TLS-enabled Websites (and an undetermined, but most probably even-smaller percentage of other types of systems) make use of Perfect Forward Secrecy (PFS). This configurable option ensures that if an issue of this nature arises, previously encrypted traffic retained in packet captures isn&#8217;t susceptible to retrospective cryptanalysis.</p>
<p>Without PFS, there are no automated safeguards that can ameliorate these issues, once a vulnerability of this nature has been exposed.  Many operators and users may not realize that if attackers captured packets of encrypted traffic in the past from vulnerable services/applications which weren&#8217;t configured with PFS &#8211; i.e., the overwhelming majority of such systems &#8211; and have retained those captured packets, they&#8217;ve the opportunity now to use analysis tools to replay those packets and decrypt the Internet traffic contained in those packets. This means that attackers can potentially unearth their credentials, intellectual property, personal financial information, etc. with access to previously captured packet-dumps.</p>
<p>The ability for an attacker to decrypt packet capture archives requires that the attacker has obtained the private keys used to encrypt that traffic. As recent research shows, this is not a theoretical vulnerability – private key material has been compromised in a lab environment and therefore we must assume that attackers have at least the same, if not more substantial capabilities.</p>
<p>The &#8216;Heartbleed&#8217; vulnerability may well result in an underground market in &#8216;vintage&#8217; packet captures &#8211; i.e., packet captures performed after the date this vulnerability was introduced into OpenSSL, and prior to some date in the future after which it is presumed that the most &#8216;interesting&#8217; servers, services, applications, and devices have been remediated.</p>
<p>This incident has the potential to evolve into a massive 21st-Century, criminalized, Internet-wide version of the Venona Project, targeting the entire population of Internet users who had the ill fortune to unknowingly make use of encrypted applications or services running vulnerable versions of OpenSSL. This highlights the paradox of generalized cryptographic systems in use over the Internet today.</p>
<p>While the level of complexity required to correctly design and implement cryptosystems means that in most situations, developers should utilize well-known cryptographic utilities and libraries such as OpenSSL, the dangers of a cryptographic near-monoculture have been graphically demonstrated by the still-evolving Heartbleed saga.  Further complicating the situation is the uncomfortable fact that enterprises, governments, and individuals have been reaping the benefits of the work of the volunteer OpenSSL development team without contributing the minimal amounts time, effort, and resources to ensure that this vital pillar of integrity and confidentiality receives the necessary investment required to guarantee its continued refinement and validation.</p>
<p>This is an untenable situation, and it is clear that the current development model for OpenSSL is unsustainable in the modern era of widespread eavesdropping and rapid exploitation of vulnerabilities by malefactors of all stripes. Information on how to support the OpenSSl effort can be found here: <a href="https://www.openssl.org/support/">https://www.openssl.org/support/</a></p>
<div><strong>Heartbleed and Availability</strong></div>
<div>While Heartbleed is a direct threat to confidentiality, there are also potential implications for availability.</div>
<p>In some cases, attackers seeking exploitable hosts may scan and/or try to exploit this vulnerability so aggressively that they inadvertently DoS the very hosts they&#8217;re seeking to compromise. Organizations should be cognizant of this threat and ensure that the appropriate availability protections are in place so that their systems can be defended against both deliberate and inadvertent DDoS attacks.</p>
<p>It should also be noted that initial experimentation seems to indicate that it&#8217;s easiest for attackers to extract the private keys from vulnerable OpenSSL-enabled applications and services, using the least amount of exploit traffic, immediately after they have been started.  Accordingly, organizations should be prepared to defend against DDoS attacks intended to cause state exhaustion and service unavailability for SSL-enabled servers, load-balancers, reverse proxies, VPN concentrators, etc.  The purpose of such DDoS attacks would be to force targeted organizations to re-start these services in order to recover from the DDoS attacks, thus providing the attackers with a greater chance of capturing leaked private keys.</p>
<hr />
<p><strong>References</strong><br />
<a href="http://www.openssl.org/news/vulnerabilities.html#2014-0160">http://www.openssl.org/news/vulnerabilities.html#2014-0160</a><br />
<a href="http://heartbleed.com">http://heartbleed.com</a><br />
<a href="http://blog.existentialize.com/diagnosis-of-the-openssl-heartbleed-bug.html">http://blog.existentialize.com/diagnosis-of-the-openssl-heartbleed-bug.html</a><br />
<a href="http://news.netcraft.com/archives/2014/04/02/april-2014-web-server-survey.html">http://news.netcraft.com/archives/2014/04/02/april-2014-web-server-survey.html</a><br />
<a href="http://threatpost.com/seriousness-of-openssl-heartbleed-bug-sets-in/105309">http://threatpost.com/seriousness-of-openssl-heartbleed-bug-sets-in/105309</a><br />
<a href="http://arstechnica.com/security/2014/04/critical-crypto-bug-exposes-yahoo-mail-passwords-russian-roulette-style/">http://arstechnica.com/security/2014/04/critical-crypto-bug-exposes-yahoo-mail-passwords-russian-roulette-style/</a><br />
<a href="https://www.openssl.org/news/secadv_20140407.txt">https://www.openssl.org/news/secadv_20140407.txt</a><br />
<a href="https://isc.sans.edu/diary/Heartbleed+vendor+notifications/17929">https://isc.sans.edu/diary/Heartbleed+vendor+notifications/17929</a><br />
<a href="http://possible.lv/tools/hb/">http://possible.lv/tools/hb/</a><br />
<a href="http://filippo.io/Heartbleed/">http://filippo.io/Heartbleed/</a><br />
<a href="https://zmap.io/heartbleed/">https://zmap.io/heartbleed/</a><br />
<a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/ssl/openssl_heartbleed.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/ssl/openssl_heartbleed.rb</a><br />
<a href="https://gist.github.com/sh1n0b1/10100394">https://gist.github.com/sh1n0b1/10100394</a><br />
<a href="http://www.seacat.mobi/blog/heartbleed">http://www.seacat.mobi/blog/heartbleed</a> <i>Note: This event may have been a false positive caused by ErrataSec’s masscan software (</i><a href="http://blog.erratasec.com/2014/04/no-we-werent-scanning-for-hearbleed.html"><i>http://blog.erratasec.com/2014/04/no-we-werent-scanning-for-hearbleed.html</i></a><i>)</i><br />
<a href="http://arstechnica.com/security/2014/04/heartbleed-vulnerability-may-have-been-exploited-months-before-patch/">http://arstechnica.com/security/2014/04/heartbleed-vulnerability-may-have-been-exploited-months-before-patch/</a><br />
<a href="https://twitter.com/1njected/status/453781230593769472">https://twitter.com/1njected/status/453781230593769472</a></p>
<p>Venona Project: <a href="http://en.wikipedia.org/wiki/Venona" target="_blank">http://en.wikipedia.org/wiki/<wbr />Venona</a>&gt;<br />
PFS: <a href="https://community.qualys.com/blogs/securitylabs/2013/08/05/configuring-apache-nginx-and-openssl-for-forward-secrecy" target="_blank">https://community.qualys.com/<wbr />blogs/securitylabs/2013/08/05/<wbr />configuring-apache-nginx-and-<wbr />openssl-for-forward-secrecy</a></p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2014/04/heartbleed/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li><li><a href="http://www.arbornetworks.com/asert/tag/heartbleed/" rel="tag">heartbleed</a>, <a href="http://www.arbornetworks.com/asert/tag/openssl/" rel="tag">OpenSSL</a></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/analysis/" title="View all posts in analysis" rel="category tag">analysis</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/critical-infrastructure/" title="View all posts in Critical Infrastructure" rel="category tag">Critical Infrastructure</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/exploit-code/" title="View all posts in Exploit Code" rel="category tag">Exploit Code</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/internet-traffic-and-trends/" title="View all posts in Internet traffic and trends" rel="category tag">Internet traffic and trends</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/other/" title="View all posts in Other" rel="category tag">Other</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/secure-coding/" title="View all posts in Secure Coding" rel="category tag">Secure Coding</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/software-development/" title="View all posts in Software Development" rel="category tag">Software Development</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/ssl/" title="View all posts in SSL" rel="category tag">SSL</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/vulnerabilities/" title="View all posts in Vulnerabilities" rel="category tag">Vulnerabilities</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-5969 post type-post status-publish format-standard hentry category-interesting-research category-malware category-reverse-engineering category-spam" id="post-5969">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2013/12/bitcoin-alarm-bitcoin-stealing-spam/" rel="bookmark tag" title="Bitcoin Alarm &#8211; Bitcoin stealing spam blog post entry">Bitcoin Alarm &#8211; Bitcoin stealing spam</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/kenny">Kenny MacDermid</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2013/12/bitcoin-alarm-bitcoin-stealing-spam/">12/12/2013</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>The rise in Bitcoin values seems to have caused an equal increase of Bitcoin spam as malware authors attempt to make money off the many new market participants. One site that was spammed to me three times in one day is bitcoin-alarm.net. I ignored it the first two times, but they must have really wanted me to look at it, so who am I not to oblidge.</p>
<p><a href="http://www.arbornetworks.com/asert/wp-content/uploads/2013/12/btclogo.png"><img class="aligncenter size-medium wp-image-5972" alt="Bitcoin Alarm Logo" src="/asert/wp-content/uploads/2013/12/btclogo-300x36.png" width="300" height="36" /></a></p>
<p>The site promises a tool to notify you of market changes by SMS, without ever mentioning any nefarious behaviour. YouTube videos teach you what Bitcoin is, and how to install this free tool.  They even provide a link so you can donate to the author, although <a href="https://blockchain.info/address/1PwY2aBrYiZEwtApc5hQ3RwWH64LEsoXAc">it appears</a> no one has chosen to do so. This I have to download.</p>
<p><img class="aligncenter size-full wp-image-5970" alt="BitcoinAlarm Icon" src="/asert/wp-content/uploads/2013/12/AppScreenshot.png" width="175" height="50" /></p>
<p>The download BitcoinAlarm.exe (MD5: edfa12d4a454b0eb786bbe92050ab88a) had just<a href="https://www.virustotal.com/en/file/3e032b8c58aa17811d74f92658196374c2b8e6670640c121582690dab00573a0/analysis/"> 1 hit on VirusTotal</a> when I first scanned it (from <a href="http://www.kaspersky.com">Kaspersky</a>). Is it a false positive on a nice free tool? Lets dig deeper.</p>
<p>The download is an installer. A quick strings didn&#8217;t turn up anything interesting, so lets try <a href="https://github.com/devttys0/binwalk">binwalk</a>:</p>
<p><img class="aligncenter size-full wp-image-5973" alt="Binwalk Results - a rar archive" src="/asert/wp-content/uploads/2013/12/Binwalk-Results.png" width="872" height="112" /><br />
I carved out this RAR archive to see what it contains:</p>
<pre>dd if=BitcoinAlarm.exe.virus of=out.rar bs=1 skip=756224
mkdir ext
unrar x out.rar ext/</pre>
<p><img class="aligncenter size-full wp-image-5975" alt="Unrar results: an SFX script and 5 files." src="/asert/wp-content/uploads/2013/12/unrar.png" width="594" height="226" /></p>
<p>There&#8217;s an SFX script run, lets see what it does:</p>
<div id="attachment_5976" style="width: 518px" class="wp-caption aligncenter"><img class="size-full wp-image-5976" alt="CreateObject(&quot;WScript.Shell&quot;).Exec &quot;winupdate.exe 5943564.IFW&quot;" src="/asert/wp-content/uploads/2013/12/sfxvbe.png" width="508" height="22" /><p class="wp-caption-text">cat 7246235.vbe</p></div>
<p>A quick check of winupdate.exe with VirusTotal shows that it&#8217;s the valid (and non-malicious) <a href="http://www.autoitscript.com/">AutoIt</a> executable. AutoIt is a great little scripting language for Windows, it&#8217;s especially useful for automating GUI related tasks. So if winupdate.exe is AutoIt that would make 5943564.IFW an AutoIt script. It looks like it was obfuscated somewhat though:</p>
<div id="attachment_5977" style="width: 542px" class="wp-caption aligncenter"><img class="size-full wp-image-5977" alt="a bunch of comments" src="/asert/wp-content/uploads/2013/12/obfusscript.png" width="532" height="181" /><p class="wp-caption-text">head 5943564.IFW</p></div>
<p>Run it through</p>
<pre>sed -e '/^;[0-9]/d'</pre>
<p>to clean up the garbage and we end up with <a href="http://pastebin.com/QyZz8mR3">this script</a>. It starts by checking if <a href="http://www.avast.com">Avast</a> is running and if so it sleeps for 20 seconds. I guess this is long enough for Avast to get bored and go look at something else:</p>
<p><a href="http://pastebin.com/QyZz8mR3"><img class="aligncenter size-full wp-image-5979" alt="if Avast, sleep for 20 seconds" src="/asert/wp-content/uploads/2013/12/scriptstart2.png" width="432" height="127" /></a></p>
<p>Well, that&#8217;s certainly not a good sign. It&#8217;s a pretty solid chance that if software is checking for an antivirus engine that it&#8217;s up to no good. A scan of the rest of the file contains other interesting methods like &#8220;disable_uac&#8221;, &#8220;anti_hook&#8221;, &#8220;persistence&#8221;, &#8220;botkiller&#8221;, &#8220;downloader&#8221;, &#8220;disable_syste_restore&#8221;. It&#8217;s starting to look like <a href="http://www.kaspersky.com">Kaspersky</a> was right, congrats on being the 1/49 to detect this.</p>
<p>I see a lot of calls to IniRead(), and they&#8217;re all reading 65901.PPZ. It looks like this is the configuration file. In contains:</p>
<pre>[6404000]
6662859=9455413
[2244034]
6224525=3244993
[3206254]
5598349=4588436
[5378250]
6296134=4064234
[1109091]
1109091=asvep</pre>
<p>Matching these to the script we see find the sections are:</p>
<pre># 6404000 == disable_uac()
# 2244034 == AdlibRegister("anti_hook", 500)
# 3206254 == AdlibRegister("persistence", 500)
# 5378250 == startup()
# 1109021 == $sKey</pre>
<p>This crypto key is used in Main to decrypt and run the file 20070.RQT:</p>
<p><img class="aligncenter size-full wp-image-5981" alt="decrypt and run 20070.RQT with cryptkey" src="/asert/wp-content/uploads/2013/12/submain.png" width="569" height="166" /></p>
<p>The easiest way to decrypt this file was to simply let the script do the work. There&#8217;s a lot of code outside of functions though, so care has to be taken to remove everything non-crypto related. Remove the _RunPE() and replace it with</p>
<pre>FileWrite($uniscriptdir &amp; "DECRYPTED", $sArquive)</pre>
<p>The decrypted file had <a href="https://www.virustotal.com/en/file/098c5a6d4c9e0926c054fc7ca79f67e6de7bf8f41245ed1063fea48575bb377d/analysis/">30/48 hits of VirusTotal</a> when I scanned it (MD5: 224c73f8172123e5ddca2302425664a6). It&#8217;s called NetWiredRC and is a remote access trojan made for stealing login information, and likely in this case being used to steal Bitcoins. It connect to <strong>bitcoins.dd-dns.de</strong> on port 3360.</p>
<p>Some choice credential related strings from the decrypted malware:</p>
<pre>%sThunderbirdprofiles.ini
select *  from moz_logins
%s.purpleaccounts.xml
SoftwareMicrosoftInternet ExplorerIntelliFormsStorage2</pre>
<p>This free utility is nothing more than malware with very low detection rate being spammed to anyone that might have a Bitcoin sitting around. When I <a href="http://www.urlvoid.com/scan/bitcoin-alarm.net/">checked the domain with urlvoid</a> it had zero &#8216;bad&#8217; reports and was not blacklisted. I&#8217;ve since submitted the domain to multiple scanners and it&#8217;s now detected by <a href="http://www.scumware.org/">Scumware</a>.</p>
<p>On a recheck BitcoinAlarm.exe&#8217;s detection is up to 14 of 49 scanners, and the download link appears to return 404. bitcoins.dd-dns.de is no longer answering on port 3360.</p>
<p>Never before has it been so easy to leave cash accessible from the Internet, so expect more malware to make off with your Bitcoin wallet. Bitcoins that are not in use should be moved off into <a href="https://en.bitcoin.it/wiki/Cold_storage">cold storage</a>, or donated to <a href="http://theseinfelddictionary.com/2007/12/12/human-fund/">the human fund</a> at 136K8a5Mb8uDguFb7RnoXz7gzBSe2xaEED (ahem, worth a shot right?).</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2013/12/bitcoin-alarm-bitcoin-stealing-spam/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/reverse-engineering/" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/spam/" title="View all posts in Spam" rel="category tag">Spam</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-5946 post type-post status-publish format-standard hentry category-ddos-attacks category-backdoors category-botnets category-forensics category-interesting-research category-malware category-reverse-engineering category-spyware category-trojan-horses category-vulnerabilities" id="post-5946">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2013/12/happy-holidays-point-of-sale-malware-campaigns-targeting-credit-and-debit-cards/" rel="bookmark tag" title="Happy Holidays: Point of Sale Malware Campaigns Targeting Credit and Debit Cards blog post entry">Happy Holidays: Point of Sale Malware Campaigns Targeting Credit and Debit Cards</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/cwilson">cwilson</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2013/12/happy-holidays-point-of-sale-malware-campaigns-targeting-credit-and-debit-cards/">12/03/2013</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p><strong>Inside Recent Point-of-Sale Malware Campaign Activities</strong></p>
<p><strong>Curt Wilson, Dave Loftus, Matt Bing</strong></p>
<p>An active Point of Sale (PoS) compromise campaign designed to steal credit and debit card data using the Dexter and Project Hook malware has been detected. Indicators of compromise will be provided for mitigation and detection purposes. Prior to the publication of this Threat Intelligence document (embedded at the end of this post), members of the FS-ISAC, major Credit Card vendors and law enforcement were notified.</p>
<p>It appears that there are at least three distinct versions of Dexter:</p>
<ol>
<li>Stardust (looks to be an older version, perhaps version 1)</li>
<li>Millenium (note spelling)</li>
<li>Revelation (two observed malware samples; has the capability to use FTP to exfiltrate data)</li>
</ol>
<p>In early November 2013, ASERT researchers discovered two servers hosting Dexter and other POS malware to include Project Hook.  The Dexter campaign looks more active, especially in the Eastern Hemisphere and therefore shall be the main focus herein. Dexter, first documented by Seculert in December 2012, is a Windows-based malware used to steal credit card data from PoS systems. The exact method of compromise is not currently known, however PoS systems suffer from the same security challenges that any other Windows-based deployment does. Network and host-based vulnerabilities (such as default or weak credentials accessible over Remote Desktop and open wireless networks that include a PoS machine), misuse, social engineering and physical access are likely candidates for infection. Additionally, potential brittleness and obvious criticality of PoS systems may be a factor in the reportedly slow patch deployment process on PoS machines, which increases risk. Smaller businesses are likely an easier target due to reduced security. While the attackers may receive less card data from smaller retailers, infections may be more numerous and last longer due to the lack of security reporting and security staff in such environments.</p>
<p>Figure 1: Dexter (Purple) and Project Hook (Orange) infections in the Eastern Hemisphere</p>
<p><a href="http://www.arbornetworks.com/asert/wp-content/uploads/2013/12/Screen-Shot-2013-12-03-at-1.18.27-AM.png"><img class="alignnone size-medium wp-image-5948" title="Dexter (Purple) and Project Hook (Orange) infections in the eastern hemisphere" alt="Dexter and Project Hook infections in the eastern hemisphere" src="/asert/wp-content/uploads/2013/12/Screen-Shot-2013-12-03-at-1.18.27-AM-300x194.png" width="518" height="334" /></a></p>
<p>Figure 2: Dexter (Purple) and Project Hook (Orange) infections in the western hemisphere</p>
<p><a href="http://www.arbornetworks.com/asert/wp-content/uploads/2013/12/Screen-Shot-2013-12-03-at-1.22.00-AM.png"><img class="alignnone size-medium wp-image-5947" alt="Screen Shot 2013-12-03 at 1.22.00 AM" src="/asert/wp-content/uploads/2013/12/Screen-Shot-2013-12-03-at-1.22.00-AM-300x199.png" width="512" height="339" /></a></p>
<p>For the full document to include a list of various compromise indicators and information about the back-end infrastructure, please download the full public report -</p>
<p><a href="http://www.arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf">Dexter and Project Hook Break the Bank</a></p>
<p>&nbsp;</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2013/12/happy-holidays-point-of-sale-malware-campaigns-targeting-credit-and-debit-cards/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/backdoors/" title="View all posts in Backdoors" rel="category tag">Backdoors</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/forensics/" title="View all posts in Forensics" rel="category tag">Forensics</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/reverse-engineering/" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/spyware/" title="View all posts in Spyware" rel="category tag">Spyware</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/trojan-horses/" title="View all posts in Trojan Horses" rel="category tag">Trojan Horses</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/vulnerabilities/" title="View all posts in Vulnerabilities" rel="category tag">Vulnerabilities</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-4965 post type-post status-publish format-standard hentry category-arbor-networks-ddos-experts category-exploit-code category-interesting-research category-malware" id="post-4965">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2013/02/scavenging-connections-on-dynamic-ip-networks-redux/" rel="bookmark tag" title="Scavenging Connections On Dynamic-IP Networks Redux blog post entry">Scavenging Connections On Dynamic-IP Networks Redux</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/dschwarz">Dennis Schwarz</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2013/02/scavenging-connections-on-dynamic-ip-networks-redux/">02/04/2013</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>While a lot has changed since Seth McGann&#8217;s 1998 Phrack magazine article &#8220;<a href="http://www.phrack.org/issues.html?issue=54&amp;id=7#article">Scavenging Connections On Dynamic-IP Networks</a>,” it&#8217;s not hard to extrapolate his idea into modern day malware sinkholes. In this blog post we would like to share some of the connections scavenged over a short period from the <a href="http://www.no-ip.com/">No-IP</a> dynamic DNS network&#8211;a network we run into time and time again in our malware analysis.</p>
<p>Malware campaigns have not been shy about using these and other dynamic DNS hostnames for their command &amp; control (C&amp;C) servers. With the price (free), dynamic nature, and anonymity (throw-away email addresses and proxies) it&#8217;s not hard to see the appeal. Using available APIs, malware authors are building in support directly into their bot builder kits as well.</p>
<p><a href="/asert/wp-content/2013/02/scavenging-connections-on-dynamic-ip-networks-redux" rel="attachment wp-att-4966"><img class="size-full wp-image-4966 aligncenter" alt="no-ip" src="/asert/wp-content/uploads/2013/02/no-ip1.jpg" width="729" height="475" /></a></p>
<p style="text-align: center;"> <i style="text-align: center;">No-IP support built-in to the Xtreme Remote Access Trojan (RAT</i>)</p>
<p>Querying our malware zoo for the main free tier domain (no-ip.org) returns almost 6500 unique subdomains. As of this writing, about 4200 (64%) of these no longer resolve and are expired. As a proof of concept, we re-registered 100 of these sub-domains (see Appendix A) and in 4 groups of 25 sinkholed them for 3-4 days at a time. We used a simple sinkhole that redirected all TCP ports minus SSH (22) to a Python daemon that limited the connection time to 5 seconds and logged the first 2048 received bytes.</p>
<p>Disregarding general Internet background noise (hi critical.io, proxy scanners, and SQL Slammer), we received connections from around 6650 unique IPs distributed across the globe.</p>
<p><a href="/asert/wp-content/2013/02/scavenging-connections-on-dynamic-ip-networks-redux" rel="attachment wp-att-4967"><img class="size-full wp-image-4967 aligncenter" alt="map" src="/asert/wp-content/uploads/2013/02/map1.jpg" width="1025" height="494" /></a></p>
<p style="text-align: center;"><i>Map of source IPs connecting to a two-week sinkhole of 100 no-ip.org domains</i></p>
<p>Considering the low number of domains that were registered, many surprises and concerns cropped up. The sheer number of unique sources, geographical distribution, amount of traffic generated by abandoned bots (close to 7 GB of PCAP data), and the variety of malware families was interesting and insightful. There was good representation of both ASCII and binary blob communications, but the latter was more prevalent. The number of HTTP based phone homes was also lower than expected. Further analysis reveals the following interesting elements.</p>
<p><b>Xtreme RAT</b></p>
<p>There were two types of phone homes. The first includes a version string and we saw 2.9, 3.1, 3.2, and 3.5 Private (as of this writing, 3.6 is the latest publicly available). The second type of phone home message includes the password used in the campaign and we saw 123123, 87080060, and 1234567890 (default).</p>
<p><i>Type 1 (130 unique IPs)</i></p>
<pre>myversion|2.9</pre>
<p><i>Type 2 (57 unique IPs)</i></p>
<pre>GET /1234567890.functions HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/5.0; 
SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center 
PC 6.0; InfoPath.2; .NET4.0C)
Host: XXX.no-ip.org:8089
Connection: Keep-Alive
Cache-Control: no-cache</pre>
<p><strong>DarkComet</strong></p>
<p>Two types of phone homes were seen.</p>
<p>Type 1 (54 unique IPs)</p>
<pre>D573BA5A4EFFC3FB629308</pre>
<p>Type 2 (215 unique IPs)</p>
<pre>KEEPALIVE8404156</pre>
<p><strong>Various IRC Bots (325 unique IPs)</strong></p>
<p>As expected, IRC based bots were well represented. Some sample nicknames:</p>
<ul>
<li>[iRooT-XP-CRI]702619</li>
<li>ESP|00|XP|SP3|8254484</li>
<li>{00-ITA-2K-ASP&#8211;6618}</li>
<li>ScAry0518258</li>
<li>pwned[00000]</li>
</ul>
<p><strong>Turkojan (75 unique IPs)</strong></p>
<pre>ams</pre>
<p><strong>CIA Trojan (3 unique IPs)</strong></p>
<pre>details;6333;Administrator;HOME;name;CIA 1.3;No;name</pre>
<p><strong>GhostHeart2 (2 unique IPs)</strong></p>
<p>Starting at offset 13, zlib chunk.</p>
<pre>00000000  47 68 30 73 74 61 00 00  00 b0 02 00 00 78 9c 4b Gh0sta.. .....x.K
00000010  63 60 60 98 03 c4 ac 40  cc 04 c4 e7 f8 20 f4 40 c``....@ ..... .@
00000020  02 0b 28 2d c4 c8 cc f0  81 0b e2 9e 03 2b 18 78 ..(-.... .....+.x
00000030  f2 72 72 93 49 35 ab 9c  91 81 e1 1e 2f 03 c3 17 .rr.I5.. ..../...
00000040  20 6d 64 60 68 84 2e 6f  7c e6 0d a5 ce 1d 05 54  md`h..o |......T
00000050  04 47 d6 9c 38 bf fd da  f5 97 b8 e4 01 82 d8 11 .G..8... ........
00000060  ac</pre>
<pre>.</pre>
<p><strong>MyRat (16 unique IPs)</strong></p>
<p>Starting at offset 13, looks like a zlib chunk.</p>
<pre>00000000  4d 79 52 61 74 b8 00 00  00 24 01 00 00 78 9c 4b MyRat... .$...x.K
00000010  8b 33 61 9a c3 c0 c0 c0  0a c4 8c 40 ac c1 c5 c0 .3a..... ...@....
00000020  c0 04 a4 83 53 8b ca 32  93 53 15 02 12 93 b3 15 ....S..2 .S......
00000030  8c 19 18 ae c4 98 30 fd  60 40 00 90 da 1b 46 4f ......0. `@....FO
00000040  18 5a 7d 67 17 86 c4 9a  80 b4 30 74 4a cd 2f 04 .Z}g.... ..0tJ./.
00000050  a9 b1 b0 16 66 c8 60 80  e8 61 66 80 98 07 52 cf ....f.`. .af...R.
00000060  06 c4 02 50 8c 02 14 a0  18 aa ee 25 50 13 33 98 ...P.... ...%P.3.
00000070  c3 c8 70 60 05 a3 e9 32  a0 e0 22 a8 bb 18 8a 0b ..p`...2 ..".....
00000080  52 53 53 d0 0d c0 0e fe  b3 33 30 5c 04 ea cd ae RSS..... .30....
00000090  48 2d 4e ce 2f 4a 65 00  ba 6b 81 2a 44 6e 31 d0 H-N./Je. .k.*Dn1.
000000A0  df 30 3b 97 dd de 70 6a  49 f8 de d2 a5 2e fb be .0;...pj I.......
000000B0  63 33 07 00 3f 40 28 73                          c3..?@(s</pre>
<p><strong>YoyoDDoS (471 unique IPs)</strong></p>
<p>0xb8 variant.</p>
<pre>00000000  79 6d 74 d8 68 90 95 8e  8f 8d d0 84 8d d1 d8 c1 ymt.h... ........
00000010  c6 c5 c8 d8 69 85 99 94  cd 7b 8f 8a 95 d8 68 8a ....i... .{....h.
00000020  8f 9b 95 8b 8b 8f 8a b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000030  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000040  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000050  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000060  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000070  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
00000080  cb cb ca c7 6d 7a b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ....mz.. ........
00000090  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
000000A0  67 91 8e d8 60 68 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 g...`h.. ........
000000B0  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
000000C0  e8 59 3c 56 3c 56 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 .Y&lt;V
000000D0  b8 b8 b8 b8 b8 b8 b8 b8  b8 b8 b8 b8 b8 b8 b8 b8 ........ ........
000000E0  e1 b7 b8 b8                                      ....</pre>
<p><strong>Trojan.DDoser (5 unique IPs)<br />
</strong><br />
Base64 encoded.</p>
<pre>*SNEW*/2||*||RGVmYXVsdA==||*||Uk8=||*||NC4y||*||WFAgeDg2||*||name||*|
|QVVUSExPQURFUkRFRkFVTFQ=||*||</pre>
<p><strong>Spy-Net RAT (19 unique IPs)</strong></p>
<p>Base64 encoded.</p>
<pre>hZGVPsqmMkI|</pre>
<p><strong>Unknown #1 (2 unique IPs)</strong></p>
<pre>104|OnConnect|United States|me|name - me|172.16.3.44|Not Detected|4.0.4 Update 2
|United States|OnConnect|</pre>
<p><strong> Unknown #2 (2 unique IPs)</strong><br />
Two version numbers were seen: 4.0 and 6.0.</p>
<pre>LOGIN|Slovakia#SK|name and something like a password hash|#!#|pixel|name|name-
PC|Windows 7|Connection Established|Intel(R) Pentium(R) M processor 1600MHz 1598MHz
|0,5|Not Available|Not Available||140|4.0|123456</pre>
<p><strong>Unknown #3 (16 unique IPs)</strong></p>
<p>Two version numbers were seen: 0.7 and 1.2.</p>
<pre>02|Dell@DELL-name|XP/Vista|TR|1700|N|t+1.2|1.2|-|</pre>
<p>This analysis of a small sample of No-IP domains and their associated malware gives us a tiny peek into some, possibly forgotten, attack campaigns and how active they can be. While No-IP and other dynamic DNS hostnames shouldn&#8217;t automatically be assumed to be bad, we feel they warrant further scrutiny and attention if seen on your networks.</p>
<p>It should come as no surprise  that there is a lot of malware out there, in all sorts of shapes and sizes. Sinkholing is just another tool in the malware researcher&#8217;s toolbox for the endless task of classifying, analyzing, and mitigating the shadier half of the Internet. In the meantime, the ASERT team work continues on the sinkholing project. Goals include expanding the scope, automating collection and classification as much as possible, and, of course, integrating the data into the ATLAS portal.</p>
<p style="text-align: center;">********</p>
<p> <b>Appendix 1: Domains </b></p>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="200"><strong>Between Nov 6-8:</strong>sparkles.no-ip.orgloucoservegame.no-ip.orgwinchesterhacker.no-ip.orgmoof1.no-ip.orgtotty46.no-ip.orgmmsalti.no-ip.orgmaradona.no-ip.org</p>
<p>chmsou.no-ip.org</p>
<p>notiweb.no-ip.org</p>
<p>diddy69.no-ip.org</p>
<p>juventus-nando.no-ip.org</p>
<p>hoolaco.no-ip.org</p>
<p>by-brunix.no-ip.org</p>
<p>bolinha130.no-ip.org</p>
<p>rathacking786.no-ip.org</p>
<p>123boof.no-ip.org</p>
<p>gabrielzinho.no-ip.org</p>
<p>warez-kw.no-ip.org</p>
<p>demone2011.no-ip.org</p>
<p>markinyourdark.no-ip.org</p>
<p>amine69.no-ip.org</p>
<p>turkoloko.no-ip.org</p>
<p>bilal182010.no-ip.org</p>
<p>tucanoquebrado.no-ip.org</p>
<p>&nbsp;</p>
<p><strong>Between Nov 9 &#8211; 12</strong></p>
<p>ibraaaaaa.no-ip.org</p>
<p>darthlord1.no-ip.org</p>
<p>aljaybol.no-ip.org</p>
<p>aidsvlek.no-ip.org</p>
<p>nomanvirus.no-ip.org</p>
<p>xtrema.no-ip.org</p>
<p>nonozin.no-ip.org</p>
<p>lance11111.no-ip.org</p>
<p>y2c.no-ip.org</p>
<p>pequenoserver.no-ip.org</p>
<p>bcsmetall.no-ip.org</p>
<p>deus-chess25.no-ip.org</p>
<p>memea7.no-ip.org</p>
<p>hermogenes.no-ip.org</p>
<p>anonymousbs2.no-ip.org</p>
<p>wellcomemagila.no-ip.org</p>
<p>wolver.no-ip.org</p>
<p>romerohacker.no-ip.org</p>
<p>difusao.no-ip.org</p>
<p>6thekey2.no-ip.org</p>
<p>180291.no-ip.org</p>
<p>hackerdr.no-ip.org</p>
<p>revoli.no-ip.org</p>
<p>anon1.no-ip.org</p>
<p>xupeta.no-ip.org</p>
<p>&nbsp;</p>
<p>&nbsp;</td>
<td valign="top" width="200"><strong>Between Nov 13 &#8211; 15:</strong>k4b000.no-ip.orgadelson3x.no-ip.orgmuerteya.no-ip.orgbnbtx.no-ip.org6shades16.no-ip.orgchivas.no-ip.orgmarcus3.no-ip.org</p>
<p>ilkkan.no-ip.org</p>
<p>desgarrada.no-ip.org</p>
<p>axf.no-ip.org</p>
<p>darkki123.no-ip.org</p>
<p>avisos.no-ip.org</p>
<p>bobharis.no-ip.org</p>
<p>ooooffff1.no-ip.org</p>
<p>tratt1.no-ip.org</p>
<p>evilsniper.no-ip.org</p>
<p>cust0.no-ip.org</p>
<p>lavitaebella.no-ip.org</p>
<p>es-imvu.no-ip.org</p>
<p>merda2.no-ip.org</p>
<p>darkcometx.no-ip.org</p>
<p>dark-sam.no-ip.org</p>
<p>victima123.no-ip.org</p>
<p>z-666.no-ip.org</p>
<p>fzlmo0s3.no-ip.org</p>
<p>tounsi-vip.no-ip.org</p>
<p>&nbsp;</p>
<p><strong>Between Nov 16 &#8211; 19:</strong></p>
<p>helli1.no-ip.org</p>
<p>shootersiker.no-ip.org</p>
<p>adsll.no-ip.org</p>
<p>slow-v4.no-ip.org</p>
<p>bolinha2012.no-ip.org</p>
<p>6avhosts.no-ip.org</p>
<p>gandhihaxx.no-ip.org</p>
<p>kareemsql.no-ip.org</p>
<p>thedarkdkpiteur.no-ip.org</p>
<p>norhdsss.no-ip.org</p>
<p>xtremecheese.no-ip.org</p>
<p>froozen.no-ip.org</p>
<p>xxtreme.no-ip.org</p>
<p>x-treme.no-ip.org</p>
<p>ohgkm.no-ip.org</p>
<p>hackers1337x.no-ip.org</p>
<p>smoke1.no-ip.org</p>
<p>n00bz0r.no-ip.org</p>
<p>drico-drica.no-ip.org</p>
<p>shades16.no-ip.org</p>
<p>wkrldi132.no-ip.org</p>
<p>6blackhatt.no-ip.org</p>
<p>khabran.no-ip.org</p>
<p>6serverstatus11.no-ip.org</p>
<p>celsodns.no-ip.org</p>
<p>&nbsp;</p>
<p>&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2013/02/scavenging-connections-on-dynamic-ip-networks-redux/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/arbor-networks-ddos-experts/" title="View all posts in Arbor Networks - DDoS Experts" rel="category tag">Arbor Networks - DDoS Experts</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/exploit-code/" title="View all posts in Exploit Code" rel="category tag">Exploit Code</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-4904 post type-post status-publish format-standard hentry category-arbor-networks-ddos-experts category-atlas category-ddos-attacks category-botnets category-interesting-research" id="post-4904">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2012/11/how-likely-is-a-ddos-armageddon-attack/" rel="bookmark tag" title="How likely is a DDoS Armageddon attack? blog post entry">How likely is a DDoS Armageddon attack?</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/cmorales">Carlos Morales</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2012/11/how-likely-is-a-ddos-armageddon-attack/">11/26/2012</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>The recent DDoS attacks against many of the North American financial firms had some unique characteristics that put a strain on the defenses in place and resulted in a number of well publicized service outages. The escalating threat is not new.  It’s been steadily building up over the last few years as botnet command and control has matured, the<a href="/asert/2012/02/ddos-attack-tools-a-visual-guide/"> tools available to exploit those botnets have gone mainstream</a>, and the cost of using the tools has plummeted.  What the attacks did do is raise the industry’s collective consciousness around how bad the situation has gotten.    The effectiveness of the attacks has changed the way that Internet operators, whether service provider, hosting provider, government or enterprise think about their defenses.   It has also raised a number of troubling questions.</p>
<p>The most common question that I have been asked is around the growing size of attacks and the capacity of Internet operators to withstand such threats.   How big does an attack have to be to overwhelm the biggest, most prepared financial company?   How big does an attack have to be to overwhelm the biggest and most prepared service provider?   Is there an Armageddon attack on the horizon that threatens to take down the entire Internet?  There are indications that this<a href="http://blogs.computerworld.com/cybercrime-and-hacking/21276/beyond-stuxnet-preparing-internet-armageddon"> could be the case</a>.</p>
<p>It should be noted that size is by no means the only means by which an attack can be effective.  It’s a very visible way of taking down a network similar to the way a 7 mile backup on a local highway is a visible sign that you’re not getting to your destination quickly.   Application layer attacks, IP protocol attacks, connection attacks and other stealthy attack methods can be just as effective in taking down a victim while being much more difficult to detect and mitigate.  The financial sector attacks were multi-vector and had aspects of both volumetric and application layer attack traffic.</p>
<p>This article is going to focus on larger sized attacks and the possibility of an Armageddon attack.   First, there are a few different measures of size including bandwidth (bps), packets (pps) and connections (cps).    In all three cases Internet operators such as enterprises will have a limit which they can handle.   Bps is the most commonly considered measure of size and it is easy to estimate network bandwidth limits.  If the internet operator has 10Gbps worth of upstream bandwidth, then attacks bigger than this will overwhelm the links.   Packet per second (pps) limits are more of a challenge to estimate limits because each device that is in-line with traffic will have limits in handling pps that will be dependent on the configurations that they are running and the type of traffic seen.   High pps attacks often cause more challenges than high bps attacks because multiple bottlenecks may exist on the network.     High cps attacks are typically targeted at stateful devices on the network that have a connection table.   These tend to be the harder to measure because network traffic analyzers tend to focus on just bps or pps.</p>
<p>With all three attack types, all enterprise, government and hosting provider networks will have bottlenecks that can be over-run relatively easily by big DDoS attacks.  Most enterprise and government datacenters have no more than 10 Gbps with some ranging slightly higher than this.   Arbor Network frequently sees attacks much larger than this.  As an example, Arbor’s ATLAS system receives anonymous attack statistics from hundreds of Arbor Peakflow SP deployments.   The largest bandwidth attacks measured in 2011 and 2012 were 101.4 Gbps and 100.8 Gbps respectively.   The largest packet per second attacks measured in 2011 and 2012 were 139.7 Mpps and 82.4 Mpps respectively.   Another source of data is the annual security survey of Internet operators that Arbor runs.   One of the survey questions is about the largest bps attacks seen over the previous year.    The chart below reflects that biggest attacks reported each year since the survey was first conducted in 2002.</p>
<p><a href="/asert/wp-content/uploads/2012/11/Blog11.jpg"><img class="alignnone size-full wp-image-4905" title="Blog1" src="/asert/wp-content/uploads/2012/11/Blog11.jpg" alt="" width="858" height="360" /></a></p>
<p>Based on the data from the chart above, there have been DDoS attacks capable of overwhelming a 10 Gbps datacenter since 2005.   All this means that enterprises, governments and hosting providers need help from their upstream service providers to deal with threats of this magnitude.   Many of these providers offer managed security services that will provide protection against bigger attacks.   At a certain point, the attacks are big enough that the providers consider them their responsibility anyways because of the potential impact to multiple customers.  However, it’s heavily recommended to have an agreement in place to ensure SLAS and guaranteed response times.</p>
<p>That brings me back to the question on whether an Armageddon attack is possible that can not only overwhelm the end victim but also all the Internet providers in between.   Based on the current Internet environment, this is all too possible.   The first thing that you need to consider what the available bandwidth is to generate an attack.   There have been botnets discovered that have contained more than 1M infected hosts.   Assuming an average of 1 Mbps worth of upstream access per host, a conservative estimate based on the number of broadband subscribers, 4G and 3G users deployed in the world, a 1M host botnet could generate an attack of 1 Tbps.   Now what if this botnet and multiple other large botnets attack at the same time?   Service providers have a lot of bandwidth throughout their network but there are limits to how much traffic they can handle.   Attacks of that magnitude described would have profound effect on the Internet as a whole exploiting bottlenecks in many places simultaneously.  No single service provider, even the largest tier ones, would be able to handle all this traffic without adversely affecting their user base.</p>
<p>Is this possible?  It certainly seems so.  Is it likely?   It doesn’t seem so since it would affect everyone on the Internet and not just a single victim.   That said, many attacks that didn’t seem likely before are now becoming commonplace as motivations have shifted.   It is something that CSOs from within the carrier community are likely considering and hopefully taking steps to plan for the worst.</p>
<p>&nbsp;</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2012/11/how-likely-is-a-ddos-armageddon-attack/#comments" class="comments-count-number">0Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/arbor-networks-ddos-experts/" title="View all posts in Arbor Networks - DDoS Experts" rel="category tag">Arbor Networks - DDoS Experts</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/atlas/" title="View all posts in ATLAS" rel="category tag">ATLAS</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/botnets/" title="View all posts in Botnets" rel="category tag">Botnets</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
									<article class="post-4816 post type-post status-publish format-standard hentry category-arbor-networks-ddos-experts category-atlas category-ddos-attacks category-interesting-research category-malware" id="post-4816">

						<header>
							<h1 class="entry-title"><a href="http://www.arbornetworks.com/asert/2012/07/exterminating-the-rat-part-i-dissecting-dark-comet-campaigns/" rel="bookmark tag" title="Exterminating the RAT Part I: Dissecting Dark Comet Campaigns blog post entry">Exterminating the RAT Part I: Dissecting Dark Comet Campaigns</a></h1>
							<small class="meta">
	<span class="meta-author">By: <a href="http://www.arbornetworks.com/asert/author/cwilson">cwilson</a></span> - <time datetime="%3$s" pubdate><a href="http://www.arbornetworks.com/asert/2012/07/exterminating-the-rat-part-i-dissecting-dark-comet-campaigns/">07/11/2012</a></time>
</small>						</header>

						<!-- *optional* remove read more link -->
						<!-- http://codex.wordpress.org/Customizing_the_Read_More -->
						<!-- Resolves Issue #4: https://github.com/grayghostvisuals/WP-Flex/issues/4 -->
						<div class="entry-content">
							<p>It should be abundantly clear that there are serious concerns at play when dealing with Remote Access Trojans, as they are used in many espionage style attacks where sensitive data and valuable intellectual property are stolen. Occasionally, a RAT is also used to launch DDoS attacks, but these DDoS attacks are less common.  The real value of the RAT to the attacker is the core remote control functionality that breaches the confidentiality and integrity of the victim and the victim network by allowing the attacker full access to the target system. The monitoring of all keystrokes (including passwords, sensitive data entered onto secure sites), control of file upload/download, the ability to steal any file, access network shares, spy via webcam or microphone, download and install additional malware, and other features make these RATs a formidable threat when wielded by a focused attacker. A common targeted attack methodology starts with initial network penetration by compromising one or more systems and installing a RAT or something similar to a RAT that calls back to the attacker. Once the RAT is installed, that infected system becomes a valuable launching pad for the attacker to move laterally on the internal network, seeking information of value to the goals of the attackers campaign.</p>
<p>&nbsp;</p>
<p>Arbor Networks and others have previously profiled the Dark Comet Remote Access Trojan (RAT). While the author of Dark Comet claims that the tool is not intended for malicious purposes, it has been used for  many malicious campaigns, including the recent attack on Syrian opposition leaders where the Dark Comet Trojan was delivered to them disguised as a Skype component. Dark Comet is clearly popular, free and stable enough for many attack campaigns with varying motives and therefore provides some insight into this arena.</p>
<p>When an organization is hit by a RAT infection, it can be helpful to attempt to determine what the attacker was up to and what indicators point towards their motives. Using a combination of open source intelligence and ASERT insight, we will try to piece together some interesting elements. While these indicators can help, unless verbose logging or system/network monitoring is in place, it can be difficult if not impossible to determine every action taken via the RAT.  Unfortunately, a “wipe and reload” approach isn’t sufficient to determine what took place.  An extensive analysis may need to be undertaken to determine the depth and scope of the breach.</p>
<p>We will profile several potentially interesting Dark Comet campaigns that we have discovered in this first part of the RAT series. Future entries in this series will cover other RAT campaigns of interest as our research delivers additional insights.</p>
<h2>Interesting campaign indicators</h2>
<p>How might we start trying to narrow down the campaigns of interest from among the 4000+ Dark Comet samples that we have in our malware analysis repository? One method might be to take a look at the passwords, server IDs and Command &amp; Control infrastructure being used by the RAT itself. While it is of course possible for any attacker to set any password, C&amp;C or server ID or name for any reason such as for misdirection purposes, it is also possible that these elements may reflect the intent of the campaign and give a hint towards the actors behind the scenes. It is also possible that attackers are smart enough to use very vague or generic names for all of the user-selected components of any RAT campaign in order to reduce visibility and fly under the radar.</p>
<h2>Campaign #1: Password contains the phrase “Boeing747”</h2>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="148">C&amp;C Name/IP address : port</td>
<td valign="top" width="148">Password</td>
<td valign="top" width="148">Server ID</td>
<td valign="top" width="148">Md5 hash</td>
</tr>
<tr>
<td valign="top" width="148">41.132.36.63:1604</td>
<td valign="top" width="148">Boeing747!@#Legacy123</td>
<td valign="top" width="148">Guest16</td>
<td valign="top" width="148">40f1aac00c440ed7811cd042bca1b4d8</td>
</tr>
</tbody>
</table>
<p>The password caught my eye due to its contents and also the length and use of mixed case, numbers and special characters. The use of “Boeing747” may have nothing to do with a real Boeing 747 and could have just been something chosen to make a strong password. The C&amp;C in this case is a South African IP, apparently located in an area called Centurion, which houses two Air Force bases which could account for the password reference. There is clearly not enough information available here to determine motive.  Very little public information is available when searching for the MD5, only virus scan results showing that many antivirus scans from early in 2011 provide a generic detection name, except for a vendor that alerts for “BackDoor.Comet.16” and two other vendors that alert using the name “Fynloski”.  Enterprises seeing hits that match these names need to be aware of what they are dealing with and take proper investigation measures to determine the intent and scope of the breach.</p>
<h2>Campaign #2: Server ID “SearchandDestroy_GOV”</h2>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="148">C&amp;C Name/IP address : port</td>
<td valign="top" width="148">Password</td>
<td valign="top" width="148">Server ID</td>
<td valign="top" width="148">Md5 hash</td>
</tr>
<tr>
<td valign="top" width="148">ratnetwork.no-ip.net:1604</td>
<td valign="top" width="148"></td>
<td valign="top" width="148">SearchandDestroy_GOV</td>
<td valign="top" width="148">2770f5bd84bb585d449a7c0e1223920f</td>
</tr>
</tbody>
</table>
<p>This campaign, while noisy is a little bit more interesting as it suggests that the attacker may be experimenting with redirecting .gov sites. After infection, the hosts file of the infected machine has been changed, adding the following entries:</p>
<p>www.x.gov: 74.208.130.89</p>
<p>x.gov: 74.208.130.89</p>
<p>www.security.gov: 74.208.130.89</p>
<p>brandon.gov: 74.208.130.89</p>
<p>www.brandon.gov: 74.208.130.89</p>
<p>www.searchanddestroy.gov: 74.208.130.89</p>
<p>security.gov: 74.208.130.89</p>
<p>searchanddestroy.gov: 74.208.130.89</p>
<p>These are all bogus domains, however it does illustrate the potential to perform a redirect or a man-in-the-middle attack on the unsuspecting user. The destination IP address is a webserver containing several virtual domains, which included “underworldhacking.com”.</p>
<p>The IP address of the host at the time of the attack seen in our analysis infrastructure was 174.61.238.123<strong> </strong>and currently resolves to 38.78.193.22. Both IP addresses are associated with the hostnames ratnetwork.no-ip.net and zombienetwork.no-ip.net.</p>
<h2>Campaign #3: Server ID “server-Bifrost1.3” and hostname “9d1.no-ip.org”</h2>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="148">C&amp;C Name/IP address : port</td>
<td valign="top" width="148">Password</td>
<td valign="top" width="148">Server ID</td>
<td valign="top" width="148">Md5 hash</td>
</tr>
<tr>
<td valign="top" width="148">9d1.no-ip.org:1604</td>
<td valign="top" width="148"></td>
<td valign="top" width="148">server-Bifrost1.3</td>
<td valign="top" width="148">0e492c93cbaec7b5d4cc432e2c66454f</td>
</tr>
</tbody>
</table>
<p>The C&amp;C name here is associated with multiple RAT campaigns. For example, we see information on an Arabic language forum thread including a user named “9D1” discussing TCP port 288 as being associated with a message about “Xtreme RAT” in late 2011.  The topic of that thread relates to password theft. Another likely Xtreme RAT campaign can be found mentioned at <a href="http://home.mcafee.com/virusinfo/virusprofile.aspx?key=1063074#none">http://home.mcafee.com/virusinfo/virusprofile.aspx?key=1063074#none</a> running on TCP port 3460 from late April 2012. We also see another Dark Comet campaign on TCP port 3333 in sandbox output <a href="http://xml.ssdsandbox.net/index.php/6fcb95632b754a941f3e490d5785e7c4">http://xml.ssdsandbox.net/index.php/6fcb95632b754a941f3e490d5785e7c4</a> which is using a default DarkComet mutex that starts with the characters DC. The mutex in this case is DC596I04Z1. Clearly, this dynamic address is up to no good.  The server name, Bifrost 1.3, could indicate that this attacker or group of attackers is also working with the Bifrost RAT.  As of May 29, 2012 this hostname points to the IP address 41.234.27.145 that appears to be located in or near Cairo, Egypt.</p>
<h2>Campaign #4: Server ID “SynBots” and C&amp;C named “syncenter”</h2>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="148">C&amp;C Name/IP address : port</td>
<td valign="top" width="148">Password</td>
<td valign="top" width="148">Server ID</td>
<td valign="top" width="148">Md5 hash</td>
</tr>
<tr>
<td valign="top" width="148">syncenter.no-ip.org:6002</td>
<td valign="top" width="148">roflcopter</td>
<td valign="top" width="148">SynBots</td>
<td valign="top" width="148">4fdcc3e11d84d11df182375e83d52938</td>
</tr>
</tbody>
</table>
<p>This campaign appears to be aimed at Runescape users or other gaming communities, as indicated by the sample seeking file attributes for the following files:</p>
<p>Runescape Dicing Hack.resources.dll</p>
<p>Runescape Dicing Hack.resources</p>
<p>Runescape Dicing Hack.resources.exe</p>
<p>Based on the indicators seen here, it is possible that the purpose of this particular campaign could be to build a DDoS bot, potentially for use as a host booter to boot other gamers off-line with SYN flood attacks.</p>
<h2>Campaign #5: password used “mafia007”, Server ID “Hack Kurd”</h2>
<p>A case of watching too much James Bond, or something more threatening?</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="148">C&amp;C Name/IP address : port</td>
<td valign="top" width="148">Password</td>
<td valign="top" width="148">Server ID</td>
<td valign="top" width="148">Md5 hash</td>
</tr>
<tr>
<td valign="top" width="148">mafia007.no-ip.org:10000</td>
<td valign="top" width="148">mafia007</td>
<td valign="top" width="148">Hack_Kurd</td>
<td valign="top" width="148">0e492c93cbaec7b5d4cc432e2c66454f</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>It looks as though this particular sample was packed using some type of .NET crypter or packer that makes the sample more difficult to analyze. The only quickly discovered public reference to this sample by its MD5 hash  is a sandbox report found at <a href="http://xml.ssdsandbox.net/index.php/0e492c93cbaec7b5d4cc432e2c66454f">http://xml.ssdsandbox.net/index.php/0e492c93cbaec7b5d4cc432e2c66454f</a> which reveals basically nothing about the sample except that it was unable to run, generating an error code “KilledByWindowsLoader”.</p>
<p>This sample drops a file  C:Documents and Settings[Username]Local SettingsTempAdobeUpdate.exe and attempts to enumerate elements of the Microsoft .NET runtime version 2.  Based on the nickname “mafia007” and a little bit of digging reveals that the crypter likely used here is called “Crypter Zero” or “Zero Crypter” which claims to be 100% FUD (fully undetectable by antivirus). This particular crypter is from 2011, and the authors point to an underground file-scanning service to illustrate their point. Zero Crypter is being sold for 50 euro.</p>
<p>While packers can complicate matters, thankfully we have memory dumps that bypass the need to perform a manual unpacking/decrypting process in many cases.</p>
<p>We also determine that an Italian e-mail address containing the string “mafia007” has shown much interest in Dark Comet and other Trojans and demonstrates the use of the Zero Packer on them. A similar username was found on various underground forums that had been compromised, and passwords leaked by LulzSec.</p>
<p>mafia007.no-ip.org resolved to 151.31.38.204 during the initial sample analysis and currently resolves to 151.82.18.157. Both are Italian IP addresses.</p>
<p>While I cannot be 100% certain, I don’t believe this person to be a serious attacker based on the weak operational security demonstrated here.  Therefore, this campaign may be a case of “too much James Bond” although appearances can be deceiving. It would not be the first time that an attacker does not attempt to hide very well.</p>
<h2>Summary</h2>
<p>Dark Comet is very popular RAT and is actively developed and widely used. It can be difficult to determine the motive of the attacker, however sometimes there are enough traces left over that can help us piece together the potential goals of a campaign.  RAT infections can be very serious, requiring an in-depth investigation to determine the goals of the attacker and the level of risk posed.</p>
<p>Future articles covering other RAT threats will emerge as part of the “Exterminating a RAT” series.</p>
<p><strong>References</strong>:</p>
<p><a href="/asert/2012/03/its-not-the-end-of-the-world-darkcomet-misses-by-a-mile/">/asert/2012/03/its-not-the-end-of-the-world-darkcomet-misses-by-a-mile/</a></p>
<p><a href="/asert/wp-content/uploads/2012/07/Crypto-DarkComet-Report.pdf">/asert/wp-content/uploads/2012/03/Crypto-DarkComet-Report.pdf</a></p>
<p><a href="http://blog.trendmicro.com/darkcomet-surfaced-in-the-targeted-attacks-in-syrian-conflict/">http://blog.trendmicro.com/darkcomet-surfaced-in-the-targeted-attacks-in-syrian-conflict/</a></p>
<p><a href="http://resources.infosecinstitute.com/darkcomet-analysis-syria/">http://resources.infosecinstitute.com/darkcomet-analysis-syria/</a></p>
<p>&nbsp;</p>
						</div>

						<!-- post footer -->
						<footer class="entry-footer">
							<div class="comments-count">
								<a href="http://www.arbornetworks.com/asert/2012/07/exterminating-the-rat-part-i-dissecting-dark-comet-campaigns/#comments" class="comments-count-number">1Comments</a>
							</div>

							<ul class="entry-taxonomies">
								<li>
									Tagged:									<ul class="entry-list entry-list-tags">
										<li class="entry entry-tags"></li>
									</ul>
								</li>

								<li>
									Filed under:									<ul class="entry-list entry-list-categories">
										<li class="entry entry-categories"><a href="http://www.arbornetworks.com/asert/category/arbor-networks-ddos-experts/" title="View all posts in Arbor Networks - DDoS Experts" rel="category tag">Arbor Networks - DDoS Experts</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/atlas/" title="View all posts in ATLAS" rel="category tag">ATLAS</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/ddos-attacks/" title="View all posts in Attacks and DDoS Attacks" rel="category tag">Attacks and DDoS Attacks</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/interesting-research/" title="View all posts in Interesting Research" rel="category tag">Interesting Research</a></li><li>,<a href="http://www.arbornetworks.com/asert/category/malware/" title="View all posts in Malware" rel="category tag">Malware</a></li>
									</ul>
								</li>
							</ul>
						</footer>

					</article>
				
				<!-- post loop error message -->
				
				<p><a href="http://www.arbornetworks.com/asert/category/interesting-research/page/2/" >Go Back In Time &rarr;</a></p>
			</section>
		</div>

		<div class="l-column-right">
			<span class="column-title">featuring</span>
			<aside id="sidebar" role="complementary">
				<article id="text-4" class="widget widget_text"><h3 class="widget-title">Arbor Sert</h3>			<div class="textwidget"><p>This blog is the public home of our research, commentary, analysis and industry observations. Like the company itself, our blog features a wide variety of talented individual contributors, from world-renowned security researchers on Arbor’s Security Engineering & Response Team (ASERT) to product managers, engineers and architects, to the office of the CTO. As experts, they all bring an interesting mix of subject matter expertise and experience to the conversation.
</p><p>
Arbor is a company with a history rooted in groundbreaking research at the University of Michigan a decade ago, and we remain researchers at heart. We hope you find our perspective interesting and we welcome your comments and feedback.
</p></div>
		</article><div class="widget">
<h3 class="slider-label widget-title">Live Data Feed</h3>
<div class="data-feed">
<div class="flexslider-sm-wrap">
<div class="slider-sm flexslider-sm">
<ul id='active-threat-metrics' class='slides'>
<li>
<div><div>
<span class='data-feed-num large'>
6027
</span>
<span class='metric-info'>
DDoS Attacks Per Day Worldwide
</span>
</div></div>
</li>
<li>
<div><div>
<span class='metric-num'>
71.8
</span>
<span class='metric-info'>
 Peak Attack in Gbps Past 24 Hours
</span>
</div></div>
</li>
<li>
<div><div>
<span class='metric-num'>
785
</span>
<span class='metric-info'>
 Active Botnets Detected
</span>
</div></div>
</li>
</ul>
</div>
</div>
</div>
<footer class="happening-right-now-module-footer">
<a href="http://atlas.arbor.net"><img src="//arbornetworks.com/images/atlas.png" alt="Atlas"><span class="feed-link">Feed based on ATLAS data</span></a>
</footer>
</div>
<article id="tag_cloud-2" class="widget widget_tag_cloud"><h3 class="widget-title">Tag Cloud</h3><div class="tagcloud"><a href='http://www.arbornetworks.com/asert/tag/end-of-internet/' class='tag-link-51' title='2 topics' style='font-size: 10.709677419355pt;'>"End of Internet"</a>
<a href='http://www.arbornetworks.com/asert/tag/500-internal-ddos/' class='tag-link-52' title='1 topic' style='font-size: 8pt;'>500 Internal DDoS</a>
<a href='http://www.arbornetworks.com/asert/tag/504/' class='tag-link-53' title='1 topic' style='font-size: 8pt;'>504</a>
<a href='http://www.arbornetworks.com/asert/tag/add-new-tag/' class='tag-link-54' title='2 topics' style='font-size: 10.709677419355pt;'>Add new tag</a>
<a href='http://www.arbornetworks.com/asert/tag/albaddos/' class='tag-link-55' title='1 topic' style='font-size: 8pt;'>AlbaDDoS</a>
<a href='http://www.arbornetworks.com/asert/tag/aldi/' class='tag-link-56' title='1 topic' style='font-size: 8pt;'>Aldi</a>
<a href='http://www.arbornetworks.com/asert/tag/aldi-bot/' class='tag-link-57' title='1 topic' style='font-size: 8pt;'>Aldi Bot</a>
<a href='http://www.arbornetworks.com/asert/tag/algorithm/' class='tag-link-58' title='1 topic' style='font-size: 8pt;'>algorithm</a>
<a href='http://www.arbornetworks.com/asert/tag/arbor-networks-ddos-experts/' class='tag-link-3' title='3 topics' style='font-size: 12.516129032258pt;'>Arbor Networks - DDoS Experts</a>
<a href='http://www.arbornetworks.com/asert/tag/armageddon/' class='tag-link-59' title='3 topics' style='font-size: 12.516129032258pt;'>Armageddon</a>
<a href='http://www.arbornetworks.com/asert/tag/attack/' class='tag-link-60' title='1 topic' style='font-size: 8pt;'>attack</a>
<a href='http://www.arbornetworks.com/asert/tag/attacks/' class='tag-link-61' title='1 topic' style='font-size: 8pt;'>Attacks</a>
<a href='http://www.arbornetworks.com/asert/tag/beer-ddos/' class='tag-link-62' title='1 topic' style='font-size: 8pt;'>Beer DDoS</a>
<a href='http://www.arbornetworks.com/asert/tag/bgp/' class='tag-link-63' title='3 topics' style='font-size: 12.516129032258pt;'>BGP</a>
<a href='http://www.arbornetworks.com/asert/tag/black-peace-group/' class='tag-link-64' title='1 topic' style='font-size: 8pt;'>Black Peace Group</a>
<a href='http://www.arbornetworks.com/asert/tag/bot/' class='tag-link-67' title='2 topics' style='font-size: 10.709677419355pt;'>Bot</a>
<a href='http://www.arbornetworks.com/asert/tag/botnet/' class='tag-link-68' title='6 topics' style='font-size: 16.279569892473pt;'>Botnet</a>
<a href='http://www.arbornetworks.com/asert/tag/botnets/' class='tag-link-7' title='2 topics' style='font-size: 10.709677419355pt;'>Botnets</a>
<a href='http://www.arbornetworks.com/asert/tag/china/' class='tag-link-72' title='2 topics' style='font-size: 10.709677419355pt;'>China</a>
<a href='http://www.arbornetworks.com/asert/tag/crypto/' class='tag-link-76' title='2 topics' style='font-size: 10.709677419355pt;'>Crypto</a>
<a href='http://www.arbornetworks.com/asert/tag/danny-mcpherson/' class='tag-link-82' title='2 topics' style='font-size: 10.709677419355pt;'>Danny McPherson</a>
<a href='http://www.arbornetworks.com/asert/tag/ddos/' class='tag-link-87' title='16 topics' style='font-size: 22pt;'>ddos</a>
<a href='http://www.arbornetworks.com/asert/tag/denial-of-service-attack/' class='tag-link-93' title='2 topics' style='font-size: 10.709677419355pt;'>Denial-of-service attack</a>
<a href='http://www.arbornetworks.com/asert/tag/dirt-jumper/' class='tag-link-94' title='2 topics' style='font-size: 10.709677419355pt;'>Dirt Jumper</a>
<a href='http://www.arbornetworks.com/asert/tag/down/' class='tag-link-99' title='2 topics' style='font-size: 10.709677419355pt;'>down</a>
<a href='http://www.arbornetworks.com/asert/tag/facebook/' class='tag-link-106' title='2 topics' style='font-size: 10.709677419355pt;'>Facebook</a>
<a href='http://www.arbornetworks.com/asert/tag/google/' class='tag-link-114' title='5 topics' style='font-size: 15.225806451613pt;'>Google</a>
<a href='http://www.arbornetworks.com/asert/tag/halloween/' class='tag-link-118' title='2 topics' style='font-size: 10.709677419355pt;'>Halloween</a>
<a href='http://www.arbornetworks.com/asert/tag/hijack/' class='tag-link-119' title='2 topics' style='font-size: 10.709677419355pt;'>hijack</a>
<a href='http://www.arbornetworks.com/asert/tag/internet/' class='tag-link-128' title='2 topics' style='font-size: 10.709677419355pt;'>internet</a>
<a href='http://www.arbornetworks.com/asert/tag/internet-protocol/' class='tag-link-129' title='2 topics' style='font-size: 10.709677419355pt;'>Internet Protocol</a>
<a href='http://www.arbornetworks.com/asert/tag/internet-service-provider/' class='tag-link-130' title='8 topics' style='font-size: 17.784946236559pt;'>Internet service provider</a>
<a href='http://www.arbornetworks.com/asert/tag/internet-traffic/' class='tag-link-131' title='8 topics' style='font-size: 17.784946236559pt;'>Internet traffic</a>
<a href='http://www.arbornetworks.com/asert/tag/ipv4/' class='tag-link-20' title='2 topics' style='font-size: 10.709677419355pt;'>IPv4</a>
<a href='http://www.arbornetworks.com/asert/tag/ipv6/' class='tag-link-21' title='3 topics' style='font-size: 12.516129032258pt;'>IPv6</a>
<a href='http://www.arbornetworks.com/asert/tag/iran/' class='tag-link-135' title='2 topics' style='font-size: 10.709677419355pt;'>Iran</a>
<a href='http://www.arbornetworks.com/asert/tag/malware-2/' class='tag-link-139' title='2 topics' style='font-size: 10.709677419355pt;'>malware</a>
<a href='http://www.arbornetworks.com/asert/tag/network/' class='tag-link-149' title='2 topics' style='font-size: 10.709677419355pt;'>network</a>
<a href='http://www.arbornetworks.com/asert/tag/outage/' class='tag-link-156' title='4 topics' style='font-size: 14.021505376344pt;'>outage</a>
<a href='http://www.arbornetworks.com/asert/tag/peering/' class='tag-link-158' title='3 topics' style='font-size: 12.516129032258pt;'>peering</a>
<a href='http://www.arbornetworks.com/asert/tag/security/' class='tag-link-169' title='5 topics' style='font-size: 15.225806451613pt;'>Security</a>
<a href='http://www.arbornetworks.com/asert/tag/streaming-media/' class='tag-link-177' title='2 topics' style='font-size: 10.709677419355pt;'>Streaming media</a>
<a href='http://www.arbornetworks.com/asert/tag/traffic/' class='tag-link-182' title='2 topics' style='font-size: 10.709677419355pt;'>traffic</a>
<a href='http://www.arbornetworks.com/asert/tag/wikileaks/' class='tag-link-191' title='3 topics' style='font-size: 12.516129032258pt;'>Wikileaks</a>
<a href='http://www.arbornetworks.com/asert/tag/youtube/' class='tag-link-197' title='4 topics' style='font-size: 14.021505376344pt;'>YouTube</a></div>
</article>			</aside>
		</div>

	</div>
</div>
<footer class="footer footer-primary clearfix" role="contentinfo">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-P2XR"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P2XR');</script>
<!-- End Google Tag Manager -->


	<div class="l-wrapper l-wrapper-footer">
		<div class="l-column-left clearfix">

<div class="menu-footer-container"><ul id="menu-footer" class="menu"><li id="menu-item-5416" class="disclaimer-info menu-item menu-item-type-custom menu-item-object-custom menu-item-5416"><a href="/">Corporate Site  |</a></li>
<li id="menu-item-5414" class="disclaimer-info menu-item menu-item-type-custom menu-item-object-custom menu-item-5414"><a href="/threats/">Threat Portal  |</a></li>
<li id="menu-item-5415" class="disclaimer-info menu-item menu-item-type-custom menu-item-object-custom menu-item-5415"><a href="http://atlas.arbor.net">ATLAS Portal  |</a></li>
<li id="menu-item-5417" class="disclaimer-info menu-item menu-item-type-custom menu-item-object-custom menu-item-5417"><a href="/privacy-policy/">Privacy Policy  |</a></li>
<li id="menu-item-5418" class="disclaimer-info menu-item menu-item-type-custom menu-item-object-custom menu-item-5418"><a href="/legal-notice/">Legal</a></li>
</ul></div>
			<!-- WPFlex vCard -->
			
							<!-- fn org -->
				<section id="wpflex-options">
					<ul class="dashboard-options">
						<!-- fn org -->
													<li class="fnorg"><small>© Copyright 2014 Arbor Networks, All rights reserved</small></li>  
						
						<!-- adr -->
													<li class="disclaimer">
								<small class="disclaimer-info">
									<span>Arbor Networks is a global provider of DDoS attack prevention, network security and visibility solutions. To find out more, visit <a href="http://www.arbornetworks.com/">http://www.arbornetworks.com/</a></span>
								</small>
							</li>
											</ul>
				</section>
			</div>
			
		<div class="l-column-right">
			<ul id="footer-socials">
				<!-- Linkedin -->
													<li id="footer-linkedin">
						<div class="linkedin">
						  <a href="http://www.linkedin.com/company/arbor-networks" rel="external"><img src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/img/linkedin.png" alt=""></a>
						</div>
					</li>
				
				<!-- Twitter -->
													<li id="footer-twitter">
						<div class="twitter">
						  <a href="https://twitter.com/arbornetworks" rel="external"><img src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/img/twitter.png" alt=""></a>
						</div>
					</li>
				
				<!-- Pinterest -->
													<li id="footer-pinterest">
						<div class="pinterest">
						  <a href="http://www.youtube.com/user/ArborNetworks" rel="external"><img src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/img/pinterest.png" alt=""></a>
						</div>
					</li>
				
				<!-- Slideshare -->
													<li id="footer-slideshare">
						<div class="slideshare">
						  <a href="http://www.slideshare.net/Arbor_Networks" rel="external"><img src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/img/slideshare.png" alt=""></a>
						</div>
					</li>
				
				<!-- Youtube -->
													<li id="footer-youtube">
						<div class="youtube">
						  <a href="http://www.youtube.com/user/ArborNetworks" rel="external"><img src="http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/img/youtube.png" alt=""></a>
						</div>
					</li>
							</ul>
		</div>
	</div>
</footer>
<link rel='stylesheet' id='gigpress-css-css'  href='http://www.arbornetworks.com/asert/wp-content/plugins/gigpress/css/gigpress.css?ver=3.8.2' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arbornetworks.com/asert/wp-content/themes/atlas-blog-theme/js/minified/main-min.js?ver=1.0.5'></script>
</body>
</html>
