http://virtuallyhyper.com/2013/02/fixing-android-phone-device-permissions-on-fedora-17/
HTTP/1.1 200 OK
Server: cloudflare-nginx
Date: Tue, 22 Jul 2014 19:45:15 GMT
Content-Type: text/html; charset=utf-8
Connection: close
Set-Cookie: __cfduid=dcfc10f9420554eaa5fa3d0a8f860b1d71406058315508; expires=Mon, 23-Dec-2019 23:50:00 GMT; path=/; domain=.virtuallyhyper.com; HttpOnly
Last-Modified: Wed, 16 Jul 2014 15:19:03 GMT
Expires: Tue, 22 Jul 2014 19:55:15 GMT
Cache-Control: max-age=600
Vary: Accept-Encoding
CF-RAY: 14e22337e7f50f21-IAD
Content-Encoding: gzip


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Fixing Android Phone Device Permissions on Fedora 17</title>
<meta name="author" content="VirtuallyHyper">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
 
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dokv=88e434a982/"},atok:"d9334430380701569218b38c564f4a86",petok:"4e6384c2355e7b111532f88865df57d95a783636-1406058315-1800",zone:"virtuallyhyper.com",rocket:"0",apps:{"ga_key":{"ua":"UA-7265705-7","ga_bs":"2"}}}];!function(a,b){a=document.createElement("script"),b=document.getElementsByTagName("script")[0],a.async=!0,a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dokv=97fb4d042e/cloudflare.min.js",b.parentNode.insertBefore(a,b)}()}}catch(e){};
//]]>
</script>
<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
 
<script type="text/javascript">
//<![CDATA[
  (function() {
    var shr = document.createElement('script');
    shr.setAttribute('data-cfasync', 'false');
    shr.src = '//dsms0mj1bbhn4.cloudfront.net/assets/pub/shareaholic.js';
    shr.type = 'text/javascript'; shr.async = 'true';
    shr.onload = shr.onreadystatechange = function() {
      var rs = this.readyState;
      if (rs && rs != 'complete' && rs != 'loaded') return;
      var site_id = 'a59cdffe14bc028831ad82e874afb210';
      try { Shareaholic.init(site_id); } catch (e) {}
    };
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(shr, s);
  })();
//]]>
</script>
 
<link href="/assets/themes/twitter-2.0/css/bootstrap.min.css" rel="stylesheet">
<style type="text/css" media="screen">body{padding-top:60px; }</style>
<link href="/assets/themes/twitter-2.0/css/bootstrap-responsive.min.css" rel="stylesheet">
<link href="/assets/themes/twitter-2.0/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
<link href="/assets/themes/twitter-2.0/css/syntax.css" rel="stylesheet" type="text/css">
 
<link rel="shortcut icon" href="/assets/themes/twitter-2.0/favicon.ico">
 
<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-7265705-7']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>
<a class="brand" href="/">VirtuallyHyper</a>
<div class="nav-collapse">
<ul class="nav navbar-nav">
<li><a href="/about.html">About</a></li>
<li><a href="/archive.html">Archive</a></li>
<li><a href="/categories.html">Categories</a></li>
<li><a href="/search.html">Search</a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Certifications <b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="/2012/08/vcap5-dcd/">VCAP_DCD</a></li>
<li><a href="/2012/09/vcap5-dca/">VCAP_DCA</a></li>
<li class="divider"></li>
<li><a href="/2012/12/rhcsa-and-rhce-study-guide/">RHCSA_RCHE</a></li>
</ul>
</li>
</ul>
</div> 
</div>
</div>
</div>
<div class="container-fluid">
<div class="row-fluid">
<div class="span8">
<div class="content">
<div class="page-header">
<h1>Fixing Android Phone Device Permissions on Fedora 17</h1>
</div>
<i class="fa fa-calendar"></i> 13 February 2013 <i class="fa fa-user"></i> <a href="http://virtuallyhyper.com">Karim Elatov</a> <div style="float: right;"><i class="fa fa-comments"></i> <a href="/2013/02/fixing-android-phone-device-permissions-on-fedora-17/#disqus_thread"></a></div>
<div class="tag_box">
<i class="fa fa-tags"></i>
<a href="/tags.html#/dev/bus/usb/001/019-ref">/dev/bus/usb/001/019 <span>1</span></a>
<a href="/tags.html#/dev/sdb-ref">/dev/sdb <span>1</span></a>
<a href="/tags.html#/etc/udev/rules.d/-ref">/etc/udev/rules.d/ <span>1</span></a>
<a href="/tags.html#/lib/udev/rules.d/50-udev-default.rules-ref">/lib/udev/rules.d/50-udev-default.rules <span>1</span></a>
<a href="/tags.html#adb-ref">adb <span>2</span></a>
<a href="/tags.html#dmesg-ref">dmesg <span>1</span></a>
<a href="/tags.html#HTC-ref">HTC <span>1</span></a>
<a href="/tags.html#lsusb-ref">lsusb <span>1</span></a>
<a href="/tags.html#systemctl-ref">systemctl <span>3</span></a>
<a href="/tags.html#udev-ref">udev <span>1</span></a>
<a href="/tags.html#udevadm-ref">udevadm <span>1</span></a>
<a href="/tags.html#udevadm control --reload-rules-ref">udevadm control --reload-rules <span>1</span></a>
</div>
<hr>
<p>I was connecting my <em>HTC</em> phone to another <em>Fedora</em> computer and I realized I didn’t have appropriate permissions to the device. After I plugged in the device, <strong>adb</strong> gave me the following error:</p>
<pre><code>moxz:~&gt;/usr/local/android/platform-tools/adb devices -l
* daemon not running. starting it now on port 5037 *
* daemon started successfully *
List of devices attached
???????????? no permissions usb:1-2
</code></pre>
<p><em>Googling</em> around I found <a href="http://ptspts.blogspot.com/2011/10/how-to-fix-adb-no-permissions-error-on.html">page</a> as well. The blog post was for <em>Ubuntu</em> and it included a lot of phones, which I didn’t really need. So I decided to create my own <em>udev</em> rules for my <em>Fedora</em> 17 install. The first thing that we need to is figure out the device path of our usb phone. After plugging the phone into the usb slot, we will see the following in <strong>dmesg</strong>:</p>
<pre><code>moxz:~&gt;dmesg | tail -11
[1004050.455351] usb 1-2: USB disconnect, device number 18
[1004060.234058] usb 1-2: new full-speed USB device number 19 using ohci_hcd
[1004060.426808] usb 1-2: New USB device found, idVendor=0bb4, idProduct=0c86
[1004060.426816] usb 1-2: New USB device strings: Mfr=2, Product=3, SerialNumber=4
[1004060.426820] usb 1-2: Product: HTC
[1004060.426823] usb 1-2: Manufacturer: HTC
[1004060.426826] usb 1-2: SerialNumber: HT164T500742
[1004060.434233] scsi18 : usb-storage 1-2:1.0
[1004061.444207] scsi 18:0:0:0: Direct-Access HTC File-CD Gadget 0000 PQ: 0 ANSI: 2
[1004061.450206] sd 18:0:0:0: Attached scsi generic sg3 type 0
[1004061.468162] sd 18:0:0:0: [sdb] Attached SCSI removable disk
</code></pre>
<p>We can see that our phone device is <strong>sdb</strong>, now using <em>udev</em> we can query the device for more information, like so:</p>
<pre><code>moxz:~&gt;udevadm info -q all -n /dev/sdb
P: /devices/pci0000:00/0000:00:02.2/usb1/1-2/1-2:1.0/host18/target18:0:0/18:0:0:0/block/sdb
N: sdb
S: disk/by-id/usb-HTC_File-CD_Gadget_HT164T500742-0:0
S: disk/by-path/pci-0000:00:02.2-usb-0:2:1.0-scsi-0:0:0:0
E: DEVLINKS=/dev/disk/by-id/usb-HTC_File-CD_Gadget_HT164T500742-0:0 /dev/disk/by-path/pci-0000:00:02.2-usb-0:2:1.0-scsi-0:0:0:0
E: DEVNAME=/dev/sdb
E: DEVPATH=/devices/pci0000:00/0000:00:02.2/usb1/1-2/1-2:1.0/host18/target18:0:0/18:0:0:0/block/sdb
E: DEVTYPE=disk
E: ID_BUS=usb
E: ID_INSTANCE=0:0
E: ID_MODEL=File-CD_Gadget
E: ID_MODEL_ENC=File-CD\x20Gadget\x20\x20
E: ID_MODEL_ID=0c86
E: ID_PATH=pci-0000:00:02.2-usb-0:2:1.0-scsi-0:0:0:0
E: ID_PATH_TAG=pci-0000_00_02_2-usb-0_2_1_0-scsi-0_0_0_0
E: ID_REVISION=0000
E: ID_SERIAL=HTC_File-CD_Gadget_HT164T500742-0:0
E: ID_SERIAL_SHORT=HT164T500742
E: ID_TYPE=disk
E: ID_USB_DRIVER=usb-storage
E: ID_USB_INTERFACES=:080650:ff4201:
E: ID_USB_INTERFACE_NUM=00
E: ID_VENDOR=HTC
E: ID_VENDOR_ENC=HTC\x20\x20\x20\x20\x20
E: ID_VENDOR_ID=0bb4
E: MAJOR=8
E: MINOR=16
E: SUBSYSTEM=block
E: TAGS=:systemd:
E: UDISKS_PRESENTATION_NOPOLICY=0
E: USEC_INITIALIZED=1004061498268
</code></pre>
<p>The most important information is the following:</p>
<pre><code>P: DEVPATH=/devices/pci0000:00/0000:00:02.2/usb1/1-2/1-2:1.0/host18/target18:0:0/18:0:0:0/block/sdb
E: ID_SERIAL_SHORT=HT164T500742
E: ID_VENDOR=HTC
E: ID_VENDOR_ID=0bb4
</code></pre>
<p>Now based on that information we need to create a <em>udev</em> rule to allow <em>others</em> to write to the device. Actually using <em>udev</em> again, we can print a more ‘udev’ friendly output, like this:</p>
<pre><code>moxz:~&gt;udevadm info -a -p /devices/pci0000:00/0000:00:02.2/usb1/1-2
Udevadm info starts with the device specified by the devpath and then
walks up the chain of parent devices. It prints for every device
found, all possible attributes in the udev rules key format.
A rule to match, can be composed by the attributes of the device
and the attributes from one single parent device.

looking at device '/devices/pci0000:00/0000:00:02.2/usb1/1-2':
KERNEL=="1-2"
SUBSYSTEM=="usb"
DRIVER=="usb"
ATTR{configuration}==""
ATTR{bNumInterfaces}==" 2"
ATTR{bConfigurationValue}=="1"
ATTR{bmAttributes}=="80"
ATTR{bMaxPower}==" 2mA"
ATTR{urbnum}=="2662"
ATTR{idVendor}=="0bb4"
ATTR{idProduct}=="0c86"
ATTR{bcdDevice}=="0228"
ATTR{bDeviceClass}=="00"
ATTR{bDeviceSubClass}=="00"
ATTR{bDeviceProtocol}=="00"
ATTR{bNumConfigurations}=="1"
ATTR{bMaxPacketSize0}=="64"
ATTR{speed}=="12"
ATTR{busnum}=="1"
ATTR{devnum}=="19"
ATTR{devpath}=="2"
ATTR{version}==" 2.00"
ATTR{maxchild}=="0"
ATTR{quirks}=="0x0"
ATTR{avoid_reset_quirk}=="0"
ATTR{authorized}=="1"
ATTR{manufacturer}=="HTC"
ATTR{product}=="HTC"
ATTR{serial}=="HT164T500742"
</code></pre>
<p>Now copying the above output, let’s create a new rule file called <strong>/etc/udev/rules.d/51-phone.rules</strong> and put the following into it:</p>
<pre><code>SUBSYSTEM=="usb",ATTR{idVendor}=="0bb4",GROUP="elatov",MODE="0666"
</code></pre>
<p>The reason why the file is numbered 51 is because by default the system <em>udev</em> rules change the permission of all USB devices to <em>664</em> in rule number 50. Here is the file and line that does that:</p>
<pre><code>moxz:~&gt;grep usb /lib/udev/rules.d/50-udev-default.rules | grep MODE
SUBSYSTEM=="usb", ENV{DEVTYPE}=="usb_device", MODE="0664"
</code></pre>
<p>So we need to make sure our rule loads after that one (therefore we are 51).Now let’s reload the rules and restart the <em>udev</em> daemon:</p>
<pre><code>moxz:~&gt;sudo udevadm control --reload-rules
moxz:~&gt;sudo systemctl restart udev
moxz:~&gt;sudo systemctl status udev
udev.service - udev Kernel Device Manager
Loaded: loaded (/usr/lib/systemd/system/udev.service; static)
Active: active (running) since Tue, 05 Feb 2013 13:28:13 -0800; 5s ago
Main PID: 28367 (udevd)
CGroup: name=systemd:/system/udev.service
└ 28367 /usr/lib/udev/udevd
</code></pre>
<p>That looks good. Now we have to uplug the device and plug it back it. First let’s check out the current permissions on the USB device. Here is a list of the USB devices on the <em>Fedora</em> machine:</p>
<pre><code>moxz:~&gt;lsusb
Bus 001 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 001 Device 002: ID 413c:3200 Dell Computer Corp. Mouse
Bus 001 Device 019: ID 0bb4:0c86 High Tech Computer Corp.
</code></pre>
<p>The last one is the phone (bus 001, device 019), now checking out the permissions of the file corresponding to that device, we see this:</p>
<pre><code>moxz:~&gt;ls -l /dev/bus/usb/001/019
crw-rw-r-- 1 root root 189, 18 Feb 5 13:06 /dev/bus/usb/001/019
</code></pre>
<p>Now unplugging the phone and plugging it back in, we see the following:</p>
<pre><code>moxz:~&gt;lsusb
Bus 001 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 001 Device 002: ID 413c:3200 Dell Computer Corp. Mouse
Bus 001 Device 020: ID 0bb4:0c86 High Tech Computer Corp.
</code></pre>
<p>We can see that the device <em>ID</em> has changed. Now checking out the permissions of the new file:</p>
<pre><code>moxz:~&gt;ls -l /dev/bus/usb/001/020
crw-rw-rw- 1 root root 189, 19 Feb 5 13:31 /dev/bus/usb/001/020
</code></pre>
<p>That’s all good. Now listing the available devices with <strong>adb</strong>, we see the following:</p>
<pre><code>moxz:~&gt;adb devices
List of devices attached
HT164T500742 device
</code></pre>
<div class='shareaholic-canvas' data-app='share_buttons' data-app-id='6778737' style="float: left"></div>
<div class="pagination" style="float: right">
<ul>
<li class="prev"><a href="/2013/01/organizing-your-music-library-using-acoustic-fingerprinting/" title="Organizing Your Music Library Using Acoustic Fingerprinting">&larr; Previous</a></li>
<li><a href="/archive.html">Archive</a></li>
<li class="next"><a href="/2013/02/installing-musiccabinet-on-top-of-subsonic/" title="Installing MusicCabinet on Top of SubSonic">Next &rarr;</a></li>
</ul>
</div>
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
 
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-7439655074445804" data-ad-slot="4448070391"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_shortname = 'virtuallyhyper'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</div>
<div class="span4">
<div class="sidebar">
<div class="social sidebar-item">
<a href="https://twitter.com/virtuallyhyper" class="twitter-follow-button" data-show-count="false">Follow @virtuallyhyper</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>
<div class="sidebar-item">
<h2>Want to support us?</h2>
<a href="http://bit.ly/donate-to-virtuallyhyper" target="_blank">
<img src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif"/>
</a>
<a href="http://flattr.com/thing/1101166/VirtuallyHyper" target="_blank">
<img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0"/></a>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script type="text/javascript" src="https://blockchain.info//Resources/wallet/pay-now-button.js"></script>
<div style="font-size:8px;margin:0 auto;width:100%" class="blockchain-btn" data-address="1LbaicuGY3RsusHonGmwhXWaUw2yYnj2k3" data-shared="false">
<div class="blockchain stage-begin">
<img src="http://i.imgur.com/zTI9f5u.png"/>
</div>
<div class="blockchain stage-loading" style="text-align:center">
<img src="https://blockchain.info//Resources/loading-large.gif"/>
</div>
<div class="blockchain stage-ready">
<p align="center">Our Bitcoin Address: <b><br><small>[[address]]</small></b></p>
<p align="center" class="qr-code"></p>
</div>
<div class="blockchain stage-paid">
Donation of <b>[[value]] BTC</b> Received. Thank You.
</div>
<div class="blockchain stage-error">
<font color="red">[[error]]</font>
</div>
</div>
<script type='text/javascript'>
              var amzn_wdgt={widget:'MyFavorites'};
              amzn_wdgt.tag='virtuallyhyper-20';
              amzn_wdgt.columns='1';
              amzn_wdgt.rows='3';
              amzn_wdgt.title='Henri-Cartier-Bresson: Photographer Extraordinaire';
              amzn_wdgt.width='250';
              amzn_wdgt.ASIN='0893817449,0500410607,050054199X,0500286426,0893818755,050054333X,0500543178,0945506562';
              amzn_wdgt.showImage='True';
              amzn_wdgt.showPrice='True';
              amzn_wdgt.showRating='True';
              amzn_wdgt.design='2';
              amzn_wdgt.colorTheme='Orange';
              amzn_wdgt.headerTextColor='#FFFFFF';
              amzn_wdgt.marketPlace='US';
            </script>
<script type='text/javascript' src='http://wms-na.amazon-adsystem.com/20070822/US//js/AmazonWidgets.js'>
            </script>
</div> 
</div>
</div> 
</div> 
<footer>
<p>&copy;VirtuallyHyper 2014. Thoughts are our own and may not neccessarily represent the companies we work for.
</p>
</footer>
</div> 
 
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'virtuallyhyper'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
 
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/themes/twitter-2.0/js/jquery.min.js"><\/script>')</script>
 
<script src="/assets/themes/twitter-2.0/js/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7265705-7', 'virtuallyhyper.com');
  ga('send', 'pageview');

</script>
</body>
</html>

