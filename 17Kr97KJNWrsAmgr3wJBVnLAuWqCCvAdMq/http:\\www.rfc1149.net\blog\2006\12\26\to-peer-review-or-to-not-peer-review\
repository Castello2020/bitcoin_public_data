http://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/
HTTP/1.1 200 OK
Server: nginx/1.4.7
Date: Tue, 22 Jul 2014 15:41:42 GMT
Content-Type: text/html
Content-Length: 22354
Last-Modified: Wed, 18 Jun 2014 08:12:08 GMT
Connection: close
ETag: "53a149d8-5752"
X-XRDS-Location: http://www.myopenid.com/xrds?username=tardieu.myopenid.com
Strict-Transport-Security: max-age=60000
Accept-Ranges: bytes

<!DOCTYPE html>
<html lang="en" prefix="foaf: http://xmlns.com/foaf/0.1/ schema: http://schema.org/ dc: http://purl.org/dc/terms/">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="../../../../../css/stylesheet-2.css" type="text/css" />
<link rel="shortcut icon" href="../../../../../wwwicons/pigeon-16.png" />
<title>To peer review or to not peer review?</title>
<link rel="canonical" href="https://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/" />
<!--[if lt IE 9]>
<script type="text/javascript">
// html5shiv MIT @rem remysharp.com/html5-enabling-script
// iepp v1.6.2 MIT @jon_neal iecss.com/print-protector
/*@cc_on(function(m,c){var z="abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video";function n(d){for(var a=-1;++a<o;)d.createElement(i[a])}function p(d,a){for(var e=-1,b=d.length,j,q=[];++e<b;){j=d[e];if((a=j.media||a)!="screen")q.push(p(j.imports,a),j.cssText)}return q.join("")}var g=c.createElement("div");g.innerHTML="<z>i</z>";if(g.childNodes.length!==1){var i=z.split("|"),o=i.length,s=RegExp("(^|\\s)("+z+")",
"gi"),t=RegExp("<(/*)("+z+")","gi"),u=RegExp("(^|[^\\n]*?\\s)("+z+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),r=c.createDocumentFragment(),k=c.documentElement;g=k.firstChild;var h=c.createElement("body"),l=c.createElement("style"),f;n(c);n(r);g.insertBefore(l,
g.firstChild);l.media="print";m.attachEvent("onbeforeprint",function(){var d=-1,a=p(c.styleSheets,"all"),e=[],b;for(f=f||c.body;(b=u.exec(a))!=null;)e.push((b[1]+b[2]+b[3]).replace(s,"$1.iepp_$2")+b[4]);for(l.styleSheet.cssText=e.join("\n");++d<o;){a=c.getElementsByTagName(i[d]);e=a.length;for(b=-1;++b<e;)if(a[b].className.indexOf("iepp_")<0)a[b].className+=" iepp_"+i[d]}r.appendChild(f);k.appendChild(h);h.className=f.className;h.innerHTML=f.innerHTML.replace(t,"<$1font")});m.attachEvent("onafterprint",
function(){h.innerHTML="";k.removeChild(h);k.appendChild(f);l.styleSheet.cssText=""})}})(this,document);@*/
</script>
<![endif]-->

<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = '//api.flattr.com/js/0.6/load.js?mode=auto&uid=oneeyed&button=compact&category=text&language=en_GB';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */</script>
<link rel="openid.server" href="https://www.myopenid.com/server" />
<link rel="openid.delegate" href="https://tardieu.myopenid.com" />
<link rel="openid2.local_id" href="https://tardieu.myopenid.com" />
<link rel="openid2.provider" href="https://www.myopenid.com/server" />
<link rel="alternate" type="application/atom+xml" title="An avian carrier's blog" href="https://www.rfc1149.net/blog/feed/" />
<link rel="author" title="Samuel Tardieu" href="../../../../../sam.html" />

<meta name="description" content="2006-12-26-to-peer-review-or-to-not-peer-review">
<link rel="contents" title="Archives" href="../../../../../blog/" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/" />
<meta name="twitter:title" content="To peer review or to not peer review?" />
<meta name="twitter:description" content="As an experienced programmer, I participate in many Free Software projects when time permits. I am committed to a few projects, and I frequently submit" />
<meta name="twitter:site:id" content="1185642952" />
<meta name="twitter:creator:id" content="1185642952" />



</head>
<body>
<div id="wholebody">
<div id="content">
<nav id="page-navigation">
  <div class="floatleft">
  <a href="../../../../../blog/2006/10/28/geeky-show/" lang="en" rel="prev" title="Previous blog post: Geeky show">Geeky show</a>
</div>

  <div class="floatright">
  <a href="../../../../../blog/2006/12/30/reading-a-dvd-with-vlc-or-mplayer-is-now-illegal-in-france/" lang="en" rel="next" title="Next blog post: Reading a DVD with VLC or mplayer is now illegal in France" class="langleft">Reading a DVD with VLC or mplayer is now illegal in France</a>
</div>

</nav>
<article typeof="schema:BlogPosting">
  <header>
    
    <div id="title"><h1 property="schema:name">To peer review or to not peer review?</h1></div>
    <div id="authorship">
      <p>
	<a href="../../../../../sam.html" rel="author">Samuel Tardieu</a>,
	<time property="schema:datePublished">2006-12-26</time>
      </p>
    </div>
  </header>
  <div property="schema:articleBody">
    <p>As an experienced programmer, I participate in many Free Software projects when time permits. I am committed to a few projects, and I frequently submit patches to random projects that I happen to bump into. I also understand the dynamics of free software: when a bug stands in my way, I often fix it myself rather than waiting for another contributor (who may have her own priorities and agenda) to fix it. Same when I badly need a feature.</p>
<p>In this post, I will compare the submission process of two changes I made to free software recently:</p>
<ul>
<li>a new watchdog driver for the <a href="http://www.kernel.org/">Linux kernel</a>;</li>
<li>a fix for a critical flow in SIP message handling in the <a href="http://www.asterisk.org/">Asterisk</a> telephony system.</li>
</ul>
<h3 id="linux-device-driver">Linux device driver</h3>
<p>I first posted my new device driver code as a patch (a difference between the actual Linux source code and the modified one) on the <a href="http://lkml.org/">linux-kernel mailing-list</a>. Shortly after that, some people publicly answered my mail and offered remarks and criticisms about my changes. Most of the advices were well targeted and I modified my patch accordingly. Some of the remarks were a bit off because people commenting the code hadn’t read the device datasheet and were confused by some names used therein and mirrored into the driver; I explained the situation and why I would not act upon those remarks. One point about a possible concurrent access was discussed and resolved after a few technical exchanges. I then posted a modified patch for everyone to comment on. This later patch was then <i>acked</i> (i.e., blessed) by a major developer.</p>
<p>Various parts of the Linux kernel are maintained by different people. The device I was addressing was a watchdog (a piece of hardware that forcibly reboots your computer if the operating system fails to say “I’m still alive” on a regular basis), so the watchdog subsystem maintainer took responsability and integrated it into his own development tree, so that people willing to test this new driver could do so easily. After some time, while the new driver had shown not visible disturbance of the rest of the kernel, it was pulled by Linus Torvalds into the main Linux kernel tree and was released as part of Linux 2.6.19.</p>
<p>Note that when the watchdog subsystem maintainer integrated my new driver into his tree, he was already quite confident that the driver was clean as it had been carefully read and commented on by several other developers. The integration within his tree rather than into the main Linux kernel ensured that all the watchdog drivers can play nicely together.</p>
<h3 id="asterisk-flaw-in-the-sip-engine">Asterisk flaw in the SIP engine</h3>
<p><a href="http://adsl.free.fr/">Free Telecom</a> is the second most important ADSL provider in France. They provide a triple-play service over ADSL: IP, telephony and television. The telephony service can be accessed either using an analog phone connected to their ADSL modem or using a SIP connection to their server. On the server side, Free Telecom chose to use a solution by <a href="http://www.cirpack.com/">Cirpack</a>, made from boxes able to handle several thousands of simultaneous SIP sessions.</p>
<p>When the Cirpack server was upgraded at the beginning of December, all Asterisk boxes using Free Telecom as their SIP provider immediately stopped working: the voice was not going through anymore. This problem was signaled onto a forum by an Asterisk user a few hours after the upgrade and promptly analyzed by a Cirpack engineer: it appeared to be a flaw in Asterisk SIP handling. The engineer rolled back the Free Telecom server to the previous revision and sent me a mail with the description of the problem. Why me? Because we know each other as we studied together, and he knew I was using Asterisk to connect to the Free Telecom SIP server and that I was likely to quickly investigate and fix the problem.</p>
<p>A few hours later, I produced two short fixes for Asterisk and was able to test them against a Cirpack server running the new firmware. Everything went fine and the problem was fixed. I posted the patches to the <a href="http://bugs.digium.com/view.php?id=8524">Asterisk bug tracking system</a> and, less than four hours later, added full debugging information with and without the patches at the request of a manager so that it was clear what the problem was and how the patch fixed it.</p>
<p>I also sent several mails on the Asterisk developers mailing-list to underline the importance of the flaw. As long as the flaw is not fixed, any upgrade made by a VoIP provider may break all its Asterisk clients without any easy workaround. To describe the flaw shortly, an unpatched Asterisk doesn’t understand perfectly valid SIP headers and interprets them in a totally wrong way, causing the subsequent traffic to be sent to the wrong place.</p>
<p>Asterisk 1.4.0 was released 19 days after I explained this critical flaw and posted the patches to correct it. Not only were the patches not included in the release, but as far as I can tell no peer review has occurred on the patches. The only request made by a manager was that some developers, who have not yet answered, test the patch.</p>
<p>Also, at some point, this very same manager added a relationship between this problem and another one without any comment to explain this alleged relationship. As far as I can tell, the two bugs are totally unrelated and I fail to see any relationship between them except that they address two problems in SIP message processing, although one is about SIP headers syntax and the other one about the SIP engine internal state machine.</p>
<p>At this point, it is worth noting that I do not feel bad about Asterisk because my patches were not included in the latest release; what I criticize here is what I consider a lack of feedback on user-contributed fixes and a lack of interaction between developers.</p>
<h3 id="comparing-the-two-processes">Comparing the two processes</h3>
<p>Proposed changes to the Linux kernel are posted on a public mailing-list as plain-text, where anyone is free to comment on them. The plain-text format makes it easy to intersperse the relevant code portion with the comments. One or several structured discussions follow, each one addressing one aspect of the proposed patch. New versions of the patch may then be proposed and discussed until the patch is finally blessed (acked) by one or more fellow developers. Note that this process happens in an email client, without any compilation taking place at this stage. Technical flaws may be found by code reading and discussion rather than by testing whether the code seems to trigger a bug or not. Also, if the code would benefit from extra documentation, such documentation will be requested publicly by other developers.</p>
<p>Proposed changes to Asterisk are posted onto the Asterisk bug tracking system maintained by <a href="http://www.digium.com/">Digium</a> (the original authors and the current maintainers of Asterisk). A disclaimer also needs to be filled by contributors, as Digium wants to be able to make a proprietary version of Asterisk, while others may only distribute it as a GPL software. I have the impression that the patches are not peer reviewed: the use of a bug tracking system doesn’t ease such a code review process, compared to a mailing-list as in the Linux kernel patches case. I am also under the impression that patches are tested rather than being read first. If enough developers report that the patch hasn’t visibly broken their system, the patch may eventually be integrated.</p>
<p>Also, parts of Asterisk sometimes undergo major rewritings without any attempt to explain what has been changed exactly. For the Linux kernel, it would be unacceptable: a serie of incremental patches would be required to be submitted on the mailing-list, with a step-by-step justification of why things need to be changed. When incremental patches are not doable, because changes depend on each other, separate patches that need to be applied at the same time will still be required so that individual changes are reviewable by other developers.</p>
<p>As you may have guessed at this stage, I <strong>much</strong> prefer the Linux kernel way of doing it. The peer review system exposes proposed changes to several pairs of hackers eyes. The patches and the subsequent discussions also teach potential contributors what they need to send and how they need to present it. This iterative process not only generates better code but also shows good practices to other programmers.</p>
<p>I would really like other large software projects, such as Asterisk, to adopt it to increase the code quality and the developers interaction.</p>
  </div>
  <span class="tip">
    If you like this post, you can send some bitcoin dust to
      <a href="bitcoin:17Kr97KJNWrsAmgr3wJBVnLAuWqCCvAdMq?label=rfc1149-blog&amp;message=Tip%20for%20blog%20post&amp;amount=0.001">17Kr97KJNWrsAmgr3wJBVnLAuWqCCvAdMq.
  </span>
  <span class="plusone"><g:plusone size="small"></g:plusone></span>
  <a class="FlattrButton" style="display:none;" href="https://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/" title="To peer review or to not peer review?" data-flattr-description="2006-12-26-to-peer-review-or-to-not-peer-review"></a>
  <footer>
    <address><span><a href="../../../../../sam.html" rel="author">Samuel Tardieu</a></span></address> |
    <abbr title="2006-12-26" property="schema:datePublished">2006-12-26</abbr> |
    <a href="../../../../../blog/tag/asterisk/">Asterisk</a>, <a href="../../../../../blog/tag/free-software/">Free Software</a>, <a href="../../../../../blog/tag/linux/">Linux</a>, <a href="../../../../../blog/tag/programming/">Programming</a>, <a href="../../../../../blog/tag/voip/">VoIP</a> |
    <a href="../../../../../blog/2006/12/26/to-peer-review-or-to-not-peer-review/index.html#disqus_thread">Comments</a> |
    <span class="copyright"><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="noicon" property="https://creativecommons.org/ns#license">CC BY-NC-SA</a></span>
  </footer>
  <div id="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    var disqus_shortname = 'rfc1149';
    var disqus_url = 'https://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/'.replace(/^https:/, 'http:');
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript><p>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></p></noscript>
    <a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</article>

</div>
<aside id="sidebar" class="bar">
<div id="pageicon"><a href="../../../../../" class="noicon"><img src="../../../../../wwwicons/pigeon-64.png" alt="[page icon]" title="Go to home page" /></a></div>
<br />
<nav>
<h2>Samuel Tardieu</h2>
<g:plusone annotation="inline"></g:plusone>
<a class="FlattrButton" style="display:none;" href="https://www.rfc1149.net/blog/2006/12/26/to-peer-review-or-to-not-peer-review/" title="To peer review or to not peer review?" data-flattr-description="2006-12-26-to-peer-review-or-to-not-peer-review"></a>
</nav>

<nav>
<ul>
  <li><a href="../../../../../">Site home</a></li>
  <li><a href="../../../../../sam.html">Me and myself</a></li>
  <li><a href="../../../../../blog/">An avian carrier's blog</a> <a href="../../../../../blog/feed/"><img src="../../../../../wwwicons/atom-feed-16.png" alt="Atom feed" title="Feed for all blog posts" /></a>
    <ul>
      <li><a href="../../../../../blog/en/" lang="en">English posts only</a></li>
      <li><a href="../../../../../blog/fr/" lang="fr">Billets en français</a></li>
    </ul>
  </li>
  <li><a href="../../../../../devel/">Software projects</a></li>
  <li><a href="../../../../../biblio.html">Publications</a></li>
  <li>Follow me on <a href="https://twitter.com/rfc1149" class="noicon">Twitter</a></li>
</ul>
</nav>

<hr />

<nav>
<h2>Latest posts</h2>
<ul id="latestposts">
<li>
    <a href="../../../../../blog/2014/01/27/apple-users-security-is-not-for-you/" lang="en">Apple users: security is not for you</a>
</li>
<li>
    <a href="../../../../../blog/2013/05/02/why-bitcoin-transfers-are-not-instantaneous/" lang="en">Why bitcoin transfers are not instantaneous</a>
</li>
<li>
    <a href="../../../../../blog/2013/05/01/the-cloudy-state-of-bitcoin-exchanges-in-europe/" lang="en">The cloudy state of bitcoin exchanges in Europe</a>
</li>

</ul>
</nav>
<hr />

<nav>
<h2>Tags</h2>
<a style="font-size: 65%" href="../../../../../blog/tag/ada/">Ada</a> <a style="font-size: 68%" href="../../../../../blog/tag/android/">Android</a> <a style="font-size: 60%" href="../../../../../blog/tag/anime/">Anime</a> <a style="font-size: 62%" href="../../../../../blog/tag/asterisk/">Asterisk</a> <a style="font-size: 62%" href="../../../../../blog/tag/bitcoin/">Bitcoin</a> <a style="font-size: 68%" href="../../../../../blog/tag/bug/">Bug</a> <a style="font-size: 61%" href="../../../../../blog/tag/c/">C</a> <a style="font-size: 67%" href="../../../../../blog/tag/critiques/">Critiques</a> <a style="font-size: 61%" href="../../../../../blog/tag/erlang/">Erlang</a> <a style="font-size: 68%" href="../../../../../blog/tag/factor/">Factor</a> <a style="font-size: 67%" href="../../../../../blog/tag/forth/">Forth</a> <a style="font-size: 118%" href="../../../../../blog/tag/free-software/">Free Software</a> <a style="font-size: 68%" href="../../../../../blog/tag/geek/">Geek</a> <a style="font-size: 62%" href="../../../../../blog/tag/gentoo/">Gentoo</a> <a style="font-size: 60%" href="../../../../../blog/tag/geocaching/">Geocaching</a> <a style="font-size: 68%" href="../../../../../blog/tag/google/">Google</a> <a style="font-size: 61%" href="../../../../../blog/tag/haskell/">Haskell</a> <a style="font-size: 60%" href="../../../../../blog/tag/health/">Health</a> <a style="font-size: 64%" href="../../../../../blog/tag/ipv6/">IPv6</a> <a style="font-size: 62%" href="../../../../../blog/tag/j/">J</a> <a style="font-size: 60%" href="../../../../../blog/tag/java/">Java</a> <a style="font-size: 61%" href="../../../../../blog/tag/javascript/">Javascript</a> <a style="font-size: 64%" href="../../../../../blog/tag/jekyll/">Jekyll</a> <a style="font-size: 105%" href="../../../../../blog/tag/la-vie-et-le-reste/">La vie et le reste</a> <a style="font-size: 74%" href="../../../../../blog/tag/linux/">Linux</a> <a style="font-size: 67%" href="../../../../../blog/tag/logiciel-libre/">Logiciel libre</a> <a style="font-size: 68%" href="../../../../../blog/tag/legislation/">Législation</a> <a style="font-size: 106%" href="../../../../../blog/tag/net/">Net</a> <a style="font-size: 60%" href="../../../../../blog/tag/ovh/">OVH</a> <a style="font-size: 77%" href="../../../../../blog/tag/petits-tracas/">Petits tracas</a> <a style="font-size: 65%" href="../../../../../blog/tag/photo-and-imaging/">Photo and imaging</a> <a style="font-size: 102%" href="../../../../../blog/tag/programming/">Programming</a> <a style="font-size: 67%" href="../../../../../blog/tag/python/">Python</a> <a style="font-size: 65%" href="../../../../../blog/tag/recoverjpeg/">Recoverjpeg</a> <a style="font-size: 60%" href="../../../../../blog/tag/robotics/">Robotics</a> <a style="font-size: 65%" href="../../../../../blog/tag/ruby/">Ruby</a> <a style="font-size: 64%" href="../../../../../blog/tag/scala/">Scala</a> <a style="font-size: 61%" href="../../../../../blog/tag/science/">Science</a> <a style="font-size: 67%" href="../../../../../blog/tag/security/">Security</a> <a style="font-size: 61%" href="../../../../../blog/tag/software-patents/">Software patents</a> <a style="font-size: 64%" href="../../../../../blog/tag/technologie/">Technologie</a> <a style="font-size: 73%" href="../../../../../blog/tag/technology/">Technology</a> <a style="font-size: 60%" href="../../../../../blog/tag/urbi/">Urbi</a> <a style="font-size: 62%" href="../../../../../blog/tag/voip/">VoIP</a> <a style="font-size: 60%" href="../../../../../blog/tag/xmpp/">XMPP</a> <a style="font-size: 60%" href="../../../../../blog/tag/xorg/">Xorg</a> <a style="font-size: 61%" href="../../../../../blog/tag/zeromq/">ZeroMQ</a> <a style="font-size: 65%" href="../../../../../blog/tag/education/">Éducation</a>
</nav>


</aside>
<footer id="page-footer">
<div class="spacer"> </div>
<hr />
This site is maintained by
    <a href="../../../../../sam.html#me" rel="author schema:creator" typeof="schema:Person"><span property="schema:name">Samuel Tardieu</span></a>
    using <a href="http://jaspervdj.be/hakyll/">Hakyll</a>
    and hosted by
    <a href="http://www.online.net/" class="noicon" rel="schema:provider" typeof="schema:Organization"><span property="schema:name">Online SAS</span></a>. <a href="../../../../../rfc1149.html">Why <code>rfc1149.net</code>?</a>

<script type="text/javascript">
window.___gcfg = {lang: 'en'};
(function() {
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'https://apis.google.com/js/plusone.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>
</footer>

</div>
</body>
</html>

