http://spritesmods.com/?art=hddhack&page=8
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 07:28:42 GMT
Server: Apache/2.2.22 (Debian)
X-Powered-By: PHP/5.4.4-14+deb7u12
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 4299
Connection: close
Content-Type: text/html

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" 
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>Sprites mods - Hard disk hacking - Conclusion</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="style/style-new.css" />
<link rel="stylesheet" type="text/css" href="style/print.css" media="print" />
<link type="application/rss+xml" rel="alternate" title="Sprites Mods" href="http://spritesmods.com/rss.php" />
</head>
<body>

<div id="header"><span id="sitename"><span id="sitenamebig">SpritesMods</span>.com</span><h1>Hard disk hacking - Conclusion</h1></div>


<div id="left">
<p />
<a href="?art=main">Welcome</a><br /><ul id="mainmenu"><li><a href="?art=hardware">Hardware stuff</a></li><li><a href="?art=hacks">Hacks</a><ul id="submenu"><li><a href="?art=rtl8366sb">Dumb to managed switch conversion</a></li><li><a href="?art=zx3hack">Hacking the Kodak Zx3</a></li><li><a href="?art=vpx500">Hacking the VPx500</a></li><li><a href="?art=twitter1943">Twittering vintage arcade game</a></li><li><a href="?art=hddhack">Hard disk hacking</a></li><li><a href="?art=wtcluster">Cluster using WT-300s</a></li><li><a href="?art=ljdisplay">Standalone HPLJ display hack</a></li><li><a href="?art=keybled">Laptop keyboard LED</a></li><li><a href="?art=wskpsip">Convert a SMC WSKP100 to use SIP</a></li><li><a href="?art=sweexusb">Add USB to a Sweex LB000021 router</a></li><li><a href="?art=swordfish">Damocles' Swordfish</a></li><li><a href="?art=mouseeye">Optical mouse-cam</a></li><li><a href="?art=ledbl">LEDs replacing CCFL backlight</a></li><li><a href="?art=picframe">Use a cheap digital photoframe as a second display for your PC</a></li></ul></li><li><a href="?art=software">Software</a></li><li><a href="?art=consoles">Console hacking</a></li><li><a href="?art=security">Security</a></li><li><a href="?art=nabaztag">Nabaztag</a></li><li><a href="?art=about">About Spritesmods</a></li></ul></div>

<div id="right">
<div id="righttop">
<p /><a href="?art=hddhack&amp;page=1"><strong>Page 1</strong><br /></a>Intro<p /><a href="?art=hddhack&amp;page=2"><strong>Page 2</strong><br /></a>Parts on the PCB<p /><a href="?art=hddhack&amp;page=3"><strong>Page 3</strong><br /></a>Hooking up JTAG<p /><a href="?art=hddhack&amp;page=4"><strong>Page 4</strong><br /></a>Injecting code<p /><a href="?art=hddhack&amp;page=5"><strong>Page 5</strong><br /></a>Persistence<p /><a href="?art=hddhack&amp;page=6"><strong>Page 6</strong><br /></a>Software flashing<p /><a href="?art=hddhack&amp;page=7"><strong>Page 7</strong><br /></a>Other uses<p /><strong>Page 8</strong><br />Conclusion (+ discussion / remarks)<p>
</p>
</div>
<div id="rightbottom">
<p>
Do you like my hacking? If so, please consider leaving something in the<br />
</p>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="AWHK8LYRDDS3C">
<input type="hidden" name="lc" value="GB">
<input type="hidden" name="item_name" value="Spritesmods.com">
<input type="hidden" name="no_note" value="0">
<input type="hidden" name="cn" value="Remarks">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="rm" value="1">
<input type="hidden" name="return" value="http://spritesmods.com/?art=main&amp;thanks=1">
<input type="hidden" name="currency_code" value="EUR">
<input type="hidden" name="bn" value="PP-DonationsBF:donate.png:NonHosted">
<input type="image" src="http://spritesmods.com/donate.png" border="0" name="submit" alt="PayPal, de veilige en complete manier van online betalen.">
<!--
<img alt="" border="0" src="https://www.paypalobjects.com/nl_NL/i/scr/pixel.gif" width="1" height="1">
-->
</form>

<p>
Or use Bitcoins:<br />
<script src="btc/coin.js"></script>
<script>
CoinWidgetCom.go({
	wallet_address: "16wKm29FmTLmYSrDtBXB4zLYGsqfrTwcEC"
	, currency: "bitcoin"
	, counter: "count"
	, alignment: "bl"
	, qrcode: true
	, auto_show: false
	, lbl_button: "Donate"
	, lbl_address: "My Bitcoin Address:"
	, lbl_count: "donations"
	, lbl_amount: "BTC"
});
</script>
</p>


<p>
<br />Current contents:
<br />EUR181 (about $240.73) and a bunch of cool hardware.
</p>


<p>
Follow Spritesmods on <a href="http://twitter.com/SpritesMods">Twitter</a>!
</p>
</div>
</div>
<div id="center">
<p><h1>Conclusion
</h1>
</p>
<!-- google_ad_section_start -->
<p>
So, there you have it. While the hard disk controller is a beast without much data 
known about it, it's still perfectly well possible to reverse engineer it and to
write custom code for it. The unknown-ness of the controller does make it harder
to write generic hacks, which makes me doubtfull that a thing like the evil 
firmware patch will ever be seen in the wild: it's much easier to just get another
zero-day software exploit than reverse engineer the firmware of every single hard
disk every server you stumble upon has.
</p>
<p>
I also hope to have proven that a broken hard disk is something you can still use. 
While the mechanics of a broken HD probably are shot, the PCB still contains an 
usable embedded system, which actually is pretty powerful considering you can usually
get broken hard disks for free.
</p>
<p>
Releasing the source-code for a security project always is a nasty subject. I want to
release code, but I do not want to be responsible for a lot of permanently hacked
servers... I decided to compromise: you can download the code I used 
<a href="hddhack/hddhack.tgz">here</a>, but I removed the shadow-replacement code.
Make note: I'm not going to support the process to get all this running in any way;
it's a hack, you figure it out.
</p>
<!-- google_ad_section_end -->
<p>	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- singlebigad -->
	<ins class="adsbygoogle"
	     style="display:inline-block;width:728px;height:90px"
	     data-ad-client="ca-pub-6055011648930388"
	     data-ad-slot="3668631373"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	</p><p id="prevnext"><a href="?art=hddhack&amp;page=7">&laquo Prev</a>&nbsp;8&nbsp;</p><p /><strong>Last 10 comments</strong> <a href="?art=hddhack&amp;page=8&amp;showall=true">Show all</a><a id="cmtid2371"></a><div class="comment"><strong>Pinery wrote at 8 May 2014, 17.24:</strong><p>help?

cable VTAR,nTRST,TDI,TMS,TCK,RTCK,TDO

my.cfg
interface ft2232
ft2232_device_desc &quot;TIAO USB Multi-Protocol Adapter A&quot;
ft2232_layout jtagkey
ft2232_vid_pid 0x0403 0x8A98
adapter_khz 1000
reset_config trst_only separate trst_push_pull

feroceon.cfg
...
#reset_config trst_and_srst

openocd -f my.cfg -f feroceon.cfg

telnet localhost 4444

&gt;halt
Halt timed out,wake up GDB.
timed out while waitting for target halted
in procedure 'halt'

????</p></div><a id="cmtid2360"></a><div class="comment"><strong>Mike74 wrote at 5 Apr 2014, 14.44:</strong><p>Do you have the password for this site http://www.griol.com/ftp/?</p></div><a id="cmtid2358"></a><div class="comment"><strong>dencee wrote at 1 Apr 2014, 4.41:</strong><p>I'm very curious how you managed to deduce the firmware vendor command to read and write the flash via SATA. A trial and error method would run the risk of false positives and even worse, destroying the drive's firmware. Care to share? 

Here's the statement I'm referring to:
&quot;After some messing around and guessing VSC parameters, fwtool could all of a sudden also read and write the flash of a HD attached to the PC it's run on.&quot;

Great work BTW!</p></div><a id="cmtid2355"></a><div class="comment"><strong>11th-Hourï¿½ wrote at 10 Mar 2014, 14.24:</strong><p>This is really cool stuff</p></div><a id="cmtid2337"></a><div class="comment"><strong>Alan wrote at 7 Feb 2014, 3.05:</strong><p>Have you considered trying to alter a WD firmware to see if TLER can be re-enabled on consumer drives like the WDXXEARS drives?</p></div><a id="cmtid2327"></a><div class="comment"><strong>Sprite_tm wrote at 10 Jan 2014, 12.12:</strong><p>Sam: Yes, I know that. WD doesn't have a shell running on that port, and WD is the only manufacturer I know the JTAG-port of. For this purpose, having a JTAG port is better than having access to a (restricted) shell.</p></div><a id="cmtid2326"></a><div class="comment"><strong>Sam wrote at 10 Jan 2014, 1.50:</strong><p>You're making it way too complicated. The unused &quot;jumper&quot; pins on most disks are a TTL or CMOS level RS-232 port. There is a shell used for debug and manufacturing on it, people have discovered and documented commands.</p></div><a id="cmtid2316"></a><div class="comment"><strong>no_so_nosee_nsa wrote at 2 Jan 2014, 18.03:</strong><p>Thanks for sharing.  Seems things in the world are going to get a lot worse, maybe never get any better.</p></div><a id="cmtid2315"></a><div class="comment"><strong>ein wrote at 2 Jan 2014, 9.55:</strong><p>Great job mate! Keep goin'.</p></div><a id="cmtid2314"></a><div class="comment"><strong>Thomas wrote at 2 Jan 2014, 4.11:</strong><p>I wonder if the Cortex-M3 has access to the same memory map as the arm cores. Having access to the M3 would give you the ability to run persistently, and not rely soley on hooks from the original firmware.</p></div><a id="leavecmt"></a>
<div class="comment">
Leave a comment:<form method="post" action="?#leavecmt">
<p>
<input type="hidden" name="page" value="8" />
<input type="hidden" name="art" value="hddhack" />
<input type="hidden" name="capval" value="1499844224" />
Your name:<br />
<input type="text" name="name" value="" /><br />
What does this picture say?<br />
<img src="captcha/captcha.php?secret=246333074" alt="Sorry, this is a captcha" /><br />
<input type="hidden" name="capfld" value="xxgbhj" />
<input type="text" name="xxgbhj" /><br />
Your comment:<br />
<textarea name="comment" rows="5" cols="60"></textarea><br />
<input type="submit" name="postcomment" value="Comment" />
</p>
</form>
</div>
<br /><div class="copy">&copy; 2006-2013 Sprite_tm - <a href="?art=contact&amp;af=Hard disk hacking">Contact</a></div></div>
</body>
</html>

