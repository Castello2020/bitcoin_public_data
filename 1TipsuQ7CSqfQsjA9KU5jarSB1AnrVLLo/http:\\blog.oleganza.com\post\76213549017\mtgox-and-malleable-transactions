http://blog.oleganza.com/post/76213549017/mtgox-and-malleable-transactions
HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
P3P: CP="ALL ADM DEV PSAi COM OUR OTRo STP IND ONL"
X-Tumblr-User: oleganza
X-Tumblr-Pixel-0: http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDpcL1wvYmxvZy5vbGVnYW56YS5jb21cL3Bvc3RcLzc2MjEzNTQ5MDE3XC9tdGdveC1hbmQtbWFsbGVhYmxlLXRyYW5zYWN0aW9ucyIsInJlcXR5cGUiOjAsInJvdXRlIjoiXC9wb3N0XC86aWRcLzpzdW1tYXJ5In0=&U=HDCCAJMGKK&K=7bb755bcd2ac274caebafa5041ecbe8b7e085af145a5aced2753e0e21468868a--http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6XC9cL2Jsb2cub2xlZ2FuemEuY29tXC9wb3N0XC83NjIxMzU0OTAxN1wvbXRnb3gtYW5kLW1hbGxlYWJsZS10cmFu
X-Tumblr-Pixel-1: c2FjdGlvbnMiLCJyZXF0eXBlIjowLCJyb3V0ZSI6IlwvcG9zdFwvOmlkXC86c3VtbWFyeSIsInBvc3RzIjpbeyJwb3N0aWQiOiI3NjIxMzU0OTAxNyIsImJsb2dpZCI6IjQ0MzgzMyIsInNvdXJjZSI6MzN9XX0=&U=BIKHOODKCP&K=6627af227b3eaa306d0faa362078c12c95a5951b2782c2f35d8ba7b69cf0d324
X-Tumblr-Pixel: 2
Link: <http://tmblr.co/Z3kFay16_hdVP>; rel=shorturl
Link: <http://38.media.tumblr.com/avatar_b5ab343e4862_128.gif>; rel=icon
X-UA-Compatible: IE=Edge,chrome=1
Content-Encoding: gzip
X-UA-Device: desktop
Vary: X-UA-Device
Content-Length: 9721
Accept-Ranges: bytes
Date: Thu, 24 Jul 2014 12:59:07 GMT
Connection: close

<!DOCTYPE html>
<script>var __pbpa = true;</script><script>var translated_warning_string = 'Warning: Never enter your Tumblr password unless \u201chttps://www.tumblr.com/login\u201d\x0ais the address in your web browser.\x0a\x0aYou should also see a green \u201cTumblr, Inc.\u201d identification in the address bar.\x0a\x0aSpammers and other bad guys use fake forms to steal passwords.\x0a\x0aTumblr will never ask you to log in from a user\u2019s blog.\x0a\x0aAre you absolutely sure you want to continue?';</script><script type="text/javascript" language="javascript" src="http://assets.tumblr.com/assets/scripts/pre_tumblelog.js?_v=c65abde67782d19ef9d6ba2e8362ef98"></script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# blog: http://ogp.me/ns/blog#">
        <!-- DEFAULT COLORS -->
        <meta name="color:Background" content="#eee"/>
        <meta name="color:Content Background" content="#fff"/>
        <meta name="color:Title" content="#444"/>
        <meta name="color:Description" content="#666"/>
        <meta name="color:Post Title" content="#c00"/>    
        <meta name="color:Text" content="#444"/>
        <meta name="color:Inline Link" content="#c00"/>
        <meta name="color:Quote" content="#666"/>
        <meta name="color:Quote Source" content="#444"/>
        <meta name="color:Link Post" content="#c00"/>
        <meta name="color:Conversation Background" content="#f8f8f8"/>
        <meta name="color:Conversation Border" content="#ddd"/>
        <meta name="color:Conversation Text" content="#444"/>
        <meta name="color:Conversation Label" content="#111"/>
        <meta name="color:Photo Border" content="#fff"/>
        <meta name="color:Date" content="#ccc"/>
        <meta name="color:Date Background" content="#fff"/>
        <!-- END DEFAULT COLORS -->

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Oleg Andreev - MtGox and malleable transactions</title>
        <link rel="icon" href="http://38.media.tumblr.com/avatar_b5ab343e4862_128.gif"/>
        <link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.oleganza.com/rss"/>
        <meta name="viewport" content="width=775"/> <!-- iPhone -->

        <style type="text/css">
            body {
                margin:           0px;
                background-color: #FFFFFF;
                font-family:      Helvetica Neue, Helvetica, sans-serif;
letter-spacing:130%;
            }

code, tt {
  font-size:12px;
 }


            
            #content {
                width:            520px;
                margin:           auto;
                padding:          15px;
                background-color: #fff;
                position:         relative;
            }

            a {
                color:            #156ddf;
            }

            h1 {
                padding:          10px 0px 60px 0px;
                margin:           0px;
                xtext-align:       center;
                font:             25px Helvetica Neue, Helvetica, sans-serif;
                letter-spacing:   130%;
                line-height:      50px;
            }
            
            h1 a {
                color:            #000000;
                text-decoration:  none;
            }

            #description {
                position:         absolute;
								left: 						565px;
            }

            #description div {
                font:             normal 0.8em Helvetica Neue, Helvetica,sans-serif;
                line-height:      130%;
                width:            150px;
                color:            #000000;
            }

						

#description div#search {
 text-align: right;
}

            #description div a {
                xcolor:            #000000;
            }
            
            #description #nav_container {
 line-height:170%;
            }
            
            #description #nav_container .dim {
                filter: alpha(opacity=50); 
                -moz-opacity: 0.5; 
                opacity: 0.5;
            }

						#searchresultcount {
							margin: 0 0 30px;
							text-align: center;
						}
            
            .post {
                position:         relative;
                margin-bottom:    80px;
            }

            .post div.labels {
                position:         absolute;
                right:            535px;
                text-align:       right;
                width:            150px;
            }

            .post div.date {
                background-color: #FFFFFF;
                white-space:      nowrap;
                font:             bold 0.8em Helvetica Neue, Helvetica, sans-serif;
                color:            #CCCCCC;
                display:          inline;
                padding:          3px 5px 0px 5px;
                line-height:      20px;
                xtext-transform:lowercase;
            }

            .post div.date a {
                color:            #CCCCCC;
                text-decoration:  none;
            }

            .post h2 {
                font-size:        16px;
                font-weight:      Bold;
                color:            #000000;
                margin:           0px 0px 10px 0px;
            }

            .post h2 a {
                color:            #000000;
                text-decoration:  none;
            }
            
            /* Regular Post */
            .post .regular {
                font-size:        14px;
                color:            #000000;
                line-height:      140%;
            }

            .post .regular blockquote {
                font-style: italic;
            }
            
            /* Photo Post */
            .post .photo img {
                border:           solid 0px #eee;
            }

            .post .photo div.caption {
                font-size:        14px;
                color:            #000000;
                margin-top:       5px;
            }
            
            .post .photo div.caption a {
                xcolor:            #000000;
            }
            
            /* Quote Post */
            .post .quote span.quote {
               font:             16px Times New Roman, serif;
font-style:italic;
                color:            #000000;
            }

            .post .quote span.quote a {
font:             16px Times New Roman, serif;
font-style:italic;
                xcolor:            #000000;
            }

            .post .quote span.quote big.quote {
                xfont:             Bold 60px Georgia, serif;
                xline-height:      8px;
                xvertical-align:   -20px;
display:none;
            }
            
            .post .quote span.source {
font:             16px Times New Roman, serif;
font-style:italic;
                color:            #535353;
            }

            .post .quote span.source a {
                xcolor:            #535353;
            }
            
            /* Link Post */
            .post .link a.link {
                font:             14px Helvetica Neue,Helvetica, sans-serif;
                color:            #1e6dd3;
            }
            
            .post .link span.description {
                font-size: 14px;
                font-weight: normal;
                line-height:150%;

            }

            /* Conversation Post */
            .post .conversation ul {
                background-color: #f8f8f8;
                list-style-type:  none;
                margin:           0px;
                padding:          0px;
                border-left:      solid 5px #ddd;
            }
            
            .post .conversation ul li {
                border-bottom:    solid 1px #ddd;
                font-size:        14px;
                padding:          4px 0px 4px 8px;
                color:            #444;
            }
            
            .post .conversation ul li span.label {
                font-weight:      bold;
                color:            #111;
            }
            
            /* Audio Post */      
            .post .audio div.caption {
                font-size:        14px;
                color:            #000000;
                margin-top:       5px;
            }
            
            .post .audio div.caption a {
                xcolor:            #000000;
            }
            
            /* Video Post */
            .post .video {
                width:            400px;
                margin:           auto;
            }

            .post .video div.caption {
                font-size:        14px;
                color:            #000000;
                margin-top:       5px;
            }
            
            .post div.video div.caption a {
                xcolor:            #000000;
            }

            /* Footer */
            #footer {
                margin:           40px 0px 30px 0px;
                text-align:       center;
                font-size:        14px;
text-transform:lowercase;
            }
            
            #footer a {
                text-decoration:  none;
                color:            #000000;
            }
            
            #footer a:hover {
                text-decoration:  underline;
            }
            
						.query { font-weight: bold; }

						
            
        </style>

        <!--[if lt IE 7]>
            <style type="text/css">
                .post div.labels {
                    right: 450px;
                }
            </style>
        <![endif]-->
    <link rel="alternate" href="android-app://com.tumblr/tumblr/x-callback-url/blog?blogName=oleganza&postID=76213549017" />
<script src="http://assets.tumblr.com/assets/scripts/tumblelog.js?_v=7edb3c3b36e8b351a1249cf33411a3a7"></script>
<link rel="stylesheet" type="text/css" href="http://assets.tumblr.com/fonts/gibson/stylesheet.css?v=3">
<meta http-equiv="x-dns-prefetch-control" content="off"/>

<!-- BEGIN TUMBLR FACEBOOK OPENGRAPH TAGS --><!-- If you'd like to specify your own Open Graph tags, define the og:url and og:title tags in your theme's HTML. --><!-- Read more: http://ogp.me/ --><meta property="fb:app_id" content="48119224995" /><meta property="og:site_name" content="" /><meta property="og:title" content="MtGox and malleable transactions" /><meta property="og:url" content="http://blog.oleganza.com/post/76213549017/mtgox-and-malleable-transactions" /><meta property="og:description" content="MtGox issued a statement that due to a &ldquo;design issue&rdquo; in Bitcoin protocol, they were having problems with withdrawing BTC and so they had to halt all withdrawals until the problem is fixed...." /><meta property="og:determiner" content="a" /><meta property="og:type" content="tumblr-feed:entry" /><meta property="og:image" content="http://assets.tumblr.com/images/og/text_200.png" /><meta property="al:ios:url" content="tumblr://x-callback-url/blog?blogName=oleganza&amp;postID=76213549017" /><meta property="al:ios:app_name" content="Tumblr" /><meta property="al:ios:app_store_id" content="305343404" /><meta property="al:android:url" content="tumblr://x-callback-url/blog?blogName=oleganza&amp;postID=76213549017" /><meta property="al:android:app_name" content="Tumblr" /><meta property="al:android:package" content="com.tumblr" /><!-- END TUMBLR FACEBOOK OPENGRAPH TAGS -->


<!-- TWITTER TAGS --><meta charset="utf-8"><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="MtGox issued a statement that due to a &amp;#8220;design issue&amp;#8221; in Bitcoin protocol, they were having problems with withdrawing BTC and so they had to halt all withdrawals until the problem is fixed.
https://www.mtgox.com/press_release_20140210.html

 If you need a quick answer: there&amp;#8217;s no bug in the Bitcoin itself. You may go to Bitstamp/Coinbase/BTC-E/Bitcoin-Central and buy more BTC with a huge discount before it gets back to &#36;800-&#36;900.

 Long answer:

 Unconfirmed Bitcoin transactions were always &amp;#8220;malleable&amp;#8221;, that is you can slightly change a transaction that &amp;#8220;floats around&amp;#8221; (not yet in the blockchain) and you wouldn&amp;#8217;t break its signatures. You can&amp;#8217;t change something important about it, like source transactions, amounts, order of inputs and outputs or other important metadata. What you can do is to add some bogus data or flip a sign on a signature that doesn&amp;#8217;t change the meaning of the transaction, but changes its binary representation. (More info here: https://en.bitcoin.it/wiki/Transaction_Malleability)

 What does it mean in practice? You may send a transaction ABC123, then someone may see it on the network, change slightly to ABC124 and send it too. If he gets lucky, ABC124 will be included first and ABC123 will never be included (because it&amp;#8217;d be a double-spend). There&amp;#8217;s no problem for the recipient of the transaction: they will still get all their money on the address they expect. But if they were watching the blockchain specifically for transaction ABC123, they will never find it there.

 MtGox claims to be fooled this way:

 User asks MtGox to withdraw some bitcoins to some address of the user&amp;#8217;s choice.
 MtGox takes some of its own &amp;#8220;unspent transaction outputs&amp;#8221; and composes a transaction which sends funds to the user&amp;#8217;s address.
 MtGox remembers a hash of that transaction (unique fingerprint of its contents) and begins to watch the blockchain for this hash to appear in it.
 User or someone else sees unconfirmed MtGox transaction in the p2p network. He changes some bytes in it to keep it valid, but make it different to change its hash.
 New, modified transaction gets included in the blockchain. MtGox has sent money where needed, but does not know about it. User also got the funds no problem - his personal wallet will show that he has the funds.
 Then, user goes to MtGox support and complains that the money did not go through. Or, MtGox themselves see that they&amp;#8217;ve been watching for transaction for too long and could automatically re-send another transaction that sends some other &amp;#8220;unspent tx outputs&amp;#8221; to the same address (sort of, to &amp;#8220;retry&amp;#8221; the transaction). One way or another, it creates a lot of confusion for MtGox and initially may even lead them to sending the same money twice, or multiple times to the same user.
 Is it a design issue in Bitcoin to allow slight changes in unconfirmed transactions? Yes, probably is. But it&amp;#8217;s not entirely clear how it can be prevented at all. An immediate fix would disallow potentially useful more complex transactions and require a global network consensus to enforce new behavior. Zero-confirmation transactions were always known to be malleable and methods to limit their malleability were already discussed and deployed (e.g. transactions with non-canonical signatures may not be relayed by all nodes). But for all practical purposes, it&amp;#8217;s a known feature, just like many other weird facets of Bitcoin. Those who build Bitcoin wallets, exchanges or payment processors must be aware of this and act accordingly.

 MtGox had this problem because they didn&amp;#8217;t know about this Bitcoin property. And usually transactions were not deliberately modified by anyone, so it was okay for the most of the time.

 It&amp;#8217;s not rocket science to fix the problem. For instance, MtGox may fix the problem this way: instead of watching blockchain for appearance of the specific hash of a specific transaction, they should instead watch if the address X  (specified by user) got amount N (specified by user) from outputs Y, Z and W (owned by MtGox). This would guarantee that even if transaction is modified, they will see for sure if the users actually got the money sent to them, or not." /><meta name="twitter:title" content="MtGox and malleable transactions" /><meta name="twitter:url" content="http://blog.oleganza.com/post/76213549017/mtgox-and-malleable-transactions" /><meta name="twitter:site" content="tumblr" /><meta name="twitter:creator" content="oleganza" /><meta name="twitter:app:name:iphone" content="Tumblr" /><meta name="twitter:app:name:ipad" content="Tumblr" /><meta name="twitter:app:name:googleplay" content="Tumblr" /><meta name="twitter:app:id:iphone" content="305343404" /><meta name="twitter:app:id:ipad" content="305343404" /><meta name="twitter:app:id:googleplay" content="com.tumblr" /><meta name="twitter:app:url:iphone" content="tumblr://x-callback-url/blog?blogName=oleganza&amp;postID=76213549017&amp;referrer=twitter-cards" /><meta name="twitter:app:url:ipad" content="tumblr://x-callback-url/blog?blogName=oleganza&amp;postID=76213549017&amp;referrer=twitter-cards" /><meta name="twitter:app:url:googleplay" content="tumblr://x-callback-url/blog?blogName=oleganza&amp;postID=76213549017&amp;referrer=twitter-cards" />

</head>
    <body>
        <div id="content">
            <h1><a href="/">Oleg Andreev</a></h1>

            <div id="description">
                <div>
										<div id="search">
											<form action="/search" method="get">
											    <nobr><input type="search" name="q" value="" size=20/>&nbsp;<!--input type="submit" value="Search"/--></nobr><br/><br/>
											</form>
										</div>
	
                    <div style="font-size:13px">
<img src="http://cs7001.vk.me/c311220/v311220146/8df9/BfEPbD7ZFjg.jpg" width="152" xsrc="http://data.tumblr.com/avatar_e969e17d83f9_64.gif" /><br/><br/>
Software designer with focus on user experience and security.<br/><br/>
You may start with my <a href="http://blog.oleganza.com/post/83346088497/selected-articles-on-bitcoin">selection of articles on Bitcoin</a>. 
<br/><br/>
<hr style="border:none;border-top:1px solid #ccc"/><br/>
Author of <a href="http://gitboxapp.com">Gitbox</a> version control app.
<br/><br/>
Author of <a href="http://github.com/oleganza/CoreBitcoin">CoreBitcoin</a>, an implementation of Bitcoin in Objective-C. 
<br/><br/>Lead developer of <a href="http://fungolf.com">FunGolf GPS</a>, the best golfer's personal assistant.
<br/><br/>
<hr style="border:none;border-top:1px solid #ccc"/><br/>
I am happy to give you an interview or provide you with a consultation.<br/>
I am very interested in innovative ways to secure property and personal interactions: all the way from cryptography to user interfaces. I am not interested in trading, mining or building exchanges.
<br/><br/>
This blog enlightens people thanks to your generous donations: <small><a href="bitcoin:1TipsuQ7CSqfQsjA9KU5jarSB1AnrVLLo "> 1TipsuQ7CSqfQsjA9KU5jarSB1AnrVLLo </small><br/>
</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16845160-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
                    
                    <p id="nav_container">
<a href="http://oleganza.tumblr.com/post/73474045/about">about</a>
<br/>
<a href="http://twitter.com/oleganza">twitter.com/oleganza</a>
<br/>
<a href="mailto:oleganza@gmail.com">oleganza@gmail.com</a>
<br/>
                        <a href="/archive" id="archive_link">archive</a>
<br/>
                        <a href="http://blog.oleganza.com/rss">rss</a>
                    </p>
                </div>
            </div>
            
						

            
                <div class="post">
                    <div class="labels">
                        
                            <div class="date"><a href="http://blog.oleganza.com/post/76213549017/mtgox-and-malleable-transactions">February 10</a></div>
                        
                    
                        
                    </div>

                    
                        <div class="regular">
                            <h2><a href="http://blog.oleganza.com/post/76213549017/mtgox-and-malleable-transactions">MtGox and malleable transactions</a></h2>
                            <p>MtGox issued a statement that due to a &#8220;design issue&#8221; in Bitcoin protocol, they were having problems with withdrawing BTC and so they had to halt all withdrawals until the problem is fixed.
<a href="https://www.mtgox.com/press_release_20140210.html">https://www.mtgox.com/press_release_20140210.html</a></p>

<p>If you need a quick answer: there&#8217;s no bug in the Bitcoin itself. You may go to Bitstamp/Coinbase/BTC-E/Bitcoin-Central and buy more BTC with a huge discount before it gets back to $800-$900.</p>

<p>Long answer:</p>

<p>Unconfirmed Bitcoin transactions were always &#8220;malleable&#8221;, that is you can slightly change a transaction that &#8220;floats around&#8221; (not yet in the blockchain) and you wouldn&#8217;t break its signatures. You can&#8217;t change something important about it, like source transactions, amounts, order of inputs and outputs or other important metadata. What you can do is to add some bogus data or flip a sign on a signature that doesn&#8217;t change the <em>meaning</em> of the transaction, but changes its binary representation. (More info here: <a href="https://en.bitcoin.it/wiki/Transaction_Malleability">https://en.bitcoin.it/wiki/Transaction_Malleability</a>)</p>

<p>What does it mean in practice? You may send a transaction ABC123, then someone may see it on the network, change slightly to ABC124 and send it too. If he gets lucky, ABC124 will be included first and ABC123 will never be included (because it&#8217;d be a double-spend). There&#8217;s no problem for the recipient of the transaction: they will still get all their money on the address they expect. But if they were watching the blockchain specifically for transaction ABC123, they will never find it there.</p>

<p>MtGox claims to be fooled this way:</p>

<ol><li>User asks MtGox to withdraw some bitcoins to some address of the user&#8217;s choice.</li>
<li>MtGox takes some of its own &#8220;unspent transaction outputs&#8221; and composes a transaction which sends funds to the user&#8217;s address.</li>
<li>MtGox remembers a <em>hash</em> of that transaction (unique fingerprint of its contents) and begins to watch the blockchain for this hash to appear in it.</li>
<li>User or someone else sees unconfirmed MtGox transaction in the p2p network. He changes some bytes in it to keep it valid, but make it different to change its hash.</li>
<li>New, modified transaction gets included in the blockchain. MtGox has sent money where needed, but does not know about it. User also got the funds no problem - his personal wallet will show that he has the funds.</li>
<li>Then, user goes to MtGox support and complains that the money did not go through. Or, MtGox themselves see that they&#8217;ve been watching for transaction for too long and could automatically re-send another transaction that sends some other &#8220;unspent tx outputs&#8221; to the same address (sort of, to &#8220;retry&#8221; the transaction). One way or another, it creates a lot of confusion for MtGox and initially may even lead them to sending the same money twice, or multiple times to the same user.</li>
</ol><p>Is it a design issue in Bitcoin to allow slight changes in unconfirmed transactions? Yes, probably is. But it&#8217;s not entirely clear how it can be prevented at all. An immediate fix would disallow potentially useful more complex transactions and require a global network consensus to enforce new behavior. Zero-confirmation transactions were always known to be malleable and methods to limit their malleability were already discussed and deployed (e.g. transactions with non-canonical signatures may not be relayed by all nodes). But for all practical purposes, it&#8217;s a known feature, just like many other weird facets of Bitcoin. Those who build Bitcoin wallets, exchanges or payment processors must be aware of this and act accordingly.</p>

<p>MtGox had this problem because they didn&#8217;t know about this Bitcoin property. And usually transactions were not deliberately modified by anyone, so it was okay for the most of the time.</p>

<p>It&#8217;s not rocket science to fix the problem. For instance, MtGox may fix the problem this way: instead of watching blockchain for appearance of the specific hash of a specific transaction, they should instead watch if the address X  (specified by user) got amount N (specified by user) from outputs Y, Z and W (owned by MtGox). This would guarantee that even if transaction is modified, they will see for sure if the users actually got the money sent to them, or not.</p>
                        </div>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </div>
            

            <div id="footer">
                
                
                
            </div>
        </div>
    <!-- BEGIN TUMBLR CODE --><iframe scrolling="no" width="1" height="1" frameborder="0" style="background-color:transparent; overflow:hidden; position:absolute; top:0; left:0; z-index:9999;" id="ga_target"></iframe><script type="text/javascript">
    (function(){
        var analytics_frame = document.getElementById('ga_target');
        var analytics_iframe_loaded;
        var user_logged_in;
        var blog_is_nsfw = 'No';

        var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
        var eventer = window[eventMethod];
        var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
        eventer(messageEvent,function(e) {
            var message = (e.data && e.data.split) ? e.data.split(';') : '';
            switch (message[0]) {
                case 'analytics_iframe_loaded':
                    analytics_iframe_loaded = true;
                    postCSMessage();
                    postGAMessage();
                    break;
                case 'user_logged_in':
                    user_logged_in = message[1];
                    postGAMessage();
                    break;
            }
        }, false);

        analytics_frame.src = "http://assets.tumblr.com/analytics.html?3e91d63d5994bffc6ac211967f138b2c#http://blog.oleganza.com";
        function postGAMessage() {
            if (analytics_iframe_loaded && user_logged_in) {
                var is_ajax = false;
                analytics_frame.contentWindow.postMessage(['tick_google_analytics', is_ajax, user_logged_in, blog_is_nsfw, '/post/76213549017/mtgox-and-malleable-transactions?route=%2Fpost%2F%3Aid%2F%3Asummary'].join(';'), analytics_frame.src.split('/analytics.html')[0]);
            }
        }
        function postCSMessage() {
            COMSCORE = true;
            analytics_frame.contentWindow.postMessage('enable_comscore;' + window.location, analytics_frame.src.split('/analytics.html')[0]);
        }
    })();
</script><script>
            var _qevents = _qevents || [];
            (function() {
                var s = document.createElement('script');
                var el = document.getElementsByTagName('script')[0];
                s.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";
                el.parentNode.insertBefore(s, el);
            })();
        </script><script type="text/javascript">
            _qevents.push( { qacct: 'p-19UtqE8ngoZbM' } );
        </script><noscript><div style="display: none;"><img src="//pixel.quantserve.com/pixel/'p-19UtqE8ngoZbM'.gif" height="1" width="1" alt="Quantcast"/></div></noscript><script type="text/javascript">!function(s){s.src='http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDpcL1wvYmxvZy5vbGVnYW56YS5jb21cL3Bvc3RcLzc2MjEzNTQ5MDE3XC9tdGdveC1hbmQtbWFsbGVhYmxlLXRyYW5zYWN0aW9ucyIsInJlcXR5cGUiOjAsInJvdXRlIjoiXC9wb3N0XC86aWRcLzpzdW1tYXJ5In0=&U=MIOPJBCDID&K=30bee185236b3c5f148dca49a0f9b3190f4c1ed9b1bb91ddd4770833a0b3cfb6&R='.replace(/&R=[^&$]*/,'').concat('&R='+escape(document.referrer)).slice(0,2000).replace(/%.?.?$/,'');}(new Image());</script><noscript><img style="position:absolute;z-index:-3334;top:0px;left:0px;visibility:hidden;" src="http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDpcL1wvYmxvZy5vbGVnYW56YS5jb21cL3Bvc3RcLzc2MjEzNTQ5MDE3XC9tdGdveC1hbmQtbWFsbGVhYmxlLXRyYW5zYWN0aW9ucyIsInJlcXR5cGUiOjAsInJvdXRlIjoiXC9wb3N0XC86aWRcLzpzdW1tYXJ5Iiwibm9zY3JpcHQiOjF9&U=MIOPJBCDID&K=c6da2d7b1fa61d2f63bcfbd3f8f60519252dd44c03fa203371944afef4b4e256&R="></noscript><script type="text/javascript">!function(s){s.src='http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6XC9cL2Jsb2cub2xlZ2FuemEuY29tXC9wb3N0XC83NjIxMzU0OTAxN1wvbXRnb3gtYW5kLW1hbGxlYWJsZS10cmFuc2FjdGlvbnMiLCJyZXF0eXBlIjowLCJyb3V0ZSI6IlwvcG9zdFwvOmlkXC86c3VtbWFyeSIsInBvc3RzIjpbeyJwb3N0aWQiOiI3NjIxMzU0OTAxNyIsImJsb2dpZCI6IjQ0MzgzMyIsInNvdXJjZSI6MzN9XX0=&U=FDEKEDLOID&K=0d23b4a538d7172302d33dea291e99a26cc4d7a2aba8afde49cf7457e8c09d69&R='.replace(/&R=[^&$]*/,'').concat('&R='+escape(document.referrer)).slice(0,2000).replace(/%.?.?$/,'');}(new Image());</script><noscript><img style="position:absolute;z-index:-3334;top:0px;left:0px;visibility:hidden;" src="http://www.tumblr.com/impixu?T=1406206747&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6XC9cL2Jsb2cub2xlZ2FuemEuY29tXC9wb3N0XC83NjIxMzU0OTAxN1wvbXRnb3gtYW5kLW1hbGxlYWJsZS10cmFuc2FjdGlvbnMiLCJyZXF0eXBlIjowLCJyb3V0ZSI6IlwvcG9zdFwvOmlkXC86c3VtbWFyeSIsInBvc3RzIjpbeyJwb3N0aWQiOiI3NjIxMzU0OTAxNyIsImJsb2dpZCI6IjQ0MzgzMyIsInNvdXJjZSI6MzN9XSwibm9zY3JpcHQiOjF9&U=FDEKEDLOID&K=044fdcf9237791230d07e2baa7c5d14151a1bac32df09c5aa22fe4e492b42198&R="></noscript><script>
                    (function() {
                        var s = document.createElement('script');
                        var el = document.getElementsByTagName('script')[0];
                        s.src = ('https:' == document.location.protocol ? 'https://s' : 'http://l') + '.yimg.com/ss/rapid-3.18.1.js';
                        s.onload = function(){
                            var YAHOO = window.YAHOO;
                            if (YAHOO) {
                                var keys = {
                                    pd:'/post/:id/:summary',
                                    _li:0,
                                    b_id:443833,
                                    i_rad:0,
                                    i_strm:0
                                };
                                var conf = {
                                                                        spaceid:1197716038,
                                    client_only:1,
                                    yql_enabled:false,
                                    keys:keys,
                                    nol:1
                                };
                                YAHOO.rapid = new YAHOO.i13n.Rapid(conf);
                            }
                        };
                        el.parentNode.insertBefore(s, el);
                    })();
                </script><iframe id="tumblr_controls" class="tumblr_controls" width="1" height="1" frameborder="0" scrolling="no" src="http://assets.tumblr.com/assets/html/iframe/o.html?_v=9e17aad297935c7fb478643c59604364#src=http%3A%2F%2Fblog.oleganza.com%2Fpost%2F76213549017%2Fmtgox-and-malleable-transactions&amp;pid=76213549017&amp;rk=AlRsipgM&amp;lang=en_US&amp;name=oleganza&amp;avatar=http%3A%2F%2F38.media.tumblr.com%2Favatar_b5ab343e4862_64.gif&amp;title=Oleg+Andreev&amp;url=http%3A%2F%2Fblog.oleganza.com%2F&amp;page_slide=slide"></iframe><div id="teaser_iframe_container" style="display:none;"><iframe scrolling="no" frameborder="0" src="http://www.tumblr.com/assets/html/iframe/teaser.html?_v=bfe495a8395cc4648dc91acfefafee5c#src=http%3A%2F%2Fblog.oleganza.com%2Fpost%2F76213549017%2Fmtgox-and-malleable-transactions&amp;pid=76213549017&amp;rk=AlRsipgM&amp;lang=en_US&amp;name=oleganza&amp;avatar=http%3A%2F%2F38.media.tumblr.com%2Favatar_b5ab343e4862_64.gif&amp;title=Oleg+Andreev&amp;url=http%3A%2F%2Fblog.oleganza.com%2F&amp;page_slide=slide" id="teaser_iframe" width="1" height="1"></iframe></div><script type="text/javascript">
    (function(Tumblr){
        var follow_iframe_initialized = false;
        if (Tumblr.FollowTeaser && Tumblr.PostMessageListener) {
            // Don't do anything until the first initialize event
            Tumblr.PostMessageListener.initialize(function(message, origin) {
                if (follow_iframe_initialized || message.length < 2) return;

                if (message[0] === 'follow_iframe' && message[1] === 'enable') {
                    Tumblr.FollowTeaser.current_page = 1;
                    Tumblr.FollowTeaser.infer_infinite_scroll = true;
                    Tumblr.FollowTeaser.create_from_tumblr_controls("http:\/\/assets.tumblr.com\/assets\/html\/iframe\/follow.html?_v=a52b0a29bf82ebeec459a1f647a24914");
                    Tumblr.FollowTeaser.scroll_listener(true);
                    follow_iframe_initialized = true;
                }
            });
        }
    })(this.Tumblr || (this.Tumblr = {}));
</script><!--[if IE]><script type="text/javascript">document.getElementById('tumblr_controls').allowTransparency=true;</script><![endif]--><!-- END TUMBLR CODE -->

</body>
</html>
