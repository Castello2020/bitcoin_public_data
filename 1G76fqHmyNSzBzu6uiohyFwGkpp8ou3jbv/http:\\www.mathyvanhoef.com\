http://www.mathyvanhoef.com/
HTTP/1.0 200 OK
Content-Type: text/html; charset=UTF-8
Expires: Tue, 22 Jul 2014 23:35:56 GMT
Date: Tue, 22 Jul 2014 23:35:56 GMT
Cache-Control: private, max-age=0
Last-Modified: Mon, 21 Jul 2014 20:13:30 GMT
ETag: "fe279d7f-2b53-42fb-b207-bad40026a089"
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Server: GSE
Alternate-Protocol: 80:quic,80:quic

<!DOCTYPE html>
<html class='v2' dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<meta content='IE=8' http-equiv='X-UA-Compatible'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<script type="text/javascript">(function() { var b=window,f="chrome",g="tick",k="jstiming";(function(){function d(a){this.t={};this.tick=function(a,d,c){var e=void 0!=c?c:(new Date).getTime();this.t[a]=[e,d];if(void 0==c)try{b.console.timeStamp("CSI/"+a)}catch(h){}};this[g]("start",null,a)}var a;b.performance&&(a=b.performance.timing);var n=a?new d(a.responseStart):new d;b.jstiming={Timer:d,load:n};if(a){var c=a.navigationStart,h=a.responseStart;0<c&&h>=c&&(b[k].srt=h-c)}if(a){var e=b[k].load;0<c&&h>=c&&(e[g]("_wtsrt",void 0,c),e[g]("wtsrt_","_wtsrt",h),e[g]("tbsd_","wtsrt_"))}try{a=null,
b[f]&&b[f].csi&&(a=Math.floor(b[f].csi().pageT),e&&0<c&&(e[g]("_tbnd",void 0,b[f].csi().startE),e[g]("tbnd_","_tbnd",c))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,e&&0<c&&(e[g]("_tbnd",void 0,b.external.startE),e[g]("tbnd_","_tbnd",c))),a&&(b[k].pt=a)}catch(p){}})();b.tickAboveFold=function(d){var a=0;if(d.offsetParent){do a+=d.offsetTop;while(d=d.offsetParent)}d=a;750>=d&&b[k].load[g]("aft")};var l=!1;function m(){l||(l=!0,b[k].load[g]("firstScrollTime"))}b.addEventListener?b.addEventListener("scroll",m,!1):b.attachEvent("onscroll",m);
 })();</script>
<meta content='blogger' name='generator'/>
<link href='http://www.mathyvanhoef.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://www.mathyvanhoef.com/' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Mathy Vanhoef - Atom" href="http://www.mathyvanhoef.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Mathy Vanhoef - RSS" href="http://www.mathyvanhoef.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Mathy Vanhoef - Atom" href="http://www.blogger.com/feeds/3500917063499850097/posts/default" />
<link rel="me" href="http://www.blogger.com/profile/12266874794108836514" />
<link rel="openid.server" href="http://www.blogger.com/openid-server.g" />
<link rel="openid.delegate" href="http://www.mathyvanhoef.com/" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1735305980-ieretrofit.js"></script>
<![endif]-->
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Mathy Vanhoef</title>
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/static/v1/widgets/1535467126-widget_css_2_bundle.css' />
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=3500917063499850097&zx=fe279d7f-2b53-42fb-b207-bad40026a089' />
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#ffffff"/>
<Group description="Page" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.background.color" description="Background Color" type="color" default="#000000"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#444444" />
<Variable name="header.background.color" description="Header Background" type="color" default="transparent" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="description.text.color" description="Text Color" type="color"
default="#444444" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#444444"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#444444"/>
<Variable name="tabs.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Date Header" selector=".main-inner .widget h2.date-header, .main-inner .widget h2.date-header span">
<Variable name="date.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="date.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Post Background" selector=".post">
<Variable name="post.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="post.border.color" description="Border Color" type="color" default="#eeeeee" />
<Variable name="post.border.bevel.color" description="Bevel Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Gadget Text" selector=".sidebar .widget">
<Variable name="widget.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#666666"/>
</Group>
<Group description="Gadget Links" selector=".sidebar .widget">
<Variable name="widget.link.color" description="Link Color" type="color" default="#3778cd"/>
<Variable name="widget.link.visited.color" description="Visited Color" type="color" default="#4d469c"/>
<Variable name="widget.link.hover.color" description="Hover Color" type="color" default="#3778cd"/>
</Group>
<Group description="Gadget Background" selector=".sidebar .widget">
<Variable name="widget.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="widget.border.color" description="Border Color" type="color" default="#222222"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#000000"/>
</Group>
<Group description="Sidebar Background" selector=".column-left-inner .column-right-inner">
<Variable name="widget.outer.background.color" description="Background Color" type="color" default="transparent" />
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="image.border.color" description="Border Color" type="color" default="transparent"/>
</Group>
<Group description="Feed" selector=".blog-feeds">
<Variable name="feed.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Feed Links" selector=".blog-feeds">
<Variable name="feed.link.color" description="Link Color" type="color" default="#3778cd"/>
<Variable name="feed.link.visited.color" description="Visited Color" type="color" default="#4d469c"/>
<Variable name="feed.link.hover.color" description="Hover Color" type="color" default="#3778cd"/>
</Group>
<Group description="Pager" selector=".blog-pager">
<Variable name="pager.background.color" description="Background Color" type="color" default="#ffffff" />
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="footer.text.color" description="Text Color" type="color" default="#444444" />
</Group>
<Variable name="title.shadow.spread" description="Title Shadow" type="length" default="-1px"/>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee"
default="$(color) none repeat scroll top left"/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.size" description="Body Background Size" type="string" default="auto"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="none"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none" />
<Variable name="header.padding.top" description="Header Top Padding" type="length" default="22px" />
<Variable name="header.margin.top" description="Header Top Margin" type="length" default="0" />
<Variable name="header.margin.bottom" description="Header Bottom Margin" type="length" default="0" />
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="8px" />
<Variable name="widget.padding.side" description="Widget Padding Side" type="length" default="15px" />
<Variable name="widget.outer.margin.top" description="Widget Top Margin" type="length" default="0" />
<Variable name="widget.outer.background.gradient" description="Gradient" type="url" default="none" />
<Variable name="widget.border.radius" description="Gadget Border Radius" type="length" default="0" />
<Variable name="outer.shadow.spread" description="Outer Shadow Size" type="length" default="0" />
<Variable name="date.header.border.radius.top" description="Date Header Border Radius Top" type="length" default="0" />
<Variable name="date.header.position" description="Date Header Position" type="length" default="15px" />
<Variable name="date.space" description="Date Space" type="length" default="30px" />
<Variable name="date.position" description="Date Float" type="string" default="static" />
<Variable name="date.padding.bottom" description="Date Padding Bottom" type="length" default="0" />
<Variable name="date.border.size" description="Date Border Size" type="length" default="0" />
<Variable name="date.background" description="Date Background" type="background" color="transparent"
default="$(color) none no-repeat scroll top left" />
<Variable name="date.first.border.radius.top" description="Date First top radius" type="length" default="0" />
<Variable name="date.last.space.bottom" description="Date Last Space Bottom" type="length"
default="20px" />
<Variable name="date.last.border.radius.bottom" description="Date Last bottom radius" type="length" default="0" />
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" />
<Variable name="image.shadow.spread" description="Image Shadow Size" type="length" default="0"/>
<Variable name="image.border.radius" description="Image Border Radius" type="length" default="0"/>
<Variable name="separator.outdent" description="Separator Outdent" type="length" default="15px" />
<Variable name="title.separator.border.size" description="Widget Title Border Size" type="length" default="1px" />
<Variable name="list.separator.border.size" description="List Separator Border Size" type="length" default="1px" />
<Variable name="shadow.spread" description="Shadow Size" type="length" default="0"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
<Variable name="date.side" description="Side where date header is placed" type="string" default="right"/>
<Variable name="pager.border.radius.top" description="Pager Border Top Radius" type="length" default="0" />
<Variable name="pager.space.top" description="Pager Top Space" type="length" default="1em" />
<Variable name="footer.background.gradient" description="Background Gradient" type="url" default="none" />
<Variable name="mobile.background.size" description="Mobile Background Size" type="string"
default="auto"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee url(http://themes.googleusercontent.com/image?id=0BwVBOzw_-hbMNjViMzQ0ZDEtMWU1NS00ZTBkLWFjY2EtZjM5YmU4OTA2MjBm) repeat-x fixed top center /* Credit: Jason Morrow (http://jasonmorrow.etsy.com) */;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #3778cd;
}
a:visited {
text-decoration: none;
color: #4d469c;
}
a:hover {
text-decoration: underline;
color: #3778cd;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(http://www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(http://www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #3778cd;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .blog-posts {
padding: 0 10px;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #3778cd url(http://www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 930px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 930px;
max-width: 930px;
_width: 930px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 260px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 260px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("260px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 260px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 260px;
margin-right: -260px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<script type="text/javascript">var a="indexOf",b="&m=1",e="(^|&)m=",f="?",g="?m=1";function h(){var c=window.location.href,d=c.split(f);switch(d.length){case 1:return c+g;case 2:return 0<=d[1].search(e)?null:c+b;default:return null}}var k=navigator.userAgent;if(-1!=k[a]("Mobile")&&-1!=k[a]("WebKit")&&-1==k[a]("iPad")||-1!=k[a]("Opera Mini")||-1!=k[a]("IEMobile")){var l=h();l&&window.location.replace(l)};
</script><script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('headEnd');
</script></head>
<body class='loading'>
<div class='navbar section' id='navbar'><div class='widget Navbar' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
        gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
          if (gapi.iframes && gapi.iframes.getContext) {
            gapi.iframes.getContext().openChild({
                url: 'https://www.blogger.com/navbar.g?targetBlogID\0753500917063499850097\46blogName\75Mathy+Vanhoef\46publishMode\75PUBLISH_MODE_HOSTED\46navbarType\75BLUE\46layoutType\75LAYOUTS\46searchRoot\75http://www.mathyvanhoef.com/search\46blogLocale\75en_GB\46v\0752\46homepageUrl\75http://www.mathyvanhoef.com/\46vt\75-1031493175067395052',
                where: document.getElementById("navbar-iframe-container"),
                id: "navbar-iframe"
            });
          }
        });
      </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header'><div class='widget Header' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
Mathy Vanhoef
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>PhD Student Computer Security @KULeuven</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs section' id='crosscol'><div class='widget PageList' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li class='selected'><a href='http://www.mathyvanhoef.com/'>Home</a></li>
<li><a href='http://www.mathyvanhoef.com/p/publications.html'>Publications</a></li>
<li><a href='http://www.mathyvanhoef.com/p/about.html'>About</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=PageList&widgetId=PageList1&action=editWidget&sectionId=crosscol' onclick='return _WidgetManager._PopupConfig(document.getElementById("PageList1"));' target='configPageList1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
<div class='tabs section' id='crosscol-overflow'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main'><div class='widget Blog' id='Blog1'>
<div class='blog-posts hfeed'>
<!-- google_ad_section_start(name=default) -->

          <div class="date-outer">
        
<h2 class='date-header'><span>Friday, 30 May 2014</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry'>
<a name='922135596181614234'></a>
<h3 class='post-title entry-title'>
<a href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html'>ApBleed: Heartbleed over WPA1/2 Enterprise</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-922135596181614234'>
Tl;dr: <a href="https://github.com/vanhoefm/apbleed">ApBleed is my proof-of-concept</a> to test heartbleed against wireless networks. Patches welcome.<br />
<br />
<div style="text-align: justify;">
Once the heartbleed vulnerability in OpenSSL was made public, most focused on its applicability to web servers. Other targets such as SVN servers, VPNs, etc. were also mentioned. However, there was little public discussion about the impact of heartbleed on wireless networks.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Nevertheless, it was clear heartbleed was also exploitable against WPA1/2 enterprise networks, even if it wasn't discussed as publicly as other heartbleed stories. Normally enterprise networks use one of the <a href="https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">many EAP methods</a> inside an SSL tunnel to authenticate users. If OpenSSL is being used, this SSL tunnel might be vulnerable to heartbleed.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Of particular interest are networks like <a href="https://www.eduroam.org/">eduroam</a>. Eduroam is a world-wide roaming access service between research institutions. This means that I can go to a different country, see an eduroam hotspot, and connect to it using the credentials of my home institution. What's interesting is how my credentials are checked. It's done by setting up an <b>SSL tunnel to the RADIUS server of my own institution</b>. The eduroam network will take care of the <span data-dobid="hdw">necessary </span>packet routing. The image below illustrates this (<a href="https://www.eduroam.us/node/73">taken from eduroam website</a>):</div>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-Guiqs0uCY-c/U4cX4N14wPI/AAAAAAAAAXw/hmwaIgvNhwQ/s1600/newrouting_small.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-Guiqs0uCY-c/U4cX4N14wPI/AAAAAAAAAXw/hmwaIgvNhwQ/s1600/newrouting_small.png" height="400" width="600" /></a></div>
<br />
<div style="text-align: justify;">
Let's assume I'm a student at lsu.edu and currently visiting an institution of utk.edu. If I now connect to an eduroam hotspot, an SSL tunnel will be set up between my device and the RADIUS server of lsu.edu (i.e. my own institution). If my credentials are valid, lsu.edu will notify utk.edu that I should be allowed on the network.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Why is this interesting for an attacker? Because the SSL tunnel is set up before user authentication, and even before you are assigned an IP. The only thing known about you is your MAC address and your "home" institution (i.e. the realm defining your home institution). Of course, an attacker can spoof both the MAC address and the home institution. The attacker only has to be within range of an eduroam hotspot, and he or she can pick any eduroam hotspot at will. The eduroam network will then forward packets to the RADIUS server the attacker specified (i.e. the realm spoofed by the attacker). This is what allows a user to directly set up an SSL tunnel with the radius server of their home institution. However, this means we can anonymously connect to any institution we want!</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
The guys from eduroam quickly responded to this. Hours after heartbleed got public they posted <a href="https://confluence.terena.org/display/H2eduroam/heartbleed-note">a warning on their website</a>. One day after heartbleed, <a href="http://lists.shmoo.com/pipermail/hostap/2014-April/029976.html">with some help from the HostApd mailing list</a>, they had a working proof of concept to test whether institutions were vulnerable. To quote eduroam:</div>
<div style="text-align: justify;">
<blockquote class="tr_bq">
Following up on the heartbleed vulnerability in OpenSSL: it is 
confirmed that EAP-authentication in RADIUS servers is vulnerable to the
 attack. It is therefore extremely important to upgrade OpenSSL and 
restart RADIUS services as soon as possible. </blockquote>
<blockquote class="tr_bq">
The attack is feasible from any public eduroam hotspot, not just your RADIUS peers.<br />
Federation-level admins in Europe will receive notice from the 
eduroam OT with a list of vulnerable realms. [..] </blockquote>
<blockquote class="tr_bq">
While the tools are not publicly 
available for security reasons, we're providing the service of scanning a
 realm list for global federation admins on their request. [..]</blockquote>
</div>
<div style="text-align: justify;">
Though I focus on eduroam, every networking using enterprise authentication with an EAP method inside an SSL tunnel might be vulnerable to heartbleed. Nevertheless, eduroam is more interesting than your ordinary network, because it allows you to anonymously connect to any institution which has joined the eduroam federation. </div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Few public proof-of-concepts were available (if any at all). I can think of three reasons for this. First, not everyone was aware enterprise authentication was vulnerable to heartbleed. Second, it's a little bit harder to make a working proof-of-concept against wireless networks. Third reason might have to do with the impact of public exploits. Because authentication (and hence the SSL tunnel) takes place before getting access to a
 network, it's not possible to consult a certificate revocation list 
(CRL) or query the certificate status online (with OCSP) [<a href="https://confluence.terena.org/display/H2eduroam/heartbleed-note">eduroam</a>]. So revoking certificates is not possible.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
However, <a href="http://www.slideshare.net/lgrangeia/heartbleed-35236317">recently proof-of-concepts are being released</a>. So it's time to release my own proof-of-concept as well :) I modified wpa_supplicant so, once connected to an AP and ready to talk to the radius server, it opens a local socket. This means you can now connect to this socket and pretend it's the RADIUS server. <b>The big advantage of this approach is that you can use any existing heartbleed tool to test the radius server.</b> Simply let the heartbleed tool connect to the socket created by my proof-of-concept. The code has not been tested thoroughly, but worked in all my small experiments. <a href="https://github.com/vanhoefm/apbleed">Get a copy of my PoC (called ApBleed) at github.</a> Patches are welcome!</div>
<br />
Some example outputs of running my tool:<br />
<br />
<div class="separator" style="clear: both; text-align: left;">
<a href="http://3.bp.blogspot.com/-I5CTuwbbbLg/U4e3muX5tOI/AAAAAAAAAYU/m-D9unGqkt4/s1600/apbleed_supp.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-I5CTuwbbbLg/U4e3muX5tOI/AAAAAAAAAYU/m-D9unGqkt4/s1600/apbleed_supp.png" height="217" width="600" /></a></div>
<br />
Using existing heartbleed tools to connect to the radius server:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-dzaBhbP5mAw/U4ezGVnENJI/AAAAAAAAAYE/57B6KV1OXoI/s1600/apbleed_result.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-dzaBhbP5mAw/U4ezGVnENJI/AAAAAAAAAYE/57B6KV1OXoI/s1600/apbleed_result.png" /></a></div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Geplaatst door
<span class='fn'>Mathy</span>
</span>
<span class='post-timestamp'>
op
<a class='timestamp-link' href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html' rel='bookmark' title='permanent link'><abbr class='published' title='2014-05-30T01:33:00+02:00'>01:33</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html#comment-form' onclick=''>1 reacties</a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-606357465'>
<a href='http://www.blogger.com/post-edit.g?blogID=3500917063499850097&postID=922135596181614234&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=922135596181614234&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=922135596181614234&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=922135596181614234&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=922135596181614234&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=922135596181614234&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html' size='medium' width='300' annotation='inline'/></div>
</div>
<span class='post-backlinks post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html#links'>Links naar dit bericht</a>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://www.mathyvanhoef.com/search/label/exploits' rel='tag'>exploits</a>,
<a href='http://www.mathyvanhoef.com/search/label/network' rel='tag'>network</a>,
<a href='http://www.mathyvanhoef.com/search/label/wireless' rel='tag'>wireless</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'><span class='post-location'>
</span>
</div>
</div>
</div>
</div>
<!-- google_ad_section_end(name=default) -->
<div class='inline-ad'>
<script type="text/javascript"><!--
google_ad_client="pub-2753532741085396";
google_ad_host="pub-1556223355139109";
google_ad_width=468;
google_ad_height=15;
google_ad_format="468x15_0ads_al_s";
google_ad_host_channel="0001";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="444444";
google_color_url="444444";
google_color_text="444444";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<!-- google_ad_section_start -->

            </div></div>
          

          <div class="date-outer">
        
<h2 class='date-header'><span>Sunday, 15 December 2013</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry'>
<a name='7235098347987692121'></a>
<h3 class='post-title entry-title'>
<a href='http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html'>Reversing and Exploiting ARM Binaries: rwthCTF Trafman</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7235098347987692121'>
<div style="text-align: justify;">
As ARM is becoming more and more popular, the need to reverse engineer ARM binaries is increasing as well. For example, nearly all mobile phones have at least one ARM processor. In this post I show how to set up a virtual ARM environment using Qemu, give an introduction to ARM assembly (while highlighting the differences with x86), show how to reverse ARM binaries, and finally demonstrate how to write basic exploits for ARM. We will use the <a href="https://www.mediafire.com/?b27u67c779o8azp">trafman challenge</a> of <a href="http://ctf.itsec.rwth-aachen.de/">rwthCTF</a> as an example.</div>
<div style="text-align: justify;">
<br />
<br /></div>
<div style="text-align: justify;">
<b><span style="font-size: large;">Virtual ARM Environment</span></b></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
To start we need an environment capable of running ARM binaries. Since I didn't have an ARM machine I created a virtual ARM environment using Qemu. Qemu is similar to VirtualBox or VMWare, except that it can support multiple architectures. This allows you the emulate ARM on your default x86 or x64 machine.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
First we need to know which ARM architecture to pick. Most Linux distributions support two architectures: <b>armel</b> and <b>armhf</b>. Armel&nbsp;supports the ARMv4 instruction set and emulates floating point operations in software, while armhf supports the ARMv7 instruction set and uses hardware floating point operations. At least that's the case for Debian, Ubuntu uses the term "armel" differently [<a href="https://wiki.ubuntu.com/ARM">Ubuntu FAQ</a>, <a href="http://emdebian.org/~zumbi/fosdem-arm-2011/">ARM FOSDEM</a>]. In this post I will stick to Debian. Though I haven't tested this myself, it should be possible to <a href="http://unix.stackexchange.com/a/60287">run armel binaries on an armhf system</a>&nbsp;(this should be true for both Ubuntu and Debian). <a href="http://emdebian.org/~zumbi/fosdem-arm-2011/">For completeness</a>, there were also the '<b>arm'</b> and <b>'armeb'</b>&nbsp;architectures, but they are no longer supported and don't appear to be used anymore. We will use the armhf architecture, in particular <a href="http://www.debian.org/releases/stable/armhf/release-notes/">Debian Wheezy armhf</a>.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Unlike x86/PC systems, ARM systems typically don't have a BIOS. This means nothing initializes the hardware, reads the first sector of the disk, or finds where to execute code from. Instead, Qemu allows you to start a system using a "-kernel" option. It loads the given binary into memory at 0x6001000 and uses a kernel calling convention to pass the commandline and the location of initrd [<a href="http://io.smashthestack.org/arm/">#IO ARM Challenge</a>]. In practice this means we'll always have to start Qemu using a -kernel and -initrd option.</div>
<div style="text-align: justify;">
<div style="text-align: left;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: left;">
<div style="text-align: justify;">
With that background we're ready to install Debian Wheezy armhf using Qemu. First create an empty directory for the virtual environment, create a virtual harddisk for Qemu, and download the appropriate initrd and vmlinux from the Debian FTP:</div>
</div>
<div style="text-align: left;">
<ul>
<li><b>qemu-img create -f raw hda.img 3G</b></li>
<li><b>wget <a href="http://ftp.debian.org/debian/dists/wheezy/main/installer-armhf/current/images/vexpress/netboot/initrd.gz">http://ftp.debian.org/debian/dists/wheezy/main/installer-armhf/current/images/vexpress/netboot/initrd.gz</a></b></li>
<li><b>wget <a href="http://ftp.debian.org/debian/dists/wheezy/main/installer-armhf/current/images/vexpress/netboot/vmlinuz-3.2.0-4-vexpress">http://ftp.debian.org/debian/dists/wheezy/main/installer-armhf/current/images/vexpress/netboot/vmlinuz-3.2.0-4-vexpress</a></b></li>
</ul>
</div>
Note that vexpress stands for the system we will emulate, namely a Versatile Express board. We will emulate it with a cortex-a9 processor, so we pass vexpress-a9 as an argument to Qemu. Now start the installer under Qemu as follows:<br />
<div style="text-align: left;">
</div>
<div style="text-align: left;">
<ul>
<li><b>qemu-system-arm -M vexpress-a9 -kernel vmlinuz-3.2.0-4-vexpress -initrd initrd.gz -append "root=/dev/mmcblk0" -drive if=sd,cache=unsafe,file=hda.img</b></li>
</ul>
</div>
Follow the instructions. A graphical environment is not required. After the installation we have to extract the installed initrd image, otherwise (if you use the downloaded initrd) the installer will again boot.&nbsp;To mount the virtual filesystem we first have to find the proper offset. Execute "<b>file hda.img</b>". The output should include something like "startsector 2048". The offset is now 512*2048. In case your offset is different than 2048 you will have to update the numbers in the next commands:</div>
<ul><span style="text-align: left;">
<li><b>mkdir mountdir</b></li>
<li><b>mount -o loop,offset=$((512*2048)) hda.img mountdir/</b></li>
<li><b>cp mountdir/initrd.img-3.2.0-4-vexpress .</b></li>
<li><b><b>umount mountdir/</b></b></li>
</span></ul>
<div>
And now you can boot your virtual ARM environment with:</div>
<span style="font-weight: bold; text-align: left;"></span>

<br />
<ul><span style="font-weight: bold; text-align: left;">
<li>qemu-system-arm -M vexpress-a9 -kernel&nbsp;vmlinuz-3.2.0-4-vexpress&nbsp;-initrd <span style="color: red;">initrd.img-3.2.0-4-vexpress</span> -append "root=/dev/<span style="color: red;">mmcblk0p2</span>" -drive if=sd,cache=unsafe,file=hda.img</li>
</span></ul>
You should now have a working Qemu environment.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-fGHFBKG2n7k/UoEyiHEH76I/AAAAAAAAAUA/ZqpDpQmjMoM/s1600/qemu.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-fGHFBKG2n7k/UoEyiHEH76I/AAAAAAAAAUA/ZqpDpQmjMoM/s400/qemu.png" height="306" width="400" /></a></div>
<br />
One warning: Qemu is still an emulator. When testing rare edge cases of exotic ARM instructions (which do not occur much in practice) there's always a chance the emulator is wrong.<br />
<br />
<br />
<b><span style="font-size: large;">Network Interface in Qemu</span></b><br />
<br />
<div style="text-align: justify;">
If the program you want to reverse engineer is a network service, it is convenient to be able to connect to it from your host system. This allows you to use tools on your host system to connect and exploit the binary (while debugging it in the guest system). This is especially convenient if Qemu is slow.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
To enable network support we must specify a network device (NIC) that will be emulated. And we must specify the network backend that Qemu should use to interact with the emulated NIC. By default Qemu emulates an Intel e1000 PCI card&nbsp;with a user-mode network stack.&nbsp;User mode networking is great for allowing access to network resources, including the Internet. By default, however, it acts as a firewall and does not permit any incoming traffic. It also doesn't support protocols other than TCP and UDP. For example, ping won't work [<a href="https://en.wikibooks.org/wiki/QEMU/Networking#User_mode_networking">WikiBooks</a>].</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
The first option to allow incoming traffic is port redirection. This allows you to redirect a port on the host OS to a port on the guest OS. For debugging a simple service this is sufficient. As an example, redirecting TCP port 6666 on the host to port 8080 on the guest is done as follows:</div>
<blockquote class="tr_bq">
<span style="font-weight: bold;">qemu-system-arm -M vexpress-a9 -kernel&nbsp;vmlinuz-3.2.0-4-vexpress&nbsp;-initrd&nbsp;</span><span style="font-weight: bold;">initrd.img-3.2.0-4-vexpress</span><span style="font-weight: bold;">&nbsp;</span><span style="font-weight: bold;">-append "root=/dev/</span><span style="font-weight: bold;">mmcblk0p2</span><span style="font-weight: bold;">" -drive if=sd,cache=unsafe,file=hda.img<span style="color: red;"> -redir tcp:6666::8080</span></span></blockquote>
<div style="text-align: justify;">
You can now run a service on port 8080 in the Qemu guest, and connect to it from the host using port 6666. Multiple ports can be redirected. Port redirection can also be used to share folders between the guest and the host [<a href="https://en.wikibooks.org/wiki/QEMU/Networking#Redirecting_ports">WikiBooks</a>]. The downside is that you cannot dynamically add new redirects once Qemu is running. Additionally, only TCP and UDP are supported.<br />
<br /></div>
<div style="text-align: justify;">
The second option is to create a TAP interface [<a href="http://backreference.org/2010/03/26/tuntap-interface-tutorial/">Tun/Tap Intro</a>,&nbsp;<a href="http://wiki.qemu.org/Documentation/Networking">QemuWiki</a>].&nbsp;It offers very good performance and can be configured to create virtually any type of network topology. This creates a new virtual interface on your host system, and you can use this interface to communicate with the guest. To start Qemu using a TAP interface as network backend, use the following command:</div>
<blockquote class="tr_bq">
<span style="font-weight: bold; text-align: start;">qemu-system-arm -M vexpress-a9 -kernel&nbsp;vmlinuz-3.2.0-4-vexpress&nbsp;-initrd&nbsp;</span><span style="font-weight: bold; text-align: start;">initrd.img-3.2.0-4-vexpress</span><span style="font-weight: bold; text-align: start;">&nbsp;</span><span style="font-weight: bold; text-align: start;">-append "root=/dev/</span><span style="font-weight: bold; text-align: start;">mmcblk0p2</span><span style="font-weight: bold; text-align: start;">"&nbsp;-drive if=sd,cache=unsafe,file=hda.img <span style="color: red;">-net nic -net tap,ifname=qtap0</span></span></blockquote>
<div style="text-align: justify;">
Unfortunately you will have to manually configure IP addresses (e.g. setup a DHCP server, configure DNS, configure IP forwarding/NAT, etc). I will not go into detail here. If you don't need an internet connection and only need basic communication between the host and guest, execute the following commands in the guest:</div>
<ul>
<li>ip addr add 172.20.0.2/24 dev eth0</li>
<li>route add default gw 172.20.0.1 eth0</li>
</ul>
<div>
I prefer port redirection because it's easier to configure and is usually sufficient to get the job done.</div>
<div>
<br /></div>
<br />
<div style="text-align: justify;">
<b><span style="font-size: large;">Introduction to ARM Assembly</span></b></div>
<div style="text-align: justify;">
<br />
Simplified, an ARM processor can be in two modes: ARM mode and Thumb mode. When the CPU is in ARM mode it executes 32 bit ARM instructions, and when it is in Thumb mode it executes mixed 16- and 32-bit Thumb instructions. The purpose of Thumb mode is to improve code density. How to switch between ARM and Thumb mode will be explained shortly.<br />
<br />
In both ARM and Thumb mode we have access to 16 32-bit registers called r0..r15. Special registers are:<br />
<ul>
<li>r12: intra procedure register (ip)</li>
<li>r13: stack pointer (sp)</li>
<li>r14: link register (lr)</li>
<li>r15: program counter (pc)</li>
</ul>
Register r12 is sometimes used as an Intra Procedure (<b>ip</b>) call scratch register, meaning it holds intermediate values when a subroutine is being called. So if you see the <b>ip</b>&nbsp;register in a disassembly listing, it does <i>not</i> stand for instruction pointer. Finally, subroutines must preserve the contents of r4..r11 and the stack pointer r13. A few short examples:<br />
<blockquote class="tr_bq">
<span style="font-family: Courier New, Courier, monospace;">sub sp, #8 &nbsp; &nbsp; &nbsp; &nbsp;; sp -= 8 &nbsp;// allocate stack memory</span><br />
<span style="font-family: Courier New, Courier, monospace;">add r7, sp, #0 &nbsp; &nbsp;; r7 = sp + 0</span><br />
<span style="font-family: Courier New, Courier, monospace;">add r7, #0 &nbsp; &nbsp; &nbsp; &nbsp;; r7 += 0</span><br />
<span style="font-family: Courier New, Courier, monospace;"><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0497a/BABJGHFJ.html">str</a> r0, [r7, #4] &nbsp;; *(r7 + 4) = r0 // dereference ptr</span><br />
<span style="font-family: Courier New, Courier, monospace;"><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0497a/BABJGHFJ.html">str</a> r0, [r7, #0] &nbsp;; *(r7 + 0) = r0</span><br />
<span style="font-family: Courier New, Courier, monospace;">nop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; No Operation</span><br />
<span style="font-family: Courier New, Courier, monospace;"><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0489c/Cjagdjbf.html">movw</a> r0, #33848 &nbsp; ; r0[0:16] &nbsp;= 0x8438 // move to bottom</span><br />
<span style="font-family: Courier New, Courier, monospace;"><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0489c/Cjagdjbf.html">movt</a> r0, #1 &nbsp; &nbsp; &nbsp; ; r0[16:32] = 0x1 &nbsp; &nbsp;// move to top</span><br />
<span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Now r0 contains 0x18438</span></blockquote>
Here r7 is used as a frame pointer to access local variables or function arguments. Also note that certain&nbsp;instructions (like <span style="font-family: Courier New, Courier, monospace;">add</span>) can have three arguments (unlike the common two arguments in x86). In order to move a 32bit word in a register we need two instructions: one to set the bottom half of the register, and one to set the upper half of the register. This is a consequence of the RISC architecture of ARM: we have simple instructions that execute quickly, but must be more verbose to get stuff done.<br />
<br />
What we called jumps in x86 lingo are called <b>branches</b> in ARM. For example "<span style="font-family: Courier New, Courier, monospace;">jmp offset</span>" on x86 becomes "<span style="font-family: Courier New, Courier, monospace;">b addr</span>" in ARM. Function calls from x86 are also called branches, in particular "<span style="font-family: Courier New, Courier, monospace;">call func</span>" from x86 becomes "<span style="font-family: Courier New, Courier, monospace;">bl addr</span>" in ARM. Here BL stands for Branch and Link, meaning the program counter r15 is set to <span style="font-family: Courier New, Courier, monospace;">addr</span> and the link register r14 is set to the return address. This highlights an important difference with x86: in ARM the return address is not pushed on the stack by the caller. Instead, it it always saved in the link register (lr). The callee is responsible for saving the return address (generally the callee will save it on the stack).<br />
<br />
The instructions&nbsp;<a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0204f/Cihfddaf.html"><span style="font-family: Courier New, Courier, monospace;">bx</span>,&nbsp;<span style="font-family: Courier New, Courier, monospace;">blx</span>, and&nbsp;<span style="font-family: Courier New, Courier, monospace;">bjx</span></a>&nbsp;can be used to switch processor mode from ARM to Thumb (or reverse). There are two use cases: the target is a label or the target is a register [<a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0204f/Cihfddaf.html">ARM</a>]. In the case the target is a label, the instruction is of the form "<span style="font-family: Courier New, Courier, monospace;">blx addr</span>", and the mode is always switched. In case the target is specified using a register, e.g. "<span style="font-family: Courier New, Courier, monospace;">blx lr</span>", the mode will be set according to the least significant bit (LSB) of the register. Note that all ARM and Thumb instructions must be 16-bit (two bytes) aligned, thus the least significant bit (LSB) of function addresses is in fact always zero. An even address means the target code is an ARM instruction, an uneven address means it is Thumb code. For example, when the register contains the value 0x8001 the processor will switch to Thumb mode and start executing at 0x8000. The same is true when returning from a function: if the return address is even it will switch to ARM, if it is uneven it will switch to Thumb mode. Returning can be done using "<span style="font-family: Courier New, Courier, monospace;">pop {pc}</span>" or "<span style="font-family: Courier New, Courier, monospace;">bx lr</span>". Both instructions will set the processor context accordingly. Note that branch instructions without an "X" in them do not change processor mode.<br />
<br />
One practical consequence of ARM vs. Thumb addresses is that we often see references to "symbol+1", indicating that the symbol is referring to a function in Thumb mode. Additionally we have to use correct addresses in our exploit: Your debugger might say a function starts at address 0x8000, but if it is a function using Thumb instructions we must actually use the address 0x8001 (depending on context). Finally we note that we can inspect the current mode in gdb by using the "<span style="font-family: Courier New, Courier, monospace;">i r cpsr</span>" command. <a href="http://www-mdp.eng.cam.ac.uk/web/library/enginfo/mdp_micro/lecture3/lecture3-1.html">Bit 0x20 will be set</a> if we are in Thumb mode, i.e. Thumb mode is set if (cpsr &amp; 0x20) != 0.<br />
<br />
Let's end with the second half of the previous example:<br />
<blockquote class="tr_bq">
<span style="font-family: Courier New, Courier, monospace;">blx 0x82ec &nbsp; &nbsp; &nbsp;; branch to 0x82ec (and switch mode)</span><br />
<span style="font-family: Courier New, Courier, monospace;">bl 0x8398 &nbsp; &nbsp; &nbsp; ; branch to 0x8298 (don't switch mode)</span><br />
<span style="font-family: Courier New, Courier, monospace;">add r12, r12, #8, 20 &nbsp; &nbsp; ; r12 = 0x8000</span><br />
<span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">0x8000&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">= RotateRight(8, 2*20) [<a href="http://people.cs.umass.edu/~trekp/cs201/lecture_notes/lecture11.txt">ref</a>]</span><br />
<span style="font-family: Courier New, Courier, monospace;">mov sp, r7 &nbsp; &nbsp; &nbsp;; set stack pointer to original value</span><br />
<span style="font-family: Courier New, Courier, monospace;">pop {r7, pc} &nbsp; &nbsp;; restore r7 and return to caller</span></blockquote>
The first instruction branches to address 0x82ec and switches the current processor mode, with the return address saved in the <b>lr</b> register. In case we were executing Thumb code this return address will be uneven, otherwise it will be even. The second instruction branches to 0x8398 without switching mode (there is no <span style="font-family: Courier New, Courier, monospace;">x</span> in the branch instruction). Hence the function will be executed in the mode the processor is currently in. We also have an interesting <span style="font-family: Courier New, Courier, monospace;">add</span> instruction: it adds RotateRight(<b>8</b>, 2*<b>20</b>) to r12 (which is equal to 0x8000). For more background on how this constant is encoded read <a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0204f/Cihbeage.html">the ARM documentation</a>.<br />
<br /></div>
<div style="text-align: justify;">
If you want to understand ARM in more detail, a fun way to learn it is by making an ARM intro challenge. Essentially that means displaying cool graphics using only ARM code. The full background on how to get started is on&nbsp;<a href="http://io.smashthestack.org/arm/">#IO STS</a>. Perhaps luckily, a detailed understanding is not required to reverse engineer a program and follow this guide.</div>
<div style="text-align: justify;">
<br />
<br /></div>
<div style="text-align: justify;">
<b><span style="font-size: large;">Reversing the Trafman Challenge</span></b></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
As an example we will reverse engineer the <a href="https://www.mediafire.com/?b27u67c779o8azp">Trafman challenge</a> from rwthCTF (for the binary to work properly you need to create a directory called "db" next to the binary). We open the binary in <a href="https://www.hex-rays.com/products/ida/support/download_demo.shtml">IDA</a> and see that it failed to disassemble the first instructions:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-MhpQtKKqHlQ/Uqy35HTE4tI/AAAAAAAAAUc/uWt6fB62DBs/s1600/strafman_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-MhpQtKKqHlQ/Uqy35HTE4tI/AAAAAAAAAUc/uWt6fB62DBs/s1600/strafman_1.png" /></a></div>
<br />
This is because <span style="font-family: Courier New, Courier, monospace;">start</span> is located at the uneven address 0x880D. In other words the binary starts executing in Thumb mode at address 0x880C, but IDA thinks it starts executing at 0x880D. We fix this by selecting address 0x880C, pressing ALT+G, and changing the value to 1 (this tells IDA that Thumb code is located at this address). Now again select address 0x880C and press C to directly convert the section to code.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-5iAGRsPjpkg/Uqy5HHYJnWI/AAAAAAAAAUo/JBbGcsDfWgc/s1600/strafman_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-5iAGRsPjpkg/Uqy5HHYJnWI/AAAAAAAAAUo/JBbGcsDfWgc/s1600/strafman_2.png" /></a></div>
<br />
We see a call which initializes libc. The pointer to the main function is stored in r0. Hence main() is located at address 0x87E0 and is Thumb code. So go to address 0x87E0, press ALT+G, set value to 1, and repeat until all instructions are in Thumb. Now select all the instructions belonging to the main function and press P to create a function of this code block. We have to manually select all the instructions in the function because otherwise IDA fails to create the function for us. Rename the function to main.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-2eF2asxSLSk/Uqy-OGY0AlI/AAAAAAAAAU4/_vsZc3Ztw8M/s1600/strafman_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-2eF2asxSLSk/Uqy-OGY0AlI/AAAAAAAAAU4/_vsZc3Ztw8M/s1600/strafman_2.png" /></a></div>
<br />
With this starting point you can analyze what the binary is doing. Also remember to interact as much as possible with the application before looking at assembler code. In fact, I found one vulnerability by simply entering unusual inputs.<br />
<br />
The binary gets its input and output using stdin and stdout, respectively. During the CTF a new executable was spawned for every new connection and its input/output was forwarded. On startup the binary asks for a username. Our first goal is to find a valid username.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-p4j8W7Du7no/Uqzdeh6yH2I/AAAAAAAAAVI/Ud9-8E9XSRU/s1600/strafman_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-p4j8W7Du7no/Uqzdeh6yH2I/AAAAAAAAAVI/Ud9-8E9XSRU/s1600/strafman_2.png" /></a></div>
<br />
We want to locate the code responsible for checking the username. To do this we find where the error message is referenced. So, open the Strings subview and double click on the "ERR Invalid User" string. Now select the name of the string (aErrInvalidUser) and press X to find all references to the string. Only one function is referencing this string, open it. After a little bit of reverse engineering we get the following:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-Gz55w5N2ZOE/UqzhvkkLPHI/AAAAAAAAAVg/x8uhwbJwhG0/s1600/strafman_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-Gz55w5N2ZOE/UqzhvkkLPHI/AAAAAAAAAVg/x8uhwbJwhG0/s1600/strafman_3.png" /></a></div>
<br />
The ASCII string "traffic_operator" is loaded and compared to the string entered by the user. Based on the result of this comparison we either get the error message or are successfully logged in. That solves our first problem: the username is traffic_operator.<br />
<br />
Once logged in the user has three options:<br />
<ol>
<li><b>Get command</b>: the user enters a file name of exactly 40&nbsp;alphanumeric&nbsp;characters. If this file was previously added (see next point) its content is loaded and displayed to the user.</li>
<li><b>Execute command</b>: the user enters a file name of at least 40 alphanumeric&nbsp;characters. It creates a file with as name the 40 first characters and allows to user to write arbitrary content to it.</li>
<li><b>Exit</b>.</li>
</ol>
After testing these functions we find a buffer overflow when getting a command (i.e. when reading a file). To trigger the overflow we write a large file using the second option, and then read it using the first option. In my virtual ARM environment I used the following commands to test and trigger the vulnerability:<br />
<ul>
<li><b>ARM host</b>:&nbsp;nc -c ./trafman -l -p 8000</li>
<li><b>Guest OS</b>:&nbsp;perl -e 'print "traffic_operator\n2\n"."a"x40 ."\n"."A"x400 ."\n1\n"."a"x40 ."\n"' | nc localhost 8000</li>
</ul>
We will analyze the crash in more detail in the next section. First, we reverse engineer the option menu. It's easy to locate this code because it's contained in the only function that main() calls. So open main and double click on the only non-library function being called. The text-based interface shows only three options. However, when looking at the code, we see there is a hidden option. When entering 23 the address of printf is displayed:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-AnRYqRSCki8/Uqzp263lvcI/AAAAAAAAAWE/lQNJTaM-U5A/s1600/strafman_3.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-AnRYqRSCki8/Uqzp263lvcI/AAAAAAAAAWE/lQNJTaM-U5A/s1600/strafman_3.png" /></a></div>
<br />
Notice that r0 is set to 0x8FC4 which is a pointer to the ASCII string "&gt; %p". Register r7 is initialized in the beginning of the function to&nbsp;0x12010. This address contains the dynamically loaded address of printf. Hence, it will tell us where libc is located in memory.<br />
<br /></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
<b><span style="font-size: large;">Getting Control of the Program Counter</span></b></div>
<div style="text-align: justify;">
<br />
We know what to do to crash the program. But we don't yet know what is causing the crash, which code is responsible, and whether it's exploitable. To answer these questions we run the binary in a debugger. Executing the following commands allows us to connect to the service from our host OS yet still debug the trafman binary itself:<br />
<ul>
<li>gbc nc</li>
<li>set follow-fork-mode child</li>
<li>r -c ./trafman -l -p 8000</li>
</ul>
We now trigger the crash with:<br />
<ul>
<li>perl -e 'print "traffic_operator\n2\n"."a"x40 ."\n"."A"x400 ."\n1\n"."a"x40 ."\n"' | nc localhost 8000</li>
</ul>
This results in a segmentation fault because it's trying to execute code at 0x41414141. Executing "x/20x $sp" in gdb to dump the stack shows that it's likely a stackoverflow vulnerability. With this alone we know enough to write a functional exploit. But since we're learning ARM we will take a look at the code that is responsible for the buffer overflow. We open the function that is executed when the user selects option 1 in the menu and reverse it.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-xh7rfnv7Ms0/Uq0KQQ8wvhI/AAAAAAAAAWU/UvkCJhFMOn4/s1600/strafman_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-xh7rfnv7Ms0/Uq0KQQ8wvhI/AAAAAAAAAWU/UvkCJhFMOn4/s1600/strafman_3.png" /></a></div>
<br />
What happens here is that each byte in the file gets read using fgetc until we are at the end of the file. In every loop the new byte is saved to an array on the stack, which will eventually overflow. The function returns to the caller using a "<span style="font-family: Courier New, Courier, monospace;">pop {pc}</span>" instruction. An interesting instruction here is "<span style="font-family: Courier New, Courier, monospace;">adds r0, #1</span>". It adds one to the register r0, and updates the status (a.k.a. condition) flags according to the resulting value. In particular, if the result is zero (meaning r0 was -1), the zero flag will be set. Using the BNE instruction we test for the zero flag. If it is set we exit the loop. Note that more instructions can set the status flag this way, and they can be recognized using the S suffix.<br />
<br />
So we indeed have a classic buffer overflow (without a stack canary). The return address is saved on the stack and popped on the function exit. Our first step in exploiting the binary is to find out where we have to put the return address in our file (remember that the content of the file is written to the stack and parts of it will overflow the saved return address). To quickly accomplish this we use the pattern_create tool from metasploit. We again start the binary in Qemu as follows (I won't repeat this again):<br />
<ul>
<li>gbc nc</li>
<li>set follow-fork-mode child</li>
<li>r -c ./trafman -l -p 8000</li>
</ul>
</div>
<div style="text-align: justify;">
On our host we execute the following commands:<br />
<ul>
<li>PATRN=$(/usr/share/metasploit-framework/tools/pattern_create.rb 400)</li>
<li>perl -e 'print "traffic_operator\n2\n"."a"x40 ."\n"."'$PATRN'" ."\n1\n"."a"x40 ."\n"' | nc localhost 8000</li>
</ul>
</div>
<div style="text-align: justify;">
We let pattern_create.rb generate a unique pattern of 400 characters. As an example, a unique pattern of 20 characters would be "Aa0Aa1Aa2Aa3Aa4Aa5Aa". If we now know which bytes in this pattern get loaded in the program counter, we can let pattern_offset.rb calculate the offset where the return address is located in our file. In gdb we see it segfaults with the program counter at 0x41326a40. So we find the offset with the following command:<br />
<ul>
<li>/usr/share/metasploit-framework/tools/pattern_offset.rb 41326a40</li>
</ul>
This returns 276. So we have to put the return address <b>276</b> bytes into the payload. As a quick test, execute the following command:<br />
<ul>
<li>perl -e 'print "traffic_operator\n2\n"."a"x40 ."\n"."A"x<b>276</b> ."ABCD\n1\n"."a"x40 ."\n"' | nc localhost 8000</li>
</ul>
This will segfault with the program counter at "ABCD". We now need to point the program counter to code that will get us a shell. Unfortunately the binary uses both ASLR and NX, meaning it uses random addresses, and we can't execute data on the stack and/or heap.<br />
<br />
<br />
<b><span style="font-size: large;">Defeating ASLR and NX</span></b><br />
<br />
Our goal is a return-to-libc attack. In particular we will attempt to execute system("/bin/sh"). Defeating ASLR is trivial due to the hidden menu option which prints the address of printf. Based on the address of printf we can locate the addresses of other variables and functions within the libc library. To get the address of printf and system for a specific run we execute "p printf" and "p system" in gdb. This gives:<br />
<ul>
<li>system: 0x76f2aa38</li>
<li>printf:&nbsp;0x76f347d4</li>
</ul>
There is one catch: gdb says these functions are located at an even address. However, the functions are actually Thumb code! So make sure that the correct processor mode is used when executing these functions (if necessary make the addresses uneven). Anyway, the hidden menu option returns an uneven address, hence to get the address of system we take the address of printf and substract 0x9D9C from it.<br />
<br />
So we can call system, but still need to pass an argument to it. There are two steps to accomplish this, first we need to find out where in memory the string "/bin/sh" is located, then we need to find a way to put a pointer to this string into register r0 (recall that r0 contains the first argument of a function).<br />
<br />
Finding a "/bin/sh" string it easy. Internally the system() function uses it as well, so it's located in the libc library. To quick find it execute the following in gdb:<br />
<ul>
<li>find &amp;system, +99999999, "/bin/sh"</li>
</ul>
In my particular instance this returned 0x76fc6528. So to dynamically get the address of "/bin/sh" we take the address of printf and add 0x91D53 to it (again remember that the hidden option returns the uneven address). To load this pointer into r0 with NX enabled we will use return-oriented-programming (ROP).<br />
<br />
We will use ROP gadgets located in the libc library, because that's the only library we know the addresses of. Within the library we have to find gadgets which set r0 and let us return to the system function. To do this I transferred libc.so.6 to the host and executed:<br />
<ul>
<li>arm-linux-objdump -d libc.so.6 | grep "pop.*r0.*pc"</li>
</ul>
<div>
To install the arm-linux-* tools see <a href="http://io.smashthestack.org/arm/">IO SmashTheStack</a>. There are likely better tools to find usable gadgets, but this quick and dirty method got the job done. Important is to search for both Thumb and ARM gadgets! Forcing Thumb mode can be done using -Mforce-thumb. The most interesting gadget found was:</div>
<div>
<ul>
<li><b>5a7bc</b>: pop &nbsp;{r0, r4, pc}</li>
</ul>
</div>
Remark that this is ARM instruction. In objdump printf is located at 0x387d4. I found this by executing:<br />
<ul>
<li>arm-linux-objdump -d libc.so.6 | grep "printf&gt;:"</li>
</ul>
So to dynamically get the location of the gadget we take the location of printf and add 0x21FE8 to it. Good, we now have everything in place to trigger the overflow and make it execute system("/bin/sh"). Combining all findings results in <a href="http://paste.debian.net/70960/">the following exploit</a>, where I wrote the&nbsp;nclib myself and its functionality should be self-explanatory. When executing the exploit it looks like this:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-Stcy_w0rKAo/Uq28HQlOoDI/AAAAAAAAAWs/HSuww0x3xdo/s1600/strafman_4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Stcy_w0rKAo/Uq28HQlOoDI/AAAAAAAAAWs/HSuww0x3xdo/s1600/strafman_4.png" /></a></div>
<br />
DONE. FINALLY! :D</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Geplaatst door
<span class='fn'>Mathy</span>
</span>
<span class='post-timestamp'>
op
<a class='timestamp-link' href='http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html' rel='bookmark' title='permanent link'><abbr class='published' title='2013-12-15T17:09:00+01:00'>17:09</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html#comment-form' onclick=''>4
reacties</a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-606357465'>
<a href='http://www.blogger.com/post-edit.g?blogID=3500917063499850097&postID=7235098347987692121&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=7235098347987692121&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=7235098347987692121&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=7235098347987692121&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=7235098347987692121&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=7235098347987692121&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html' size='medium' width='300' annotation='inline'/></div>
</div>
<span class='post-backlinks post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html#links'>Links naar dit bericht</a>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://www.mathyvanhoef.com/search/label/exploits' rel='tag'>exploits</a>,
<a href='http://www.mathyvanhoef.com/search/label/tutorials' rel='tag'>tutorials</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'><span class='post-location'>
</span>
</div>
</div>
</div>
</div>
<!-- google_ad_section_end -->
<div class='inline-ad'>
<script type="text/javascript"><!--
google_ad_client="pub-2753532741085396";
google_ad_host="pub-1556223355139109";
google_ad_width=468;
google_ad_height=15;
google_ad_format="468x15_0ads_al_s";
google_ad_host_channel="0001";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="444444";
google_color_url="444444";
google_color_text="444444";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<!-- google_ad_section_start -->

            </div></div>
          

          <div class="date-outer">
        
<h2 class='date-header'><span>Sunday, 10 November 2013</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry'>
<a name='6400434697002483484'></a>
<h3 class='post-title entry-title'>
<a href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html'>Unmasking a Spoofed MAC Address (CVE-2013-4579)</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-6400434697002483484'>
<div style="text-align: justify;">
<div style="text-align: justify;">
<b><span style="color: red;">Update</span></b>: This vulnerability has been fixed in <a href="http://www.kernelhub.org/?p=2&amp;msg=396037">kernel&nbsp;3.8.13.16</a> and above.<br />
<br />
Certain Atheros wireless drivers do not properly update the MAC address when changed (spoofed) by a user. This allows an active attacker to retrieve the original MAC address. In short, spoofing your MAC address does not always hide the original MAC address.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
<center>
<iframe allowfullscreen="" frameborder="0" height="375" mozallowfullscreen="" src="//player.vimeo.com/video/79032071" webkitallowfullscreen="" width="500"></iframe></center>
</div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<span style="font-size: large;"><b>Background</b></span></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
While working on the ath9k_htc driver<span style="color: #444444; font-family: arial, sans-serif; font-size: x-small;"><span style="line-height: 16px;">&nbsp;(</span></span>used by Atheros USB WiFi dongles<span style="color: #444444; font-family: arial, sans-serif; font-size: x-small;"><span style="line-height: 16px;">)&nbsp;</span></span>I noticed the driver did not properly set a spoofed MAC address. Though the device appears to use the newly assigned MAC address correctly, the flaw allows an attacker capable of injecting packets towards the target to uncover the original MAC address.</div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
The cause of the problem lies in how the driver and hardware implement <a href="http://wireless.kernel.org/en/users/Documentation/iw/vif/">Multiple Virtual Interface (VIF)</a> support. Using this technology a single wireless chip can listen on multiple MAC addresses. Because sending an&nbsp;<a href="https://en.wikipedia.org/wiki/Retransmission_(data_networks)">acknowledgement</a>&nbsp;to correctly received packets is done in hardware, a question that arises is how the wireless chip can quickly determine whether a wireless packet was destined for it. At first you'd think there&nbsp;must be some method to give the hardware a (possibly fixed length) list of MAC addresses to listen on. However, some devices uses a different strategy (and in particular Atheros devices uses this method). Their strategy is the following: the wireless chip has a register which contains the "main" hardware MAC address (<span style="font-family: Courier New, Courier, monospace;">mainmac</span>), and a register containing a mask (<span style="font-family: Courier New, Courier, monospace;">macmask</span>). Given an incoming frame destined for a particular mac (<span style="font-family: Courier New, Courier, monospace;">incmac</span>), it sends an ACK and accepts the frame if and only if: (<span style="font-family: Courier New, Courier, monospace;">mainmac &amp; macmask) == (incmac &amp; macmask)</span>. You can see that <span style="font-family: Courier New, Courier, monospace;">macmask</span> determines which bits of <span style="font-family: Courier New, Courier, monospace;">incmask</span><span style="font-family: inherit;"> (MAC of the packet being received)</span> have to match those of <span style="font-family: Courier New, Courier, monospace;">mainmac</span>. Essentially the <span style="font-family: Courier New, Courier, monospace;">macmask</span>&nbsp;represents the locations where the bits of all the virtual MAC addresses are identical to the "main" hardware MAC address (<span style="font-family: Courier New, Courier, monospace;">mainmac</span>).</div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
To clarify, consider a device having two virtual interfaces, one with MAC address&nbsp;72:40:a2:3f:65:5a and another one with address&nbsp;8e:8e:95:cd:90:4e. In binary these MAC addresses are:</div>
</div>
<blockquote class="tr_bq">
<div style="text-align: justify;">
01110010 : 01000000 : 10100010 : 00111111 : 01100101 : 01011010 &nbsp;(<span style="text-align: justify;">72:40:a2:3f:65:5a)</span></div>
<div style="text-align: justify;">
10001110 : 10001110 : 10010101 : 11001101 : 10010000 : 01001110 &nbsp;(<span style="text-align: justify;">8e:8e:95:cd:90:4e)</span></div>
</blockquote>
<div style="text-align: justify;">
<div style="text-align: justify;">
Now, <span style="font-family: Courier New, Courier, monospace;">macmask</span>&nbsp;should consist of the bits where both these MAC addresses are the same (mathematically that's the negation of the XOR). In our example the mask would be:</div>
</div>
<div style="text-align: justify;">
<blockquote class="tr_bq">
<div style="text-align: justify;">
00000011 : 00110001 : 11001000 : 00001101 : 00001010 : 11101011 &nbsp;(03:31:c8:0d:0a:eb)</div>
</blockquote>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
So the wireless chip can pick either 72:40:a2:3f:65:5a or 8e:8e:95:cd:90:4e as its main MAC address, and then set the mask to 03:31:c8:0d:0a:eb. Frames sent to either of these MAC addresses will now be accepted and acknowledged. For more details see the <a href="http://lxr.free-electrons.com/source/drivers/net/wireless/ath/hw.c#L26">comments in the atheros driver source file</a>. Unfortunately this technique has the side effect that the wireless chipset now <a href="http://permalink.gmane.org/gmane.linux.kernel.wireless.general/107039">listens on more MAC addresses</a> then we really want, as not all bits of incoming frames are checked!</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
<b><span style="font-size: large;">Vulnerability Details</span></b></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
When a MAC address is spoofed the driver does not simply update the <span style="font-family: Courier New, Courier, monospace;">mainmac</span> register. Instead the <span style="font-family: Courier New, Courier, monospace;">mainmac</span> register will still contain the original MAC address, and <span style="font-family: Courier New, Courier, monospace;">macmask</span> will contain the bits where the original and spoofed MAC agree (see previous section). The wireless chip will acknowledge frames sent to the spoofed MAC addresses, and the operating system will include the spoofed MAC address in all packets, so everything will seem to work properly. Unfortunately this method allows an attacker to uncover the original MAC address bit by bit (given the spoofed MAC address). Specifically we can determine the value of any bit of the original MAC address as follows:</div>
<ol>
<li style="text-align: justify;"><b>Flip the bit in the spoofed MAC address</b>&nbsp;and send a packet to the modified MAC address.</li>
<li style="text-align: justify;">We now have two cases:</li>
<ul>
<li style="text-align: justify;"><b>The device replies with an ACK</b>: This means the mask for this bit is zero, thus the bit in the spoofed MAC address was different than the original MAC address.</li>
<li style="text-align: justify;"><b>Device doesn't reply</b>: This means the mask for this bit is one, so the bit we are guessing was identical to the bit in the spoofed MAC</li>
</ul>
</ol>
<div style="text-align: justify;">
By doing this for each bit, we eventually learn the complete original MAC address.</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
The vulnerability has been successfully exploited against <a href="http://wikidevi.com/w/index.php?title=Special%3AAsk&amp;q=%5B%5BChip1+model%3A%3A~AR7010*%5D%5D&amp;po=%3FInterface%0D%0A%3FForm+factor%3DFF%0D%0A%3FVendor+ID%0D%0A%3FDevice+ID%0D%0A%3FChip1+model%0D%0A%3FChip2+model%0D%0A%3FOUI%0D%0A&amp;eq=yes&amp;p%5Bformat%5D=broadtable&amp;sort_num=&amp;order_num=ASC&amp;p%5Blimit%5D=500&amp;p%5Boffset%5D=&amp;p%5Blink%5D=all&amp;p%5Bsort%5D=&amp;p%5Bheaders%5D=show&amp;p%5Bmainlabel%5D=&amp;p%5Bintro%5D=&amp;p%5Boutro%5D=&amp;p%5Bsearchlabel%5D=%E2%80%A6+further+results&amp;p%5Bdefault%5D=&amp;p%5Bclass%5D=sortable+wikitable+smwtable&amp;eq=yes">AR7010</a> and&nbsp;<a href="http://wikidevi.com/w/index.php?title=Special%3AAsk&amp;q=%5B%5BChip1+model%3A%3A~AR9271*%5D%5D&amp;po=%3FInterface%0D%0A%3FForm+factor%3DFF%0D%0A%3FVendor+ID%0D%0A%3FDevice+ID%0D%0A%3FChip1+model%0D%0A%3FChip2+model%0D%0A%3FOUI%0D%0A&amp;eq=yes&amp;p%5Bformat%5D=broadtable&amp;sort_num=&amp;order_num=ASC&amp;p%5Blimit%5D=500&amp;p%5Boffset%5D=&amp;p%5Blink%5D=all&amp;p%5Bsort%5D=&amp;p%5Bheaders%5D=show&amp;p%5Bmainlabel%5D=&amp;p%5Bintro%5D=&amp;p%5Boutro%5D=&amp;p%5Bsearchlabel%5D=%E2%80%A6+further+results&amp;p%5Bdefault%5D=&amp;p%5Bclass%5D=sortable+wikitable+smwtable&amp;eq=yes">AR9271</a> chipsets (which use the ath9k_htc driver) under following operating systems:</div>
</div>
<ul>
<li style="text-align: justify;">Debian 7.2.0 amd64 and i386</li>
<li style="text-align: justify;">Kali 1.0.5 amd64 and i386</li>
<li style="text-align: justify;">Ubuntu 13.10 amd64 and i386</li>
</ul>
<div style="text-align: justify;">
<div style="text-align: justify;">
The ath9k driver is not vulnerable (see comments below). The ath5k and ath10k were not tested and/or investigated. Other drivers also capable of creating multiple virtual interfaces with different MAC addresses, on a single device, might also be susceptible to the same vulnerability (so feel free test your device and post results).</div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<span style="font-size: large;"><b>Exploit</b></span></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
A <a href="http://paste.debian.net/hidden/f35bf5ee/">proof of concept has been implemented</a> in python using scapy. Given a MAC address that you suspect to be spoofed the tool will attempt to uncover the original MAC address. In case the tool returns the same MAC address as you entered, it means the target is not susceptible to the attack, or that the target is using the default MAC address of the device.</div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<span style="font-size: large;"><b>Patch</b></span></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
<br /></div>
</div>
<div style="text-align: justify;">
<div style="text-align: justify;">
Update: I have <a href="http://people.cs.kuleuven.be/~mathy.vanhoef/public/ath9khtc.patch">made a patch</a> and <a href="http://thread.gmane.org/gmane.linux.kernel.wireless.general/116199/focus=116264">submitted it</a> to the linux-wireless@vger.kernel.org mailing list (before this patch I also notified the <a href="https://lists.ath9k.org/pipermail/ath9k-devel/2013-November/012215.html">ath9k-devel mailing list</a>&nbsp;of the bug and filed a&nbsp;<a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=729573">bug report</a>&nbsp;for debian). The CVE ID of this bug is&nbsp;<span style="text-align: start;"><a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-4579">CVE-2013-4579</a>.</span></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
<b><span style="font-size: large;">Final Remarks</span></b></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Though spoofing a MAC address can be done securely by simply updating <span style="font-family: Courier New, Courier, monospace;">mainmac</span>, an attacker can use the same technique to learn that two virtual MAC addresses actually belong to the same user. So if you put up several virtual interfaces (possibly with random MAC addresses) <b>they can be easily linked back together</b> (again, that's if your device uses a method similar to the one described above). This flaw is inherent to usage of&nbsp;<span style="font-family: Courier New, Courier, monospace;">macmask</span> and, at first sight, seems difficult to fix.</div>
</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Geplaatst door
<span class='fn'>Mathy</span>
</span>
<span class='post-timestamp'>
op
<a class='timestamp-link' href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html' rel='bookmark' title='permanent link'><abbr class='published' title='2013-11-10T16:24:00+01:00'>16:24</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html#comment-form' onclick=''>7
reacties</a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-606357465'>
<a href='http://www.blogger.com/post-edit.g?blogID=3500917063499850097&postID=6400434697002483484&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=6400434697002483484&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=6400434697002483484&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=6400434697002483484&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=6400434697002483484&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='http://www.blogger.com/share-post.g?blogID=3500917063499850097&postID=6400434697002483484&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html' size='medium' width='300' annotation='inline'/></div>
</div>
<span class='post-backlinks post-comment-link'>
<a class='comment-link' href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html#links'>Links naar dit bericht</a>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://www.mathyvanhoef.com/search/label/drivers' rel='tag'>drivers</a>,
<a href='http://www.mathyvanhoef.com/search/label/exploits' rel='tag'>exploits</a>,
<a href='http://www.mathyvanhoef.com/search/label/network' rel='tag'>network</a>,
<a href='http://www.mathyvanhoef.com/search/label/privacy' rel='tag'>privacy</a>,
<a href='http://www.mathyvanhoef.com/search/label/research' rel='tag'>research</a>,
<a href='http://www.mathyvanhoef.com/search/label/wireless' rel='tag'>wireless</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'><span class='post-location'>
</span>
</div>
</div>
</div>
</div>

        </div></div>
      
<!-- google_ad_section_end -->
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://www.mathyvanhoef.com/search?updated-max=2013-11-10T16:24:00%2B01:00&amp;max-results=3' id='Blog1_blog-pager-older-link' title='Older Posts'>Older Posts</a>
</span>
<a class='home-link' href='http://www.mathyvanhoef.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='blog-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='http://www.mathyvanhoef.com/feeds/posts/default' target='_blank' type='application/atom+xml'>Posts (Atom)</a>
</div>
</div>
<script type="text/javascript">window.___gcfg = {'lang': 'en_GB'};</script>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget PopularPosts' id='PopularPosts1'>
<h2>Popular Posts</h2>
<div class='widget-content popular-posts'>
<ul>
<li>
<a href='http://www.mathyvanhoef.com/2012/05/whatsapp-considered-insecure.html'>WhatsApp Considered Insecure</a>
</li>
<li>
<a href='http://www.mathyvanhoef.com/2012/09/compat-wireless-injection-patch-for.html'>Compat-Wireless Injection Patch for Aircrack-ng</a>
</li>
<li>
<a href='http://www.mathyvanhoef.com/2011/10/exploiting-insert-into-sql-injections.html'>Exploiting 'INSERT INTO' SQL Injections Ninja Style</a>
</li>
<li>
<a href='http://www.mathyvanhoef.com/2013/11/unmasking-spoofed-mac-address.html'>Unmasking a Spoofed MAC Address (CVE-2013-4579)</a>
</li>
<li>
<a href='http://www.mathyvanhoef.com/2011/08/backtrack-5-and-windows-dual-boot-with.html'>Backtrack 5 and Windows Dual Boot with Full Disk Encryption</a>
</li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=PopularPosts&widgetId=PopularPosts1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("PopularPosts1"));' target='configPopularPosts1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget AdSense' id='AdSense1'>
<div class='widget-content'>
<script type="text/javascript"><!--
google_ad_client="pub-2753532741085396";
google_ad_host="pub-1556223355139109";
google_ad_width=200;
google_ad_height=200;
google_ad_format="200x200_as";
google_ad_type="text_image";
google_ad_host_channel="0001";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="444444";
google_color_url="3778CD";
google_color_text="444444";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=AdSense&widgetId=AdSense1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("AdSense1"));' target='configAdSense1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget LinkList' id='LinkList1'>
<h2>Other Blogs</h2>
<div class='widget-content'>
<ul>
<li><a href='http://www.daanraman.com/'>Daan Raman</a></li>
<li><a href='http://www.arneswinnen.net/'>Arne Swinnen</a></li>
<li><a href='http://rutgerbevers.be/'>Rutger Bevers</a></li>
<li><a href='http://thomasstockx.blogspot.be/'>Thomas Stockx</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=LinkList&widgetId=LinkList1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("LinkList1"));' target='configLinkList1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget Text' id='Text1'>
<h2 class='title'>Like what you read?</h2>
<div class='widget-content'>
1G76fqHmyNSzBzu6uiohyFwGkpp8ou3jbv (BTC)<br />D6ByeAJNY2EmSvNnb8FNtEpf8uC3Y1pcdx (DOGE)<br />LeSmpQhVLbJ86PhsyUvT1JYi665DXBdXHk (LTC)<br />
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=Text&widgetId=Text1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("Text1"));' target='configText1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div><div class='widget Subscribe' id='Subscribe1'>
<div style='white-space:nowrap'>
<h2 class='title'>Subscribe To</h2>
<div class='widget-content'>
<div class='subscribe-wrapper subscribe-type-POST'>
<div class='subscribe expanded subscribe-type-POST' id='SW_READER_LIST_Subscribe1POST' style='display:none;'>
<div class='top'>
<span class='inner' onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img class='subscribe-dropdown-arrow' src='http://img2.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
Posts
</span>
<div class='feed-reader-links'>
<a class='feed-reader-link' href='http://www.netvibes.com/subscribe.php?url=http%3A%2F%2Fwww.mathyvanhoef.com%2Ffeeds%2Fposts%2Fdefault' target='_blank'>
<img src='http://img1.blogblog.com/img/widgets/subscribe-netvibes.png'/>
</a>
<a class='feed-reader-link' href='http://add.my.yahoo.com/content?url=http%3A%2F%2Fwww.mathyvanhoef.com%2Ffeeds%2Fposts%2Fdefault' target='_blank'>
<img src='http://img1.blogblog.com/img/widgets/subscribe-yahoo.png'/>
</a>
<a class='feed-reader-link' href='http://www.mathyvanhoef.com/feeds/posts/default' target='_blank'>
<img align='absmiddle' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
                Atom
              </a>
</div>
</div>
<div class='bottom'></div>
</div>
<div class='subscribe' id='SW_READER_LIST_CLOSED_Subscribe1POST' onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<div class='top'>
<span class='inner'>
<img class='subscribe-dropdown-arrow' src='http://img2.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
Posts
</span>
</span>
</div>
<div class='bottom'></div>
</div>
</div>
<div class='subscribe-wrapper subscribe-type-COMMENT'>
<div class='subscribe expanded subscribe-type-COMMENT' id='SW_READER_LIST_Subscribe1COMMENT' style='display:none;'>
<div class='top'>
<span class='inner' onclick='return(_SW_toggleReaderList(event, "Subscribe1COMMENT"));'>
<img class='subscribe-dropdown-arrow' src='http://img2.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
All Comments
</span>
<div class='feed-reader-links'>
<a class='feed-reader-link' href='http://www.netvibes.com/subscribe.php?url=http%3A%2F%2Fwww.mathyvanhoef.com%2Ffeeds%2Fcomments%2Fdefault' target='_blank'>
<img src='http://img1.blogblog.com/img/widgets/subscribe-netvibes.png'/>
</a>
<a class='feed-reader-link' href='http://add.my.yahoo.com/content?url=http%3A%2F%2Fwww.mathyvanhoef.com%2Ffeeds%2Fcomments%2Fdefault' target='_blank'>
<img src='http://img1.blogblog.com/img/widgets/subscribe-yahoo.png'/>
</a>
<a class='feed-reader-link' href='http://www.mathyvanhoef.com/feeds/comments/default' target='_blank'>
<img align='absmiddle' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
                Atom
              </a>
</div>
</div>
<div class='bottom'></div>
</div>
<div class='subscribe' id='SW_READER_LIST_CLOSED_Subscribe1COMMENT' onclick='return(_SW_toggleReaderList(event, "Subscribe1COMMENT"));'>
<div class='top'>
<span class='inner'>
<img class='subscribe-dropdown-arrow' src='http://img2.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1COMMENT"));'>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='http://img1.blogblog.com/img/icon_feed12.png'/>
All Comments
</span>
</span>
</div>
<div class='bottom'></div>
</div>
</div>
<div style='clear:both'></div>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=Subscribe&widgetId=Subscribe1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("Subscribe1"));' target='configSubscribe1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div><div class='widget BlogArchive' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>&#9660;&#160;</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/search?updated-min=2014-01-01T00:00:00%2B01:00&amp;updated-max=2015-01-01T00:00:00%2B01:00&amp;max-results=1'>2014</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>&#9660;&#160;</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2014_05_01_archive.html'>May</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='http://www.mathyvanhoef.com/2014/05/apbleed-heartbleed-over-wpa12-enterprise.html'>ApBleed: Heartbleed over WPA1/2 Enterprise</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/search?updated-min=2013-01-01T00:00:00%2B01:00&amp;updated-max=2014-01-01T00:00:00%2B01:00&amp;max-results=5'>2013</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2013_12_01_archive.html'>December</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2013_11_01_archive.html'>November</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2013_06_01_archive.html'>June</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2013_04_01_archive.html'>April</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2013_02_01_archive.html'>February</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/search?updated-min=2012-01-01T00:00:00%2B01:00&amp;updated-max=2013-01-01T00:00:00%2B01:00&amp;max-results=9'>2012</a>
<span class='post-count' dir='ltr'>(9)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_11_01_archive.html'>November</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_09_01_archive.html'>September</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_08_01_archive.html'>August</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_07_01_archive.html'>July</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_06_01_archive.html'>June</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_05_01_archive.html'>May</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_02_01_archive.html'>February</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2012_01_01_archive.html'>January</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/search?updated-min=2011-01-01T00:00:00%2B01:00&amp;updated-max=2012-01-01T00:00:00%2B01:00&amp;max-results=5'>2011</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2011_10_01_archive.html'>October</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://www.mathyvanhoef.com/2011_08_01_archive.html'>August</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=BlogArchive&widgetId=BlogArchive1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3'><div class='widget Attribution' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Template images by <a href='http://jasonmorrow.etsy.com' target='_blank'>Jason Morrow</a>. Powered by <a href='http://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=3500917063499850097&widgetType=Attribution&widgetId=Attribution1&action=editWidget&sectionId=footer-3' onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' target='configAttribution1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script type='text/javascript'>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-35642360-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = (document.location.protocol == 'https:' ?
                  'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
<script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('widgetJsBefore');
</script><script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/2423294629-widgets.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type='text/javascript'>
if (typeof(BLOG_attachCsiOnload) != 'undefined' && BLOG_attachCsiOnload != null) { window['blogger_templates_experiment_id'] = "templatesV2";window['blogger_blog_id'] = '3500917063499850097';BLOG_attachCsiOnload(''); }_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d3500917063499850097','//www.mathyvanhoef.com/','3500917063499850097');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '3500917063499850097', 'bloggerUrl': 'http://www.blogger.com', 'title': 'Mathy Vanhoef', 'pageType': 'index', 'url': 'http://www.mathyvanhoef.com/', 'canonicalUrl': 'http://www.mathyvanhoef.com/', 'canonicalHomepageUrl': 'http://www.mathyvanhoef.com/', 'homepageUrl': 'http://www.mathyvanhoef.com/', 'blogspotFaviconUrl': 'http://www.mathyvanhoef.com/favicon.ico', 'enabledCommentProfileImages': true, 'adultContent': false, 'disableAdSenseWidget': false, 'analyticsAccountNumber': 'UA-35642360-1', 'searchLabel': '', 'searchQuery': '', 'pageName': '', 'pageTitle': 'Mathy Vanhoef', 'encoding': 'UTF-8', 'locale': 'en_GB', 'localeUnderscoreDelimited': 'en_gb', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'languageDirection': 'ltr', 'feedLinks': '\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42Mathy Vanhoef - Atom\42 href\75\42http://www.mathyvanhoef.com/feeds/posts/default\42 /\76\n\74link rel\75\42alternate\42 type\75\42application/rss+xml\42 title\75\42Mathy Vanhoef - RSS\42 href\75\42http://www.mathyvanhoef.com/feeds/posts/default?alt\75rss\42 /\76\n\74link rel\75\42service.post\42 type\75\42application/atom+xml\42 title\75\42Mathy Vanhoef - Atom\42 href\75\42http://www.blogger.com/feeds/3500917063499850097/posts/default\42 /\76\n', 'meTag': '\74link rel\75\42me\42 href\75\42http://www.blogger.com/profile/12266874794108836514\42 /\76\n', 'openIdOpTag': '\74link rel\75\42openid.server\42 href\75\42http://www.blogger.com/openid-server.g\42 /\76\n\74link rel\75\42openid.delegate\42 href\75\42http://www.mathyvanhoef.com/\42 /\76\n', 'latencyHeadScript': '\74script type\75\42text/javascript\42\76(function() { var b\75window,f\75\42chrome\42,g\75\42tick\42,k\75\42jstiming\42;(function(){function d(a){this.t\75{};this.tick\75function(a,d,c){var e\75void 0!\75c?c:(new Date).getTime();this.t[a]\75[e,d];if(void 0\75\75c)try{b.console.timeStamp(\42CSI/\42+a)}catch(h){}};this[g](\42start\42,null,a)}var a;b.performance\46\46(a\75b.performance.timing);var n\75a?new d(a.responseStart):new d;b.jstiming\75{Timer:d,load:n};if(a){var c\75a.navigationStart,h\75a.responseStart;0\74c\46\46h\76\75c\46\46(b[k].srt\75h-c)}if(a){var e\75b[k].load;0\74c\46\46h\76\75c\46\46(e[g](\42_wtsrt\42,void 0,c),e[g](\42wtsrt_\42,\42_wtsrt\42,h),e[g](\42tbsd_\42,\42wtsrt_\42))}try{a\75null,\nb[f]\46\46b[f].csi\46\46(a\75Math.floor(b[f].csi().pageT),e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b[f].csi().startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),null\75\75a\46\46b.gtbExternal\46\46(a\75b.gtbExternal.pageT()),null\75\75a\46\46b.external\46\46(a\75b.external.pageT,e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b.external.startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),a\46\46(b[k].pt\75a)}catch(p){}})();b.tickAboveFold\75function(d){var a\0750;if(d.offsetParent){do a+\75d.offsetTop;while(d\75d.offsetParent)}d\75a;750\76\75d\46\46b[k].load[g](\42aft\42)};var l\75!1;function m(){l||(l\75!0,b[k].load[g](\42firstScrollTime\42))}b.addEventListener?b.addEventListener(\42scroll\42,m,!1):b.attachEvent(\42onscroll\42,m);\n })();\74/script\076', 'mobileHeadScript': '', 'adsenseClientId': 'pub-2753532741085396', 'ieCssRetrofitLinks': '\74!--[if IE]\76\74script type\75\42text/javascript\42 src\75\42https://www.blogger.com/static/v1/jsbin/1735305980-ieretrofit.js\42\76\74/script\76\n\74![endif]--\076', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/76f25a6f2e06af76', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sf': 'n'}}, {'name': 'skin', 'data': {'vars': {'date_border_size': '0', 'description_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_background_gradient_cap': 'none', 'tabs_selected_background_color': '#666666', 'footer_background_gradient': 'none', 'date_background': 'transparent none no-repeat scroll top left', 'widget_border_radius': '0', 'post_title_text_color': '#444444', 'widget_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_link_hover_color': '#3778cd', 'link_visited_color': '#4d469c', 'mobile_background_size': 'auto', 'date_space': '30px', 'post_title_font': 'normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_text_color': '#444444', 'title_separator_border_size': '1px', 'header_background_gradient': 'none', 'widget_outer_background_gradient': 'none', 'widget_link_color': '#3778cd', 'mobile_button_color': '#ffffff', 'widget_title_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_outer_background_color': 'transparent', 'date_last_border_radius_bottom': '0', 'widget_outer_margin_top': '0', 'shadow_spread': '20px', 'title_shadow_spread': '-1px', 'outer_shadow_spread': '0', 'keycolor': '#eeeeee', 'image_shadow_spread': '0', 'image_background_color': 'transparent', 'header_font': 'normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'header_background_color': 'transparent', 'date_header_border_radius_top': '0', 'widget_border_bevel_color': 'transparent', 'tabs_border_color': '#999999', 'widget_background_color': '#ffffff', 'date_position': 'static', 'post_first_padding_top': '0', 'tabs_background_gradient': 'url(http://www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png)', 'mobile_background_overlay': 'transparent none repeat scroll top left', 'date_border_color': '#eeeeee', 'tabs_background_color': '#eeeeee', 'widget_link_visited_color': '#4d469c', 'feed_text_color': '#444444', 'header_margin_top': '0', 'link_hover_color': '#3778cd', 'date_last_space_bottom': '20px', 'header_margin_bottom': '0', 'date_padding_bottom': '0', 'list_separator_border_size': '1px', 'description_text_color': '#444444', 'body_text_color': '#444444', 'header_padding_top': '22px', 'post_border_color': '#eeeeee', 'footer_text_color': '#444444', 'post_background_color': '#ffffff', 'pager_space_top': '1em', 'endSide': 'right', 'startSide': 'left', 'body_background_size': 'auto', 'tabs_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_font': 'normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'date_first_border_radius_top': '0', 'date_header_position': '15px', 'date_text_color': '#444444', 'widget_title_text_color': '#444444', 'image_border_color': 'transparent', 'separator_outdent': '15px', 'widget_text_color': '#444444', 'link_color': '#3778cd', 'widget_border_color': '#eeeeee', 'pager_border_radius_top': '0', 'feed_link_color': '#3778cd', 'header_text_color': '#444444', 'footer_background_color': '#ffffff', 'widget_padding_top': '8px', 'feed_link_visited_color': '#4d469c', 'feed_link_hover_color': '#3778cd', 'date_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_selected_text_color': '#ffffff', 'date_side': 'right', 'post_border_bevel_color': '#eeeeee', 'widget_padding_side': '15px', 'body_background_color': '#eeeeee', 'image_border_radius': '0', 'pager_background_color': '#ffffff', 'widget_alternate_text_color': '#666666'}, 'override': ''}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\75classic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\75flipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\75magazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\75mosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\75sidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\75snapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\75timeslide'}}}]);
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'crosscol', null, document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'href': 'http://www.mathyvanhoef.com/', 'title': 'Home', 'isCurrentPage': true}, {'href': 'http://www.mathyvanhoef.com/p/publications.html', 'title': 'Publications', 'isCurrentPage': false, 'id': '5694411682882214890'}, {'href': 'http://www.mathyvanhoef.com/p/about.html', 'title': 'About', 'isCurrentPage': false, 'id': '5424981829575763592'}], 'mobile': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts1', 'sidebar-right-1', null, document.getElementById('PopularPosts1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AdSenseView', new _WidgetInfo('AdSense1', 'sidebar-right-1', null, document.getElementById('AdSense1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar-right-1', null, document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'sidebar-right-1', null, document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_SubscribeView', new _WidgetInfo('Subscribe1', 'sidebar-right-1', null, document.getElementById('Subscribe1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', null, document.getElementById('Attribution1'), {'attribution': 'Template images by \74a href\75\47http://jasonmorrow.etsy.com\47 target\75\47_blank\47\76Jason Morrow\74/a\76. Powered by \74a href\75\47http://www.blogger.com\47 target\75\47_blank\47\76Blogger\74/a\76.'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3589638247-lbx__en_gb.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/2392111094-lightbox_bundle.css'}, 'displayModeFull'));
</script>
</body>
</html>
