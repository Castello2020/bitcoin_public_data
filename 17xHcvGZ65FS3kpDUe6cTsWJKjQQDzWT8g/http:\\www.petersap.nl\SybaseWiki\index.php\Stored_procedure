http://www.petersap.nl/SybaseWiki/index.php/Stored_procedure
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 03:53:51 GMT
Server: Apache/2.2.22 (Debian)
X-Powered-By: PHP/5.3.28-5.3.28+xs4all.2
X-Content-Type-Options: nosniff
Content-language: en
Vary: Accept-Encoding,Cookie
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Cache-Control: private, must-revalidate, max-age=0
Last-Modified: Sat, 23 Nov 2013 19:08:03 GMT
Connection: close
Content-Type: text/html; charset=UTF-8

<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>Stored procedure - SybaseWiki</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.7" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/SybaseWiki/opensearch_desc.php" title="SybaseWiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.petersap.nl/SybaseWiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="SybaseWiki Atom feed" href="/SybaseWiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://www.petersap.nl/SybaseWiki/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/SybaseWiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/SybaseWiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://www.petersap.nl/SybaseWiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: sap1_psap-mw_:resourceloader:filter:minify-css:7:50e950fd4b4859722ccf8d7db4274962 */</style>

<script src="http://www.petersap.nl/SybaseWiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Stored_procedure","wgTitle":"Stored procedure","wgCurRevisionId":1710,"wgArticleId":1345,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["ASE"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Stored_procedure","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: sap1_psap-mw_:resourceloader:filter:minify-js:7:c89fc005766e312c555f83b307d08d63 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Stored_procedure skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">Stored procedure</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From SybaseWiki</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Creating_a_stored_procedure"><span class="tocnumber">2</span> <span class="toctext">Creating a stored procedure</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Executing_the_stored_procedure"><span class="tocnumber">3</span> <span class="toctext">Executing the stored procedure</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Remove_a_stored_procedure_from_the_database"><span class="tocnumber">4</span> <span class="toctext">Remove a stored procedure from the database</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Notes"><span class="tocnumber">5</span> <span class="toctext">Notes</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>A stored procedure can be seen as a number of T-SQL statements, grouped together into a block of code (See also <a rel="nofollow" class="external free" href="http://en.wikipedia.org/wiki/Stored_procedure">http://en.wikipedia.org/wiki/Stored_procedure</a>).
</p><p>Within a stored procedure you can not only retrieve results, or modify data in a table, but also use normal control-flow type of statements such as “if” and “while”. Using stored procedures can give you the following benefits when compared to plain SQL statements:
</p>
<ul><li> Stored procedures are stored in the database and the syntax is already checked.
</li><li> Once executed, the resulting query plan will stay in memory (as long as possible) for future use. This eliminates the need for recalculating the query plan the next time the procedure is executed.
</li><li> Modularity, there is no need to recode the same SQL statements into the application over and over again. Just put the logic into a stored procedure and call that procedure from the application.
</li><li> Reduced network traffic.
</li><li> More fine grained security rules can be implemented.
</li></ul>
<h2> <span class="mw-headline" id="Creating_a_stored_procedure">Creating a stored procedure</span></h2>
<p>The following example creates a stored procedure. It will retrieve the title from a table called titles when a valid title_id is supplied. The output will be returned in an output-variable. When the title can not be determined, an error message is raised.
</p>
<pre>create procedure getTitle @title_id tid,
                          @title    varchar(80) output
as

-- declare some local variables
declare @error  int,
        @rowc   int

-- retrieve the title
select @title = title
       from   titles
       where  title_id = @title_id

select @error = @@error,
       @rowc  = @@rowcount

-- check for errors (permissions or so)
if     @error&#160;!= 0
       return  1

-- do we have a valid title?
if     @rowc  &#160;!= 1
begin
       raiserror 20000 "Title for id&#160;%1! not found", @title_id
       return  1
end

return 0
</pre>
<h2> <span class="mw-headline" id="Executing_the_stored_procedure">Executing the stored procedure</span></h2>
<pre>declare @title varchar(80)
exec getTitle "BU1032", @title output
</pre>
<p>Sample output:
</p>
<pre>(return status = 0)

Return parameters:

                                                                                 
-------------------------------------------------------------------------------- 
The Busy Executive's Database Guide


(1 row affected)
</pre>
<h2> <span class="mw-headline" id="Remove_a_stored_procedure_from_the_database">Remove a stored procedure from the database</span></h2>
<p>When you need to modify a stored procedure it must be dropped first and then be re-created.
</p>
<pre>drop proc getTitle
</pre>
<h2> <span class="mw-headline" id="Notes">Notes</span></h2>
<ul><li> In your ASE server there are also stored procedures from Sybase. The names of these generally start with sp_ and are located in the sybsystemprocs database. You should create your own stored procedures not in Sybase system databases, like master or sybsystemprocs.
</li><li> Statistics of tables should be up-to-date so ASE can calculate good query plans. Run “update index statistics” regularly, in combination with sp_recompile.
</li><li> Increase the size of the procedure cache when needed.
</li><li> Remember to use transaction handling. Stored procedures are not a separate logical unit of work.
</li><li> Use good error handling, see the above example.
</li><li> Within a stored procedure, you can call another stored procedure or do all other kinds of things. Check the Sybase documentation for more details (<a rel="nofollow" class="external free" href="http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.sqlug/html/sqlug/sqlug666.htm">http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.sqlug/html/sqlug/sqlug666.htm</a>)
</li></ul>

<!-- 
NewPP limit report
Preprocessor visited node count: 18/1000000
Preprocessor generated node count: 24/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sap1_psap-mw_:pcache:idhash:1345-0!*!*!!en!*!* and timestamp 20140723033843 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.petersap.nl/SybaseWiki/index.php?title=Stored_procedure&amp;oldid=1710">http://www.petersap.nl/SybaseWiki/index.php?title=Stored_procedure&amp;oldid=1710</a>"</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/SybaseWiki/index.php?title=Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/SybaseWiki/index.php?title=Category:ASE" title="Category:ASE">ASE</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="/SybaseWiki/index.php?title=Stored_procedure" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="/SybaseWiki/index.php?title=Talk:Stored_procedure&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="/SybaseWiki/index.php?title=Stored_procedure&amp;action=edit" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="/SybaseWiki/index.php?title=Stored_procedure&amp;action=history" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/SybaseWiki/index.php?title=Special:UserLogin&amp;returnto=Stored+procedure" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="/SybaseWiki/index.php?title=Main_Page" style="background-image: url(http://www.petersap.nl/home_support/Wiki-Logo.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/SybaseWiki/index.php?title=Main_Page" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
				<li id="n-recentchanges"><a href="/SybaseWiki/index.php?title=Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/SybaseWiki/index.php?title=Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-googleadsense">
		<h5>Google AdSense</h5>
		<div class='pBody'>
<script type="text/javascript">
/* <![CDATA[ */
google_ad_client = "pub-2021130256999819";
/* petersap.nl */
google_ad_slot = "8705775058";
google_ad_width = 120;
google_ad_height = 600;
/* ]]> */
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/SybaseWiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search SybaseWiki [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/SybaseWiki/index.php?title=Special:WhatLinksHere/Stored_procedure" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/SybaseWiki/index.php?title=Special:RecentChangesLinked/Stored_procedure" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="/SybaseWiki/index.php?title=Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/SybaseWiki/index.php?title=Stored_procedure&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
				<li id="t-permalink"><a href="/SybaseWiki/index.php?title=Stored_procedure&amp;oldid=1710" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="//www.mediawiki.org/"><img src="/SybaseWiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<div id="f-analyticsystemsico">
		If you have found the information on the SybaseWiki useful, please make a Bitcoin donation to 17xHcvGZ65FS3kpDUe6cTsWJKjQQDzWT8g to help support the site.<br><br>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 11 July 2007, at 20:04.</li>
		<li id="viewcount">This page has been accessed 9,936 times.</li>
		<li id="privacy"><a href="/SybaseWiki/index.php?title=SybaseWiki:Privacy_policy" title="SybaseWiki:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/SybaseWiki/index.php?title=SybaseWiki:About" title="SybaseWiki:About">About SybaseWiki</a></li>
		<li id="disclaimer"><a href="/SybaseWiki/index.php?title=SybaseWiki:General_disclaimer" title="SybaseWiki:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script type="text/javascript">window.google_analytics_uacct = "UA-4534966-1";</script>
<script src="http://www.petersap.nl/SybaseWiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4534966-1");
pageTracker._trackPageview();
</script><!-- Served in 0.258 secs. --></body></html>
