http://www.hackthissite.org/forums/viewtopic.php?p=48462
HTTP/1.1 200 OK
Date: Thu, 24 Jul 2014 10:55:31 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Set-Cookie: phpbb3_28pla_u=1; expires=Fri, 24-Jul-2015 10:55:31 GMT; path=/; domain=.hackthissite.org; HttpOnly
Set-Cookie: phpbb3_28pla_k=; expires=Fri, 24-Jul-2015 10:55:31 GMT; path=/; domain=.hackthissite.org; HttpOnly
Set-Cookie: phpbb3_28pla_sid=e8d96e3792508060256cac8c29042789; expires=Fri, 24-Jul-2015 10:55:31 GMT; path=/; domain=.hackthissite.org; HttpOnly
Cache-Control: private, no-cache="set-cookie"
Expires: 0
Pragma: no-cache
Server: HackThisSite Load Balancer
Strict-Transport-Security: max-age=31536000

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="copyright" content="2000, 2002, 2005, 2007 phpBB Group" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<title>Hack This Site Forum &bull; View topic - XOR cipher help - fstream binary wrting</title>

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '10';
	var base_url = './viewtopic.php?f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789';
	var style_cookie = 'phpBBstyle';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	
	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<script type="text/javascript" src="./styles/Carbon/template/styleswitcher.js"></script>
<script type="text/javascript" src="./styles/Carbon/template/forum_fn.js"></script>

<link href="./styles/Carbon/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?sid=e8d96e3792508060256cac8c29042789&amp;id=8&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/Carbon/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/Carbon/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/Carbon/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />


</head>

<body id="phpbb" class="section-viewtopic ltr">
<span id="blank-element" style="display: none"></span>
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php?sid=e8d96e3792508060256cac8c29042789" title="Board index" id="logo"><img src="images/spacer.gif" width="920" height="90" alt="" /></a>
				<!-- <p>Training the hacker underground</p> -->
				<p style="display: none;"><a href="#start_here">Skip to content</a></p>
			</div>
			<div style="text-align: center;"><a href="https://www.hackthissite.org/uFq19qW30930T34vB4wDp57VEaKhytIGo5Uxq63AadlTrtyoB7qVVQCb389sVr30JF2xhh0uQf2b8y6w2" target="_blank"><img src="https://www.hackthissite.org/KS39BSU2532B007F3FKUr0N44v92X3Nqh793gEB8e9MLj905SLm3G3H98dcIpJ58oURoe9fD20R17M71Y53iKoTI05upz5V5mM92JA1NYpzyCo0rJpT9hoF1TyhC8MF5vGanJn0Lwv8p5M2y66zAHuac8Z697850Z" alt="Learn Security Online" id="atimg" class="abstaimg" title="Learn Security Online" border="0" /></a>
<div id="8951c95109" class="pagefair-acceptable"></div><br />[<a href="https://www.hackthissite.org/advertise/">Advertise With HackThisSite.org</a>]<!-- Kontera ContentLink(TM);-->
<script type='text/javascript'>
var dc_AdLinkColor = '#06464' ; 
var dc_PublisherID = 79308 ; 
</script>
<script type='text/javascript' src='http://kona.kontera.com/javascript/lib/KonaLibInline.js'>
</script><br />
<p style="font-size: 16px; font-weight: bold; padding: 0px; margin: 10px 0px 10px 0px;">
<a href="http://www.hackthissite.org/">Hack This Site</a> - 
<a href="./index.php?sid=e8d96e3792508060256cac8c29042789">Forums Index</a></p></div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php?sid=e8d96e3792508060256cac8c29042789" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php?f=17&amp;sid=e8d96e3792508060256cac8c29042789">Computers</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=36&amp;sid=e8d96e3792508060256cac8c29042789">Programming</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=102&amp;sid=e8d96e3792508060256cac8c29042789">C and C++</a></li>

				<!--<li class="rightside"><a href="#" onclick="fontsizeup(); return false;" class="fontsize" title="Change font size">Change font size</a></li>-->

				<li class="rightside"><a href="./viewtopic.php?f=102&amp;t=6220&amp;start=0&amp;sid=e8d96e3792508060256cac8c29042789&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>			</ul>

			
			<ul class="linklist rightside">
				<li class="icon-faq"><a href="./faq.php?sid=e8d96e3792508060256cac8c29042789" title="Frequently Asked Questions">FAQ</a></li>
				                <li class="icon-search"><a href="./search.php?sid=e8d96e3792508060256cac8c29042789" title="View the advanced search options">Search</a></li>
				<li class="icon-members"><a href="./memberlist.php?sid=e8d96e3792508060256cac8c29042789" title="View complete list of members">Members</a></li>					<li class="icon-logout"><a href="./ucp.php?mode=login&amp;sid=e8d96e3792508060256cac8c29042789" title="Login" accesskey="l">Login</a></li>
							</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>

	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
		 <h2><a href="./viewtopic.php?f=102&amp;t=6220&amp;start=0&amp;sid=e8d96e3792508060256cac8c29042789">XOR cipher help - fstream binary wrting  </a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div class="topic-actions">

	<div class="buttons">
			<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789" title="Post a reply"><span></span>Post a reply</a></div>
		</div>

			<div class="search-box">
			<form method="post" id="topic-search" action="./search.php?t=6220&amp;sid=e8d96e3792508060256cac8c29042789">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" value="6220" name="t" />
				<input type="hidden" value="msgonly" name="sf" />
			</fieldset>
			</form>
		</div>
			<div class="pagination">
			15 posts			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>1</strong> of <strong>2</strong></a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789&amp;start=10">2</a></span>		</div>
	
</div>
<div class="clear"></div>

	<div id="p48442" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 class="first">
								<a href="#p48442">XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48442&amp;sid=e8d96e3792508060256cac8c29042789#p48442"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a></strong> on Mon Nov 01, 2010 8:49 pm			<br />([msg=48442]see XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content"><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>/*--------------------------------------------------------------------------------<br />===== Copyright =====<br />Copyright (c) 2010 Fabian Heredia<br /><br />This software is provided 'as-is', without any express or implied<br />warranty. In no event will the authors be held liable for any damages<br />arising from the use of this software.<br /><br />Permission is granted to anyone to use this software for any purpose,<br />including commercial applications, and to alter it and redistribute it<br />freely, subject to the following restrictions:<br /><br />&nbsp; &nbsp;1. The origin of this software must not be misrepresented; you must not<br />&nbsp; &nbsp;claim that you wrote the original software. If you use this software<br />&nbsp; &nbsp;in a product, an acknowledgment in the product documentation would be<br />&nbsp; &nbsp;appreciated but is not required.<br /><br />&nbsp; &nbsp;2. Altered source versions must be plainly marked as such, and must not be<br />&nbsp; &nbsp;misrepresented as being the original software.<br /><br />&nbsp; &nbsp;3. This notice may not be removed or altered from any source<br />&nbsp; &nbsp;distribution.<br /><br />===== Explanation =====<br />&nbsp; &nbsp; The XOR cipher is based uppon boolean logic XOR. The cipher uses the 2<br />strings&#91;plain &amp; key&#93; to safely encrypt the first(bit by bit).<br />Table:<br />---------------<br />| A | B | XOR |<br />| 0 | 0 |&nbsp; 0&nbsp; |<br />| 0 | 1 |&nbsp; 1&nbsp; |<br />| 1 | 0 |&nbsp; 1&nbsp; |<br />| 1 | 1 |&nbsp; 0&nbsp; |<br />---------------<br />&nbsp; &nbsp; If you have acces to at least two of the three &#91;plain, key, ciphered&#93;<br />the remaining one is no longer protected. It is recommended to use a key<br />at most once since an attacker could start seeing patterns.<br />--------------------------------------------------------------------------------*/<br />#include &lt;iostream&gt;<br />#include &lt;fstream&gt;<br />#include &lt;string&gt;<br />#include &lt;limits.h&gt;<br />using namespace std;<br /><br />// Cipher explained avobe.<br />string cipher(string toCrypt, string key){<br />&nbsp; &nbsp; string crypted = toCrypt;<br />&nbsp; &nbsp; unsigned int iK = key.length(), iC = toCrypt.length();<br />&nbsp; &nbsp; for(unsigned int i = 0, j = 0; i &lt; iC; i++){<br />&nbsp; &nbsp; &nbsp; &nbsp; crypted&#91;i&#93; = toCrypt&#91;i&#93; ^ key&#91;j&#93;; // ^ is the operator for Bitwise XOR<br />&nbsp; &nbsp; &nbsp; &nbsp; if(j++ == iK){j = 0;}<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return crypted;<br />}<br /><br />// Function for writing into a file.<br />int write(string toWrite, string file)<br />{<br />&nbsp; &nbsp; ofstream output(file.c_str(), ios::binary);<br />&nbsp; &nbsp; if(output.is_open())<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; output &lt;&lt; toWrite;<br />&nbsp; &nbsp; &nbsp; &nbsp; output.close();<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else { return 1;}<br />&nbsp; &nbsp; return 0;<br />}<br /><br />int main(int argc, char *argv&#91;&#93;){<br />&nbsp; &nbsp; // If we recieve exactly 3 arguments.&#91;Plain, Key, ,and Output file&#93;<br />&nbsp; &nbsp; if(argc == 4)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if(write(cipher(argv&#91;1&#93;, argv&#91;2&#93;), argv&#91;3&#93;))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;FAILED&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // If we recieve exactly 2 arguments.&#91;File and Key&#93;<br />&nbsp; &nbsp; else if(argc == 3)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; // TODO: File Manipulation<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else if(argc &gt; 1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; argv&#91;0&#93; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Usage:&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t1) 0 arguments - Utility for ciphering a file/text.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t2) 2 Arguments - &#91;File to cipher&#93; and &#91;key&#93;&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t3) 3 Arguments - &#91;Plain&#93;, &#91;key&#93;, and &#91;output file&#93;.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // If we recieve no arguments<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; string plain, key, output;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;File: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; output;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; ifstream file(output.c_str(), ios::binary);<br />&nbsp; &nbsp; &nbsp; &nbsp; if(file.is_open())<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Loading file contents to memory.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned int size = file.tellg();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char * mem = new char &#91;size&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.seekg (0, ios::beg);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.read(mem, size);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.close();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Writing and cleaning up.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(cipher(mem, key), output.c_str());<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete&#91;&#93; mem;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Plain: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; plain;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(write(cipher(plain, key), output))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;FAILED!&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return 0;<br />}<br /></code></dd></dl><br />cipher() works great. However, when I write into a file it start losing data and it doesn't come back as the plaintext. Any idea what I am doing wrong?</div>

			<div id="sig48442" class="signature">Donate bitcoins to me! [1DhRP3hHgmSLQdRTZyT8VPTmzAj7Z2rsGA]<br />Dunno what bitcoins are? <a href="http://bitcoinme.com/" class="postlink">BitcoinMe</a></div>
		</div>

					<dl class="postprofile" id="profile48442">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a>			</dt>

			<dd>Poster<br /><img src="./images/ranks/blackboll_2.gif" alt="Poster" title="Poster" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 286</dd><dd><strong>Joined:</strong> Tue Sep 21, 2010 7:48 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/fabianhjr/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48460" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48460">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48460&amp;sid=e8d96e3792508060256cac8c29042789#p48460"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=8333&amp;sid=e8d96e3792508060256cac8c29042789">tucak</a></strong> on Tue Nov 02, 2010 6:56 am			<br />([msg=48460]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">When you are reading the file in, you forgot to jump to the end, before getting the position.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(file.is_open())<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Loading file contents to memory.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.seekg(0,ios::end); // Jump to the end!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned int size = file.tellg(); // get the last position<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char * mem = new char &#91;size&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.seekg (0, ios::beg);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.read(mem, size);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.close();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Writing and cleaning up.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(cipher(mem, key), output.c_str());<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete&#91;&#93; mem;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</code></dd></dl></div>

			
		</div>

					<dl class="postprofile" id="profile48460">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=8333&amp;sid=e8d96e3792508060256cac8c29042789">tucak</a>			</dt>

			<dd>New User<br /><img src="./images/ranks/blackboll_0.gif" alt="New User" title="New User" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 47</dd><dd><strong>Joined:</strong> Wed Jun 04, 2008 12:20 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/tucak/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=8333&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48462" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48462">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48462&amp;sid=e8d96e3792508060256cac8c29042789#p48462"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789">tgoe</a></strong> on Tue Nov 02, 2010 7:48 am			<br />([msg=48462]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">You're essentially working with raw bytes. You shouldn't be using string at all.<br /><br />And cipher() has an off-by-one error: <br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>&nbsp; &nbsp; for(unsigned int i = 0, j = 0; i &lt; iC; i++){<br />&nbsp; &nbsp; &nbsp; &nbsp; crypted&#91;i&#93; = toCrypt&#91;i&#93; ^ key&#91;j&#93;; // ^ is the operator for Bitwise XOR<br />&nbsp; &nbsp; &nbsp; &nbsp; if(j++ == iK){j = 0;} // j isn't incremented until *after* the boundary check<br />&nbsp; &nbsp; }<br /></code></dd></dl></div>

			
		</div>

					<dl class="postprofile" id="profile48462">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1205929" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789">tgoe</a>			</dt>

			<dd>Contributor<br /><img src="./images/ranks/blackboll_3.gif" alt="Contributor" title="Contributor" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 633</dd><dd><strong>Joined:</strong> Sun Sep 28, 2008 2:33 pm</dd><dd><strong>Location:</strong> q3dm7</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/tgoe/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48485" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48485">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48485&amp;sid=e8d96e3792508060256cac8c29042789#p48485"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a></strong> on Tue Nov 02, 2010 8:03 pm			<br />([msg=48485]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">O_O holy fucking sheep shit bat man. Who the fuck taught you to get the size of a file like that?!? Whoever it was, they should be fucking shot on site for fail.<br /><br />use stat() to get the file size before you open it.<br /><br />Also, i absolutely despise random access on files. I must recommend mmap() as an alternative. I'm at work atm so i can't post a super detailed post on anything, but code speaks louder then words imo. check this out i whooped to together typing at the speed of light in emacs.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>#include &lt;stdio.h&gt;<br />#include &lt;stdlib.h&gt;<br />#include &lt;sys/mman.h&gt;<br />#include &lt;sys/types.h&gt;<br />#include &lt;sys/stat.h&gt;<br />#include &lt;fcntl.h&gt;<br />#include &lt;unistd.h&gt;<br /><br />int get_file_size(char *file)<br />{<br />&nbsp; struct stat statb;<br />&nbsp; return (!stat(file, &amp;statb)) ? (int) statb.st_size : -1;<br />}<br /><br />int main(int argc, char *argv&#91;&#93;)<br />{<br />&nbsp; char *contents;<br />&nbsp; int fd, size;<br /><br />&nbsp; if ((size = get_file_size(&quot;./rawr&quot;)) == -1)<br />&nbsp; {<br />&nbsp; &nbsp; fprintf(stderr, &quot;No such file diqhed!\n&quot;);<br />&nbsp; &nbsp; return 1;<br />&nbsp; }<br /><br />&nbsp; if (!(fd = open(&quot;./rawr&quot;, O_RDONLY)))<br />&nbsp; {<br />&nbsp; &nbsp; fprintf(stderr, &quot;wooops, cant open that file.\n&quot;);<br />&nbsp; &nbsp; return 1;<br />&nbsp; }<br /><br />&nbsp; contents = mmap((caddr_t)0, size, PROT_READ, MAP_PRIVATE, fd, 0);<br />&nbsp; if (contents == (char*) -1)<br />&nbsp; {<br />&nbsp; &nbsp; fprintf(stderr, &quot;god damnit, mmap b0rked on us\n&quot;);<br />&nbsp; &nbsp; return 1;<br />&nbsp; }<br /><br />&nbsp; write(0, contents, size);<br />&nbsp; <br />&nbsp; return 0;<br /><br />}<br /></code></dd></dl></div>

			<div id="sig48485" class="signature">&quot;If art interprets our dreams, the computer executes them in the guise of programs!&quot; - SICP<br /><br /><img src="http://www.digitalftx.org/signature.php?xml=thetan.xml" alt="Image" /><br /><br />“If at first, the idea is not absurd, then there is no hope for it” - Albert Einstein</div>
		</div>

					<dl class="postprofile" id="profile48485">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1008665" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a>			</dt>

			<dd>Contributor<br /><img src="./images/ranks/blackboll_3.gif" alt="Contributor" title="Contributor" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 657</dd><dd><strong>Joined:</strong> Thu Dec 17, 2009 6:58 pm</dd><dd><strong>Location:</strong> Various Bay Area Cities, California</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/thetan/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li><li class="web-icon"><a href="http://www.digitalftx.org" title="WWW: http://www.digitalftx.org"><span>Website</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48562" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48562">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48562&amp;sid=e8d96e3792508060256cac8c29042789#p48562"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a></strong> on Thu Nov 04, 2010 7:36 pm			<br />([msg=48562]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">At least I got some more free time.<br /><br />No one teaches me. I am doing a try &amp; error approach. I scrapped everything and attempt it again.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>/*--------------------------------------------------------------------------------<br />===== Copyright =====<br />Copyright (c) 2010 Fabian Heredia<br /><br />This software is provided 'as-is', without any express or implied<br />warranty. In no event will the authors be held liable for any damages<br />arising from the use of this software.<br /><br />Permission is granted to anyone to use this software for any purpose,<br />including commercial applications, and to alter it and redistribute it<br />freely, subject to the following restrictions:<br /><br />&nbsp; &nbsp;1. The origin of this software must not be misrepresented; you must not<br />&nbsp; &nbsp;claim that you wrote the original software. If you use this software<br />&nbsp; &nbsp;in a product, an acknowledgment in the product documentation would be<br />&nbsp; &nbsp;appreciated but is not required.<br /><br />&nbsp; &nbsp;2. Altered source versions must be plainly marked as such, and must not be<br />&nbsp; &nbsp;misrepresented as being the original software.<br /><br />&nbsp; &nbsp;3. This notice may not be removed or altered from any source<br />&nbsp; &nbsp;distribution.<br /><br />===== Explanation =====<br />&nbsp; &nbsp; The XOR cipher is based uppon boolean logic XOR. The cipher uses the 2<br />strings&#91;plain &amp; key&#93; to safely encrypt the first(bit by bit).<br />Table:<br />---------------<br />| A | B | XOR |<br />| 0 | 0 |&nbsp; 0&nbsp; |<br />| 0 | 1 |&nbsp; 1&nbsp; |<br />| 1 | 0 |&nbsp; 1&nbsp; |<br />| 1 | 1 |&nbsp; 0&nbsp; |<br />---------------<br />&nbsp; &nbsp; If you have acces to at least two of the three &#91;plain, key, ciphered&#93;<br />the remaining one is no longer protected. It is recommended to use a key<br />at most once since an attacker could start seeing patterns.<br />--------------------------------------------------------------------------------*/<br />#include &lt;iostream&gt;<br />#include &lt;iomanip&gt;<br />#include &lt;fstream&gt;<br />#include &lt;limits.h&gt;<br />#define MAX_LEN 128<br />using namespace std;<br /><br />// Cipher explained avobe.<br />char* cipher(char* toCrypt, char* key)<br />{<br />&nbsp; &nbsp; for(unsigned int i = 0, j = 0; i &lt; sizeof(toCrypt); i++)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; toCrypt&#91;i&#93; ^= key&#91;j&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; j = (j + 1) % sizeof(key);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return toCrypt;<br />}<br /><br />// Function for writing into a file.<br />void write(char* toWrite, char* file)<br />{<br />&nbsp; &nbsp; ofstream out(file, ios::binary);<br />&nbsp; &nbsp; if(out.is_open())<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; for(unsigned int i = 0; i &lt; sizeof(toWrite); i++)<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out &lt;&lt; toWrite&#91;i&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; out.close();<br />&nbsp; &nbsp; }<br />}<br /><br />int main(int argc, char *argv&#91;&#93;){<br />&nbsp; &nbsp; // If we recieve exactly 3 arguments.&#91;Plain, Key, ,and Output file&#93;<br />&nbsp; &nbsp; /*if(argc == 4)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if(write(cipher(argv&#91;1&#93;, argv&#91;2&#93;), argv&#91;3&#93;))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;FAILED&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }*/<br />&nbsp; &nbsp; // If we recieve exactly 2 arguments.&#91;File and Key&#93;<br />&nbsp; &nbsp; /*else */if(argc == 3)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; // TODO: File Manipulation<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else if(argc &gt; 1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; argv&#91;0&#93; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Usage:&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t1) 0 arguments - Utility for ciphering a file/text.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t2) 2 Arguments - &#91;File to cipher&#93; and &#91;key&#93;&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t3) 3 Arguments - &#91;Plain&#93;, &#91;key&#93;, and &#91;output file&#93;.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // If we recieve no arguments<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; char *plain, *key, *out;<br />&nbsp; &nbsp; &nbsp; &nbsp; plain = new char&#91;MAX_LEN&#93;, key = new char&#91;MAX_LEN&#93;, out = new char&#91;MAX_LEN&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;File: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; out;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; ifstream file(out, ios::binary);<br />&nbsp; &nbsp; &nbsp; &nbsp; if(file.is_open())<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Loading file contents to memory.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned long size = file.tellg();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char *mem;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mem = new char&#91;size&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.seekg (0, ios::end);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.read(mem, size);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.close();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Writing and cleaning up.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(cipher(mem, key), out);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete&#91;&#93; mem;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Plain: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; plain;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(cipher(plain, key), out);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; plain;<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; out;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return 0;<br />}<br /></code></dd></dl><br />It compiles and runs but does not work as expected. Again I am losing data when ciphering/writing.<br />@thetan, I will make that commit for the next revision.(Which I am doing atm)<br /><br />-- Thu Nov 04, 2010 6:59 pm --<br /><br />BTW, do I have any memory leaks?</div>

			<div id="sig48562" class="signature">Donate bitcoins to me! [1DhRP3hHgmSLQdRTZyT8VPTmzAj7Z2rsGA]<br />Dunno what bitcoins are? <a href="http://bitcoinme.com/" class="postlink">BitcoinMe</a></div>
		</div>

					<dl class="postprofile" id="profile48562">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a>			</dt>

			<dd>Poster<br /><img src="./images/ranks/blackboll_2.gif" alt="Poster" title="Poster" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 286</dd><dd><strong>Joined:</strong> Tue Sep 21, 2010 7:48 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/fabianhjr/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48574" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48574">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48574&amp;sid=e8d96e3792508060256cac8c29042789#p48574"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a></strong> on Fri Nov 05, 2010 1:34 am			<br />([msg=48574]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">The problem is the way you're getting the size/length of the key string. sizeof(key) is synonymous for sizeof(char*). You want strlen() instead.<br /><br />something to this effect:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>char* cipher(char* toCrypt, char* key)<br />{<br />&nbsp; &nbsp; int keyLen = strlen(key);<br />&nbsp; &nbsp; for(int i = 0; *toCrypt; ++toCrypt)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; *toCrypt ^= key&#91;i++&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; i %= keyLen;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return toCrypt;<br />}<br /></code></dd></dl><br />should do, untested, but at least the point is conveyed.<br /><br /><blockquote><div><cite>fabianhjr wrote:</cite>BTW, do I have any memory leaks?</div></blockquote><br />None that are blatantly obvious, run the program against valgrind and it should let you know if you have any it comes across during the course of execution.</div>

			<div id="sig48574" class="signature">&quot;If art interprets our dreams, the computer executes them in the guise of programs!&quot; - SICP<br /><br /><img src="http://www.digitalftx.org/signature.php?xml=thetan.xml" alt="Image" /><br /><br />“If at first, the idea is not absurd, then there is no hope for it” - Albert Einstein</div>
		</div>

					<dl class="postprofile" id="profile48574">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1008665" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a>			</dt>

			<dd>Contributor<br /><img src="./images/ranks/blackboll_3.gif" alt="Contributor" title="Contributor" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 657</dd><dd><strong>Joined:</strong> Thu Dec 17, 2009 6:58 pm</dd><dd><strong>Location:</strong> Various Bay Area Cities, California</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/thetan/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li><li class="web-icon"><a href="http://www.digitalftx.org" title="WWW: http://www.digitalftx.org"><span>Website</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48710" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48710">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48710&amp;sid=e8d96e3792508060256cac8c29042789#p48710"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a></strong> on Sun Nov 07, 2010 10:55 pm			<br />([msg=48710]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">Mhhh, not even chars are doing it.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>/*--------------------------------------------------------------------------------<br />===== Copyright =====<br />Copyright (c) 2010 Fabian Heredia<br /><br />This software is provided 'as-is', without any express or implied<br />warranty. In no event will the authors be held liable for any damages<br />arising from the use of this software.<br /><br />Permission is granted to anyone to use this software for any purpose,<br />including commercial applications, and to alter it and redistribute it<br />freely, subject to the following restrictions:<br /><br />&nbsp; &nbsp;1. The origin of this software must not be misrepresented; you must not<br />&nbsp; &nbsp;claim that you wrote the original software. If you use this software<br />&nbsp; &nbsp;in a product, an acknowledgment in the product documentation would be<br />&nbsp; &nbsp;appreciated but is not required.<br /><br />&nbsp; &nbsp;2. Altered source versions must be plainly marked as such, and must not be<br />&nbsp; &nbsp;misrepresented as being the original software.<br /><br />&nbsp; &nbsp;3. This notice may not be removed or altered from any source<br />&nbsp; &nbsp;distribution.<br /><br />===== Explanation =====<br />&nbsp; &nbsp; The XOR cipher is based uppon boolean logic XOR. The cipher uses the 2<br />strings&#91;plain &amp; key&#93; to safely encrypt the first(bit by bit).<br />Table:<br />---------------<br />| A | B | XOR |<br />| 0 | 0 |&nbsp; 0&nbsp; |<br />| 0 | 1 |&nbsp; 1&nbsp; |<br />| 1 | 0 |&nbsp; 1&nbsp; |<br />| 1 | 1 |&nbsp; 0&nbsp; |<br />---------------<br />&nbsp; &nbsp; It is recommended to use a key at most once since an attacker could start<br />seeing patterns.(Frequency Analysis) It is also recommended that the length of<br />the key is equal or more than&nbsp; the length of the plain.<br />--------------------------------------------------------------------------------*/<br />#include &lt;iostream&gt;<br />#include &lt;iomanip&gt;<br />#include &lt;string.h&gt;<br />#include &lt;fstream&gt;<br />#include &lt;limits.h&gt;<br />#define MAX_LEN 512<br />using namespace std;<br /><br />// Cipher explained avobe.<br />char* cipher(char* toCrypt, const char* key)<br />{<br />&nbsp; &nbsp; for(unsigned long i = 0; i &lt; strlen(toCrypt); i++)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; toCrypt&#91;i&#93; ^= key&#91;i % strlen(key)&#93;;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return toCrypt;<br />}<br /><br />// Function for writing into a file.<br />void write(const char* toWrite, const char* file)<br />{<br />&nbsp; &nbsp; ofstream out(file, ios::binary);<br />&nbsp; &nbsp; if(out.is_open())<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; out &lt;&lt; toWrite;<br />&nbsp; &nbsp; &nbsp; &nbsp; out.close();<br />&nbsp; &nbsp; }<br />}<br /><br />void cryptFile(char* fileName, char* key)<br />{<br />&nbsp; &nbsp; fstream out(fileName, ios::binary);<br />&nbsp; &nbsp; unsigned long size = out.tellg();<br />&nbsp; &nbsp; char *mem;<br />&nbsp; &nbsp; mem = new char&#91;size&#93;;<br />&nbsp; &nbsp; out.seekg(0, ios::end);<br />&nbsp; &nbsp; out.read(mem, size);<br />&nbsp; &nbsp; out.close();<br />&nbsp; &nbsp; // Writing and cleaning up.<br />&nbsp; &nbsp; write(cipher(mem, key), fileName);<br />&nbsp; &nbsp; delete&#91;&#93; mem;<br />}<br /><br />int main(int argc, char *argv&#91;&#93;){<br />&nbsp; &nbsp; // If we recieve 3 arguments.&#91;Plain, key, and file&#93;<br />&nbsp; &nbsp; if(argc &gt; 3)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; write(cipher(argv&#91;1&#93;, argv&#91;2&#93;), argv&#91;3&#93;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // If we recieve exactly 2 arguments.&#91;File and Key&#93;<br />&nbsp; &nbsp; else if(argc &gt; 2)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; cryptFile(argv&#91;1&#93;, argv&#91;2&#93;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // Help message!<br />&nbsp; &nbsp; else if(argc &gt; 1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; argv&#91;0&#93; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Usage:&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t1) 0 arguments - CLI Wizard for ciphering a file/text.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t2) 2 Arguments - &#91;File to cipher&#93; and &#91;key&#93;&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;\t3) 3 Arguments - &#91;Plain&#93;, &#91;key&#93;, and &#91;output file&#93;.&quot; &lt;&lt; endl;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; // If we recieve no arguments<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; // Var Declaration<br />&nbsp; &nbsp; &nbsp; &nbsp; char *plain, *key, *out;<br />&nbsp; &nbsp; &nbsp; &nbsp; plain = new char&#91;MAX_LEN&#93;, key = new char&#91;MAX_LEN&#93;, out = new char&#91;MAX_LEN&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; // File to manipulate<br />&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;File: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; out;<br />&nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; // If it exsists we ask for a pass to crypt.<br />&nbsp; &nbsp; &nbsp; &nbsp; ifstream file(out, ios::binary);<br />&nbsp; &nbsp; &nbsp; &nbsp; if(file.is_open())<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cryptFile(out, key);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; // Else we ask for a plain message and a key to write into a file.<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Plain: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; plain;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; &quot;Key: &quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin &gt;&gt; setw(MAX_LEN) &gt;&gt; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cin.ignore(INT_MAX, '\n');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(cipher(plain, key), out);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; plain;<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; key;<br />&nbsp; &nbsp; &nbsp; &nbsp; delete &#91;&#93; out;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return 0;<br />}</code></dd></dl><br /><br />I added a cout &lt;&lt; toCrypt; Before and after the for loop of the cipher. It looks like it is how it handles char* that would be terminated by a space or other special characters?! Also, now if I try to cryptFile() Windows Complaints and exits the program. <img src="./images/smilies/icon_e_sad.gif" alt=":(" title="Sad" /><br /><br />So far I improved the cipher.(Which is more readable) and added a function to clear some main() space.<br /><br />thetan thanks for your support so far. <img src="./images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" /></div>

			<div id="sig48710" class="signature">Donate bitcoins to me! [1DhRP3hHgmSLQdRTZyT8VPTmzAj7Z2rsGA]<br />Dunno what bitcoins are? <a href="http://bitcoinme.com/" class="postlink">BitcoinMe</a></div>
		</div>

					<dl class="postprofile" id="profile48710">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a>			</dt>

			<dd>Poster<br /><img src="./images/ranks/blackboll_2.gif" alt="Poster" title="Poster" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 286</dd><dd><strong>Joined:</strong> Tue Sep 21, 2010 7:48 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/fabianhjr/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48787" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48787">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48787&amp;sid=e8d96e3792508060256cac8c29042789#p48787"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a></strong> on Wed Nov 10, 2010 2:05 pm			<br />([msg=48787]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">Seeing how i cant really stand C++ much, i just rewrote the entire thing in C. Everything seems to be in working order from a few trial runs. Have fun porting it all to nasty ass C++ <img src="./images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /><br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>#include &lt;string.h&gt;<br />#include &lt;limits.h&gt;<br />#include &lt;stdio.h&gt;<br />#include &lt;stdlib.h&gt;<br />#include &lt;sys/mman.h&gt;<br />#include &lt;sys/types.h&gt;<br />#include &lt;sys/stat.h&gt;<br />#include &lt;fcntl.h&gt;<br />#include &lt;unistd.h&gt;<br /><br />int get_file_size(char *file)<br />{<br />&nbsp; &nbsp; struct stat statb;<br />&nbsp; &nbsp; return (!stat(file, &amp;statb)) ? (int) statb.st_size : -1;<br />}<br /><br />// Cipher explained above.<br />char* cipher(char* toCrypt, int clen, char* key)<br />{<br />&nbsp; &nbsp; int i, len = strlen(key);<br />&nbsp; &nbsp; for(i = 0; i &lt; clen; i++)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; toCrypt&#91;i&#93; ^= key&#91;i % len&#93;;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return toCrypt;<br />}<br /><br />// Function for writing into a file.<br />int dump(char* toWrite, int size, char* file)<br />{ <br />&nbsp; &nbsp; int fd = open(file, O_WRONLY|O_CREAT);<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if (fd == -1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; fprintf(stderr, &quot;failed opening file\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; write(fd, toWrite, size);<br /><br />&nbsp; &nbsp; return 1;<br />}<br /><br />int cryptFile(char* fileName, char* key)<br />{<br />&nbsp; &nbsp; char *contents;<br />&nbsp; &nbsp; int fd, size, pagesize;<br /><br />&nbsp; &nbsp; if ((size = get_file_size(fileName)) == -1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; fprintf(stderr, &quot;No such file diqhed!\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; if (!(fd = open(fileName, O_RDWR)))<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; fprintf(stderr, &quot;wooops, cant open that file.\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; pagesize = size + (size % getpagesize());<br />&nbsp; &nbsp; contents = mmap((caddr_t)0, pagesize, PROT_READ | PROT_WRITE, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MAP_SHARED, fd, 0);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; if (contents == (char*) -1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; fprintf(stderr, &quot;god damnit, mmap b0rked on us\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; cipher(contents, size, key);<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if (msync(contents, size, MS_SYNC) == -1)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; fprintf(stderr, &quot;Failed flushing data to disk\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; munmap(contents, pagesize);<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; return 1;<br />}<br /><br />int main(int argc, char *argv&#91;&#93;)<br />{<br />&nbsp; &nbsp; switch (argc)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; case 2: //........................................Help message!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%s\n&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;Usage:\n&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;\t1) 0 arguments - CLI Wizard for ciphering a &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;file/text.\n&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;\t2) 2 Arguments - &#91;File to cipher&#93; and &#91;key&#93;\n&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;\t3) 3 Arguments - &#91;Plain&#93;, &#91;key&#93;, and &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;&#91;output file&#93;.\n&quot;, argv&#91;0&#93;); <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; case 3: //.....If we recieve exactly 2 arguments.&#91;File and Key&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;encrypting file\n&quot;); <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cryptFile(argv&#91;1&#93;, argv&#91;2&#93;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; case 4: //.....If we recieve 3 arguments.&#91;Plain, key, and file&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;encrypting arguments\n&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int size = strlen(argv&#91;1&#93;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dump(cipher(argv&#91;1&#93;, size, argv&#91;2&#93;), size, argv&#91;3&#93;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return 0;<br />}<br /></code></dd></dl></div>

			<div id="sig48787" class="signature">&quot;If art interprets our dreams, the computer executes them in the guise of programs!&quot; - SICP<br /><br /><img src="http://www.digitalftx.org/signature.php?xml=thetan.xml" alt="Image" /><br /><br />“If at first, the idea is not absurd, then there is no hope for it” - Albert Einstein</div>
		</div>

					<dl class="postprofile" id="profile48787">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1008665" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789">thetan</a>			</dt>

			<dd>Contributor<br /><img src="./images/ranks/blackboll_3.gif" alt="Contributor" title="Contributor" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 657</dd><dd><strong>Joined:</strong> Thu Dec 17, 2009 6:58 pm</dd><dd><strong>Location:</strong> Various Bay Area Cities, California</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/thetan/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=33432&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li><li class="web-icon"><a href="http://www.digitalftx.org" title="WWW: http://www.digitalftx.org"><span>Website</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48793" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48793">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48793&amp;sid=e8d96e3792508060256cac8c29042789#p48793"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a></strong> on Wed Nov 10, 2010 7:06 pm			<br />([msg=48793]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">thetan, apples elped me figure out strlen() was getting Null Byte poisoned.<br />Now I am porting everything to use vector&lt;char&gt;. I will post back when I archieve it. <img src="./images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /><br /><br />Thanks Thetan!</div>

			<div id="sig48793" class="signature">Donate bitcoins to me! [1DhRP3hHgmSLQdRTZyT8VPTmzAj7Z2rsGA]<br />Dunno what bitcoins are? <a href="http://bitcoinme.com/" class="postlink">BitcoinMe</a></div>
		</div>

					<dl class="postprofile" id="profile48793">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789">fabianhjr</a>			</dt>

			<dd>Poster<br /><img src="./images/ranks/blackboll_2.gif" alt="Poster" title="Poster" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 286</dd><dd><strong>Joined:</strong> Tue Sep 21, 2010 7:48 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/fabianhjr/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=40329&amp;sid=e8d96e3792508060256cac8c29042789" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p48794" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p48794">Re: XOR cipher help - fstream binary wrting</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=48794&amp;sid=e8d96e3792508060256cac8c29042789#p48794"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789">tgoe</a></strong> on Wed Nov 10, 2010 10:01 pm			<br />([msg=48794]see Re: XOR cipher help - fstream binary wrting[/msg])
			</p>

			
			<div class="content">vectors, eh?<br /><br /><img src="http://oi51.tinypic.com/309rhb7.jpg" alt="Image" /><br /><span style="font-size: 80%; line-height: 116%;">(jesus tap dancing christ)</span><br /><br />If you can't and don't write this in C, you have no business fiddling with C++.<br /><br />Null Byte Poisoning? No.<br />Again, you're working with bytes... not just strings ('strings' are a subset of bytes...). How do you expect to encrypt, say, an image or program instead of just the &quot;abc123&quot; test file?</div>

			
		</div>

					<dl class="postprofile" id="profile48794">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1205929" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=19239&amp;sid=e8d96e3792508060256cac8c29042789">tgoe</a>			</dt>

			<dd>Contributor<br /><img src="./images/ranks/blackboll_3.gif" alt="Contributor" title="Contributor" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 633</dd><dd><strong>Joined:</strong> Sun Sep 28, 2008 2:33 pm</dd><dd><strong>Location:</strong> q3dm7</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/tgoe/index_sid-e8d96e3792508060256cac8c29042789.html">View Blog (0)</a></dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<form id="viewtopic" method="post" action="./viewtopic.php?f=102&amp;t=6220&amp;start=0&amp;sid=e8d96e3792508060256cac8c29042789">

	<fieldset class="display-options" style="margin-top: 0; ">
		<a href="./viewtopic.php?f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789&amp;start=10" class="right-box right">Next</a>		<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
	</fieldset>

	</form>
	<hr />

<div class="topic-actions">
	<div class="buttons">
			<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789" title="Post a reply"><span></span>Post a reply</a></div>
		</div>

			<div class="pagination">
			15 posts			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>1</strong> of <strong>2</strong></a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=102&amp;t=6220&amp;sid=e8d96e3792508060256cac8c29042789&amp;start=10">2</a></span>		</div>
	</div>

	<p></p><p><a href="./viewforum.php?f=102&amp;sid=e8d96e3792508060256cac8c29042789" class="left-box left" accesskey="r">Return to C and C++</a></p>
	<form method="post" id="jumpbox" action="./viewforum.php?sid=e8d96e3792508060256cac8c29042789" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

			<fieldset class="jumpbox">
				<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
							<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>				<option value="5">Forum Guidelines</option>
							<option value="87">&nbsp; &nbsp;Terms of Service &amp; Additional Information</option>
							<option value="7">HackThisSite</option>
							<option value="8">&nbsp; &nbsp;News</option>
							<option value="9">&nbsp; &nbsp;Comments &amp; Suggestions</option>
							<option value="18">General Discussion</option>
							<option value="37">&nbsp; &nbsp;General</option>
							<option value="30">&nbsp; &nbsp;Networking</option>
							<option value="32">&nbsp; &nbsp;Telecommunications</option>
							<option value="39">&nbsp; &nbsp;Hardware</option>
							<option value="83">&nbsp; &nbsp;Books</option>
							<option value="33">&nbsp; &nbsp;Off-Topic</option>
							<option value="126">&nbsp; &nbsp;LULZ</option>
							<option value="128">&nbsp; &nbsp;&nbsp; &nbsp;Idiots' Corner</option>
							<option value="131">&nbsp; &nbsp;Gaming</option>
							<option value="155">&nbsp; &nbsp;PDF's and Articles</option>
							<option value="79">NZone</option>
							<option value="76">Graveyard</option>
							<option value="73">HTS Subprojects</option>
							<option value="125">&nbsp; &nbsp;Store</option>
							<option value="80">&nbsp; &nbsp;IRC</option>
							<option value="140">&nbsp; &nbsp;Lectures</option>
							<option value="142">&nbsp; &nbsp;&nbsp; &nbsp;Audio/IRC Downloads</option>
							<option value="144">&nbsp; &nbsp;&nbsp; &nbsp;OFFICIAL Lecture Approvals</option>
							<option value="145">&nbsp; &nbsp;Radio</option>
							<option value="13">HTS Missions</option>
							<option value="14">&nbsp; &nbsp;Basic</option>
							<option value="15">&nbsp; &nbsp;Realistic</option>
							<option value="50">&nbsp; &nbsp;&nbsp; &nbsp;(Real 1) Uncle Arnold's Local Band Review</option>
							<option value="51">&nbsp; &nbsp;&nbsp; &nbsp;(Real 2) Chicago American Nazi Party</option>
							<option value="52">&nbsp; &nbsp;&nbsp; &nbsp;(Real 3) Peace Poetry: HACKED</option>
							<option value="84">&nbsp; &nbsp;&nbsp; &nbsp;(Real 4) Fischer's Animal Products</option>
							<option value="53">&nbsp; &nbsp;&nbsp; &nbsp;(Real 5) Damn Telemarketers!</option>
							<option value="54">&nbsp; &nbsp;&nbsp; &nbsp;(Real 6) ToxiCo Industrial Chemicals</option>
							<option value="55">&nbsp; &nbsp;&nbsp; &nbsp;(Real 7) What's Right For America</option>
							<option value="56">&nbsp; &nbsp;&nbsp; &nbsp;(Real 8) United Banks Of America</option>
							<option value="57">&nbsp; &nbsp;&nbsp; &nbsp;(Real 9) CrappySoft</option>
							<option value="58">&nbsp; &nbsp;&nbsp; &nbsp;(Real 10) Holy Word High School</option>
							<option value="65">&nbsp; &nbsp;&nbsp; &nbsp;(Real 11) BudgetServ Web Hosting</option>
							<option value="64">&nbsp; &nbsp;&nbsp; &nbsp;(Real 12) Heartland School District</option>
							<option value="63">&nbsp; &nbsp;&nbsp; &nbsp;(Real 13) Elbonian Republican Party</option>
							<option value="62">&nbsp; &nbsp;&nbsp; &nbsp;(Real 14) Yuppers Internet Solutions</option>
							<option value="61">&nbsp; &nbsp;&nbsp; &nbsp;(Real 15) seculas Ltd.</option>
							<option value="60">&nbsp; &nbsp;&nbsp; &nbsp;(Real 16) Simple Mail</option>
							<option value="59">&nbsp; &nbsp;&nbsp; &nbsp;Hack This Site</option>
							<option value="16">&nbsp; &nbsp;Application</option>
							<option value="19">&nbsp; &nbsp;Programming</option>
							<option value="22">&nbsp; &nbsp;Extended Basics</option>
							<option value="21">&nbsp; &nbsp;Javascript</option>
							<option value="20">&nbsp; &nbsp;Steganography</option>
							<option value="23">&nbsp; &nbsp;IRC Missions</option>
							<option value="147">&nbsp; &nbsp;Forensic</option>
							<option value="157">&nbsp; &nbsp;User Submitted</option>
							<option value="17">Computers</option>
							<option value="31">&nbsp; &nbsp;Operating Systems</option>
							<option value="26">&nbsp; &nbsp;&nbsp; &nbsp;Microsoft Windows</option>
							<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;*nix</option>
							<option value="124">&nbsp; &nbsp;&nbsp; &nbsp;Mac</option>
							<option value="24">&nbsp; &nbsp;Networking</option>
							<option value="28">&nbsp; &nbsp;Crypto</option>
							<option value="29">&nbsp; &nbsp;Malware</option>
							<option value="35">&nbsp; &nbsp;Telecommunications</option>
							<option value="151">&nbsp; &nbsp;&nbsp; &nbsp;Android</option>
							<option value="152">&nbsp; &nbsp;&nbsp; &nbsp;iOS</option>
							<option value="153">&nbsp; &nbsp;&nbsp; &nbsp;Windows</option>
							<option value="154">&nbsp; &nbsp;&nbsp; &nbsp;Blackberry</option>
							<option value="36">&nbsp; &nbsp;Programming</option>
							<option value="102" selected="selected">&nbsp; &nbsp;&nbsp; &nbsp;C and C++</option>
							<option value="104">&nbsp; &nbsp;&nbsp; &nbsp;Interpreted Languages</option>
							<option value="156">&nbsp; &nbsp;&nbsp; &nbsp;Custom Code</option>
							<option value="38">&nbsp; &nbsp;Web</option>
							<option value="116">&nbsp; &nbsp;Social Engineering</option>
							<option value="40">Philosophy</option>
							<option value="41">&nbsp; &nbsp;Politics</option>
							<option value="42">&nbsp; &nbsp;Ethics</option>
							<option value="43">&nbsp; &nbsp;General</option>
							<option value="67">&nbsp; &nbsp;Religion</option>
							<option value="68">&nbsp; &nbsp;Math &amp; Science</option>
							<option value="90">Graphic Design &amp; Web Design</option>
							<option value="92">&nbsp; &nbsp;General design</option>
							<option value="98">&nbsp; &nbsp;Web Design</option>
							<option value="99">&nbsp; &nbsp;Modeling and Animation</option>
						</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>

	<h3><a href="./viewonline.php?sid=e8d96e3792508060256cac8c29042789">Who is online</a></h3>
	<p>Users browsing this forum: No registered users and 0 guests</p>
</div>

<div id="page-footer">
			<div class="rules">
			<div class="inner"><span class="corners-top"><span></span></span>
			<dl>
				<dd><strong>Disclaimer : </strong></dd><dd>HackThisSite does not support illegal activities.<br />The management of this board is not responsible for the content of any external internet sites.</dd>
			</dl>
			<span class="corners-bottom"><span></span></span></div>
		</div>
	
	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php?sid=e8d96e3792508060256cac8c29042789" accesskey="h">Board index</a></li>
							<li class="rightside"><a href="./memberlist.php?mode=leaders&amp;sid=e8d96e3792508060256cac8c29042789">The team</a> &bull; <a href="./ucp.php?mode=delete_cookies&amp;sid=e8d96e3792508060256cac8c29042789">Delete all board cookies</a> &bull; All times are UTC - 5 hours </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a> &copy; 2000-2009 phpBB Group
      <div class="copyright">Carbon Style By Echo <a href="http://www.echological.com">-=Designs By Echo=-</a> &copy; 2007 Echo
		 	<br /><strong><a href="./acp/index.php?sid=e8d96e3792508060256cac8c29042789">Administration Control Panel</a></strong>
			</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	</div>

</body>
</html>
