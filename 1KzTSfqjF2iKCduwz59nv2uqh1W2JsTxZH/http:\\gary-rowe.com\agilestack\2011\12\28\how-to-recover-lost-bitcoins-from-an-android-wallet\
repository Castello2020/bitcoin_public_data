http://gary-rowe.com/agilestack/2011/12/28/how-to-recover-lost-bitcoins-from-an-android-wallet/
HTTP/1.1 200 OK
Server: GitHub.com
Date: Wed, 23 Jul 2014 07:53:49 GMT
Content-Type: text/html; charset=utf-8
Last-Modified: Sat, 19 Jul 2014 08:20:54 GMT
Connection: close
Expires: Wed, 23 Jul 2014 08:03:49 GMT
Cache-Control: max-age=600
Vary: Accept-Encoding
Content-Encoding: gzip

<html lang="en">
<head>
  <meta charset="utf-8">

<title>How to recover lost bitcoins from an Android wallet
</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
<link href="/css/docs.css" rel="stylesheet">
<link href="/css/syntax.css" rel="stylesheet">

<link rel="shortcut icon" href="/favicon.ico">
<link rel="author" href="https://plus.google.com/u/0/115295932487523951663/posts">
</head>

<body data-spy="scroll" data-target=".subnav" data-offset="50">
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
	<div class="container">
	  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
	  </a>
	  <a class="brand" href="http://gary-rowe.github.com">Building better development techniques</a>
	  <div class="nav-collapse">
		<ul class="nav">		  
		  <li class="">
			<a href="/"><i class="icon-home"></i> Home</a>
		  </li>
		  <li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-comment"></i> Social <b class="caret"></b></a>
				<ul class="dropdown-menu">										
					<li class=""><a href="http://www.twitter.com/agilestack" rel="tooltip" title="Go to twitter.com/agilestack" target="_blank">Twitter</a></li>
					<li class=""><a href="http://github.com/gary-rowe" rel="tooltip" title="Go to github.com/gary-rowe" target="_blank">GitHub</a></li>
					
					<li class=""><a href="http://www.linkedin.com/in/froot" rel="tooltip" title="Go to LinkedIn profile" target="_blank">LinkedIn</a></li>										
					<li class=""><a href="http://stackexchange.com/users/170199/gary-rowe" rel="tooltip" title="Go to Stack Exchange/gary-rowe" target="_blank">Stack Exchange</a></li>
					<li class="divider"></li>
					<li class=""><a href="http://feeds.feedburner.com/agilestack" rel="tooltip" title="Go to feedburner" target="_blank">RSS</a></li>
				</ul>
			 </li>
		<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-list"></i> Projects <b class="caret"></b></a>
				<ul class="dropdown-menu">					
					<li class=""><a href="http://multibit.org" rel="tooltip" title="Go to MultiBit">MultiBit</a></li>
					<li class=""><a href="https://github.com/gary-rowe/MultiBitMerchant" rel="tooltip" title="Go to MultiBit Merchant on GitHub" target="_blank">MultiBit Merchant</a></li>
					<li class=""><a href="https://github.com/gary-rowe/DropwizardOpenID" rel="tooltip" title="Go to Dropwizard OpenID">Dropwizard with OpenID</a></li>
          <li class=""><a href="https://github.com/gary-rowe/DropwizardEmberData" rel="tooltip" title="Go to Dropwizard Ember Data">Dropwizard with Ember Data</a></li>
          <li class=""><a href="https://github.com/timmolter/XChange" rel="tooltip" title="Go to XChange">XChange</a></li>
					<li class=""><a href="http://www.growers-nation.org/" rel="tooltip" title="Go to Growers' Nation">Growers' Nation</a></li>
				</ul>
			 </li>			
		</ul>		
	  </div>
	</div>
  </div>
</div>
<div class="container">
  <div class="content">
	<div class="row">	
	<div class="span12 column">
		<p><h1>How to recover lost bitcoins from an Android wallet
</h1></p>	
	</div>
</div>		
<div class="row">	
	<div class="span3 column">
		<h5><strong>December 28, 2011 <small> | <a href="/agilestack/2011/12/28/how-to-recover-lost-bitcoins-from-an-android-wallet#disqus_thread" data-disqus-identifier="/agilestack/2011/12/28/how-to-recover-lost-bitcoins-from-an-android-wallet">Comments</a></small></strong>
		<br/><small>Tags:  <a href="/tags/Tips" target="_blank" title="View posts tagged with &quot;Tips&quot;"><u>Tips</u></a>     <a href="/tags/Android" target="_blank" title="View posts tagged with &quot;Android&quot;"><u>Android</u></a>     <a href="/tags/Bitcoin" target="_blank" title="View posts tagged with &quot;Bitcoin&quot;"><u>Bitcoin</u></a>    </small><br/><br/>
		<!-- Twitter share -->
		<a href="https://twitter.com/share" class="twitter-share-button" data-via="gary-rowe">Tweet</a> 
		<!-- Google+ share -->
		<div class="g-plusone" data-size="medium"></div>
	</div>		
	<div class="span9 column">
		<p class="pull-right"> <a href="/agilestack/2010/08/22/my-current-development-stack" title="Previous Post: My Current Development Stack"><i class="icon-chevron-left"></i></a> 	    	<a href="/agilestack/2012/01/09/how-to-accept-bitcoins-on-your-blog-with-no-code" title="Next Post: How to accept bitcoins on your blog with no code
"><i class="icon-chevron-right"></i></a> 	 </p>  
	</div>	
</div>
<div class="row">
	<div class="span12 column">
		<hr>
	</div>
</div>
    <h2>Note - this article is now out of date due to format changes</h2>

    <h2>Background</h2>

<p>A little while ago I discovered <a href="http://lovebitcoins.org" title="Bitcoin">Bitcoin</a>. Put simply, it allows people to send any amount of money, anywhere in the world in about ten minutes without incurring an excessive transaction fee. It’s based on a very effective use of digital signatures and a public ledger of transactions to avoid double spending. In short, it is money, reinvented. If you want to send someone less than a dollar on the other side of the world, you can do it with Bitcoin.</p>

<p>There are many Bitcoin clients out there (I contribute development effort to the <a href="http://multibit.org" title="MultiBit">MultiBit</a> project) and some have taken advantage of the Android platform. In particular there is Andreas Schildbach’s <a href="http://code.google.com/p/bitcoin-wallet/" title="Google Code">Bitcoin Wallet</a> (an outstanding mobile solution with many ongoing developments) and Brian Armstrong’s <a href="https://github.com/barmstrong/bitcoin-android" title="GitHub">Bitcoin Android</a> (an early client that has seen a reduction in recent commits). I’ve used Andreas’ code for some time now as my primary mobile wallet and had an excellent experience.</p>

<p>And then my smartphone died as a result of <a href="http://www.youtube.com/watch?v=KLl9Q5ur9Oc" title="HTC Desire reboot problem">faulty networking hardware</a>.</p>

<p>Well, not a proper death, just enough to cause all the non-factory applications to stop working and to put my bitcoins (small “b” for the unit of currency with the Bitcoin protocol) at risk. Bitcoin requires you to keep your private keys safe since they provide access to your bitcoins in the public ledger (called the blockchain). Lose those private keys and you lose your bitcoins. Forever.</p>

<p>What follows is a guide that shows what I had to do to get my bitcoins back. If you find yourself in the same situation, perhaps this will help you. It does assume that you’re very technically proficient. If the idea of installing the Android SDK and using a shell to run up adb fills you with horror, stop now.</p>

<h2>What you have to do</h2>

<p>1) Do not attempt to re-install your Bitcoin wallet application – it will very likely delete your local wallet file and that’s the end of your keys.</p>

<p>2) You absolutely have to root your phone. Mine is (at the time of writing) a HTC Desire, so I used unrevoked3 (see <a href="http://unrevoked.com/">http://unrevoked.com/</a>). This should not delete any data from your system, but will enable you to access otherwise protected files.</p>

<p>3) Install the <a href="http://developer.android.com/sdk/index.html" title="Android SDK">Android SDK</a> and get the “platform tools” variant for your platform so that you get the adb application.</p>

<p>4) Hook up your phone with a USB cable (you’d probably have left it in after rooting it)</p>

<p>5) Fire up a terminal session and enter the following command (I’m using “&gt;”, “$” and “#” to represent where you are in the shells, don’t actually type them)</p>
<div class="highlight"><pre><code class="text language-text">&gt; cd &lt;wherever you&#39;ve installed Android SDK&gt;
&gt; adb shell
$
</code></pre></div>
<p>In the adb shell switch to become root</p>
<div class="highlight"><pre><code class="text language-text">$ su
#
</code></pre></div>
<p>If you get a # then you’re root. If not, try again with the unrevoked3.</p>

<p>6) Navigate to the wallet file directory</p>

<p><strong>For the Andreas Schildbach Bitcoin Wallet do this</strong></p>
<div class="highlight"><pre><code class="text language-text"># cd /data/data/de.schildbach.wallet/files
</code></pre></div>
<p>Copy the all-important private key file somewhere that adb can get to it</p>
<div class="highlight"><pre><code class="text language-text"># cat key-backup-base58 &gt; /data/local
</code></pre></div>
<p>You’ll notice that “cp” and “mv” are not options for adb against a production build of Android. Hence the sneaky use of “cat”. And, yes, I did try mounting the partition as read-write and totally failed to get it to work.</p>

<p><strong>For the Brian Armstrong Android Wallet do this</strong></p>
<div class="highlight"><pre><code class="text language-text"># cd /data/data/com.bitcoinwallet/files
</code></pre></div>
<p>Copy the all-important private key file somewhere that adb can get to it</p>
<div class="highlight"><pre><code class="text language-text"># cat prodnet.wallet &gt; /data/local/prodnet.wallet
</code></pre></div>
<p>7) Exit out of the shells (root then adb)</p>
<div class="highlight"><pre><code class="text language-text"># exit
$ exit
</code></pre></div>
<p>8) Pull the private key files off the device and somewhere local</p>
<div class="highlight"><pre><code class="text language-text">&gt; adb pull /data/local/key-backup-base58
&gt; cat key-backup-base58
</code></pre></div>
<p>The Schildbach key is stored as a simple base58 format that looks a bit like this:</p>
<div class="highlight"><pre><code class="text language-text">5dsflkjsflklnsdaflsmdflmsortofthing
</code></pre></div>
<p>The Armstrong key is more complex, it is stored as a serialized ECKey. To get the private key out of it I had to use the <a href="http://code.google.com/p/bitcoinj/" title="BitCoinJ">BitCoinJ</a> library (<a href="http://bitcoinj.googlecode.com/files/bitcoinj-0.2.zip" title="Version 0.2">version 0.2</a>) and make use of the DumpWallet.java file.  Poking around with an IDE and debugger lead me to the private key that looked a bit like this:</p>
<div class="highlight"><pre><code class="text language-text">42a34b31e9a4eedf56980ee0fc32fe6e675ff7007651ff3sortofthing
</code></pre></div>
<p>So now you have to get this private key back into a safe place.</p>

<p>9) Use Mt Gox to import the key</p>

<p>By far the fastest way is to just register an account with Mt Gox (a major Bitcoin exchange) and use their very flexible private key import facility. Just select “Private key” as a deposit method and copy-paste the contents of your key. The Mt Gox exchange can recognise a wide variety of formats and if it recognises your input then it’ll immediately give you a balance associated with that key. A short while later your Mt Gox account will be credited with the bitcoins and you can do with them as you wish.</p>

<p>10) Finally do a clean up to make sure you don’t leave the private key lying around for anyone to grab easily</p>
<div class="highlight"><pre><code class="text language-text">&gt; adb shell
$ su

# cd /data/local
# rm key-backup-base58
# rm prodnet.wallet
# rm prodnet.keychain
# exit

$ exit

&gt; exit
</code></pre></div>
<p>And you’re done.</p>

<p>This shows what must be done to recover your private keys and is correct at the time of writing. However, you should be aware that soon all private keys will be encrypted so that in addition to the above steps, you will also need to know the passphrase to gain access to the private key.</p>
		
</div>

<!-- Twitter share -->
<a href="https://twitter.com/share" class="twitter-share-button" data-via="gary-rowe">Tweet</a> 
<!-- Google+ share -->
<div class="g-plusone" data-size="medium"></div>

<h3>Related Posts</h3>
<p><strong>Useful?</strong> Consider a small donation: <a href="bitcoin:1KzTSfqjF2iKCduwz59nv2uqh1W2JsTxZH?amount=0.01&label=Agile%20Stack">1KzTSfqjF2iKCduwz59nv2uqh1W2JsTxZH</a></p>
<p><strong>Got an opinion?</strong> Comments are welcome!</p>
<p><strong>Want more?</strong> Take a look at the following:</p>

  <a href="/agilestack/2012/08/17/how-to-recover-your-bitcoins-from-a-failed-hard-drive">How to recover your bitcoins from a failed hard drive
</a><br />

  <a href="/agilestack/2013/01/13/how-bitcoin-can-contribute-to-a-resilient-community">How Bitcoin can contribute to a resilient community</a><br />

  <a href="/agilestack/2012/09/04/multibit-merchant-cheaper-in-bitcoins">MultiBit Merchant: Cheaper in bitcoins</a><br />

  <a href="/agilestack/2012/01/09/how-to-accept-bitcoins-on-your-blog-with-no-code">How to accept bitcoins on your blog with no code
</a><br />

  <a href="/agilestack/2013/05/19/simple-scaffolding">Simple Scaffolding
</a><br />

  <a href="/agilestack/2013/02/14/how-to-deploy-dynamic-sites-with-git">How to deploy dynamic sites with git
</a><br />

  <a href="/agilestack/2013/02/13/an-nginx-config-file-for-dropwizard-with-static-content">An nginx configuration file for Dropwizard with static content
</a><br />

  <a href="/agilestack/2012/12/14/how-to-deploy-static-sites-with-git">How to deploy static sites with git</a><br />

  <a href="/agilestack/2012/10/12/a-gitignore-file-for-intellij-and-eclipse-with-maven">A .gitignore file for Intellij and Eclipse with Maven
</a><br />

  <a href="/agilestack/2012/07/11/how-to-build-a-builder">How to build a Builder</a><br />

  <a href="/agilestack/2010/01/27/7-refactorings-i-couldnt-live-without">7 refactorings I couldn't live without</a><br />

  <a href="/agilestack/2010/01/14/9-top-tips-to-understand-new-code">9 top tips to understand new code</a><br />

  <a href="/agilestack/2010/01/06/avoiding-duplicate-test-results-with-hudson">Avoiding duplicate test results with Hudson
</a><br />

</div>


<hr/>
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'agilestack';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<footer class="footer">
  <div class="container">
	<p class="pull-right"> <a href="/agilestack/2010/08/22/my-current-development-stack" title="Previous Post: My Current Development Stack">&laquo; Previous Blog Post</a> 	  |  <a href="#">Back to top</a>  |   	<a href="/agilestack/2012/01/09/how-to-accept-bitcoins-on-your-blog-with-no-code" title="Next Post: How to accept bitcoins on your blog with no code
">Next Blog Post &raquo; </a> 	 </p>        
	<p>Page last generated on September  3, 2013</p>
	<p>To get in touch you should <a href="https://github.com/gary-rowe/Feedback/issues/new" title="Leave feedback for Gary"  target="_blank" >leave me some feedback</a>.</p>	
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>	
  </div>
</footer>

<!-- jQuery -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>

<!-- Twitter -->
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>    

<!-- Google +1 -->
<script type="text/javascript">
  window.___gcfg = {lang: 'en-GB'};

  (function() {
    var po = document.createElement('script'); 
    po.type = 'text/javascript'; 
    po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(po, s);
  })();
</script>

<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-900130-2']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 


</body>
</html>

