http://donncha.is/2013/05/trawling-tor-hidden-services/
HTTP/1.0 200 OK
Date: Thu, 24 Jul 2014 02:07:28 GMT
Server: Apache/2.0.52 (Red Hat) FrontPage/5.0.2.2635
X-Pingback: http://donncha.is/xmlrpc.php
Link: <http://wp.me/p3xaG9-l>; rel=shortlink
Connection: close
Content-Type: text/html; charset=UTF-8
X-Pad: avoid browser bug

<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>Trawling Tor Hidden Service &#8211; Mapping the DHT | Donncha O&#039;Cearbhaill</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://donncha.is/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="http://donncha.is/wp-content/themes/twentytwelve-custom/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Donncha O&#039;Cearbhaill &raquo; Feed" href="http://donncha.is/feed/" />
<link rel="alternate" type="application/rss+xml" title="Donncha O&#039;Cearbhaill &raquo; Comments Feed" href="http://donncha.is/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Donncha O&#039;Cearbhaill &raquo; Trawling Tor Hidden Service &#8211; Mapping the DHT Comments Feed" href="http://donncha.is/2013/05/trawling-tor-hidden-services/feed/" />
<link rel='stylesheet' id='jetpack-subscriptions-css'  href='http://donncha.is/wp-content/plugins/jetpack/modules/subscriptions/subscriptions.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='http://donncha.is/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css'  href='http://donncha.is/wp-includes/js/mediaelement/mediaelementplayer.min.css?ver=2.13.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='http://donncha.is/wp-includes/js/mediaelement/wp-mediaelement.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-style-css'  href='http://donncha.is/wp-content/themes/twentytwelve-custom/style.css?ver=3.9.1' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://donncha.is/wp-content/themes/twentytwelve-custom/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='slb_core-css'  href='http://donncha.is/wp-content/plugins/simple-lightbox/client/css/app.css?ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css'  href='http://donncha.is/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=3.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='http://donncha.is/wp-content/plugins/jetpack/_inc/genericons/genericons.css?ver=3.0.3' type='text/css' media='all' />
<script type='text/javascript' src='http://donncha.is/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://donncha.is/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://donncha.is/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://donncha.is/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Hello world&#8217; or &#8217;1&#8242;=&#8217;1' href='http://donncha.is/2013/05/hello-world/' />
<link rel='next' title='Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program' href='http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/' />
<meta name="generator" content="WordPress 3.9.1" />
<link rel='canonical' href='http://donncha.is/2013/05/trawling-tor-hidden-services/' />
<link rel='shortlink' href='http://wp.me/p3xaG9-l' />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Trawling Tor Hidden Service - Mapping the DHT" />
<meta property="og:url" content="http://donncha.is/2013/05/trawling-tor-hidden-services/" />
<meta property="og:description" content="Update 2013-08-15: I have been really enthused by reactions I received to this blog post. It has been referenced from Forbes, Gawker and the Daily Mail and a number of people have been in contact a..." />
<meta property="article:published_time" content="2013-05-15T23:13:29+00:00" />
<meta property="article:modified_time" content="2013-08-15T16:39:49+00:00" />
<meta property="article:author" content="http://donncha.is/author/donncha/" />
<meta property="og:site_name" content="Donncha O&#039;Cearbhaill" />
<meta property="og:image" content="http://donncha.is/wp-content/uploads/2013/05/THS-2-300x206.png" />
<meta property="og:image" content="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing1-150x150.png" />
<meta property="og:image" content="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing2-150x150.png" />
<meta name="twitter:site" content="@jetpack" />
<meta name="twitter:image" content="http://donncha.is/wp-content/uploads/2013/05/THS-2-300x206.png?w=240" />
<meta name="twitter:card" content="summary" />
</head>

<body class="single single-post postid-21 single-format-standard custom-font-enabled single-author">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
			<h1 class="site-title"><a href="http://donncha.is/" title="Donncha O&#039;Cearbhaill" rel="home">Donncha O&#039;Cearbhaill</a></h1>
			<ul id="media-links">
			    <li><a title="LinkedIn" href="https://www.linkedin.com/in/donnchaocearbhaill"><img src="http://donncha.is/wp-content/themes/twentytwelve-custom/icons/linkedin.png" alt="LinkedIn" /></a></li>
			    <li><a title="Twitter" href="https://www.twitter.com/DonnchaC"><img src="http://donncha.is/wp-content/themes/twentytwelve-custom/icons/twitter.png" alt="Twitter" /></a></li>
			    <li><a title="Github" href="https://www.github.com/DonnchaC"><img src="http://donncha.is/wp-content/themes/twentytwelve-custom/icons/github.png" alt="Github" /></a></li>
			    <li><a title="DU Pirate Party" href="http://www.pirates.ie"><img src="http://donncha.is/wp-content/themes/twentytwelve-custom/icons/pirate.png" alt="DU Pirate Party" /></a></li>
			</ul>
			<h2 class="site-description"></h2>
		</hgroup>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<h3 class="menu-toggle">Menu</h3>
			<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
			<div class="nav-menu"><ul><li ><a href="http://donncha.is/">Home</a></li><li class="page_item page-item-18"><a href="http://donncha.is/about/">About</a></li><li class="page_item page-item-2"><a href="http://donncha.is/contact/">Contact</a></li></ul></div>
		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">

	<div id="primary" class="site-content">
		<div id="content" role="main">

			
				
	<article id="post-21" class="post-21 post type-post status-publish format-standard hentry category-infosec tag-dos tag-hidden-services tag-tor">
				<header class="entry-header">
									<h1 class="entry-title">Trawling Tor Hidden Service &#8211; Mapping the DHT</h1>
										<div class="comments-link">
					<a href="http://donncha.is/2013/05/trawling-tor-hidden-services/#comments" title="Comment on Trawling Tor Hidden Service &#8211; Mapping the DHT">11 Replies</a>				</div><!-- .comments-link -->
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p><strong>Update 2013-08-15: </strong>I have been really enthused by reactions I received to this blog post. It has been referenced from <a href="http://www.forbes.com/sites/andygreenberg/2013/06/26/bitcoin-black-market-competition-heats-up-with-pro-marketing-and-millions-at-stake/" target="_blank">Forbes</a>, <a href="http://gawker.com/the-attack-on-the-dark-net-took-down-a-lot-more-than-ch-1081274609" target="_blank">Gawker</a> and the <a href="http://www.dailymail.co.uk/sciencetech/article-2350952/Inside-Atlantis-The-online-black-market-lets-users-buy-sell-drugs-forgeries-hacking-services-anonymously.html" target="_blank">Daily Mail</a> and a number of people have been in contact about tracking the DHT for themselves. I would recommend the IEEE S&amp;P paper, &#8220;Trawling for Tor Hidden Services: Detection, Measurement, Deanonymization&#8221; which presents the same issues allowing the DHT to be trawled. They also present some very serious attacks allowing an adversary to locate hidden services with practical resources. It is well worth checking out if you have an interest in Tor.</p>
<p>Tor hidden services have got more media attention lately as a result of some notorious sites like the <a title="Wikipedia - Silk Road (Marketplace)" href="https://en.wikipedia.org/wiki/Silk_Road_%28marketplace%29" target="_blank">Silk Road marketplace</a>, an online black market. On a basic level, Tor hidden services allow you to make TCP services available while keeping your server&#8217;s physical location hidden via the Tor anonymity network.</p>
<h2>TL;DR</h2>
<ul>
<li>Tor hidden service directories (HSDir&#8217;s) receive a subset of hidden service look-ups from users, allowing them to map relative popularity/usage of hidden service.</li>
<li>An adversary with minimal resources can carry out complete DoS attacks of Tor hidden services by running malicious Tor hidden service directories and positioning them in a particular part of the router list.</li>
<li>Many look-ups for Tor hidden services go to the incorrect hidden service directories which negatively affects the initial time to access the site.</li>
<li>Hidden services such as are popular, sites such as the Silk Road marketplace receive more than 60,000 unique user sessions a day.</li>
</ul>
<h2>Introduction</h2>
<p>For users to access a hidden service they must first retrieve a hidden service descriptor. This is a short signed message created by the hidden service approximately every hour contain a list of introduction nodes and some other identifying data such as the descriptor id (desc id). The desc ID is based on a hash of some hidden service information and it changes every 24 hours. This calculation is outlined later in the post. The hidden service then publishes its updated descriptor to a set of 6 responsible hidden service directories (HSDir&#8217;s) every hour. These responsible HSDir&#8217;s are regular node on the Tor network which have up-time longer than 24 hours and which have received the HSDir flag from the directory authorities. The set of responsible HSDir&#8217;s is based on their position of the current descriptor id in a list of all current HSDir&#8217;s ordered by their node fingerprint. This is an implementation of a simple DHT (Distributed Hash Table).</p>
<p>A client who would like to retrieve the full HS descriptor will calculate the time based descriptor id and will request it from the responsible HSDir&#8217;s directly.</p>
<div id="attachment_23" style="width: 310px" class="wp-caption alignleft"><a href="http://donncha.is/wp-content/uploads/2013/05/THS-2.png" data-slb-group="21" data-slb-active="1" data-slb-internal="0"><img class="size-medium wp-image-23" alt="Descriptor is published to a set of HSDir's" src="http://donncha.is/wp-content/uploads/2013/05/THS-2-300x206.png" width="300" height="206" /></a><p class="wp-caption-text">Descriptor is published to a set of HSDir&#8217;s</p></div>
<p>Once the client has a copy of the hidden service descriptor they can attempt to connect to one the introduction point and create a complete 7 hop circuit to the hidden service.</p>
<p>This is a very brief explanation which the Tor Project has outlined much more clearly on their <a href="https://www.torproject.org/docs/hidden-services.html.en" target="_blank">hidden service protocol</a> page but it should provide enough information to understand the following information.</p>
<h2 style="text-align: left;">The Problems</h2>
<ul>
<li>Any one can set up a Tor node (HSDir) and begin logging all hidden service descriptors published to their node. They will also receive all client requests allowing them to observe the number of look-ups for particular hidden services.</li>
<li>The list of responsible HSDir&#8217;s for a hidden service is based on the calculated descriptor ID and an ordered list of HSDir fingerprints. As the descriptor ID&#8217;s are predictable, and the node fingerprint is controlled by an adversary. The can position themselves to be the responsible directories for a targeted hidden service and subsequently perform a DoS attack by not returning the hidden service descriptor to clients. There is nothing the hidden service can do about this attack. They must rely on the Tor Project authority directories to remove the malicious HSDir&#8217;s from the consensus.</li>
</ul>
<h2>Information Gathering from the DHT</h2>
<p>Hidden services must publish their descriptors to allow clients to reach them. These descriptor id&#8217;s are deterministic but over time any HSDir should have an equal chance of receiving the descriptor for any particular hidden service as part of the DHT. As the descriptor is replicated across 6 HSDir&#8217;s, any single responsible HSDir should receive up to 1/6 of all client look-ups for that hidden service providing a good means of estimating hidden service popularity.</p>
<p>This data can be made more accurate by running more Tor HSDir&#8217;s which have <em>identity digest</em>&#8216;s in the responsible range, to the point where all the responsible HSDir&#8217;s are controlled by the observer.</p>
<p>There are currently about 1400 nodes with the &#8216;HSDir&#8217; flag running. For the past 2 months I have run 4 Tor nodes and logged all hidden service requests that they have received. Each hidden service publishes to 6 HSDir&#8217;s every day, and will publish to 360 or approximately 25% of HSDir&#8217;s in a 2 month period. As I am running 4 nodes I statistically should have received a copy of every hidden service that was online for those 60 days. While the distribution will not be perfect, my data should contain a representative set of hidden service activity. Here are some stats from those 4 nodes:</p>
<ul>
<li>Received 1.3 million requests for 3815 unique hidden services my nodes were responsible for.</li>
<li>Got 16.03 million requests for descriptors my nodes were not currently responsible for.</li>
<li>Received published descriptors for 40,500 unique hidden services</li>
<li>Received requests from clients for 25,600 unique descriptor id&#8217;s.</li>
</ul>
<p>Even these basic stats point out a number of issues with the way hidden services currently function. 16.03 million or 92.5% of all descriptor requests my nodes received were for hidden services I did not currently have descriptors for. This could be a result of the clients having an out-of-date network consensus and not choosing the correct HSDir&#8217;s as responsible. It could also be a result of an out of sync time which causes the clients to look for the wrong/old descriptor id&#8217;s. Either way, a significant amount of time is being wasted on descriptor look-up which slows down the time when first accessing a hidden service.</p>
<h3>Some More Stats..</h3>
<p>The following table contains data on requests my nodes received for some well known Tor based marketplaces. There are also requests for related phishing sites. I have confirmed that some users were directed to these phishing pages from links on the<a title="The Hidden Wiki (Tor)" href="http://kpvz7ki2v5agwt35.onion" target="_blank"> &#8220;The Hidden Wiki&#8221; (.onion)</a>. The number of requests is what my nodes observed. Descriptor look-ups from clients will be divided at random between the 6 responsible HSDir&#8217;s and clients will keep trying the remaining HSDir&#8217;s until the descriptor is found or all HSDir&#8217;s have been checked. As a result the total number of requests received by the following sites per day may be up to 6 times more than the figures below, but these still offer a relative guide to popularity.</p>
<script src="https://gist.github.com/5594954.js"></script><noscript><pre><code class="language- ">Onion Address    Descriptor ID                    Requests
----------------------------------------------------------------
silkroadvb5piz3r cjzls3i2mbj4hjnquqmuvznihues4xh4 16387
silkroadvb5piz3r m6yz6gqrmu35twduuiixzr2mqtxdo3er 10891
5onwnspjvuk7cwvk 6t44eim223ypmb2ueokcsfco5vzvryfm 1413
silkroadvb5piz3r hadco5o7rmh2vcamg7mdzqklprqffyyh 558
silkroadxmx45vk4 6tyqo2bf7xclfbmrtrxwm7mgb3z4s5ui 197
atlantisrky4es5q hdj7wkuaigt7iicqf77gyzbo7zyvq7wf 165
atlantisrky4es5q m6y4s2utv4kxgdczv7t3gbmoloezblzf 161
atlantisrky4es5q 6r3z4tlr2vvl5z34v5lcuaqckgjvtr7s 129
silkroadxmx45vk4 m6eczdbpjse3jdfw54cv4nxcc6s34eku 107
sheep5u64fi457aw ci7dpz6emlh2pxpshovnxjbyjqnp3luo 59
silkrovafuce2ur2 6r6w7ncln5mo4hdwq6yh7f2hf3hlag2u 14
sheep5u64fi457aw rzq5pd4ehayz4yker7dhmvpubm4we7om 9
silkroadopn752dl cja5ppzzmkrzvr2pgp2c2z6mtuc7m7yk 4
silkroadr5cd6wbz m4n2afulpiln4n42l7wlg36wy6okkqrh 3
silkroadfqmteec4 cjcyh7mm6lzzuqka3vlq67upyt5zwd7b 2</code></pre></noscript>
<div id="attachment_37" style="width: 160px" class="wp-caption alignleft"><a href="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing1.png" data-slb-group="21" data-slb-active="1" data-slb-internal="0"><img class="size-thumbnail wp-image-37" alt="Phishing site with a directory listing via forced browsing" src="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing1-150x150.png" width="150" height="150" /></a><p class="wp-caption-text">Phishing site with a directory listing via forced browsing</p></div>
<div id="attachment_36" style="width: 160px" class="wp-caption alignleft"><a href="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing2.png" data-slb-group="21" data-slb-active="1" data-slb-internal="0"><img class="size-thumbnail wp-image-36" alt="Text file containing phished credentials" src="http://donncha.is/wp-content/uploads/2013/05/silkroad-phishing2-150x150.png" width="150" height="150" /></a><p class="wp-caption-text">Text file containing phished credentials</p></div>
<p>It seems a lot of people, especially scammer&#8217;s running phishing sites on Tor hidden services don&#8217;t know a lot about web security which leads to sites like this.</p>
<p>Please users, if you enter your credentials on a phishing page, and it doesn&#8217;t log you into the site. Don&#8217;t try again!</p>
<p>I also observed a large number of requests to the command and control servers of the &#8220;Skynet&#8221; Tor based botnet which got attention after an AMA with the botnet owner on Reddit. Contact him <a title="@SkynetBNet" href="https://twitter.com/skynetbnet">@skynetbnet</a> on Twitter for more info.</p>
<script src="https://gist.github.com/5595748.js"></script><noscript><pre><code class="language- ">Onion Address     Descriptor ID                    Requests
----------------------------------------------------------------
gpt2u5hhaqvmnwhr  m5t2jamzi4fht3hicqadzd3rkl57lyjj 9792
x3wyzqg6cfbqrwht  m5doen5pidde5wshaormqh6l2c4bljd5 7162
gpt2u5hhaqvmnwhr  hdjeqyqaq344rbb6vxndliobueh3v2u5 6641
4bx2tfgsctov65ch  6twxygfbtb2haivmixjqx5ag35dg72tk 6485
owbm3sjqdnndmydf  hd2j5xswo5ddvxpa2rahkg24vwhqo77y 6471
niazgxzlrbpevgvq  m63z25bfydkc6nfko4b4kz44u3jsh67k 6334
6ceyqong6nxy7hwp  m6czfa7ra6qvrfvbmg6zlsimi4braizy 2691
6tkpktox73usm5vq  6ruzifokbb6ez2qbnion7deylz4jjmq3 1827
uzvyltfdj37rhqfy  6tvqgoeu4piyu3x6dsyerhhhnko6iumy 1735
6m7m4bsdbzsflego  m5zclz4icakymh2d6fbdkpq2t3n7efql 1681
6ceyqong6nxy7hwp  hds46ckhghbg5gvfwnsgwvhvdildn2e5 1605
jr6t4gi4k2vpry5c  m5zfpvht47zgiujyjkf5en2vu6g7ndzm 1579
xvauhzlpkirnzghg  6ugswkgt5pdmhlyzjgj5bhtnclophhwa 1556
jr6t4gi4k2vpry5c  m5576obc535dffll4qwq6xh37u4dz7y2 1422
ceif2rmdoput3wjh  6s544wf5d6kuyhtiqq7wo37oisi6n5ce 1397
f2ylgv2jochpzm4c  cjore7wxv2x46qrlcvmiyctm4szckpo3 1380
uy5t7cus7dptkchs  6ttlcxahq4obesp5gze4rkjjinivgoyl 1370
7wuwk3aybq5z73m7  6urq4w6to5fmjf3hyqitzlcscxszzbrd 1199
742yhnr32ntzhx3f  t5z3anxrp3e5w5z2s5kqfftuxlw4v6ng 1178
7wuwk3aybq5z73m7  m4ejch7su2xm6zrzu5gn3cgrjsg43f6y 235
6m7m4bsdbzsflego  7lsph6grzr76j27fx4r7ir3ipbexidkt 134
6tkpktox73usm5vq  hday5dik3mzlwkpvemrorfmirfdnepnp 102
6ceyqong6nxy7hwp  lzgpbrgh6ims4fgru6ojdsea7hbruh6s 25
x3wyzqg6cfbqrwht  ciq4shgjmutzgmz2t346rvkwtzuobfqe 24
owbm3sjqdnndmydf  ciebkgj3gbl4egtwqvwssc6kvtt4x6t5 15
4bx2tfgsctov65ch  6rnq6z57hvjrf4a5yktfd7qavuvlvqjb 6
</code></pre></noscript>
<p>Many of the &#8220;Skynet&#8221; onion addresses above and other popular addresses are running Bitcoin mining proxies. They generally responded with a basic authentication request for &#8220;bitcoin-mining-proxy&#8221;. The other services may be Tor based bitcoin mining pools or part of Skynet and/or other botnets. It should be straight forward to find these sites by scanning the service id&#8217;s from the raw data on Github.</p>
<h3>DoS Attacks on Tor Hidden Services</h3>
<p>Tor hidden service <em>desc_id</em>&#8216;s are calculated deterministically and if there is no <em>&#8216;descriptor cookie&#8217;</em> set in the hidden service Tor config anyone can determine the <em>desc id</em>&#8216;s for any hidden service at any point in time.This is a requirement for the current hidden service protocol as clients must calculate the current descriptor id to request hidden service descriptors from the HSDir&#8217;s. The descriptor ID&#8217;s are calculated as follows:</p>
<p><code>descriptor-id = H(permanent-id | H(time-period | descriptor-cookie | replica))</code></p>
<p>The <em>replica</em> is an integer, currently either 0 or 1 which will generate two separate descriptor ID&#8217;s, distributing the descriptor to two sets of 3 consecutive nodes in the DHT. The <em>permanent-id</em> is derived from the service public key. The hash function is SHA1.</p>
<p><code>time-period = (current-time + permanent-id-byte * 86400 / 256) / 86400</code></p>
<p>The <em>time-period</em> changes every 24 hours. The first byte of the <em>permanent_id</em> is added to make sure the hidden services do not all try to update their descriptors at the same time.</p>
<p><code>identity-digest = H(server-identity-key)</code></p>
<p>The <em>identity-digest</em> is the SHA1 hash of the public key generated from the <em>secret_id_key</em> file in Tor&#8217;s <em>keys</em> directory. Normally it should never change for a node as it is used for to determine the router&#8217;s long-term fingerprint, but the key is completely user controlled.</p>
<p>A HSDir<em></em> is responsible if it is one of the three HSDir&#8217;s after the calculated <em>desc id</em> in a descending lists of all nodes in the Tor consensus with the HSDir flag, sorted by their identity digest.  The HS descriptor is published to two <em>replica</em>&#8216;s (two set&#8217;s of 3 HSDir&#8217;s at different points of the router list) based on the two descriptor id&#8217;s generated as a result of the &#8217;0&#8242; or &#8217;1&#8242; replica value in the descriptor id hash calculation.</p>
<p>I have implemented a script calculating the descriptor ID&#8217;s for a particular hidden service at an arbitrary time and it is available on my <a href="https://github.com/DonnchaC/tor/blob/master/scripts/calc_hidservice_desc_id.py" target="_blank">Github account</a>. I have also created a modified version of &#8216;<a href="https://github.com/katmagic/Shallot" target="_blank">Shallot</a>&#8216; which can be used to generate keys with an identity key in a specified range. The is more usage information on <a href="https://github.com/DonnchaC/tor/tree/master/scripts/identity_key_generator" target="_blank">its Github page</a>.</p>
<h3>The Attack</h3>
<p>The code listed above could be used to generate identity keys and <em>identity digests</em> for an adversary’s HSDir nodes so that they&#8217;ll be selected as 6 of the HSDir&#8217;s for a targeted hidden service. These adversary controlled hidden service directories could simple return no data (404 Response) to a client requesting the targeted hidden service&#8217;s descriptor and in turn prevent them from finding introduction nodes. As there are no other sources for this hidden service descriptor it would be impossible for a user to set up a circuit a complete circuit to the hidden service and there would be a complete denial of service until the descriptor id changes.</p>
<p>For an adversary to continue this attack over a longer time-frame, they would need to set up their nodes for the upcoming desc id&#8217;s of the targeted hidden service more than 24 hours in advance to make sure they will have received the HSDir flag.</p>
<p>An adversary would need to run 12-18 nodes to keep up a complete, persistent DoS on the targeted hidden service. Six nodes would be the &#8220;responsible HSDir&#8217;s&#8221; and the other nodes would be running with identity digests in the range of the upcoming desc id&#8217;s, to gain the HSDir flags after 24 hours of up-time. An adversary can cut the resources needed by running two Tor instances/nodes per IPv4 IP or by running the Tor nodes on compromised servers on high, unprivileged ports.</p>
<p>These attacks a quite a real, practical threat against the availability of Tor hidden services. For whatever reason (extortion, censorship etc.) adversary can perform complete DoS attacks with minimal resources and there are no actions hidden service owner can do to mitigate, besides switching to descriptor cookie based authentication or multiple private address. The Tor project can try deal with these attacks by removing known malicious HSDir&#8217;s from the network consensus but I don&#8217;t see a straight forward way to identify these malicious nodes.</p>
<p>Unfortunately there are no easy solutions to this problem at the moment. I can foresee adversaries employing these attacks in the wild against popular hidden services.</p>
<h2>Conclusions</h2>
<p>Tor hidden services were originally implemented as some a simple feature on top of the Tor network and unfortunately they haven&#8217;t received the attention and love the deserve for such a popular feature. There are discussions under way to re-implement hidden services to alllow them to scale more efficiently. There are also people looking at reducing the ability of HSDir&#8217;s to sit and gather data on onion address and look-ups like I have done, by implementing a PIR protocol. A good summary of work that needs to be done is available in a <a title="Hidden Services need some love" href="https://blog.torproject.org/blog/hidden-services-need-some-love" target="_blank">blog post</a> on the Tor Project&#8217;s website. I&#8217;d urge any developers with an interest to join the <a href="https://lists.torproject.org/pipermail/tor-dev/" target="_blank">tor-dev mailing list</a> and see if there is something  you can contribute! A lot of work is needed.</p>
<p>Anyone interested in learning more about the issues with the current Tor hidden service implementation please check out the presentation <a href="http://www.ieee-security.org/TC/SP2013/program.html" target="_blank">&#8220;Trawling for Tor Hidden Services: Detection, Measurement, Deanonymization&#8221;</a> at the IEEE S&amp;P conference this Monday by Alex Biryukov, Ivan Pustogarov and RalfPhilipp Weinmann will probably provide a much more in-depth, formal investigation and I too look forward to reading it. We have been researching similar areas so I&#8217;m very interested in their approach and results.</p>
<p>All raw data and my modified Tor clients are available from my <a title="Github" href="https://github.com/DonnchaC/tor/" target="_blank">Github repo</a>. This also contains scripts for calculating hidden service descriptors and generating OR private keys with fingerprints in a particular range. This data includes all descriptor requests and hidden service ID&#8217;s my nodes observed. Please check it out if you are interested in analyzing a random subset of services on the Tor network.</p>
<p>I&#8217;d like to thank <a href="http://www.twitter.com/mikesligo" target="_blank">@mikesligo</a> for having a heated debate in the pub with me about hidden services and getting me interested in how they work. I&#8217;d also like to thank <a href="https://twitter.com/CiaranmaK" target="_blank">@CiaranmaK</a> for reading a draft of this post and pointing out some corrections.</p>
<p>Thank you for reading my first blog post. I&#8217;ll have to work on presenting things better as the information in this post is a bit all over the place. Please let me know if you have any questions or feedback in the comments below.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/?share=twitter" title="Click to share on Twitter" id="sharing-twitter-21"><span>Twitter</span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/?share=google-plus-1" title="Click to share on Google+" id="sharing-google-21"><span>Google</span></a></li><li class="share-linkedin"><a rel="nofollow" class="share-linkedin sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/?share=linkedin" title="Click to share on LinkedIn" id="sharing-linkedin-21"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow" class="share-reddit sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/?share=reddit" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-email"><a rel="nofollow" class="share-email sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/?share=email" title="Click to email this to a friend"><span>Email</span></a></li><li class="share-print"><a rel="nofollow" class="share-print sd-button share-icon" href="http://donncha.is/2013/05/trawling-tor-hidden-services/#print" title="Click to print"><span>Print</span></a></li><li class="share-end"></li></ul></div></div></div>					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="http://donncha.is/category/infosec/" title="View all posts in Infosec" rel="category tag">Infosec</a> and tagged <a href="http://donncha.is/tag/dos/" rel="tag">DoS</a>, <a href="http://donncha.is/tag/hidden-services/" rel="tag">Hidden Services</a>, <a href="http://donncha.is/tag/tor/" rel="tag">Tor</a> on <a href="http://donncha.is/2013/05/trawling-tor-hidden-services/" title="11:13 pm" rel="bookmark"><time class="entry-date" datetime="2013-05-15T23:13:29+00:00">May 15, 2013</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://donncha.is/author/donncha/" title="View all posts by Donncha" rel="author">Donncha</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

				<nav class="nav-single">
					<h3 class="assistive-text">Post navigation</h3>
					<span class="nav-previous"><a href="http://donncha.is/2013/05/hello-world/" rel="prev"><span class="meta-nav">&larr;</span> Hello world&#8217; or &#8217;1&#8242;=&#8217;1</a></span>
					<span class="nav-next"><a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/" rel="next">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program <span class="meta-nav">&rarr;</span></a></span>
				</nav><!-- .nav-single -->

				
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			11 thoughts on &ldquo;<span>Trawling Tor Hidden Service &#8211; Mapping the DHT</span>&rdquo;		</h2>

		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-3">
		<article id="comment-3" class="comment">
			<header class="comment-meta comment-author vcard">
				<img alt='' src='http://1.gravatar.com/avatar/b240aaab5e1897421d7a1933d0c510f4?s=44&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&amp;r=G' class='avatar avatar-44 photo' height='44' width='44' /><cite class="fn"><a href='http://www.gwern.net/Silk%20Road' rel='external nofollow' class='url'>gwern</a> </cite><a href="http://donncha.is/2013/05/trawling-tor-hidden-services/#comment-3"><time datetime="2013-05-18T17:20:14+00:00">May 18, 2013 at 5:20 pm</time></a>			</header><!-- .comment-meta -->

			
			<section class="comment-content comment">
				<p>Interesting&#8230; so if I am interpreting your .onion table right, that implies that in April &amp; May 2013, you found a lower bound of 27,836 visitors to SR &amp; 327 to SR phishing sites (so 1.17% of would-be SR visitors were exposed to a phishing site?) and an upper bound of 167,016/1,962 (respectively).</p>
<p>These directory lookups are one per visit to a hidden service, I take it and the results are subsequently cached?</p>
							</section><!-- .comment-content -->

			<div class="reply">
				<a class='comment-reply-link' href='/2013/05/trawling-tor-hidden-services/?replytocom=3#respond' onclick='return addComment.moveForm("comment-3", "3", "respond", "21")'>Reply</a> <span>&darr;</span>			</div><!-- .reply -->
		</article><!-- #comment-## -->
	<ol class="children">
	<li class="comment byuser comment-author-donncha bypostauthor odd alt depth-2" id="li-comment-4">
		<article id="comment-4" class="comment">
			<header class="comment-meta comment-author vcard">
				<img alt='' src='http://0.gravatar.com/avatar/e7aad85dd4dabc40edd24a2147f53a35?s=44&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&amp;r=G' class='avatar avatar-44 photo' height='44' width='44' /><cite class="fn"><a href='http://donncha.is' rel='external nofollow' class='url'>Donncha</a> <span> Post author</span></cite><a href="http://donncha.is/2013/05/trawling-tor-hidden-services/#comment-4"><time datetime="2013-05-18T23:31:45+00:00">May 18, 2013 at 11:31 pm</time></a>			</header><!-- .comment-meta -->

			
			<section class="comment-content comment">
				<p>Hi Gwern,</p>
<p>It is a small sample set. My nodes were only responsible for SR on two days. So it would be an absolute lower bound of 16387 in one day and an upper bound of 98322. This is a very wide range but it gives an idea of the order of magnitude. I wrote a script today to check how many responsible HSDir&#8217;s are returning the descriptor. I realize now I should of ran it as I found each service ID to be able to utilize this data better. It seems pretty changeable.</p>
<p>I think it reasonable that ~1% of would be SR visitors were directed to a phishing page on a particular day it was promoted. Someone was spamming the site on Reddit &#8211;  <a href="http://www.reddit.com/r/SilkRoad/comments/18c1n3/sr_registration_down/" rel="nofollow">Reddit &#8211; SR Registration Down</a>. I observed users getting directed to other phishing pages from the hidden wiki.</p>
<p>I&#8217;d just like to reiterate that the absolute values only give a rough estimate of users. But its probably the only way we have of measuring hidden service usage without being an administator on those sites.</p>
							</section><!-- .comment-content -->

			<div class="reply">
				<a class='comment-reply-link' href='/2013/05/trawling-tor-hidden-services/?replytocom=4#respond' onclick='return addComment.moveForm("comment-4", "4", "respond", "21")'>Reply</a> <span>&darr;</span>			</div><!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-435">
		<p>Pingback: <a href='http://www.forbes.com/sites/andygreenberg/2013/06/26/bitcoin-black-market-competition-heats-up-with-pro-marketing-and-millions-at-stake/' rel='external nofollow' class='url'>Bitcoin Black Market Competition Heats Up, With Pro Marketing And Millions At Stake - Forbes</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-454">
		<p>Pingback: <a href='http://motorinsurancehelp.com/bitcoin-black-market-competition-heats-up-with-pro-marketing-and-millions-at/' rel='external nofollow' class='url'>Bitcoin Black Market Competition Heats Up, With Pro Marketing And Millions At ...</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-470">
		<p>Pingback: <a href='http://freedomwat.ch/2013/06/27/bitcoin-black-market-competition-heats-up-with-pro-marketing-and-millions-at-stake/' rel='external nofollow' class='url'>Bitcoin Black Market Competition Heats Up, With Pro Marketing And Millions At Stake | The Freedom Watch</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-473">
		<p>Pingback: <a href='http://btcworldnews.com/bitcoin-accepting-atlantis-takes-on-the-silk-road/' rel='external nofollow' class='url'>Bitcoin-accepting Atlantis takes on the Silk Road | BTC World News - BitCoin Network</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-530">
		<p>Pingback: <a href='http://talesfromthelou.wordpress.com/2013/06/29/inside-atlantis-the-online-black-market-that-lets-users-buy-and-sell-drugs-forgeries-and-hacking-services-anonymously/' rel='external nofollow' class='url'>Inside Atlantis: The online black market that lets users buy and sell drugs, forgeries and hacking services anonymously | Talesfromthelou&#039;s Blog</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-550">
		<p>Pingback: <a href='http://sandblastingjobwork.com/inside-atlantis-the-online-black-market-that-lets-users-buy-and-sell-drugs' rel='external nofollow' class='url'>Inside Atlantis: The online black market that lets users buy and sell drugs &#8230;</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-856">
		<p>Pingback: <a href='http://unspy.wordpress.com/2013/07/14/bitcoin-accepting-atlantis-takes-on-the-silk-road/' rel='external nofollow' class='url'>Bitcoin-accepting Atlantis &amp; Sheep takes on the Silk Road | unSpy</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-857">
		<p>Pingback: <a href='http://unspy.wordpress.com/2013/07/14/bitcoin-atlantis-sheep-take-on-the-silk-road/' rel='external nofollow' class='url'>Bitcoin-accepting Atlantis &amp; Sheep take on the Silk Road | unSpy</a> </p>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-31877">
		<p>Pingback: <a href='http://www.deepdotweb.com/2014/06/22/study-estimating-hidden-service-traffic-dns-leaks/' rel='external nofollow' class='url'>Study: Estimating hidden service traffic from DNS leaks | Deep Dot Web</a> </p>
	</li><!-- #comment-## -->
		</ol><!-- .commentlist -->

		
		
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/05/trawling-tor-hidden-services/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://donncha.is/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes">Your email address will not be published.</p>							<p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="text" value="" size="30" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='21' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8fbf704aed" /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="56"/></p>					</form>
							</div><!-- #respond -->
			
</div><!-- #comments .comments-area -->
			
		</div><!-- #content -->
	</div><!-- #primary -->


			<div id="secondary" class="widget-area" role="complementary">
			<aside id="twitter_timeline-2" class="widget widget_twitter_timeline"><h3 class="widget-title">Follow me on Twitter</h3><a class="twitter-timeline" data-widget-id="334736514154106880" data-theme="light" data-link-color="#21759b" data-border-color="#e8e8e8" data-chrome="noheader nofooter noborders" height="400" lang="EN">My Tweets</a></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://donncha.is/2014/07/problems-using-an-openpgp-smartcard-for-ssh-with-gpg-agent/">Problems using an OpenPGP smartcard for SSH with gpg-agent</a>
						</li>
					<li>
				<a href="http://donncha.is/2013/12/bitcoin-panel-discussion-at-the-web-summit/">Bitcoin Panel Discussion at The Web Summit</a>
						</li>
					<li>
				<a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program</a>
						</li>
					<li>
				<a href="http://donncha.is/2013/05/trawling-tor-hidden-services/">Trawling Tor Hidden Service &#8211; Mapping the DHT</a>
						</li>
					<li>
				<a href="http://donncha.is/2013/05/hello-world/">Hello world&#8217; or &#8217;1&#8242;=&#8217;1</a>
						</li>
				</ul>
		</aside><aside id="recent-comments-clean-2" class="widget widget_recent_comments_clean"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://donncha.is' rel='external nofollow' class='url'>Donncha</a> on <a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/#comment-13621">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program</a></li><li class="recentcomments">peter on <a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/#comment-12792">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program</a></li><li class="recentcomments"><a href='http://www.bitsmoke.com' rel='external nofollow' class='url'>bitcoin shop</a> on <a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/#comment-2538">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program</a></li><li class="recentcomments"><a href='http://www.securitylearn.net' rel='external nofollow' class='url'>satishb3</a> on <a href="http://donncha.is/2013/06/coinbase-owning-a-bitcoin-exchange-bug-bounty-program/#comment-397">Coinbase &#8211; Owning a Bitcoin Exchange Bug Bounty Program</a></li><li class="recentcomments"><a href='http://donncha.is' rel='external nofollow' class='url'>Donncha</a> on <a href="http://donncha.is/2013/05/trawling-tor-hidden-services/#comment-4">Trawling Tor Hidden Service &#8211; Mapping the DHT</a></li></ul></aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://donncha.is/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
	<li><a href='http://donncha.is/2014/07/'>July 2014</a></li>
	<li><a href='http://donncha.is/2013/12/'>December 2013</a></li>
	<li><a href='http://donncha.is/2013/06/'>June 2013</a></li>
	<li><a href='http://donncha.is/2013/05/'>May 2013</a></li>
		</ul>
</aside><aside id="tag_cloud-2" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href='http://donncha.is/tag/bitcoin/' class='tag-link-8' title='2 topics' style='font-size: 22pt;'>Bitcoin</a>
<a href='http://donncha.is/tag/dos/' class='tag-link-6' title='1 topic' style='font-size: 8pt;'>DoS</a>
<a href='http://donncha.is/tag/hidden-services/' class='tag-link-5' title='1 topic' style='font-size: 8pt;'>Hidden Services</a>
<a href='http://donncha.is/tag/panel/' class='tag-link-10' title='1 topic' style='font-size: 8pt;'>panel</a>
<a href='http://donncha.is/tag/tor/' class='tag-link-4' title='1 topic' style='font-size: 8pt;'>Tor</a>
<a href='http://donncha.is/tag/web-summit/' class='tag-link-9' title='1 topic' style='font-size: 8pt;'>web summit</a></div>
</aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><a style="display:block; text-align: center" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>All original content on this site from  <a xmlns:cc="http://creativecommons.org/ns#" href="http://donncha.is" property="cc:attributionName" rel="cc:attributionURL">Donncha O'Cearbhaill</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</div>
		</aside>		</div><!-- #secondary -->
		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			<span id="tip-me">Buy me a beer? <strong><a href="bitcoin:1DoNNchAB64WDyAW9MDVQ8hsNiw2HPXDUv" title="Tip me some bitcoins">1DoNNchAB64WDyAW9MDVQ8hsNiw2HPXDUv</a></strong></span>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	<div class="grofile-hash-map-b240aaab5e1897421d7a1933d0c510f4">
	</div>
	<div class="grofile-hash-map-e7aad85dd4dabc40edd24a2147f53a35">
	</div>
	</div>
                <script type="text/javascript">
                        !function(d,s,id){
                                var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';
                                if(!d.getElementById(id)){
                                        js=d.createElement(s);
                                        js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
                                        fjs.parentNode.insertBefore(js,fjs);
                                }
                        }
                        (document,"script","twitter-wjs");
                </script>
        
	<script type="text/javascript">
		WPCOM_sharing_counts = {"http:\/\/donncha.is\/2013\/05\/trawling-tor-hidden-services\/":21}	</script>
		<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-linkedin' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
		});
		</script>
			<div id="sharing_email" style="display: none;">
		<form action="/2013/05/trawling-tor-hidden-services/" method="post">
			<label for="target_email">Send to Email Address</label>
			<input type="email" name="target_email" id="target_email" value="" />

			
				<label for="source_name">Your Name</label>
				<input type="text" name="source_name" id="source_name" value="" />

				<label for="source_email">Your Email Address</label>
				<input type="email" name="source_email" id="source_email" value="" />

			
			
			<img style="float: right; display: none" class="loading" src="http://donncha.is/wp-content/plugins/jetpack/modules/sharedaddy/images/loading.gif" alt="loading" width="16" height="16" />
			<input type="submit" value="Send Email" class="sharing_send" />
			<a href="#cancel" class="sharing_cancel">Cancel</a>

			<div class="errors errors-1" style="display: none;">
				Post was not sent - check your email addresses!			</div>

			<div class="errors errors-2" style="display: none;">
				Email check failed, please try again			</div>

			<div class="errors errors-3" style="display: none;">
				Sorry, your blog cannot share posts by email.			</div>
		</form>
	</div>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/akismet/_inc/form.js?ver=3.0.1'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201430'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var mejsL10n = {"language":"en-US","strings":{"Close":"Close","Fullscreen":"Fullscreen","Download File":"Download File","Download Video":"Download Video","Play\/Pause":"Play\/Pause","Mute Toggle":"Mute Toggle","None":"None","Turn off Fullscreen":"Turn off Fullscreen","Go Fullscreen":"Go Fullscreen","Unmute":"Unmute","Mute":"Mute","Captions\/Subtitles":"Captions\/Subtitles"}};
var _wpmejsSettings = {"pluginPath":"\/wp-includes\/js\/mediaelement\/"};
/* ]]> */
</script>
<script type='text/javascript' src='http://donncha.is/wp-includes/js/mediaelement/mediaelement-and-player.min.js?ver=2.14.2'></script>
<script type='text/javascript' src='http://donncha.is/wp-includes/js/mediaelement/wp-mediaelement.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2014Julaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-includes/js/comment-reply.min.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/themes/twentytwelve-custom/js/navigation.js?ver=1.0'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/client/js/prod/lib.core.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/client/js/prod/lib.view.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/themes/baseline/js/prod/client.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/themes/default/js/prod/client.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/template-tags/item/js/prod/tag.item.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/template-tags/ui/js/prod/tag.ui.js?ver=2.3.1'></script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/simple-lightbox/content-handlers/image/js/prod/handler.image.js?ver=2.3.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var recaptcha_options = {"lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='http://donncha.is/wp-content/plugins/jetpack/modules/sharedaddy/sharing.js?ver=20121205'></script>
<script type="text/javascript" id="slb_footer">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB && SLB.has_child('View.init') ) { SLB.View.init({"ui_autofit":true,"ui_animate":true,"slideshow_autostart":false,"slideshow_duration":"6","group_loop":true,"ui_overlay_opacity":"0.8","ui_title_default":false,"theme_default":"slb_default","ui_labels":{"loading":"Loading","close":"Close","nav_next":"Next","nav_prev":"Previous","slideshow_start":"Start slideshow","slideshow_stop":"Stop slideshow","group_status":"Item %current% of %total%"}}); }
if ( !!window.SLB && SLB.has_child('View.assets') ) { {$.extend(SLB.View.assets, {"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/THS-2.png":{"id":23,"_entries":[],"type":"image","source":"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/THS-2.png","internal":true,"sizes":{"thumbnail":{"file":"THS-2-150x150.png","width":150,"height":150,"mime-type":"image\/png"},"medium":{"file":"THS-2-300x206.png","width":300,"height":206,"mime-type":"image\/png"},"original":{"file":"2013\/05\/THS-2.png","width":563,"height":387}},"image_meta":{"aperture":0,"credit":"","camera":"","caption":"","created_timestamp":0,"copyright":"","focal_length":0,"iso":0,"shutter_speed":0,"title":""},"description":"This image is actually out of date as the descriptor is now published to a set of regular Tor nodes acting as a DHT","title":"Hidden Service 2","caption":"Descriptor is published to a set of HSDir's"},"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/silkroad-phishing1.png":{"id":37,"_entries":[],"type":"image","source":"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/silkroad-phishing1.png","internal":true,"sizes":{"thumbnail":{"file":"silkroad-phishing1-150x150.png","width":150,"height":150,"mime-type":"image\/png"},"medium":{"file":"silkroad-phishing1-300x168.png","width":300,"height":168,"mime-type":"image\/png"},"large":{"file":"silkroad-phishing1-1024x575.png","width":1024,"height":575,"mime-type":"image\/png"},"post-thumbnail":{"file":"silkroad-phishing1-624x350.png","width":624,"height":350,"mime-type":"image\/png"},"original":{"file":"2013\/05\/silkroad-phishing1.png","width":1366,"height":768}},"image_meta":{"aperture":0,"credit":"","camera":"","caption":"","created_timestamp":0,"copyright":"","focal_length":0,"iso":0,"shutter_speed":0,"title":""},"description":"","title":"Silkroad Phishing 1","caption":"Phishing site with a directory listing via forced browsing"},"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/silkroad-phishing2.png":{"id":36,"_entries":[],"type":"image","source":"http:\/\/donncha.is\/wp-content\/uploads\/2013\/05\/silkroad-phishing2.png","internal":true,"sizes":{"thumbnail":{"file":"silkroad-phishing2-150x150.png","width":150,"height":150,"mime-type":"image\/png"},"medium":{"file":"silkroad-phishing2-300x168.png","width":300,"height":168,"mime-type":"image\/png"},"large":{"file":"silkroad-phishing2-1024x575.png","width":1024,"height":575,"mime-type":"image\/png"},"post-thumbnail":{"file":"silkroad-phishing2-624x350.png","width":624,"height":350,"mime-type":"image\/png"},"original":{"file":"2013\/05\/silkroad-phishing2.png","width":1366,"height":768}},"image_meta":{"aperture":0,"credit":"","camera":"","caption":"","created_timestamp":0,"copyright":"","focal_length":0,"iso":0,"shutter_speed":0,"title":""},"description":"","title":"Silkroad Phishing 2","caption":"Text file containing phished credentials"}});} }
/* THM */
if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_baseline',{"name":"Baseline","parent":"","styles":[{"handle":"base","uri":"http:\/\/donncha.is\/wp-content\/plugins\/simple-lightbox\/themes\/baseline\/css\/style.css","deps":[]}],"layout_raw":"<div class=\"slb_container\"><div class=\"slb_content\">{{item.content}}<div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><div class=\"slb_controls\"><span class=\"slb_close\">{{ui.close}}<\/span><span class=\"slb_slideshow\">{{ui.slideshow_control}}<\/span><\/div><div class=\"slb_loading\">{{ui.loading}}<\/div><\/div><div class=\"slb_details\"><div class=\"inner\"><div class=\"slb_data\"><div class=\"slb_data_content\"><span class=\"slb_data_title\">{{item.title}}<\/span><span class=\"slb_group_status\">{{ui.group_status}}<\/span><div class=\"slb_data_desc\">{{item.description}}<\/div><\/div><\/div><div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><\/div><\/div><\/div>"}); }if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_default',{"name":"Default (Light)","parent":"slb_baseline","styles":[{"handle":"font","uri":"http:\/\/fonts.googleapis.com\/css?family=Yanone+Kaffeesatz","deps":[]},{"handle":"base","uri":"http:\/\/donncha.is\/wp-content\/plugins\/simple-lightbox\/themes\/default\/css\/style.css","deps":[]}]}); }})})(jQuery);}/* ]]> */</script>
<script type="text/javascript" id="slb_context">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB ) { {$.extend(SLB, {"context":["public","user_guest"]});} }})})(jQuery);}/* ]]> */</script>

	<script src="http://stats.wordpress.com/e-201430.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:3.0.2',blog:'52234885',post:'21',tz:'0'});
	var load_cmc = function(){linktracker_init(52234885,21,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script></body>
</html>

