http://arzur.net/
HTTP/1.0 200 OK
Date: Tue, 22 Jul 2014 14:55:53 GMT
Server: Apache/2.2.14 (Ubuntu)
X-Powered-By: PHP/5.3.2-1ubuntu4.24
X-Pingback: http://arzur.net/xmlrpc.php
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 19153
Connection: close
Content-Type: text/html; charset=UTF-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Zuzur&#039;s corner</title>
<link rel="shortcut icon" href="http://arzur.net/wp-content/themes/lightword/favicon.ico" />
<link rel="pingback" href="http://arzur.net/xmlrpc.php" />


<link rel="alternate" type="application/rss+xml" title="Zuzur&#039;s corner &raquo; Feed" href="http://arzur.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="Zuzur&#039;s corner &raquo; Comments Feed" href="http://arzur.net/comments/feed/" />

            <script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-111937-1']);
				            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
			<link rel='stylesheet' id='lightword_stylesheet-css'  href='http://arzur.net/wp-content/themes/lightword/style.css?ver=2.0.0.6' type='text/css' media='all' />
<link rel='stylesheet' id='lightword_stylesheet_original-css'  href='http://arzur.net/wp-content/themes/lightword/original.css?ver=2.0.0.6' type='text/css' media='all' />
<link rel='stylesheet' id='bitcointips-style-css'  href='http://arzur.net/wp-content/plugins/bitcoin-tips/style.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='social_comments-css'  href='http://arzur.net/wp-content/plugins/social/assets/comments.css?ver=2.11' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://arzur.net/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://arzur.net/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://arzur.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://arzur.net/wp-content/plugins/chili-code-highlighter/chili/jquery.chili-2.0.js?ver=2.0'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://arzur.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://arzur.net/wp-includes/wlwmanifest.xml" /> 
	<!-- Chili Code Highlighter v1.0.0 | http://www.viper007bond.com/wordpress-plugins/chili-code-highlighter/ -->
	<script type="text/javascript">
		ChiliBook.recipeFolder = 'http://arzur.net/wp-content/plugins/chili-code-highlighter/chili/';
	</script>
	<style type="text/css">
		pre.chili {
			padding: 5px;
			overflow-x: auto;
		}
	</style>
	<!--[if IE]><style type="text/css">pre.chili { padding-bottom: 20px; }</style><![endif]-->
<link rel="alternate" hreflang="fr-FR" href="http://arzur.net/?lang=fr_fr" />
<style type="text/css">
#content-body,x:-moz-any-link{float:left;margin-right:28px;}#content-body, x:-moz-any-link, x:default{float:none;margin-right:25px;} 
</style>

<script src="http://arzur.net/wp-content/themes/lightword/js/cufon-yui.js" type="text/javascript"></script>
<script src="http://arzur.net/wp-content/themes/lightword/js/vera.font.js" type="text/javascript"></script>
<script type="text/javascript">/*<![CDATA[*/Cufon.replace(['h1','h2','h3#reply-title'], { fontFamily: 'Vera' });/*]]>*/</script>
<!--[if IE 6]><style type="text/css">#header{background-image: none; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://arzur.net/wp-content/themes/lightword/images/content_top.png',sizingMethod='scale'); }#footer{background:transparent url(http://arzur.net/wp-content/themes/lightword/images/content_bottom.gif) no-repeat;height:8px;}.comm_date{background-image: none; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://arzur.net/wp-content/themes/lightword/images/date_comm_box.png',sizingMethod='scale'); }</style><![endif]-->
<!-- multilingual website powered with xili-language v. 2.14.1  WP plugin of dev.xiligroup.com -->
</head>

<body class="home blog">
<div id="wrapper">

<div id="top_cufon"><h1 id="logo"><a name="top" title="Zuzur&#039;s corner" href="http://arzur.net">Zuzur&#039;s corner</a> <small>technology, the web, programming and a bit of this and that &#8230;</small></h1></div>

<div id="header">
<a id="rss-feed" title="Syndicate this site using RSS" href="http://arzur.net/feed/">Subscribe via RSS</a>

<div id="top_bar">
<div class="center_menu">
<ul id="front_menu" >
    <li><a class="s" title="Home" href="http://arzur.net"><span>Home</span></a></li>
<div class="menu"></div>
</ul>
</div>
<form method="get" id="searchform" action="http://arzur.net"> <input type="text" value="" name="s" id="s" /> <input type="submit" id="go" value="" alt="Search" title="Search" /></form>
</div>

</div>
<div id="content"><div id="content-body">

<div class="post-229 post type-post status-publish format-standard hentry category-chef category-notebook category-sysadmin" id="post-229">
<div class="comm_date"><span class="data"><span class="j">20</span>Dec/12</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2012/12/20/notebook-importing-existing-users-from-chef/#comments">Off</a></span></div>
<h2><a title="notebook: importing existing users from chef" href="http://arzur.net/2012/12/20/notebook-importing-existing-users-from-chef/" rel="bookmark">notebook: importing existing users from chef</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2012/12/20/notebook-importing-existing-users-from-chef/">Tweet</a></div>
<p>I recently had (too much) fun trying to import a few existing chef users (opscode's platform) to another chef server. There is currently no facility to export your existing users ('clients' if you are running your own server, 'users' on the opscode platform).</p>
<p>What i ended up doing involves a lot of manual typing, but i intend to automate that in the future.</p>
<p>The key is that there is no way you can export you users' public keys without accessing the underlying CouchDB server, and as i'm pretty sure Opscode uses a multi-tenant CouchDB server, you can't do that on their platform for obvious security concerns.</p>
<p>So i ended up:</p>
<ul>
<li>creating the same users on my new chef server</li>
<li>use irb on the new chef server to overwrite every new users' public key using some of chef's internal methods</li>
</ul>
<h2>Some ranting on Opscode's platform</h2>
<p>knife doesn't even know about users, as the chef server code on that platform makes the distinction between users (who can upload cookbooks, roles, etc ...) and API clients (nodes trying to get their run lists and values stored in data bags). The <a class="vt-p" href="https://raw.github.com/jtimberman/knife-scripts/master/chef_server_backup.rb">chef backup script provided by jtimberman</a> only exports roles and nodes, and even after massaging it it to dump clients as well, the public_key field is empty - as if the platform's server removed it on purpose)</p>
<p>i didn't find any documentation about the differences in the REST API between the hosted platform and the open source chef server. I suppose that the API is here but not exposed in the gem ... i'll look into that later.</p>
<p>With opscode not allowing to export the public_key of the client, meaning there is no way you can easily script that process, you have to go through the very tedious task of copy and paste every user's public key and change your new users' document with their respective public key ...</p>
<h2>Solution</h2>
<ul>
<li>quickly hack a chef-client.rb that would allow a client (knife or chef-client to connect using an existing API client <strong>that you will not modify during this process </strong>- doing so would be a nice way to shoot yourself in the foot <img src="http://arzur.net/wp-includes/images/smilies/icon_razz.gif" alt=":-P" class="wp-smiley" /> </li>
<li>display the user on opscode's platform : <code>https://manage.opscode.com/users/</code></li>
<li>copy the public key</li>
<li>on a console, connected to the chef server (we're going to use <code>Chef::ApiClient.cdb_load</code> and <code>Chef::ApiClient.cdb_save</code> methods, which bypass Chef's REST API, and need the same access as the chef server ...)</li>
</ul>
<pre>earzur@chef-server [16:30:51]
 /etc/chef $ irb
 irb(main):001:0&gt; require 'rubygems'
 =&gt; true
 irb(main):002:0&gt; require 'chef'
 =&gt; true</pre>
<pre>&lt;...&gt;
 irb(main):004:0&gt; Chef::Config.from_file('chef-client.rb')
 =&gt; "none"</pre>
<pre>&lt;...&gt;</pre>
<pre>irb(main):007:0&gt; u = Chef::ApiClient.cdb_load('earzur')
 =&gt; #&lt;Chef::ApiClient:0x7f0f498a5188 @couchdb=#&lt;Chef::CouchDB:0x7f0f498aaef8 @rest=#&lt;Chef::REST:0x7f0f498aaea8 @redirects_followed=0, @auth_credentials=#&lt;Chef::REST::AuthCredentials:0x7f0f498aadb8 @key_file=nil, @client_name=nil&gt;, @cookies={}, @sign_request=true, @default_headers={}, @disable_gzip=false, @url="http://localhost:5984", @sign_on_redirect=true, @redirect_limit=10&gt;, @db="chef"&gt;, @admin=true, @couchdb_id="f0f19583-00a9-4b60-887d-95f410821856", @couchdb_rev="3-f3ce3f9e58f6988636168f8bd611db8e", @private_key=nil, @index_id="f0f19583-00a9-4b60-887d-95f410821856", @public_key="-----BEGIN RSA PUBLIC KEY-----\n....DAQAB\n-----END RSA PUBLIC KEY-----", @name="earzur"&gt;

 irb(main):008:0&gt; u.public_key("-----BEGIN RSA PUBLIC KEY-----\n...\n-----END RSA PUBLIC KEY-----")
 =&gt; "-----BEGIN RSA PUBLIC KEY-----\n...-----END RSA PUBLIC KEY-----\n"

 irb(main):010:0&gt; u.cdb_save
 ~ Qrack::Queue#publish will be removed in Bunny 0.8. Use direct_exchange = bunny.exchange(''); direct_exchange.publish('message', key: queue.name) if you want to publish directly to one given queue. For more informations see https://github.com/ruby-amqp/bunny/issues/15 and for more theoretical explanation check http://bit.ly/nOF1CK
 =&gt; "4-ed15fba63937223e6690765809ef0e2c"</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>done ... now repeat that for the other clients and they should be able to access both servers with the same certificates ... this doesn't scale well, but i'm not going to have to distribute another sets of certificates for this chef development server !</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:19iqbmpEtHqeCEnCtcbzzjSXYaDKTep2gm"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=19iqbmpEtHqeCEnCtcbzzjSXYaDKTep2gm" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:19iqbmpEtHqeCEnCtcbzzjSXYaDKTep2gm">19iqbmpEtHqeCEnCtcbzzjSXYaDKTep2gm</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Filed under: <a href="http://arzur.net/category/sysadmin/chef/?lang=en_us" title="View all posts in chef" rel="category tag">chef</a>, <a href="http://arzur.net/category/notebook/?lang=en_us" title="View all posts in notebook" rel="category tag">notebook</a>, <a href="http://arzur.net/category/sysadmin/?lang=en_us" title="View all posts in sysadmin" rel="category tag">sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2012/12/20/notebook-importing-existing-users-from-chef/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-219 post type-post status-publish format-standard hentry category-chef category-sysadmin" id="post-219">
<div class="comm_date"><span class="data"><span class="j"> 2</span>Oct/12</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2012/10/02/notebook-chef-interactive-testing-using-irb/#comments">Off</a></span></div>
<h2><a title="Notebook: chef interactive testing using irb" href="http://arzur.net/2012/10/02/notebook-chef-interactive-testing-using-irb/" rel="bookmark">Notebook: chef interactive testing using irb</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2012/10/02/notebook-chef-interactive-testing-using-irb/">Tweet</a></div>
<p>I'm using this trick a lot to check what are the values of attributes in chef nodes without having to navigate through the UI. You can do everything in the UI or whatnot (change attributes, save them ...). I usually do that from the top of my chef repository, but you can specify any valid path to a proper knife or chef-client configuration when calling <code>Chef::Config.from_file</code> ...</p>
<p>Quite handy:</p>
<p><code lang="ruby"><br />
[10:46:11]-erwan@ip-192-168-0-59:~/dev/chef-repo(master) > irb<br />
1.9.2p320 :001 ><br />
1.9.2p320 :001 > require 'rubygems'<br />
false<br />
1.9.2p320 :002 > require 'awesome_print'<br />
false<br />
1.9.2p320 :003 > require 'chef'<br />
true<br />
1.9.2p320 :004 > Chef::Config.from_file(".chef/knife.rb")<br />
"none"<br />
1.9.2p320 :015 > n = Chef::Node.load('build')<br />
node[build]<br />
1.9.2p320 :016 > n.ohai_time<br />
1335465628.75024<br />
1.9.2p320 :017 > n.ntp<br />
#<Chef::Node::Attribute @normal={...}, @current_normal=nil, @default={...}, @current_default={"is_server"=>false, "service"=>"ntpd", "servers"=>["0.us.pool.ntp.org", "1.us.pool.ntp.org", "0.pool.ntp.org", "1.pool.ntp.org", "2.pool.ntp.org"]}, @override={...}, @current_override={"servers"=>["0.pool.ntp.org", "1.pool.ntp.org", "2.pool.ntp.org"]}, @automatic={...}, @current_automatic=nil, @current_nesting_level=[:ntp], @auto_vivifiy_on_read=false, @set_unless_value_present=false, @set_type=nil, @has_been_read=false><br />
1.9.2p320 :019 > n['ntp']['servers']<br />
[<br />
    [0] "0.pool.ntp.org",<br />
    [1] "1.pool.ntp.org",<br />
    [2] "2.pool.ntp.org"<br />
]<br />
</code></p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:1FkKo3gg5ni3Y9GzkhurGBoCn8XFRrqi9h"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=1FkKo3gg5ni3Y9GzkhurGBoCn8XFRrqi9h" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:1FkKo3gg5ni3Y9GzkhurGBoCn8XFRrqi9h">1FkKo3gg5ni3Y9GzkhurGBoCn8XFRrqi9h</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Filed under: <a href="http://arzur.net/category/sysadmin/chef/?lang=en_us" title="View all posts in chef" rel="category tag">chef</a>, <a href="http://arzur.net/category/sysadmin/?lang=en_us" title="View all posts in sysadmin" rel="category tag">sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2012/10/02/notebook-chef-interactive-testing-using-irb/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-212 post type-post status-publish format-standard hentry category-notebook" id="post-212">
<div class="comm_date"><span class="data"><span class="j">29</span>Dec/11</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2011/12/29/notebook-batch-m4a-to-flac-conversion-using-findxargsffmpeg/#comments">Off</a></span></div>
<h2><a title="Notebook: batch m4a to flac conversion using find/xargs/ffmpeg" href="http://arzur.net/2011/12/29/notebook-batch-m4a-to-flac-conversion-using-findxargsffmpeg/" rel="bookmark">Notebook: batch m4a to flac conversion using find/xargs/ffmpeg</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2011/12/29/notebook-batch-m4a-to-flac-conversion-using-findxargsffmpeg/">Tweet</a></div>
<p>If you have a large collection of files in a certain format and need to convert it to another, it can be quite tricky to do so and retain every tag information and all (i didn't find any tool that would allow me to do that, even the excellent xACT doesn't)</p>
<p>So ...</p>
<p>you will need to have ffmpeg installed. I just used <code>sudo port install ffmpeg</code> on my mac.</p>
<p>First you need to write a little shell script. I've called it toflac.sh. This script will perform the conversion :</p>
<p><code lang="shell">#!/bin/sh</p>
<p>ffmpeg -i "$1" -f flac "${1%.m4a}.flac"<br />
</code><br />
(change the extensions appropriately to fit your needs)</p>
<p>then call it using the following command line:</p>
<p><code lang="shell">find . -name *.m4a -print0 | xargs -0 -P 4 -n 1 ./toflac.sh </code></p>
<p>this runs 4 parallel ffmpeg processes to convert your files. Quite handy.</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:18fd5VWQawAJEBH8Gcf2k3EJK697hLAnfw"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=18fd5VWQawAJEBH8Gcf2k3EJK697hLAnfw" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:18fd5VWQawAJEBH8Gcf2k3EJK697hLAnfw">18fd5VWQawAJEBH8Gcf2k3EJK697hLAnfw</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Filed under: <a href="http://arzur.net/category/notebook/?lang=en_us" title="View all posts in notebook" rel="category tag">notebook</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2011/12/29/notebook-batch-m4a-to-flac-conversion-using-findxargsffmpeg/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-169 post type-post status-publish format-standard hentry category-apple category-sysadmin tag-apple tag-battery tag-sysadmin" id="post-169">
<div class="comm_date"><span class="data"><span class="j">31</span>Oct/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/10/31/notebook-powerbook-battery-calibation/#comments">Off</a></span></div>
<h2><a title="Notebook: MacBook &#8211; Battery calibation" href="http://arzur.net/2010/10/31/notebook-powerbook-battery-calibation/" rel="bookmark">Notebook: MacBook &#8211; Battery calibation</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/10/31/notebook-powerbook-battery-calibation/">Tweet</a></div>
<p>A few weeks ago, my apr'09 13" MacBook started behaving strangely. After a few minutes off the power cord, it would simply shutdown without warning (no display of the low battery warning message ... blam ! Black screen of death). The led battery indicators would show the battery to be at 80%, and if you started the laptop again, it would work for 5-10 minutes ... then blam ! </p>
<p>I've looked for solutions to this issue for a while, this behaviour didn't match apple's documents about battery calibration / PMU reset in their knowledge base, i've tried following every steps documented there (links provided below) to no avail.</p>
<p><a href="http://support.apple.com/kb/ht3964">resetting the SMC</a><br />
<a href="http://support.apple.com/kb/ht1379">resetting the PRAM and NVRAM</a></p>
<p>I finally managed to get back to a properly running mac after following those instructions (<a href="http://support.apple.com/kb/HT1490">Battery calibration</a>) to the letter.</p>
<p>When the system would shutdown improperly, i would just start it up again until next time, and did this for 2 hours (about 6 or 7 power off / power on cycles) until the battery was completely depleted. </p>
<p>Then, i performed a full charge, allowing the system to rest for a few hours while on battery, powered it on, removed the battery adapter with my fingers crossed ... and ... I got my macbook back ! <img src="http://arzur.net/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" />  Woooot <img src="http://arzur.net/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" /> </p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:16nYGedpQvLs7eEDPb1spySJWZf3Pukmxe"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=16nYGedpQvLs7eEDPb1spySJWZf3Pukmxe" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:16nYGedpQvLs7eEDPb1spySJWZf3Pukmxe">16nYGedpQvLs7eEDPb1spySJWZf3Pukmxe</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/apple/" rel="tag">apple</a>, <a href="http://arzur.net/tag/battery/" rel="tag">battery</a>, <a href="http://arzur.net/tag/sysadmin/" rel="tag">sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/10/31/notebook-powerbook-battery-calibation/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-162 post type-post status-publish format-standard hentry category-chef category-non-classe category-notebook category-sysadmin tag-chef tag-sysadmin" id="post-162">
<div class="comm_date"><span class="data"><span class="j">31</span>Oct/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/10/31/scripting-with-chef/#comments">Off</a></span></div>
<h2><a title="scripting with chef" href="http://arzur.net/2010/10/31/scripting-with-chef/" rel="bookmark">scripting with chef</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/10/31/scripting-with-chef/">Tweet</a></div>
<p><a href="http://opscode.com/chef">Chef</a> is a very cool platform management solution. Once it is setup, you have a very clean solution to distribute server configurations across as many servers as you need, very cleanly (Ruby DSL) and quickly. A must on AWS.</p>
<p>One thing that you can't find easily in Chef's documentation is how to use the chef API to write scripts that would use the information chef is storing. </p>
<p>Imagine having a script that would run regularly (cron) and update your internal DNS zone with A records for each server it can find in your chef database.</p>
<p>I'm not sure I used the "right" approach. I just pasted some code i borrowed from knife (chef's command-line tool) and added it to my own script. I intend to find a cleaner approach later (mixins, inheritance, etc ...)</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="ruby" style="font-family:monospace;"><span style="color:#008000; font-style:italic;">#!/usr/bin/env ruby</span>
<span style="color:#CC0066; font-weight:bold;">require</span> <span style="color:#996600;">'rubygems'</span>
<span style="color:#CC0066; font-weight:bold;">require</span> <span style="color:#996600;">'chef/application'</span>
<span style="color:#CC0066; font-weight:bold;">require</span> <span style="color:#996600;">'chef/client'</span>
&nbsp;
<span style="color:#CC0066; font-weight:bold;">require</span> <span style="color:#996600;">'mixlib/cli'</span>
&nbsp;
<span style="color:#9966CC; font-weight:bold;">class</span> Client <span style="color:#006600; font-weight:bold;">&lt;</span> <span style="color:#6666ff; font-weight:bold;">Chef::Application</span>
  <span style="color:#9966CC; font-weight:bold;">include</span> <span style="color:#6666ff; font-weight:bold;">Mixlib::CLI</span>
&nbsp;
  banner <span style="color:#996600;">&quot;Usage: #{$0} (options)&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:config_file</span>, 
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-c CONFIG&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--config CONFIG&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;The configuration file to use&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:log_level</span>, 
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-l LEVEL&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--log_level LEVEL&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Set the log level (debug, info, warn, error, fatal)&quot;</span>,
    :<span style="color:#CC0066; font-weight:bold;">proc</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#CC0066; font-weight:bold;">lambda</span> <span style="color:#006600; font-weight:bold;">&#123;</span> <span style="color:#006600; font-weight:bold;">|</span>l<span style="color:#006600; font-weight:bold;">|</span> l.<span style="color:#9900CC;">to_sym</span> <span style="color:#006600; font-weight:bold;">&#125;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:log_location</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-L LOGLOCATION&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--logfile LOGLOCATION&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Set the log file location, defaults to STDOUT&quot;</span>,
    :<span style="color:#CC0066; font-weight:bold;">proc</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#0000FF; font-weight:bold;">nil</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:editor</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-e EDITOR&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--editor EDITOR&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Set the editor to use for interactive commands&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:default</span>      <span style="color:#006600; font-weight:bold;">=&gt;</span> ENV<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#996600;">'EDITOR'</span><span style="color:#006600; font-weight:bold;">&#93;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:no_editor</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-n&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--no-editor&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Do not open EDITOR, just accept the data as is&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:boolean</span>      <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#0000FF; font-weight:bold;">true</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:help</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-h&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--help&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Show this message&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:on</span>           <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#ff3333; font-weight:bold;">:tail</span>,
    <span style="color:#ff3333; font-weight:bold;">:boolean</span>      <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#0000FF; font-weight:bold;">true</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:node_name</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-u USER&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--user USER&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;API Client Username&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:client_key</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-k KEY&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--key KEY&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;API Client Key&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:chef_server_url</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-s URL&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--server-url URL&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Chef Server URL&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:yes</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-y&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--yes&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Say yes to all prompts for confirmation&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:defaults</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--defaults&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Accept default values for all questions&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:print_after</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-p&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--print-after&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Show the data after a destructive operation&quot;</span>
&nbsp;
  option :<span style="color:#CC0066; font-weight:bold;">format</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-F FORMAT&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--format FORMAT&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Which format to use for output&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:default</span> <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;json&quot;</span>
&nbsp;
  option <span style="color:#ff3333; font-weight:bold;">:version</span>,
    <span style="color:#ff3333; font-weight:bold;">:short</span>        <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;-v&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:long</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;--version&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:description</span>  <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#996600;">&quot;Show chef version&quot;</span>,
    <span style="color:#ff3333; font-weight:bold;">:boolean</span>      <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#0000FF; font-weight:bold;">true</span>,
    :<span style="color:#CC0066; font-weight:bold;">proc</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#CC0066; font-weight:bold;">lambda</span> <span style="color:#006600; font-weight:bold;">&#123;</span><span style="color:#006600; font-weight:bold;">|</span>v<span style="color:#006600; font-weight:bold;">|</span> <span style="color:#CC0066; font-weight:bold;">puts</span> <span style="color:#996600;">&quot;Chef: #{::Chef::VERSION}&quot;</span><span style="color:#006600; font-weight:bold;">&#125;</span>,
    :<span style="color:#CC0066; font-weight:bold;">exit</span>         <span style="color:#006600; font-weight:bold;">=&gt;</span> <span style="color:#006666;">0</span>
&nbsp;
  <span style="color:#9966CC; font-weight:bold;">def</span> configure_chef
    <span style="color:#9966CC; font-weight:bold;">unless</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span>
      full_path = <span style="color:#CC00FF; font-weight:bold;">Dir</span>.<span style="color:#9900CC;">pwd</span>.<span style="color:#CC0066; font-weight:bold;">split</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#CC00FF; font-weight:bold;">File</span>::SEPARATOR<span style="color:#006600; font-weight:bold;">&#41;</span>
      <span style="color:#006600; font-weight:bold;">&#40;</span>full_path.<span style="color:#9900CC;">length</span> <span style="color:#006600; font-weight:bold;">-</span> <span style="color:#006666;">1</span><span style="color:#006600; font-weight:bold;">&#41;</span>.<span style="color:#9900CC;">downto</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#006666;">0</span><span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color:#9966CC; font-weight:bold;">do</span> <span style="color:#006600; font-weight:bold;">|</span>i<span style="color:#006600; font-weight:bold;">|</span>
        config_file_to_check = <span style="color:#CC00FF; font-weight:bold;">File</span>.<span style="color:#9900CC;">join</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#006600; font-weight:bold;">&#91;</span> full_path<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#006666;">0</span>..<span style="color:#9900CC;">i</span><span style="color:#006600; font-weight:bold;">&#93;</span>, <span style="color:#996600;">&quot;.chef&quot;</span>, <span style="color:#996600;">&quot;client.rb&quot;</span> <span style="color:#006600; font-weight:bold;">&#93;</span>.<span style="color:#9900CC;">flatten</span><span style="color:#006600; font-weight:bold;">&#41;</span>
        <span style="color:#9966CC; font-weight:bold;">if</span> <span style="color:#CC00FF; font-weight:bold;">File</span>.<span style="color:#9900CC;">exists</span>?<span style="color:#006600; font-weight:bold;">&#40;</span>config_file_to_check<span style="color:#006600; font-weight:bold;">&#41;</span>
          config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config_file_to_check 
          <span style="color:#9966CC; font-weight:bold;">break</span>
        <span style="color:#9966CC; font-weight:bold;">end</span>
      <span style="color:#9966CC; font-weight:bold;">end</span>
      <span style="color:#008000; font-style:italic;"># If we haven't set a config yet and $HOME is set, and the home</span>
      <span style="color:#008000; font-style:italic;"># knife.rb exists, use it:</span>
      <span style="color:#9966CC; font-weight:bold;">if</span> <span style="color:#006600; font-weight:bold;">&#40;</span>!config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span><span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color:#006600; font-weight:bold;">&amp;&amp;</span> ENV<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#996600;">'HOME'</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#006600; font-weight:bold;">&amp;&amp;</span> <span style="color:#CC00FF; font-weight:bold;">File</span>.<span style="color:#9900CC;">exist</span>?<span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#CC00FF; font-weight:bold;">File</span>.<span style="color:#9900CC;">join</span><span style="color:#006600; font-weight:bold;">&#40;</span>ENV<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#996600;">'HOME'</span><span style="color:#006600; font-weight:bold;">&#93;</span>, <span style="color:#996600;">'.chef'</span>, <span style="color:#996600;">'client.rb'</span><span style="color:#006600; font-weight:bold;">&#41;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
        config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span> = <span style="color:#CC00FF; font-weight:bold;">File</span>.<span style="color:#9900CC;">join</span><span style="color:#006600; font-weight:bold;">&#40;</span>ENV<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#996600;">'HOME'</span><span style="color:#006600; font-weight:bold;">&#93;</span>, <span style="color:#996600;">'.chef'</span>, <span style="color:#996600;">'client.rb'</span><span style="color:#006600; font-weight:bold;">&#41;</span>
      <span style="color:#9966CC; font-weight:bold;">end</span>
    <span style="color:#9966CC; font-weight:bold;">end</span>
&nbsp;
    <span style="color:#008000; font-style:italic;"># Don't try to load a knife.rb if it doesn't exist.</span>
    <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span>
      <span style="color:#6666ff; font-weight:bold;">Chef::Config</span>.<span style="color:#9900CC;">from_file</span><span style="color:#006600; font-weight:bold;">&#40;</span>config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:config_file</span><span style="color:#006600; font-weight:bold;">&#93;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
    <span style="color:#9966CC; font-weight:bold;">else</span>
      <span style="color:#008000; font-style:italic;"># ...but do log a message if no config was found.</span>
      <span style="color:#0000FF; font-weight:bold;">self</span>.<span style="color:#9900CC;">msg</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#996600;">&quot;No knife configuration file found&quot;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
    <span style="color:#9966CC; font-weight:bold;">end</span>
&nbsp;
    <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_level</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_level</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_level</span><span style="color:#006600; font-weight:bold;">&#93;</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_location</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_location</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_location</span><span style="color:#006600; font-weight:bold;">&#93;</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:node_name</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:node_name</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:node_name</span><span style="color:#006600; font-weight:bold;">&#93;</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:client_key</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:client_key</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:client_key</span><span style="color:#006600; font-weight:bold;">&#93;</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:chef_server_url</span><span style="color:#006600; font-weight:bold;">&#93;</span> = config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:chef_server_url</span><span style="color:#006600; font-weight:bold;">&#93;</span> <span style="color:#9966CC; font-weight:bold;">if</span> config<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:chef_server_url</span><span style="color:#006600; font-weight:bold;">&#93;</span>
    <span style="color:#6666ff; font-weight:bold;">Mixlib::Log::Formatter</span>.<span style="color:#9900CC;">show_time</span> = <span style="color:#0000FF; font-weight:bold;">false</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Log</span>.<span style="color:#9900CC;">init</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_location</span><span style="color:#006600; font-weight:bold;">&#93;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
    <span style="color:#6666ff; font-weight:bold;">Chef::Log</span>.<span style="color:#9900CC;">level</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:log_level</span><span style="color:#006600; font-weight:bold;">&#93;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
&nbsp;
    <span style="color:#6666ff; font-weight:bold;">Chef::Log</span>.<span style="color:#9900CC;">debug</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#996600;">&quot;Using configuration from #{config[:config_file]}&quot;</span><span style="color:#006600; font-weight:bold;">&#41;</span>
&nbsp;
    <span style="color:#9966CC; font-weight:bold;">if</span> <span style="color:#6666ff; font-weight:bold;">Chef::Config</span><span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#ff3333; font-weight:bold;">:node_name</span><span style="color:#006600; font-weight:bold;">&#93;</span>.<span style="color:#0000FF; font-weight:bold;">nil</span>?
      <span style="color:#CC0066; font-weight:bold;">raise</span> <span style="color:#CC00FF; font-weight:bold;">ArgumentError</span>, <span style="color:#996600;">&quot;No user specified, pass via -u or specifiy 'node_name' in #{config[:config_file] ? config[:config_file] : &quot;</span>~<span style="color:#006600; font-weight:bold;">/</span>.<span style="color:#9900CC;">chef</span><span style="color:#006600; font-weight:bold;">/</span>knife.<span style="color:#9900CC;">rb</span><span style="color:#996600;">&quot;}&quot;</span>
    <span style="color:#9966CC; font-weight:bold;">end</span>
  <span style="color:#9966CC; font-weight:bold;">end</span>
&nbsp;
&nbsp;
  <span style="color:#9966CC; font-weight:bold;">def</span> parse_options<span style="color:#006600; font-weight:bold;">&#40;</span>args=<span style="color:#006600; font-weight:bold;">&#91;</span><span style="color:#006600; font-weight:bold;">&#93;</span><span style="color:#006600; font-weight:bold;">&#41;</span> 
    <span style="color:#9966CC; font-weight:bold;">super</span>
    config    
  <span style="color:#9966CC; font-weight:bold;">end</span>
&nbsp;
  <span style="color:#9966CC; font-weight:bold;">def</span> run<span style="color:#006600; font-weight:bold;">&#40;</span>args<span style="color:#006600; font-weight:bold;">&#41;</span>
    parse_options<span style="color:#006600; font-weight:bold;">&#40;</span>args<span style="color:#006600; font-weight:bold;">&#41;</span>
    configure_chef
    <span style="color:#6666ff; font-weight:bold;">Chef::Search::Query</span>.<span style="color:#9900CC;">new</span>.<span style="color:#9900CC;">search</span><span style="color:#006600; font-weight:bold;">&#40;</span><span style="color:#ff3333; font-weight:bold;">:node</span>,<span style="color:#996600;">&quot;*:*&quot;</span><span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color:#9966CC; font-weight:bold;">do</span> <span style="color:#006600; font-weight:bold;">|</span>n<span style="color:#006600; font-weight:bold;">|</span>
       <span style="color:#008000; font-style:italic;">## iterate on every node. You have access to every information</span>
       <span style="color:#008000; font-style:italic;">## chef and ohai could collect from the nodes</span>
    <span style="color:#9966CC; font-weight:bold;">end</span>
  <span style="color:#9966CC; font-weight:bold;">end</span>
<span style="color:#9966CC; font-weight:bold;">end</span>
&nbsp;
Client.<span style="color:#9900CC;">new</span>.<span style="color:#9900CC;">run</span></pre></td></tr></table></div>

<p>The command line options for your script are the same as knife's. And it works flawlessly.</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:1LqxrtqyP7ctSMFrp8MUxpg46xQAz9oXNm"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=1LqxrtqyP7ctSMFrp8MUxpg46xQAz9oXNm" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:1LqxrtqyP7ctSMFrp8MUxpg46xQAz9oXNm">1LqxrtqyP7ctSMFrp8MUxpg46xQAz9oXNm</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/chef/" rel="tag">chef</a>, <a href="http://arzur.net/tag/sysadmin/" rel="tag">sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/10/31/scripting-with-chef/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-156 post type-post status-publish format-standard hentry category-notebook category-sysadmin tag-notebook tag-shell tag-unix" id="post-156">
<div class="comm_date"><span class="data"><span class="j">12</span>Oct/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/10/12/notebook-running-a-unix-command-for-a-given-amount-of-time/#comments">Off</a></span></div>
<h2><a title="notebook: running a unix command for a given amount of time" href="http://arzur.net/2010/10/12/notebook-running-a-unix-command-for-a-given-amount-of-time/" rel="bookmark">notebook: running a unix command for a given amount of time</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/10/12/notebook-running-a-unix-command-for-a-given-amount-of-time/">Tweet</a></div>
<p>Sometimes, you need to run a command (capture, etc ...) for a given amount of time. Here's an example of a script capturing mysql traffic for half an hour :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#!/bin/sh</span>
<span style="color: #007800;">DATE</span>=<span style="color: #000000; font-weight: bold;">`</span><span style="color: #c20cb9; font-weight: bold;">date</span> +<span style="color: #000000; font-weight: bold;">%</span>Y<span style="color: #000000; font-weight: bold;">%</span>m<span style="color: #000000; font-weight: bold;">%</span>d<span style="color: #000000; font-weight: bold;">%</span>H<span style="color: #000000; font-weight: bold;">%</span>M<span style="color: #000000; font-weight: bold;">%</span>S<span style="color: #000000; font-weight: bold;">`</span>
tcpdump <span style="color: #660033;">-i</span> eth0 port <span style="color: #000000;">3306</span>  <span style="color: #660033;">-s</span> <span style="color: #000000;">65535</span> <span style="color: #660033;">-x</span> <span style="color: #660033;">-n</span> <span style="color: #660033;">-q</span> <span style="color: #660033;">-tttt</span> <span style="color: #000000; font-weight: bold;">&gt;</span> capture-<span style="color: #007800;">$DATE</span>.out <span style="color: #000000; font-weight: bold;">&amp;</span>
<span style="color: #c20cb9; font-weight: bold;">sleep</span> <span style="color: #000000;">1800</span> 
<span style="color: #c20cb9; font-weight: bold;">kill</span> <span style="color: #007800;">$!</span></pre></td></tr></table></div>

<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:114BqQf493ntTXdPBmQgZbM4GJ8VCp4JTV"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=114BqQf493ntTXdPBmQgZbM4GJ8VCp4JTV" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:114BqQf493ntTXdPBmQgZbM4GJ8VCp4JTV">114BqQf493ntTXdPBmQgZbM4GJ8VCp4JTV</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/notebook/" rel="tag">notebook</a>, <a href="http://arzur.net/tag/shell/" rel="tag">shell</a>, <a href="http://arzur.net/tag/unix/" rel="tag">unix</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/10/12/notebook-running-a-unix-command-for-a-given-amount-of-time/#comments">1 Comment</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-151 post type-post status-publish format-standard hentry category-notebook category-sysadmin tag-nagios-linux-sysadmin" id="post-151">
<div class="comm_date"><span class="data"><span class="j">10</span>Oct/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/10/10/notebook-nagios-ndo2db-on-centos-5-5-64-bits/#comments">Off</a></span></div>
<h2><a title="notebook: nagios / ndo2db on centOS 5.5 64 bits" href="http://arzur.net/2010/10/10/notebook-nagios-ndo2db-on-centos-5-5-64-bits/" rel="bookmark">notebook: nagios / ndo2db on centOS 5.5 64 bits</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/10/10/notebook-nagios-ndo2db-on-centos-5-5-64-bits/">Tweet</a></div>
<p>Trying to setup nagios 3.1 with ndo2db on a 64bits platform, ndo2bd may not work properly and crash over and over.</p>
<p>The symptoms are:</p>
<pre>
[1286679019] ndomod: Still unable to connect to data sink.  7575 items lost, 5000 queued items to flush.
</pre>
<p>in the nagios log file<br />
and <code>/var/log/messages</code> containing reports of ndo2db segfaults ...</p>
<pre>
Oct 10 12:52:26 ip-10-112-41-174 kernel: ndo2db[15666]: segfault at 00007fff8701cff8 rip 00002aaaabf2d211 rsp 00007fff8701d000 error 6
</pre>
<p>Apparently, this comes from <code>ndo2db</code> being improperly linked to a 32bits version of the mysql client lib.</p>
<p>You need to configure ndo2db like this :</p>
<pre>
./configure --prefix=/opt/nagios --enable-mysql --disable-pgsql --with-ndo2db-user=nagios --with-ndo2db-group=nagios --with-mysql-lib=/usr/lib/mysql
</pre>
<p>then you can go on and install ndo2db as documented, nagios will happily log events into you supervision database</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:1MAnPE9WXyRa4Yx8MeRw8aCTg5mKuAcGGt"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=1MAnPE9WXyRa4Yx8MeRw8aCTg5mKuAcGGt" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:1MAnPE9WXyRa4Yx8MeRw8aCTg5mKuAcGGt">1MAnPE9WXyRa4Yx8MeRw8aCTg5mKuAcGGt</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/nagios-linux-sysadmin/" rel="tag">nagios linux sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/10/10/notebook-nagios-ndo2db-on-centos-5-5-64-bits/#comments">1 Comment</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-136 post type-post status-publish format-standard hentry category-aws category-groovy category-sysadmin tag-groovy-aws-development" id="post-136">
<div class="comm_date"><span class="data"><span class="j"> 4</span>Oct/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/10/04/some-fun-with-groovy-and-aws-identity-and-access-management/#comments">Off</a></span></div>
<h2><a title="Some fun with groovy and AWS Identity And Access Management" href="http://arzur.net/2010/10/04/some-fun-with-groovy-and-aws-identity-and-access-management/" rel="bookmark">Some fun with groovy and AWS Identity And Access Management</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/10/04/some-fun-with-groovy-and-aws-identity-and-access-management/">Tweet</a></div>
<p>I'm currently playing with the all new AWS identity and access management, and wanted to share some groovy magic to play with users and groups ...</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="groovy" style="font-family:monospace;">@Grapes<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#91;</span>
  @Grab<span style="color: #66cc66;">&#40;</span>group<span style="color: #66cc66;">=</span><span style="color: #ff0000;">'com.amazonaws'</span>, module<span style="color: #66cc66;">=</span><span style="color: #ff0000;">'aws-java-sdk'</span>, version<span style="color: #66cc66;">=</span><span style="color: #ff0000;">'1.0.11'</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #a1a100;">com.amazonaws.auth.BasicAWSCredentials</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #a1a100;">com.amazonaws.services.identitymanagement.AmazonIdentityManagementClient</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #a1a100;">com.amazonaws.services.identitymanagement.model.*</span>
&nbsp;
AWS_ACCESS_KEY<span style="color: #66cc66;">=</span><span style="color: #ff0000;">'MY AWESOME KEY'</span>
AWS_SECRET_KEY<span style="color: #66cc66;">=</span><span style="color: #ff0000;">'MY EVEN MORE AWESOME KEY'</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">def</span> cred <span style="color: #66cc66;">=</span> <span style="color: #000000; font-weight: bold;">new</span> BasicAWSCredentials<span style="color: #66cc66;">&#40;</span>AWS_ACCESS_KEY,AWS_SECRET_KEY<span style="color: #66cc66;">&#41;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">def</span> ami <span style="color: #66cc66;">=</span> <span style="color: #000000; font-weight: bold;">new</span> AmazonIdentityManagementClient<span style="color: #66cc66;">&#40;</span>cred<span style="color: #66cc66;">&#41;</span>
&nbsp;
<span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;Group 'Administrators' ?&quot;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">def</span> admins <span style="color: #66cc66;">=</span> <span style="color: #000000; font-weight: bold;">null</span>
<span style="color: #000000; font-weight: bold;">try</span> <span style="color: #66cc66;">&#123;</span>
 admins <span style="color: #66cc66;">=</span> ami.<span style="color: #006600;">getGroup</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> GetGroupRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withGroupName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Administrators'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">?</span>.<span style="color: #006600;">group</span>
<span style="color: #66cc66;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #66cc66;">&#40;</span>NoSuchEntityException e<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
  <span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;Didn't find group 'Administrators' : creating it ...&quot;</span>
  admins <span style="color: #66cc66;">=</span> ami.<span style="color: #006600;">createGroup</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> CreateGroupRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withGroupName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Administrators'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">group</span>
<span style="color: #66cc66;">&#125;</span>
<span style="color: #993399;">println</span> admins
&nbsp;
<span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;User 'erwan' ?&quot;</span>
<span style="color: #000000; font-weight: bold;">def</span> erwan <span style="color: #66cc66;">=</span> <span style="color: #000000; font-weight: bold;">null</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">try</span> <span style="color: #66cc66;">&#123;</span>
  erwan <span style="color: #66cc66;">=</span> ami.<span style="color: #006600;">getUser</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> GetUserRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withUserName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'erwan'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">?</span>.<span style="color: #006600;">user</span>
<span style="color: #66cc66;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #66cc66;">&#40;</span>NoSuchEntityException e<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
  <span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;Didn't find user 'erwan' : creating it ...&quot;</span>
  erwan <span style="color: #66cc66;">=</span> ami.<span style="color: #006600;">createUser</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> CreateUserRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withUserName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'erwan'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">user</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993399;">println</span> erwan
&nbsp;
<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>erwan<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
  <span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;Listing erwan's groups ...&quot;</span>
  java.<span style="color: #006600;">util</span>.<span style="color: #aaaadd; font-weight: bold;">List</span> groups <span style="color: #66cc66;">=</span> ami.<span style="color: #006600;">listGroupsForUser</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> ListGroupsForUserRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withUserName</span><span style="color: #66cc66;">&#40;</span>erwan.<span style="color: #006600;">userName</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">getGroups</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #663399;">collect</span> <span style="color: #66cc66;">&#123;</span>
    it.<span style="color: #006600;">groupName</span>
  <span style="color: #66cc66;">&#125;</span>
  <span style="color: #993399;">println</span> groups
&nbsp;
  <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">!</span>groups.<span style="color: #CC0099;">contains</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Administrators'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
    <span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;Adding user 'erwan' to 'Administrators'&quot;</span>
    ami.<span style="color: #006600;">addUserToGroup</span> <span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> AddUserToGroupRequest<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withUserName</span><span style="color: #66cc66;">&#40;</span>erwan.<span style="color: #006600;">userName</span><span style="color: #66cc66;">&#41;</span>.<span style="color: #006600;">withGroupName</span><span style="color: #66cc66;">&#40;</span>admins.<span style="color: #006600;">groupName</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
  <span style="color: #66cc66;">&#125;</span>
  <span style="color: #993399;">println</span> <span style="color: #ff0000;">&quot;done !&quot;</span>
<span style="color: #66cc66;">&#125;</span></pre></td></tr></table></div>

<p>Even with some groove in it, java is still way too verbose to my taste, but i guess, i'll have to live with it ...<br />
And this is the output of the awesome script:</p>
<pre>
Group 'Administrators' ?
4 oct. 2010 19:05:50 com.amazonaws.http.HttpClient execute
INFO: Sending Request: POST https://iam.amazonaws.com / Parameters: (Action: GetGroup, GroupName: Administrators, SignatureMethod: HmacSHA256, AWSAccessKeyId: MY AWESOME KEY, Version: 2010-05-08, SignatureVersion: 2, Timestamp: 2010-10-04T17:05:50.839Z, Signature: 3V3lEJzcqXXXXXXXXXXXXBeyMx9DzwFXA=, )
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient handleResponse
INFO: Received successful response: 200, AWS Request ID: a40b6fd5-cfd9-11df-8b03-8bc9f2ff0492
{Path: /, GroupName: Administrators, GroupId: AGPAJZSRVEMSLHZEOKMI6, Arn: arn:aws:iam::XXXXXXXXXXXXX:group/Administrators, }
User 'erwan' ?
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient execute
INFO: Sending Request: POST https://iam.amazonaws.com / Parameters: (Action: GetUser, SignatureMethod: HmacSHA256, UserName: erwan, AWSAccessKeyId: MY AWESOME KEY, Version: 2010-05-08, SignatureVersion: 2, Timestamp: 2010-10-04T17:05:51.222Z, Signature: XXXXXXXXXXXXXXXXXXXXXXXXXXXX, )
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient handleResponse
INFO: Received successful response: 200, AWS Request ID: a422f04a-cfd9-11df-b738-6709d34e9585
{Path: /, UserName: erwan, UserId: XXXXXXXXXXXXXXXXXXXXXXX, Arn: arn:aws:iam::XXXXXXXXXXXXXX:user/erwan, }
Listing erwan's groups ...
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient execute
INFO: Sending Request: POST https://iam.amazonaws.com / Parameters: (Action: ListGroupsForUser, SignatureMethod: HmacSHA256, UserName: erwan, AWSAccessKeyId: MY AWESOME KEY, Version: 2010-05-08, SignatureVersion: 2, Timestamp: 2010-10-04T17:05:51.388Z, Signature: XXXXXXXXXXXXXXXXXXXXXXXXXXXXX, )
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient handleResponse
INFO: Received successful response: 200, AWS Request ID: a43bf67d-cfd9-11df-a1ef-f7061c8dca90
[]
Adding user 'erwan' to 'Administrators'
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient execute
INFO: Sending Request: POST https://iam.amazonaws.com / Parameters: (Action: AddUserToGroup, GroupName: Administrators, SignatureMethod: HmacSHA256, UserName: erwan, AWSAccessKeyId: MY AWESOME KEY, Version: 2010-05-08, SignatureVersion: 2, Timestamp: 2010-10-04T17:05:51.569Z, Signature: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX )
4 oct. 2010 19:05:51 com.amazonaws.http.HttpClient handleResponse
INFO: Received successful response: 200, AWS Request ID: a457e216-cfd9-11df-a356-3d1e141e353d
done !
</pre>
<p>AWESOME !! \o/</p>
<p>Next, I'll make something useful out of it, like unix's adduser/addgroup script that will create individual developers and admins access keys, play with policies in order to restrict usage based on group appartenance, try to reduce groovy's startup time by preloading the interpreter, etc ...</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:13yKJMGD6MCgMyYRHhsqdqf7greYpNkkBQ"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=13yKJMGD6MCgMyYRHhsqdqf7greYpNkkBQ" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:13yKJMGD6MCgMyYRHhsqdqf7greYpNkkBQ">13yKJMGD6MCgMyYRHhsqdqf7greYpNkkBQ</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/groovy-aws-development/" rel="tag">groovy aws development</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/10/04/some-fun-with-groovy-and-aws-identity-and-access-management/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-114 post type-post status-publish format-standard hentry category-apple category-sysadmin tag-apple tag-backup tag-hack" id="post-114">
<div class="comm_date"><span class="data"><span class="j">31</span>Aug/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/08/31/time-machine-on-a-network-drive-you-will-need-to-increase-the-band-size/#comments">Off</a></span></div>
<h2><a title="Time Machine on a network drive : you will need to increase the band size &#8230;" href="http://arzur.net/2010/08/31/time-machine-on-a-network-drive-you-will-need-to-increase-the-band-size/" rel="bookmark">Time Machine on a network drive : you will need to increase the band size &#8230;</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/08/31/time-machine-on-a-network-drive-you-will-need-to-increase-the-band-size/">Tweet</a></div>
<p>... but not by hiring a new drummer <img src="http://arzur.net/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" /> </p>
<p>My QNAP TS-209 pro's newest firmware introduces direct support for Time Machine. It works out of the box and it is pretty cool, but i quickly realized there will be a problem in the long run: a full backup of my macbook creates about 22 000 bands in the <a href="http://en.wikipedia.org/wiki/Sparse_image">sparse bundle volume</a>, which the poor little QNAP has a lot of trouble reading. I believe Time Capsules and many other appliances with few CPU cycles to spare on reading directories will have troubles too. Maybe someone in Apple could think about adding 1 or 2 levels of directories in the <code>bands</code> of sparse images ? That would make a lot of happy Time Capsule users <img src="http://arzur.net/wp-includes/images/smilies/icon_wink.gif" alt=";-)" class="wp-smiley" /> </p>
<p>Suggestion:</p>
<ul>
<li>bands are named by hexadecimal codes (0..f, then 2 letters when the namespace is exhausted, etc ...), so create one sub-directory per prefix. 0/(every file that starts with 0), ..., f/(every file that starts with f).
</li>
<li>in order to maintain compatibility with existing sparsebundle volumes, add a "<code>directory-prefix-level</code>" key in Info.plist that will be used by the function that returns a band in the bundle to find the band's exact location.
</li>
<li><code>directory-prefix-level</code> should be increased each time the namespace exhausts, and the storage driver should be updated to redistribute files across the new directories when it happens (blocking any access to the volume when it happens). This is a classical problem to solve in a B-TREE (key redistribution in pages)
</li>
</ul>
<p>So, until Apple fixes their sparse bundle driver, the solution is to increase the band sizes, in order to make sure to have less files in the directory. </p>
<p>You need to have an existing backup stored on your NAS. First, I strongly suggest making a copy of the backup's directory if you care about your backups (you care about your backups, don't you ?)</p>
<p>The QNAP Time Machine service creates a share named <code>/share/TMBackup</code>. Once time machine has used it one time (even with a cancelled backup), it will contain a directory named after your mac's hostname (mine is moody)</p>
<p><code>moody.sparsebundle</code></p>
<p>This directory is a plain, standard sparse bundle as those created with <a href="http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/hdiutil.1.html">hdiutil(1)</a>, with the exception of a file named <code>com.apple.TimeMachine.MachineID.plist</code>. This file links the backup to your host (it contains its hostname and MAC address), and Time Machine will not recognize a sparse bundle as one of his if it can't find this file in it. When this happens, TM creates another directory and starts all over: <code>moody 1.sparsebundle</code></p>
<p>Make sure TM won't try to access the drive remotely while you run the procedure. You should disable it altogether by choosing "no drive" in it's preferences pane.</p>
<p>Make sure you have the share mounted, it should be accessible from a terminal. In order to do that, "enter Time Machine", cancel, open a Terminal, sudo and then i was finally able to <code>cd /Volumes/TMBackup</code> (the name of the volume will obviously change depending on your setup)</p>
<p>Create a copy of your sparse bundle. This procedure needs free space, i believe there is no way to convert a sparse bundle in place, if you know how do to that in place, i'd be happy to hear about it <img src="http://arzur.net/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" />  :<br />
<code><br />
hdiutil convert -verbose -tgtimagekey sparse-band-size=262144 -format UDSB moody.sparsebundle -o tmp.moody.sparsebundle<br />
</code></p>
<p><strong>It will take a long time</strong>. Maybe hours for an existing, valid backup. Be warned. You are transferring a lot of data across the network. </p>
<p>Once the command completes, you should have <code>moody.sparsebundle</code> and <code>tmp.moody.sparsebundle</code> in the share directory on the NAS. Copy <code>com.apple.TimeMachine.MachineID.plist</code> to the new location:</p>
<p><code><br />
cp moody.sparsebundle/com.apple.TimeMachine.MachineID.plist tmp.moody.sparsebundle/<br />
</code></p>
<p>Change the new sparse bundle's name to the former one:</p>
<p><code><br />
mv moody.sparsebundle moody.sparsebundle.old<br />
mv tmp.moody.sparsebundle moody.sparsebundle<br />
</code></p>
<p>You should be good to go with TM now. Give it a try ...</p>
<p>Once you have validated TM can access your new bundle and is displaying data from your backup, you can get rid of the old <code>moody.sparsebundle.old</code> directory.</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:17t6ZqZeAj3KA9dWyCsQecAWnwx3rJM8Fd"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=17t6ZqZeAj3KA9dWyCsQecAWnwx3rJM8Fd" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:17t6ZqZeAj3KA9dWyCsQecAWnwx3rJM8Fd">17t6ZqZeAj3KA9dWyCsQecAWnwx3rJM8Fd</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/apple/" rel="tag">apple</a>, <a href="http://arzur.net/tag/backup/" rel="tag">backup</a>, <a href="http://arzur.net/tag/hack/" rel="tag">hack</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/08/31/time-machine-on-a-network-drive-you-will-need-to-increase-the-band-size/#comments">No Comments</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>


<div class="post-100 post type-post status-publish format-standard hentry category-sysadmin tag-monitoring tag-operations tag-sysadmin" id="post-100">
<div class="comm_date"><span class="data"><span class="j"> 8</span>Jun/10</span><span class="nr_comm"><a class="nr_comm_spot" href="http://arzur.net/2010/06/08/monitis-vs-open-source-wtf/#comments">Off</a></span></div>
<h2><a title="Monitis vs Open Source ? WTF ?" href="http://arzur.net/2010/06/08/monitis-vs-open-source-wtf/" rel="bookmark">Monitis vs Open Source ? WTF ?</a></h2>
<div style="float: right; margin-left: 10px;"><a href="https://twitter.com/share" class="twitter-share-button" data-via="zuzur" data-count="horizontal" data-url="http://arzur.net/2010/06/08/monitis-vs-open-source-wtf/">Tweet</a></div>
<p>In a <a href="http://blog.monitis.com/index.php/2010/06/08/new-whitepaper-monitis-cloud-monitoring-versus-open-source-tools/">recently published white paper</a>, Monitis is trying to prove that their cloud-based monitoring solution is far superior to "Open Source Monitoring Software".</p>
<p>What are the arguments that should make you discard any Open Source based monitoring solution ?</p>
<ul>
<li><strong>robust notifications and alerts</strong></li>
<li><strong>quick and easy to setup</strong></li>
<li><strong>low cost of entry and TCO</strong></li>
<li><strong>monitoring from outside the internal network</strong></li>
<li><strong>easily scalable</strong></li>
<li><strong>green</strong></li>
<li><strong>cool</strong></li>
</ul>
<p>So, what do these bullets have to do Open Source versus proprietary exactly ? <strong>absolutely nothing</strong>.</p>
<p>This whitepaper proves that there may be better and more cost-effective options than hosting your own monitoring infrastructure yourself. Well, news at ten ! Wow ! this is absolutely fantastic !</p>
<p>Any seasoned sysadmin should know that a switch can fry or a mail server can go down, letting your monitoring infrastructure without any mean to probe for services health and alert you. That's part of monitoring 101 !</p>
<p>This is not a "OSS or proprietary", "OSS or hosted", "OSS or whatever" decision, this is a <strong>design</strong> decision. They are comparing setting up a full-blown monitoring infrastructure (probes, queues, passive/active, agents, etc ...) against editing probes and alerts in an existing platform. Theirs, more exactly.</p>
<p><strong>Robust notifications and alerts ?</strong> Can I be notified via jabber (or yammer) when using monitis ? no. Available notification options are e-mail and/or text messages. My monitoring infrastructure sends alerts using e-mails, jabber and private yams. Can i do that with monitis ? no. I wrote the alert scripts myself. Can i do that with monitis ? no.  Argument dismissed.</p>
<p><strong>Quick and easy to setup ?</strong> I'm pretty sure the platform that monitis use for their service is not  easy to setup. That's part of why they provide a pretty good product, that's the barrier to entry in their business. They sell a service that's easy to setup. I would expect no less. Now, is adding monitoring for new hosts and services difficult in my current monitoring platform ? not at all. Once i have passed the initial setup phase, which is, admitedly, quite a steep slope to climb, i can add services and hosts in a breeze. My platform runs on a similar cloud infrastructure that they are selling as a green and cool tech. I even add the hosts automatically to the monitoring infrastructure when the instances are launched. I have started writing software that would monitor a specific metric (not a TCP port availability or a server's transmit time, a <strong>business-related metric</strong>) that would start instances when needed. Can i do that with the monitis platform ? no. My platform is as "quick and easy" to setup.</p>
<p><strong>Low cost of entry and TCO ?</strong> Admitedly, if you want to be serious about monitoring, you need dedicated hardware. In the white paper, the arguments against setting up your own platform are the cost of the hardware, and the decently competent people required to operate it :</p>
<blockquote>
<div id="_mcePaste">For open-source tools, however, the tab for monitoring is high. Consider</div>
<div id="_mcePaste">these costs:</div>
<div id="_mcePaste">
<ul>
<li>$2,000 + for a server</li>
<li>$2,000 + for a backup server and storage</li>
<li>$1,000  yearly per server for electricity</li>
<li>Setup and maintenance labor cost (usually a dedicated or a part time resource – at least $30,000 per year) to do such things as:
<ul>
<li>Add plug-ins</li>
<li>Backup data</li>
<li>Fix issues, patching</li>
<li>Update software</li>
<li>Setup monitoring and alerting</li>
</ul>
</li>
</ul>
</div>
</blockquote>
<p>Where is the connection with Open Source Software ? They are assuming operating costs for their customers, mutualizing them, thus making sure that they can collect significant margins. Nice, but if i change "Open Source" to "proprietary", the arguments stands. Even more, actually. I know a lot of proprietary monitoring solutions that require much more hardware and administration than any "Open Source" (thinking HP OpenView, CA Unicenter, ...)</p>
<p><strong>Monitoring from outside ?</strong> Having an external monitor is good practice and a proper design decision. Again, what does it has to do with "Open Source" ? Nothing in the "Open Source" solution they are trying to debunk prevents you from setting up an external monitoring system. The software even has built-in support for that. And does monitis allow me to monitor some services inside my infrastructure without exposing them ? if their platform is hosted on the cloud, they must be using multiple different IP addresses for running their probes. How do i set up my border routers ? Do I even want to do that ?! No, I don't <img src="http://arzur.net/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" />  The proper monitoring architecture <strong>must</strong> include both external and internal servers that will run probes.</p>
<p><strong>Easily scalable ?</strong> Their platform scales. Good for them. Congrats. With its centralized architecture, and the fact that, by default, every probes are run from a centralized host, Nagios may not scale well, ok. But the "few hundreds" servers assumed in this white paper is far from the limit. And you can make Nagios scale. I don't claim it is easy though.</p>
<p><strong>green ?</strong> my Nagios server is running on top of the cloud. It's green too ! it's cool too ! what a joke !</p>
<p>Ok, that was fun. Just a few totally irrelevant arguments against using Open Source Monitoring Software by a provider of a proprietary monitoring solution ...</p>
<p>It reminds me when Nominum <a href="http://www.zdnet.co.uk/news/servers/2009/09/22/why-open-source-dns-is-internets-dirty-little-secret-39760362/">was arguing about their "superior proprietary solution"</a>, allegedly more secure because the source code wasn't available. Just like if cache poisoning attacks were caused by the availability of BIND's source code.</p>
<p>If monitis can prove that they don't use any kind of open source software in their platform, they may have good basis in such arguments, but I just doubt it. I'm pretty sure they are using open source software all over their platform. For a start, netcraft.com data about their web servers doesn't display such a dislike toward OSS when it comes to web servers and operating systems. I can't help but wondering if it is the same internally.</p>
<p>In any case, they should not shoot on projects such as Nagios, which at least, must have helped them decide to design their own proprietary platform ! The reasoning in this white-paper is completely flawed. It should be titled "Why Monitis hosted monitoring is better", and every reference to "Open Source Software" in there should be replaced by "self-managed monitoring solution".</p>
<div class="bitcointips-widget"><div class="qrcode"><a href="bitcoin:1CthfjNFfs3trujiZaAkVLtdQf8JGRc6WW"><img src="https://chart.googleapis.com/chart?chs=120x120&cht=qr&chld=H|0&chl=1CthfjNFfs3trujiZaAkVLtdQf8JGRc6WW" width="120" height="120" /></a>No tips yet.<br />Be the first to tip!</div><div class="contents"><h2>Like this post? Tip me with bitcoin!</h2><p><a href="bitcoin:1CthfjNFfs3trujiZaAkVLtdQf8JGRc6WW">1CthfjNFfs3trujiZaAkVLtdQf8JGRc6WW</a></p><p>If you enjoyed reading this post, please consider tipping me using Bitcoin. Each post gets its own unique Bitcoin address so by tipping you're not only making my continued efforts possible but telling me what you liked.</p></div><div class="pluginhome"><a href="http://terk.co/wordpress-bitcoin-tips-plugin">Powered by Bitcoin Tips</a></div></div>
<div class="cat_tags clear">
<span class="category">Tagged as: <a href="http://arzur.net/tag/monitoring/" rel="tag">monitoring</a>, <a href="http://arzur.net/tag/operations/" rel="tag">operations</a>, <a href="http://arzur.net/tag/sysadmin/" rel="tag">sysadmin</a></span>
<span class="continue"><a class="nr_comm_spot" href="http://arzur.net/2010/06/08/monitis-vs-open-source-wtf/#comments">1 Comment</a></span><div class="clear"></div>
</div>
<div class="cat_tags_close"></div>
</div>




<div class="newer_older">
<span class="newer">&nbsp;</span>
<span class="older">&nbsp;<a href="http://arzur.net/page/2/" >Older Entries &raquo;</a></span>
</div>

</div>
<div class="content-sidebar">
				<h3>Recent english posts</h3>		<ul>
					<li><a href="http://arzur.net/2012/12/20/notebook-importing-existing-users-from-chef/" title="notebook: importing existing users from chef">notebook: importing existing users from chef </a>
			
			</li>
					<li><a href="http://arzur.net/2012/10/02/notebook-chef-interactive-testing-using-irb/" title="Notebook: chef interactive testing using irb">Notebook: chef interactive testing using irb </a>
			
			</li>
					<li><a href="http://arzur.net/2011/12/29/notebook-batch-m4a-to-flac-conversion-using-findxargsffmpeg/" title="Notebook: batch m4a to flac conversion using find/xargs/ffmpeg">Notebook: batch m4a to flac conversion using find/xargs/ffmpeg </a>
			
			</li>
					<li><a href="http://arzur.net/2010/10/31/notebook-powerbook-battery-calibation/" title="Notebook: MacBook &#8211; Battery calibation">Notebook: MacBook &#8211; Battery calibation </a>
			
			</li>
					<li><a href="http://arzur.net/2010/10/31/scripting-with-chef/" title="scripting with chef">scripting with chef </a>
			
			</li>
				</ul>
						<h3>Les derniers articles (français)</h3>		<ul>
					<li><a href="http://arzur.net/2013/10/29/wadi-rum-2/" title="Wadi Rum &#8211; 2">Wadi Rum &#8211; 2 </a>
			
			</li>
					<li><a href="http://arzur.net/2013/10/29/wadi-rum-1/" title="Wadi Rum &#8211; 1">Wadi Rum &#8211; 1 </a>
			
			</li>
					<li><a href="http://arzur.net/2013/10/27/petra-seconde-journee/" title="Petra &#8211; Seconde journee">Petra &#8211; Seconde journee </a>
			
			</li>
					<li><a href="http://arzur.net/2013/10/26/petra-premiere-journee/" title="Petra &#8211; premiere journee">Petra &#8211; premiere journee </a>
			
			</li>
					<li><a href="http://arzur.net/2012/05/26/recette-nutella-maison/" title="Recette nutella maison">Recette nutella maison </a>
			
			</li>
				</ul>
		<h3>Archives</h3>		<ul>
	<li><a href='http://arzur.net/2013/10/'>October 2013</a></li>
	<li><a href='http://arzur.net/2012/12/'>December 2012</a></li>
	<li><a href='http://arzur.net/2012/10/'>October 2012</a></li>
	<li><a href='http://arzur.net/2012/05/'>May 2012</a></li>
	<li><a href='http://arzur.net/2011/12/'>December 2011</a></li>
	<li><a href='http://arzur.net/2011/05/'>May 2011</a></li>
	<li><a href='http://arzur.net/2011/04/'>April 2011</a></li>
	<li><a href='http://arzur.net/2011/03/'>March 2011</a></li>
	<li><a href='http://arzur.net/2010/10/'>October 2010</a></li>
	<li><a href='http://arzur.net/2010/08/'>August 2010</a></li>
	<li><a href='http://arzur.net/2010/06/'>June 2010</a></li>
	<li><a href='http://arzur.net/2010/05/'>May 2010</a></li>
		</ul>
</div><div class="clear"></div>
</div>
<div id="footer">
<span class="text">
Copyright &copy; 2014 <a href="http://arzur.net">Zuzur&#039;s corner</a> &middot; Powered by <a href="http://www.wordpress.org" title="WordPress" target="_blank">WordPress</a> <br/><a href="http://www.lightword-design.com/" target="_blank" title="Lightword Theme">Lightword Theme</a> by Andrei Luca</em>
<a title="Go to top" class="top" href="#top">Go to top &uarr;</a>
</span>
</div>
<script type="text/javascript" src="http://arzur.net/wp-content/themes/lightword/js/menu.js"></script>
</div>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<script type="text/javascript">/* <![CDATA[ */ Cufon.now(); /* ]]> */ </script>
<script type='text/javascript'>
/* <![CDATA[ */
var Sociali18n = {"commentReplyTitle":"Post a Reply"};
/* ]]> */
</script>
<script type='text/javascript' src='http://arzur.net/wp-content/plugins/social/assets/social.js?ver=2.11'></script>
</body>
</html>
