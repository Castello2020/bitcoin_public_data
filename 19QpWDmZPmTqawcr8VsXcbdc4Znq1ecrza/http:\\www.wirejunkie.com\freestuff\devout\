http://www.wirejunkie.com/freestuff/devout/
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 21:55:50 GMT
Server: Apache
X-Powered-By: PHP/5.2.6-1+lenny8
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 4871
Connection: close
Content-Type: text/html

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>wirejunkie - resources: Devout</title>
<meta name="author" content="wirejunkie" />
<meta name="description" content="Devout is a utility that exports email from Microsoft Outlook 2000 to Evolution mbox format.  It is written in Visual Basic for Applications, which Microsoft kindly embedded inside Outlook 2000." />
<meta name="keywords" content="Outlook, Evolution, export, PST" />
<link rel="stylesheet" type="text/css" href="/style/wj-base.css" />
<link rel="stylesheet" type="text/css" href="/style/wj-print.css" media="print" />
<script type="text/javascript" src="/js/st.js"></script>
</head>
<body>
<div id="header">
    <div id="header-left"><a href="/"><img src="/images/wj-logo-50x50.gif" alt="" /></a></div>
    <div class="ie-min-width"></div>
    <div id="ie-nav-width">
	<div id="nav-major">
		<ul>
			<li><a href="/"><img src="/images/nav-0-home.png" alt="Home" style="vertical-align: top; margin-top: 8px;" /></a></li>
			<li><a href="/aboutus/"><img src="/images/nav-0-aboutus.png" alt="About Us" style="vertical-align: top; margin-top: 8px;" /></a></li>
			<li><a href="/contact/"><img src="/images/nav-0-contactus.png" alt="Contact Us" style="vertical-align: top; margin-top: 8px;" /></a></li>
			<li><a href="/services/"><img src="/images/nav-0-services.png" alt="Services" style="vertical-align: top; margin-top: 8px;" /></a></li>
			<li class="major-sel"><img src="/images/tab-major-left.png" alt="" /><a href="/resources/"><img src="/images/nav-0-resources.png" alt="Resources" style="vertical-align: top; margin-top: 10px;" /></a><img src="/images/tab-major-right.png" alt="" /></li>
		</ul>
	</div>

	<div id="nav-minor" style="padding-left: 20px;">
		<ul>
			<li style="padding: 0px 15px 0px 0px;"><img src="/images/tab-minor-left.png" alt="" /><a href="/resources/ecommerce/jsec/"><img src="/images/nav-0-jsec.png" alt="JSEC" style="vertical-align: top; margin-top: 5px;" /></a></li>
			<li><a href="/resources/wearable/keyglove/"><img src="/images/nav-0-keyglove.png" alt="KeyGlove" style="vertical-align: top; margin-top: 5px;" /></a></li>
			<li><a href="/freestuff/"><img src="/images/nav-0-freestuff.png" alt="Free Stuff" style="vertical-align: top; margin-top: 5px;" /></a></li>
			<li class="minor-act"><img src="/images/tab-minor-mid-left-active.png" alt="" /><a class="active" href="/freestuff/devout/"><img src="/images/nav-1-devout.png" alt="Devout" style="vertical-align: top; margin-top: 7px;" /></a><img src="/images/tab-minor-mid-right-active.png" alt="" /></li>
			<li style="padding: 0px 0px 0px 15px;"><a href="/resources/links/"><img src="/images/nav-0-links.png" alt="Links" style="vertical-align: top; margin-top: 5px;" /></a><img src="/images/tab-minor-right.png" alt="" /></li>
		</ul>
	</div>
    </div>
</div>
<div id="body">
<h1>Devout</h1>

<h2>Introduction</h2>

<p>Devout is a utility that exports email from Microsoft Outlook 2000 to
<a href="http://www.ximian.com/apps/evolution.php3">Evolution</a> mbox format.  It is written in Visual Basic
for Applications, which Microsoft kindly embedded inside Outlook 2000.</p>

<p>Devout will currently export all mail items in the Outlook folder list (including mail stored on an Exchange server, or
in PST files) with the following restrictions:</p>

<ul>
	<li>A minimum set of message headers is exported</li>
	<li>No allowances are made for non-ASCII characters in message headers or bodies</li>
</ul>

<p>These restrictions are documented in greater detail in the <a href="#notes">Notes</a> section.</p>

<p>The latest version of Devout can be obtained from
<a href="http://www.wirejunkie.com/freestuff/devout/">http://www.wirejunkie.com/freestuff/devout/</a></p>

<p>If you find Devout particularly useful and want to show your apprectiation, a small
donation is most welcome, either in <a href="http://bitcoin.org/">Bitcoins</a> to <a href="bitcoin:19QpWDmZPmTqawcr8VsXcbdc4Znq1ecrza?label=wirejunkie+donations">19QpWDmZPmTqawcr8VsXcbdc4Znq1ecrza</a>, or via PayPal.</p>

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<div>
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="5354772" />
<input type="image" src="https://www.paypal.com/en_AU/i/btn/btn_donate_SM.gif" name="submit" alt="[ Donate ]" />
<img alt="" src="https://www.paypal.com/en_AU/i/scr/pixel.gif" style="width: 1px; height: 1px;" />
</div>
</form>


<h2>Installation</h2>

<ol>
	<li>Download the <a href="http://www.wirejunkie.com/freestuff/devout/devout-20010714-001.zip">Devout source</a> (ZIP file, 40.5KB)</li>
	<li>Extract the file, making sure you keep the directory structure in the ZIP file intact.  This will create a directory named
	&quot;devout-20010714-001&quot;, with a subdirectory named &quot;vbmenc&quot;.</li>
	<li>From the &quot;devout-20010714-001\vbmenc&quot; directory, copy the file &quot;vbmenc.dll&quot; to your Windows System or
	System32 directory.</li>
	<li>Start Outlook.  From the main menu bar, select Tools -> Macro -> Visual Basic Editor.  If a warning about macro viruses
	appears, select &quot;Enable Macros&quot;.</li>
	<li>In the Project Explorer, right click on &quot;project1 (VbaProject.OTM)&quot; and select Import File.</li>
	<li>Go to the &quot;devout-20010714-001&quot; directory and select the CustomExport.bas file.</li>
	<li>Repeat the above two steps for the files EvolutionMboxFolder.cls, frmCustomExport.frm, MIMEMessage.cls, MimeTypeMap.cls and
	Utility.bas</li>
	<li>Close the Visual Basic Editor.</li>
</ol>

<p>Note that Devout uses some objects (treeview controls, Office objects etc.) located in external OCX or DLL files.  If you have
any difficulties installing or running Devout, go to Tools -> References in the Visual Basic Editor and make sure the following
references are selected:</p>

<ul>
	<li><b>Visual Basic For Applications</b><br /><code>c:\program files\common files\microsoft shared\vba\vba6\vbe6.dll</code></li>
	<li><b>Microsoft Outlook 9.0 Object Library</b><br /><code>c:\program files\microsoft office\office\msoutl9.olb</code></li>
	<li><b>Microsoft Forms 2.0 Object Library</b><br /><code>c:\winnt\system32\fm20.dll</code> or <code>c:\windows\systemfm20.dll</code></li>
	<li><b>Microsoft Windows Common Controls 6.0</b><br /><code>c:\winnt\system32\mscomctl.ocx</code> or <code>c:\windows\system\mscomctl.ocx</code></li>
</ul>

<p>If these references do not appear in the list, you can use the browse button to find the actual files themselves as listed above.
Note that the paths to these files may vary from system to system.</p>

<p>By default Outlook is probably set to disable macros that have not been digitally signed.  The Devout package falls into
this category, so for it to work you may need to go to Tools -> Macros -> Security and select Medium level.  After changing this
setting you may need to restart Outlook.</p>

<p>The next time you close Outlook, you will be asked if you want to save the VBA project 'VbaProject.OTM'.  Select &quot;Yes&quot;.</p>

<h2>Usage</h2>

<ol>
	<li>Start Outlook</li>
	<li>From the main menu bar, select Tools -> Macro -> Macros.  If a warning about macro viruses appears, select
	&quot;Enable Macros&quot;.</li>
	<li>Select the &quot;ExportMailToEvolution&quot; macro and click &quot;Run&quot;.  The Devout window will appear. </li>
	<li>The Devout window contains a treeview listing all the Outlook folders with a checkbox next to each folder.  Select the
	folders you wish to export.  Selecting or deselecting a folder will automatically select or deselect its children.</li>
	<li>The default destination for the exported mail is the TEMP directory.  This can be changed using the &quot;Browse&quot; button
	which will bring up a folder selection dialog.</li>
	<li>Click the &quot;Export&quot; button to start exporting.  The export can be cancelled at any time by pressing the
	&quot;Cancel&quot; button.</li>
</ol>

<p>Depending on whether or not Outlook's security patches have been installed you may be presented with a dialog that says the
following:</p>

<blockquote><p>A program is trying to access e-mail addresses you have stored in Outlook.  Do you want to allow this?  If this is
unexpected, it may be a virus and you should choose &quot;No&quot;.</p></blockquote>

<p>This should be answered with &quot;Allow access for 10 minutes&quot;.  Depending on how much email is being exported this message
may appear several times.</p>

<p>I have successfully exported about 20,000 mail messages (spread over about 240 folders) in 109 minutes - about 260MB of data.
This was on a Pentium III 450Mhz running Windows NT 4.  I exported to a local directory then copied the resultant directory structure
to my Evolution mail directory which was shared via Samba on another computer.</p>

<a name="notes"></a><h2>Notes</h2>

<p>Devout not perfect...  Sometimes it will give you messages with illegal email addresses in the headers, and
multipart/alternative and multipart/mixed messages still need a little work to be completely sane, but it <i>did</i> do an
acceptable job of exporting <i>most</i> of my mail correctly, complete with attachments, so I expect it will do the same for you.</p>

<p>Attachments and HTML message bodies are encoded using the Base64 and Quoted-Printable encoding functions in the vbmenc.dll file.
The source for this file is included in the Devout package, in the vbmenc directory.  The algorithms are based on public domain code
included with the VM mail reader, which can be found at <a href="http://www.wonderworks.com/vm">http://www.wonderworks.com/vm</a>.
Thanks to Christopher Kline for pointing me at this code.  You need <a href="http://www.mingw.org/">Minimalist GNU For Windows</a> if you
want to build vbmenc.dll yourself.</p>

<p>The headers exported for each message are as follows:</p>

<ul>
	<li>To</li>
	<li>Cc</li>
	<li>Bcc</li>
	<li>From</li>
	<li>Subject</li>
	<li>Date</li>
	<li>MIME-Version (always 1.0)</li>
	<li>Content-type</li>
</ul>

<p>The Date is always set to the time zone of the computer on which the export is run, because Outlook does not appear to provide
access to time zone data.</p>

<p>Outlook also does not provide access to the Sender's email address, so we create a reply to the current message then extract
the recipient's email address from it (thanks to Ben van der Merwe for that one).</p>

<p>No allowances other than Base64 or QP encoding are made for non-ASCII characters in messages at the moment, but Evolution
tends to deal fairly well with this.</p>

<h2>Release History:</h2>

<ul>
	<li><a href="http://www.wirejunkie.com/freestuff/devout/devout-20001025-001.zip">devout-20001025-001.zip (19.8KB)</a>:
	Initial Release - no Base64 or QP encoding.</li>
	<li><a href="http://www.wirejunkie.com/freestuff/devout/devout-20010422-001.zip">devout-20010422-001.zip (40.5KB)</a>:
	Added Base64 and Quoted-Printable encoding.</li>
	<li><a href="http://www.wirejunkie.com/freestuff/devout/devout-20010714-001.zip">devout-20010714-001.zip (40.5KB)</a>:
	Updated install documentation regarding References in the Visual Basic Editor.</li>
</ul>

<h2>License</h2>

<p>Copyright &copy; 2000, 2001 Tim Serong <script type="text/javascript">document.write('&lt;'); st(3); document.write('&gt;');</script></p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>

</div>
<div id="footer">
    <div id="footer-left"></div>
    <div class="ie-min-width"></div>
    <div id="footer-content">Copyright &copy; 2000 - 2014 wirejunkie</div>
</div>
</body>
</html>

