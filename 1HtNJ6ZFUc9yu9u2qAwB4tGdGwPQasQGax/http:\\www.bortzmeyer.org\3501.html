http://www.bortzmeyer.org/3501.html
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 08:03:18 GMT
Server: Apache/2.2.22 (Debian)
Last-Modified: Wed, 18 Jun 2014 06:30:56 GMT
ETag: "22ec0-3ca8-4fc166718c800"
Accept-Ranges: bytes
Vary: Accept-Encoding
Content-Encoding: gzip
Link: <http://www.gnu.org/copyleft/fdl.html>; rel="license"; title="GFDL"
Content-Length: 5470
Connection: close
Content-Type: text/html; charset=UTF-8

<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="fr" lang="fr" xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Generated on tyrion on 2014-06-18T08:30 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<link rel="stylesheet" type="text/css" href="screen.css" media="screen"/>
<link rel="stylesheet" type="text/css" href="print.css" media="print"/>
<link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
<link rel="openid2.local_id" href="https://openid.stackexchange.com/user/ce28a43a-5060-423a-8574-25e24a8f096e">
<!-- TODO: add META tags from the text of the entry, for instance keywords ? -->
<link rel="alternate" type="application/atom+xml" title="Atom syndication feed - summaries" href="feed.atom" />
<link rel="alternate" type="application/atom+xml" title="Atom syndication feed - full content" href="feed-full.atom" />
<link rel="search"
           type="application/opensearchdescription+xml" 
           href="http://www.bortzmeyer.org/others/add-search-engine.xml"
           title="Blog Bortzmeyer" />
<link rel="author" href="http://www.bortzmeyer.org/static/moi.html"/>
<link rel="privacy-policy" href="/privacy-policy.html"/>
<title>
Blog Stéphane Bortzmeyer: RFC 3501: INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1

</title>
</head>

<body>

<div id="page-container">
<div id="masthead">
<div class="inside">
			<h1><a href="index.html">Mon blog</a></h1>
			<hr class="hide" />
</div>
</div>
<div id="outer-column-container">
<div id="inner-column-container">
<div id="source-order-container">
<div id="left-column">
<div id="leftmenu" class="inside">
<h3>Autres trucs</h3>
<p><a href="index.html">Accueil</a></p>
<p><a href="rfcs.html">Seulement les RFC</a></p>
<p><a href="ficheslecture.html">Seulement les fiches de lecture</a></p>
<p><a href="http://echoping.sourceforge.net/">echoping</a></p>
<p><a href="http://www.demaziere.fr/eve/">Ève</a></p>
<form action="/search"><p>Recherche dans ce blog : <input type="text" name="pattern" style="width:100%"/>
</p>
</form>
</div>
</div> <!-- End of left-column -->
<div id="middle-column">
<div class="inside">

<h2 xml:lang="en"><a class="rfc" href="http://www.rfc-editor.org/rfc/rfc3501.txt">RFC 3501</a>: INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</h2><p>Date de publication du RFC : Mars 2003<br/>Auteur(s) du RFC : M. Crispin (University of Washington)<br/>Chemin des normes<br/>Première rédaction de cet article le 31 mai 2007<br/></p><hr/>
<div class="para"><p><b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Internet%20Message%20Access%20Protocol" title="Consultez l'article &quot;Internet Message Access Protocol&quot; de l'encyclopédie libre Wikipedia">IMAP</a></b>, protocole d'accès distant à des boîtes
aux lettres n'est pas juste un protocole, c'est tout un écosystème,
décrit dans de nombreux RFC. Celui-ci est le socle de la version
actuelle d'IMAP.</p></div>
<div class="para"><p>Les protocoles traditionnels du <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/courrier%20%C3%A9lectronique" title="Consultez l'article &quot;courrier électronique&quot; de l'encyclopédie libre Wikipedia">courrier électronique</a></b>, notamment <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Simple%20Mail%20Transfer%20Protocol" title="Consultez l'article &quot;Simple Mail Transfer Protocol&quot; de l'encyclopédie libre Wikipedia">SMTP</a></b> ne
permettaient que d'acheminer le courrier jusqu'à destination. Pour le
lire, pendant longtemps, la seule solution était d'accéder directement
aux fichiers où étaient stockés les messages. Cette possibilité existe
toujours mais le monde du courrier s'est enrichi de nouvelles
fonctions, comme le stockage du courrier dans une <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/base%20de%0Adonn%C3%A9es%20relationnelle" title="Consultez l'article &quot;base de&#10;données relationnelle&quot; de l'encyclopédie libre Wikipedia">base de
données relationnelle</a></b> ou comme la récupération du courrier
à distance, en mode <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Client-serveur" title="Consultez l'article &quot;Client-serveur&quot; de l'encyclopédie libre Wikipedia">client/serveur</a></b>. Pour cette
récupération, le premier protocole a été <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Post%20Office%20Protocol" title="Consultez l'article &quot;Post Office Protocol&quot; de l'encyclopédie libre Wikipedia">POP</a></b>,
dans le <a href="http://www.rfc-editor.org/rfc/rfc918.txt" class="rfc" title="Consultez le texte intégral du RFC 918">RFC 918</a> (aujourd'hui dans le <a href="http://www.rfc-editor.org/rfc/rfc1939.txt" class="rfc" title="Consultez le texte intégral du RFC 1939">RFC 1939</a>). Et
le plus courant est aujourd'hui <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Internet%20Message%20Access%20Protocol" title="Consultez l'article &quot;Internet Message Access Protocol&quot; de l'encyclopédie libre Wikipedia">IMAP</a></b>, qui fait
l'objet de notre RFC, qui remplace le <a href="http://www.rfc-editor.org/rfc/rfc2060.txt" class="rfc" title="Consultez le texte intégral du RFC 2060">RFC 2060</a>.</p></div>
<div class="para"><p><b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Post%20Office%20Protocol" title="Consultez l'article &quot;Post Office Protocol&quot; de l'encyclopédie libre Wikipedia">POP</a></b> est simple, très simple. Il est parfait
lorsqu'on veut simplement télécharger les messages sur son poste. IMAP
fonctionne sur un modèle différent, où les messages ont plutôt
vocation à rester sur le serveur, et où les clients peuvent, non
seulement les récupérer mais aussi les classer, les détruire, les
marquer comme lus, etc. Certaines de ces possibilités existaient déjà
avec POP mais étaient peu utilisées. IMAP permet au contraire, via ses
nombreux RFC, de tout faire à distance.</p></div>
<div class="para"><p>IMAP est donc un protocole complexe et notre RFC annonce la couleur
en disant qu'il est une norme, pas un tutoriel. Pour apprendre IMAP,
il vaut mieux ne pas commencer par le RFC. (La lecture du <a href="http://www.rfc-editor.org/rfc/rfc2683.txt" class="rfc" title="Consultez le texte intégral du RFC 2683">RFC 2683</a> est recommandée aux implémenteurs.)</p></div>
<div class="para"><p>Pourtant, le principe de base est simple. IMAP est
<b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Client-serveur" title="Consultez l'article &quot;Client-serveur&quot; de l'encyclopédie libre Wikipedia">client/serveur</a></b>. Le client se connecte en
<b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Transmission%20Control%20Protocol" title="Consultez l'article &quot;Transmission Control Protocol&quot; de l'encyclopédie libre Wikipedia">TCP</a></b> au serveur, et envoie des commandes sous
forme de texte, comme avec <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Simple%20Mail%20Transfer%20Protocol" title="Consultez l'article &quot;Simple Mail Transfer Protocol&quot; de l'encyclopédie libre Wikipedia">SMTP</a></b>. Il s'authentifie avec la commande
<code>LOGIN</code>, choisit une boîte aux lettres avec la
commande <code>SELECT</code>, récupère un message avec la
commande <code>FETCH</code>. Voici un exemple de
session. Notons tout de suite que chaque commande est précédée d'une
<b class="emphasis">étiquette</b> (<i class="foreign" xml:lang="en">tag</i>, voir la
section 2.2.1 du RFC) qui change à chaque commande et qui permet
d'associer une réponse à une commande, IMAP permettant d'envoyer
plusieurs commandes sans attendre de réponse). Ici, le serveur utilise
le logiciel
<a href="http://www.archiveopteryx.org/">Archiveopteryx</a> : 
</p><pre>
% telnet imap.example.org imap     
Trying 192.0.2.23...
Connected to imap.example.org.
Escape character is '^]'.
* OK [CAPABILITY IMAP4rev1 AUTH=CRAM-MD5 AUTH=DIGEST-MD5 AUTH=PLAIN COMPRESS=DEFLATE ID LITERAL+ STARTTLS] imap.example.org Archiveopteryx IMAP Server
com1 LOGIN stephane vraimentsecret
com1 OK [CAPABILITY IMAP4rev1 ACL ANNOTATE BINARY CATENATE CHILDREN COMPRESS=DEFLATE CONDSTORE ESEARCH ID IDLE LITERAL+ NAMESPACE RIGHTS=ekntx STARTTLS UIDPLUS UNSELECT URLAUTH] done
com2 SELECT INBOX
* 189 EXISTS
* 12 RECENT
* OK [UIDNEXT 1594] next uid
* OK [UIDVALIDITY 1] uid validity
* FLAGS (\Deleted \Answered \Flagged \Draft \Seen)
* OK [PERMANENTFLAGS (\Deleted \Answered \Flagged \Draft \Seen \*)] permanent flags
com2 OK [READ-WRITE] done
</pre><p>
Pour tester son serveur IMAP, on peut aussi utiliser fetchmail et lui demander d'afficher toute la session avec <code>-v -v</code> :
</p><pre>

 % fetchmail -v -v -u MYLOGIN imap.1and1.fr 
Enter password for MYLOGIN@imap.1and1.fr: 
fetchmail: 6.3.6 querying imap.1and1.fr (protocol auto) at Tue Apr 15 12:00:27 2008: poll started
fetchmail: 6.3.6 querying imap.1and1.fr (protocol IMAP) at Tue Apr 15 12:00:27 2008: poll started
Trying to connect to 212.227.15.141/143...connected.
fetchmail: IMAP&lt; * OK IMAP server ready H mimap3 65564
fetchmail: IMAP&gt; A0001 CAPABILITY
fetchmail: IMAP&lt; * CAPABILITY IMAP4rev1 LITERAL+ ID STARTTLS CHILDREN QUOTA IDLE NAMESPACE UIDPLUS UNSELECT SORT AUTH=LOGIN AUTH=PLAIN
fetchmail: IMAP&lt; A0001 OK CAPABILITY finished.
fetchmail: Protocol identified as IMAP4 rev 1
fetchmail: IMAP&gt; A0002 STARTTLS
fetchmail: IMAP&lt; A0002 OK Begin TLS negotiation.
fetchmail: Issuer Organization: Thawte Consulting cc
fetchmail: Issuer CommonName: Thawte Premium Server CA
fetchmail: Server CommonName: imap.1and1.fr
fetchmail: imap.1and1.fr key fingerprint: 93:13:99:6A:3F:23:73:C3:00:37:4A:39:EE:22:93:AB
fetchmail: IMAP&gt; A0003 CAPABILITY
fetchmail: IMAP&lt; * CAPABILITY IMAP4rev1 LITERAL+ ID CHILDREN QUOTA IDLE NAMESPACE UIDPLUS UNSELECT SORT AUTH=LOGIN AUTH=PLAIN
fetchmail: IMAP&lt; A0003 OK CAPABILITY finished.
fetchmail: Protocol identified as IMAP4 rev 1
fetchmail: imap.1and1.fr: upgrade to TLS succeeded.
fetchmail: IMAP&gt; A0004 LOGIN "m39041005-1" *
fetchmail: IMAP&lt; A0004 OK LOGIN finished.
fetchmail: selecting or re-polling default folder
fetchmail: IMAP&gt; A0005 SELECT "INBOX"

</pre><p>
IMAP a des fonctions plus riches, notamment la possibilité de chercher
dans les messages (section 6.4.4 du RFC), ici, on extrait les messages
de mai 2007, puis on récupère le sujet du premier message :
</p><pre>
com10 SEARCH since 1-May-2007 before 31-May-2007
* SEARCH 12
com10 OK done
com11 FETCH 1 (BODY.PEEK[HEADER.FIELDS (SUBJECT)])
* 1 FETCH (BODY[HEADER.FIELDS (Subject)] {17}
Subject: Rapport sur les fonctions de vue dans Archiveopteryx

)
com11 OK done
</pre></div>
<div class="para"><p>IMAP est mis en œuvre dans de nombreux serveurs comme
<b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Dovecot" title="Consultez l'article &quot;Dovecot&quot; de l'encyclopédie libre Wikipedia">Dovecot</a></b>, <a href="http://www.courier-mta.org/">Courier</a>, ou Archiveopteryx,
déja cité.</p></div>
<div class="para"><p>Côté client, on trouve du IMAP dans beaucoup de logiciels, des
<i class="foreign" xml:lang="en"><b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Webmail" title="Consultez l'article &quot;Webmail&quot; de l'encyclopédie libre Wikipedia">webmails</a></b></i> comme
<b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/SquirrelMail" title="Consultez l'article &quot;SquirrelMail&quot; de l'encyclopédie libre Wikipedia">SquirrelMail</a></b>, des <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Client%20de%20messagerie" title="Consultez l'article &quot;Client de messagerie&quot; de l'encyclopédie libre Wikipedia">MUA</a></b>
classiques comme <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/mutt" title="Consultez l'article &quot;mutt&quot; de l'encyclopédie libre Wikipedia">mutt</a></b>, des MUA en ligne de
commande comme <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/fetchmail" title="Consultez l'article &quot;fetchmail&quot; de l'encyclopédie libre Wikipedia">fetchmail</a></b>, très pratique pour
récupérer son courrier.</p></div>
<div class="para"><p>Il existe également des bibliothèques toutes faites pour programmer
son client IMAP à son goût comme <a href="http://docs.python.org/lib/module-imaplib.html">imaplib</a>
pour <b><a class="wikipedia" hreflang="fr" href="http://fr.wikipedia.org/wiki/Python%20(langage)" title="Consultez l'article &quot;Python (langage)&quot; de l'encyclopédie libre Wikipedia">Python</a></b>. Voici un
exemple d'un court programme Python qui se connecte à un serveur
IMAP, sélectionne les messages d'avril 2007 et les récupère. On note
que la bibliothèque a choisi de rester très proche du vocabulaire du RFC :
</p><pre>
import imaplib

connection = imaplib.IMAP4()
connection.login("stephane", "thisissecret")
connection.select() # Select the default mailbox
typee, data = connection.search(None,
                                '(since "1-Apr-2007")', 
                                '(before "1-May-2007")')
for num in data[0].split():
    # Fetches the whole message
    typ, data = connection.fetch(num, '(RFC822)')
    print 'Message %s\n%s\n' % (num, data[0][1])
connection.close()
connection.logout()
</pre></div>
<hr/><p class="get-rfc"><a class="rfc" href="http://www.rfc-editor.org/rfc/rfc3501.txt">Téléchargez le RFC 3501</a></p>


<p id="get-pdf" class="verysmall"><a href="3501.pdf" rel="noindex,nofollow">Version PDF de cette page</a> (mais vous pouvez aussi imprimer depuis votre navigateur, il y a une feuille de style prévue pour cela)</p>
<p id="get-source" class="verysmall"><a href="3501.xml" rel="nofollow">Source XML de cette page</a> (cette 
page est distribuée sous les termes de la licence <a href="http://www.gnu.org/copyleft/fdl.html">GFDL</a>)</p>
</div>
</div><!-- End of middle-column -->
</div><!-- End of source-order-container -->
</div><!-- End of inner-column-container -->
</div><!-- End of outer-column-container -->
<div class="clear-columns"><!-- do not delete --></div>
<div id="footer">
<div class="inside">
<hr class="hide" />
<p>Si vous aimez, vous pouvez payer avec <a href="/flattr.html">Flattr</a> <a href="https://flattr.com/submit/auto?user_id=bortzmeyer&url=http%3A%2F%2Fwww.bortzmeyer.org%2F3501.html" target="_blank"><img src="/images/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0"></a> ou avec <a href="/bitcoin-blog.html">Bitcoin</a> : adresse <code>1HtNJ6ZFUc9yu9u2qAwB4tGdGwPQasQGax</code> (ou voyez le <a href="/images/bitcoin-qrcode.png">code QR</a>). Pour toute remarque sur ce blog, s'adresser à
Stéphane Bortzmeyer <code>&lt;stephane+blog@bortzmeyer.org&gt;</code>. Je suis <a href="http://sl4.org/crocker.html">les règles de Crocker</a> donc pas besoin de faire des excès de diplomatie. Ce blog est strictement personnel et les opinions exprimées ici n'engagent donc que moi, et notamment pas mon employeur présent ou mes employeurs passés.</p>
<a href="http://prefetch.validatorsearch.verisignlabs.com"></a><!-- See http://validatorsearch.verisignlabs.com/ -->
</div>
</div><!-- End of footer -->
</div><!-- End of page-container -->
</body>
</html>


