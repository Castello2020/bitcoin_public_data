http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/
HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
X-Pingback: http://sametmax.com/xmlrpc.php
Link: <http://wp.me/p2ckfk-2I2>; rel=shortlink
Content-Encoding: gzip
Content-Length: 30257
Accept-Ranges: bytes
Date: Thu, 24 Jul 2014 14:09:23 GMT
Age: 0
Connection: close
x-Cache: uncached
url: /deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="fr-FR" >
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>  Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#8217;on mange | Sam &amp; Max: Python, Django, Git et du cul</title>
<meta http-equiv="Content-Language" content="fr" />

<link rel="shortcut icon" href="/wp-content/uploads/2012/05/favicon.ico">

<link rel="stylesheet" href="http://sametmax.com/wp-content/themes/Minimal/style.css?238" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max: Python, Django, Git et du cul RSS Feed" href="http://sametmax.com/feed/" />
<link rel="alternate" type="application/atom+xml" title="Sam &amp; Max: Python, Django, Git et du cul Atom Feed" href="http://sametmax.com/feed/atom/" />
<link rel="pingback" href="http://sametmax.com/xmlrpc.php" />


<!--[if lt IE 7]>
	<link rel="stylesheet" type="text/css" href="http://sametmax.com/wp-content/themes/Minimal/css/ie6style.css" />
	<script type="text/javascript" src="http://sametmax.com/wp-content/themes/Minimal/js/DD_belatedPNG_0.0.8a-min.js"></script>
	<script type="text/javascript">DD_belatedPNG.fix('img#logo, #header #search-form, #slogan, a#left_arrow, a#right_arrow, div.slide img.thumb, div#controllers a, a.readmore, a.readmore span, #services .one-third, #services .one-third.first img.icon, #services img.icon, div.sidebar-block .widget ul li');</script>
<![endif]-->
<!--[if IE 7]>
	<link rel="stylesheet" type="text/css" href="http://sametmax.com/wp-content/themes/Minimal/css/ie7style.css" />
<![endif]-->

<script type="text/javascript">
	document.documentElement.className = 'js';
</script>

<script type="text/javascript">
(function() {
	var s = document.createElement('SCRIPT'), s1 = document.getElementsByTagName('SCRIPT')[0];
	s.type = 'text/javascript';
	s.async = true;
	s.src = 'http://widgets.digg.com/buttons.js';
	s1.parentNode.insertBefore(s, s1);
})();
</script>
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max: Python, Django, Git et du cul &raquo; Feed" href="http://sametmax.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max: Python, Django, Git et du cul &raquo; Comments Feed" href="http://sametmax.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max: Python, Django, Git et du cul &raquo; Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#8217;on mange Comments Feed" href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/feed/" />
<meta content="Minimal v.3.3" name="generator"/><link media="screen" type="text/css" href="http://sametmax.com/wp-content/themes/Minimal/epanel/page_templates/js/fancybox/jquery.fancybox-1.3.4.css" rel="stylesheet" />
<link media="screen" type="text/css" href="http://sametmax.com/wp-content/themes/Minimal/epanel/page_templates/page_templates.css" rel="stylesheet" /><link rel='stylesheet' id='tags-page-css'  href='http://sametmax.com/wp-content/plugins/tags-page/tags-page.css?ver=3.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='http://sametmax.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wp-polls-css'  href='http://sametmax.com/wp-content/plugins/wp-polls/polls-css.css?ver=2.63' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='http://sametmax.com/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<link rel='stylesheet' id='et-shortcodes-css-css'  href='http://sametmax.com/wp-content/themes/Minimal/epanel/shortcodes/shortcodes.css?ver=1.8' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css'  href='http://sametmax.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=2.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='cfq-css'  href='http://sametmax.com/wp-content/plugins/comment-form-quicktags/style.css?ver=20110712' type='text/css' media='all' />
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/tags-page/webtoolkit.sortabletable.js?ver=3.3.1'></script>
<script type='text/javascript' src='http://sametmax.com/wp-includes/js/jquery/jquery.js?ver=1.7.1'></script>
<script type='text/javascript' src='http://sametmax.com/wp-includes/js/comment-reply.js?ver=20090102'></script>
<script type='text/javascript' src='http://sametmax.com/wp-content/themes/Minimal/epanel/shortcodes/js/et_shortcodes_frontend.js?ver=1.8'></script>
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/comment-form-quicktags/quicktags.php?ver=20121011'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://sametmax.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://sametmax.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Écrivez à l&#8217;arc, envoyez des sioux' href='http://sametmax.com/ecrivez-a-larc-envoyez-des-sioux/' />
<link rel='next' title='assert &#8220;а&#8221; == &#8220;a&#8221; # lol' href='http://sametmax.com/assert-%d0%b0-a-lol/' />
<meta name="generator" content="WordPress 3.3.1" />
<link rel='canonical' href='http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/' />
<link rel='shortlink' href='http://wp.me/p2ckfk-2I2' />
<link rel="payment" type="text/html" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&amp;language=en_GB&amp;category=text&amp;title=Deferred%2C+Future+et+Promise+%3A+le+pourquoi%2C+le+comment%2C+et+quand+est-ce+qu%26%238217%3Bon+mange&amp;description=Partager%3AEmailMore+Pin+ItShare+on+TumblrDiggPocketNo+related+posts.&amp;tags=asynchrone%2Casyncio%2Cdeferred%2Cfuture%2Cjavascript%2Cjquery%2Cpromise%2Cpython%2Ctwisted%2Cblog" />
<style type="text/css">
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('http://sametmax.com/wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}
</style>

<link rel="stylesheet" href="http://sametmax.com/wp-content/plugins/wp-syntax/wp-syntax.css" type="text/css" media="screen" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#039;on mange" />
<meta property="og:url" content="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/" />
<meta property="og:description" content="Les promesses sont une des manières de rendre un code asynchrone plus facile à gérer. On dit : ce groupe de fonctions doit s&#039;exécuter dans un ordre. Elles sont dépendantes les unes des autres." />
<meta property="og:site_name" content="Sam &amp; Max: Python, Django, Git et du cul" />
<meta property="og:image" content="http://sametmax.com/wp-content/uploads/2014/06/D8GwE.png" />
<meta name="twitter:site" content="@jetpack" />
<meta name="twitter:image:src" content="http://sametmax.com/wp-content/uploads/2014/06/D8GwE.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<style type="text/css" media="all">
/* <![CDATA[ */
@import url("http://sametmax.com/wp-content/plugins/wp-table-reloaded/css/plugin.css?ver=1.9.3");
@import url("http://sametmax.com/wp-content/plugins/wp-table-reloaded/css/datatables.css?ver=1.9.3");
/* ]]> */
</style>	<style type="text/css">
		#et_pt_portfolio_gallery { margin-left: -11px; }
		.et_pt_portfolio_item { margin-left: 23px; }
		.et_portfolio_small { margin-left: -39px !important; }
		.et_portfolio_small .et_pt_portfolio_item { margin-left: 35px !important; }
		.et_portfolio_large { margin-left: -20px !important; }
		.et_portfolio_large .et_pt_portfolio_item { margin-left: 14px !important; }
	</style>

</head>
<body>
	<div id="page-wrap">
			
		<div id="header">
			<!-- Start Logo -->
				<a href="http://sametmax.com">					<img src="http://sametmax.com/wp-content/uploads/2012/04/logo1.png" alt="Logo" id="logo"/></a>
				
				<p id="slogan">Deux développeurs en vadrouille qui se sortent les doigts du code</p>
					
			<!-- End Logo -->
					
			<!-- Start Searchbox -->
				<div id="search-form">
					<form method="get" id="searchform1" action="http://sametmax.com/">
						<input type="text" value="search this site..." name="s" id="searchinput" />
					</form>
				</div>
								
			<!-- End Searchbox -->
				
				<div class="clear"></div>
				
				<ul id="menu-top-menu" class="superfish nav clearfix"><li id="menu-item-1702" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1702"><a href="http://sametmax.com/category/programmation/">Programmation</a></li>
<li id="menu-item-1703" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1703"><a href="http://sametmax.com/category/administration-system/">Admin System</a></li>
<li id="menu-item-1704" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1704"><a href="http://sametmax.com/category/philo-et-culture/">Philo et culture</a></li>
<li id="menu-item-1706" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1706"><a href="http://sametmax.com/category/cul/">Cul</a></li>
<li id="menu-item-3340" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3340"><a href="http://sametmax.com/cours-et-tutos/">Cours et tutos</a></li>
<li id="menu-item-2610" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2610"><a href="http://sametmax.com/nos-tweets/">Nos tweets SANS twitter :-)</a></li>
<li id="menu-item-1707" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1707"><a title="Les meilleurs blogs du Web" href="http://multiboards.net/">Multiboards</a></li>
<li id="menu-item-7439" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7439"><a href="https://github.com/sametmax/">Nos githuberies</a></li>
</ul>									
		</div> <!-- end #header -->

		<div id="breadcrumbs">
		
					<a href="http://sametmax.com">Home</a> &raquo;
				
									<a href="http://sametmax.com/category/programmation/">Programmation</a> &raquo; Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#8217;on mange					
</div> <!-- end #breadcrumbs -->		
	
	<div id="content" class="clearfix">
		<div id="content-area">
					<div class="entry clearfix">
				<h1 class="title">Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#8217;on mange</h1>
					<p class="post-meta">
		Posted  by <a href="http://sametmax.com/author/sam/" title="Posts by Sam" rel="author">Sam</a> on 4 Jun 2014 in <a href="http://sametmax.com/category/programmation/" title="View all posts in Programmation" rel="category tag">Programmation</a> | <a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comments" title="Comment on Deferred, Future et Promise : le pourquoi, le comment, et quand est-ce qu&#8217;on mange">18 comments</a>	</p>
				
							
									
						
								
				<p>Si vous avez plongé dans le monde de la programmation asynchrone non bloquante, vous avez du vous heurter aux <a href="http://sametmax.com/quest-ce-quun-callback/">callbacks</a>. Si ce n&#8217;est pas le cas, aller lire l&#8217;article, et faites vos armes sur jQuery, je vais m&#8217;en servir en exemple.</p>
<p>Signalement de rigueur que l&#8217;article est long :</p>

<!-- iframe plugin v:2.3 - wordpress.org/extend/plugins/iframe/ -->
<iframe width="560" height="315" src="//www.youtube.com/embed/E8b4xYbEugo" frameborder="0" scrolling="no" class="iframe-class"></iframe>
<p>Un callback, ça va.</p>
<p>Deux callbacks, pour un seul appel, ça commence à être chiant, mais c&#8217;est compréhensible.</p>
<p>Quand les callbacks appellent eux aussi des callbacks, ça donne des codes imbitables :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">$<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  $.<span style="color: #660066;">post</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/auth/token'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    saveToken<span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/sessions/last'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>session.<span style="color: #660066;">device</span> <span style="color: #339933;">!=</span> currentDevice<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/session/ '</span> <span style="color: #339933;">+</span> session.<span style="color: #660066;">id</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'/context'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>context<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          loadContext<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
            startApp<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
              initUi<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
            <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
          <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
        <span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
      <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
        startApp<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          initUi<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#41;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Il y a pire que de lire ce code : le modifier ! Retirez un bloc, pour voir. Oh, et histoire de vous faire partager l&#8217;expérience complète, j&#8217;ai volontairement déplacé l&#8217;indentation d&#8217;une parenthèse et de deux brackets.</p>
<p>Or les codes asynchrones ont besoin de callback afin d’enchainer certaines opérations dans le bon ordre, sinon on ne peut pas récupérer le résultat d&#8217;une fonction et l&#8217;utiliser dans une autre, puisqu&#8217;on ne sait pas quand l&#8217;opération se termine.</p>
<p>Dans notre exemple, <code>$.post</code> et <code>$.get</code> font des requêtes POST et GET, et comme on ne sait pas quand le serveur va répondre, il faut mettre un callback pour gérer la réponse quand elle arrive. C&#8217;est plus performant que de bloquer jusqu&#8217;à ce que la première requête soit terminée car pendant ce temps, notre programme peut faire autre chose. Mais c&#8217;est aussi super relou à écrire et comprendre.</p>
<p>Entrent en jeu les promesses (promises). Ou les deferred. Ou les futures.</p>
<p>Typiquement, on retrouve des deferreds dans <a href="https://twistedmatrix.com/trac/">Twisted</a>, des promises pour <a href="http://api.jquery.com/jquery.ajax/">l&#8217;AJAX avec jQuery,</a> des futures pour <a href="http://docs.python.org/3.4/library/asyncio-protocol.html">asyncio</a>&#8230; Mais il y en a un peu partout de nos jours, et une lib peut utiliser plusieurs de ces concepts.</p>
<p>En fait c&#8217;est la même chose, un nom différent donné au même concept, par des gens qui l&#8217;ont réinventé dans leur coin. Les puristes vous diront qu&#8217;il y a des différences dans l&#8217;implémentation, ou alors que la promesse est l&#8217;interface tandis que le deferred est l&#8217;objet retourné, bla, bla, bla.</p>
<p>Fuck it, on va considérer que c&#8217;est tout pareil.</p>
<p>Les promesses sont une des manières de rendre un code asynchrone plus facile à gérer. On dit : ce groupe de fonctions doit s&#8217;exécuter dans un ordre car elles sont dépendantes les unes des autres.</p>
<p>Il y a d&#8217;autres moyens de gérer le problème de l&#8217;asynchrone: des événements, des queues, etc. L&#8217;avantage des promesses c&#8217;est que c&#8217;est assez simple, et ça marche là où on utilisait des callbacks avant, donc on a pu les rajouter aux libs qui étaient blindées de callbacks.</p>
<h2>Le principe</h2>
<p>La promesse est un moyen de dire que certaines fonctions, bien que non bloquantes et asynchrones, sont liées entre elles, et doivent s&#8217;exécuter les unes à la suite des autres. Cela permet de donner un ordre d&#8217;exécution à un groupe de fonctions, et surtout, que chaque fonction puisse accéder au résultat de la fonction précédente. Tout ceci sans bloquer le reste du système asynchrone.</p>
<p>En résumé, <strong>cela donne un gout de programmation synchrone, à quelque chose qui ne l&#8217;est pas.</strong></p>
<p>Cela se passe ainsi :</p>
<ul>
<li>La fonction asynchrone retourne un objet immédiatement : la promesse.</li>
<li>On ne passe pas de callback à la fonction. On rajoute un callback à la promesse.</li>
<li>Le callback prend en paramètre le résultat de la fonction asynchrone.</li>
<li>Le callback retourne le résultat de son traitement.</li>
<li>On peut rajouter autant de callbacks qu&#8217;on veut à la promesse, chacun devant accepter le résultat du callback précédent et retourner son propre résultat.</li>
<li>Si un des callbacks retourne une promesse, elle est fusionnée avec la promesse initiale, et c&#8217;est son résultat que le prochain callback va récupérer</li>
</ul>
<p>Voilà un exemple :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #006600; font-style: italic;">// $.get est asynchrone. On a pas le résultat tout de suite, mais en attendant</span>
<span style="color: #006600; font-style: italic;">// on a une promesse tout de suite.</span>
<span style="color: #003366; font-weight: bold;">var</span> $promesse <span style="color: #339933;">=</span> $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/truc/machin'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// premier callback. Il sera appelé quand $.get aura récupéré son</span>
<span style="color: #006600; font-style: italic;">// résultat</span>
$promesse.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>resultat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// faire un truc avec le résultat</span>
  <span style="color: #006600; font-style: italic;">// puis on retourne le nouveau résultat</span>
  <span style="color: #000066; font-weight: bold;">return</span> nouveau_resultat<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// deuxième callback. Il sera appelé quand le premier callback</span>
<span style="color: #006600; font-style: italic;">// aura retourné son résultat.</span>
$promesse.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>nouveau_resultat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// faire un truc</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Notez bien que c&#8217;est TRES différent de ça (en Python):</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">resultat = request.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/truc/marchin'</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> function<span style="color: black;">&#40;</span>resultat<span style="color: black;">&#41;</span>:
  <span style="color: #808080; font-style: italic;"># faire un truc</span>
  <span style="color: #ff7700;font-weight:bold;">return</span> nouveau_resultat
nouveau_resultat = function<span style="color: black;">&#40;</span>resultat<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> autre_function<span style="color: black;">&#40;</span>nouveau_resultat<span style="color: black;">&#41;</span>:
  <span style="color: #808080; font-style: italic;"># faire un truc</span>
autre_function<span style="color: black;">&#40;</span>nouveau_resultat<span style="color: black;">&#41;</span></pre></div></div>

<p>En Python, le code est bloquant par défaut. Ça va marcher, mais pendant que le code attend la réponse du serveur, votre ordinateur est en pause et ne travaille pas.</p>
<h2>Un plus beau code</h2>
<p>On se retrouve avec un code asynchrone, mais qui s&#8217;exécute dans l&#8217;ordre de lecture. Et comme on peut chainer les <code>then()</code> et donc ne pas réécrire <code>$promesse</code> à chaque fois, on obtient quelque chose de beaucoup plus lisible :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">$.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/truc/machin'</span><span style="color: #009900;">&#41;</span>
.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>resultat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// faire un truc</span>
  <span style="color: #000066; font-weight: bold;">return</span> nouveau_resultat<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>nouveau_resultat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// faire un truc</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Si on reprend notre premier exemple, ça donne ça :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">$<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// create new token</span>
$.<span style="color: #660066;">post</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/auth/token'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// then save token and get last session</span>
.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  saveToken<span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #000066; font-weight: bold;">return</span> $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/sessions/last'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// then init session</span>
.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>session.<span style="color: #660066;">device</span> <span style="color: #339933;">!=</span> currentDevice<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
    $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/session/ '</span> <span style="color: #339933;">+</span> session.<span style="color: #660066;">id</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'/context'</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>context<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      loadContext<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        startApp<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          initUi<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
  <span style="color: #009900;">&#125;</span>
  <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
    startApp<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      initUi<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Tout ça s’exécute de manière non bloquante (d&#8217;autres fonctions ailleurs dans le programme peuvent s&#8217;exécuter pendant qu&#8217;on attend la réponse du serveur), mais dans l&#8217;ordre de lecture, donc on comprend bien ce qui se passe. Si on veut retirer un bloc, c&#8217;est beaucoup plus facile.</p>
<h2>Comment ça marche à l&#8217;intérieur ?</h2>
<p>Histoire d&#8217;avoir une idée de comment une promise marche, on va faire une implémentation, simpliste et naïve, mais compréhensible, d&#8217;une promesse en Python. Pour rendre l&#8217;API un peu sympa,je vais utiliser <a href="http://sametmax.com/comprendre-les-decorateurs-python-pas-a-pas-partie-1/">les décorateurs.</a></p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> Promise:
&nbsp;
    <span style="color: #808080; font-style: italic;"># La promesse contient une liste de callbacks, donc une liste de fonctions.</span>
    <span style="color: #808080; font-style: italic;"># Pas le résultat des fonctions, mais bien les fonctions elles mêmes,</span>
    <span style="color: #808080; font-style: italic;"># puisque les fonctions sont manipulables en Python.</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>.<span style="color: black;">callbacks</span> = <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Point d'entrée pour ajouter un callback à la promesse</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> then<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, callback<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>.<span style="color: black;">callbacks</span>.<span style="color: black;">append</span><span style="color: black;">&#40;</span>callback<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Cette méthode est celle qui sera appelée par le code asynchrone</span>
    <span style="color: #808080; font-style: italic;"># quand il reçoit son résultat.</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> resolve<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, resultat<span style="color: black;">&#41;</span>:
&nbsp;
        <span style="color: #808080; font-style: italic;"># Ici, on obtient le résultat du code asycnhrone, donc on boucle</span>
        <span style="color: #808080; font-style: italic;"># sur les callbacks pour les appeler</span>
        <span style="color: #ff7700;font-weight:bold;">while</span> <span style="color: #008000;">self</span>.<span style="color: black;">callbacks</span>:
            <span style="color: #808080; font-style: italic;"># On retire le premier callback de la liste, et on l'appelle</span>
            <span style="color: #808080; font-style: italic;"># avec le résultat</span>
            resultat = <span style="color: #008000;">self</span>.<span style="color: black;">callbacks</span>.<span style="color: black;">pop</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span><span style="color: black;">&#40;</span>resultat<span style="color: black;">&#41;</span>
&nbsp;
            <span style="color: #808080; font-style: italic;"># Si le resultat est une promesse, on dit à cette nouvelle promesse</span>
            <span style="color: #808080; font-style: italic;"># de nous rappeler quand elle a reçu ses résultats à elle avant</span>
            <span style="color: #808080; font-style: italic;"># d'aller le reste de nos callbacks à nous : on fusionne les deux</span>
            <span style="color: #808080; font-style: italic;"># promesses :</span>
            <span style="color: #808080; font-style: italic;"># Promesse 1</span>
            <span style="color: #808080; font-style: italic;">#  - callback1</span>
            <span style="color: #808080; font-style: italic;">#  - callback2</span>
            <span style="color: #808080; font-style: italic;">#  - Promesse 2</span>
            <span style="color: #808080; font-style: italic;">#      * callback 1</span>
            <span style="color: #808080; font-style: italic;">#      * callback 2</span>
            <span style="color: #808080; font-style: italic;">#  - callback 3</span>
            <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>resultat, Promise<span style="color: black;">&#41;</span>:
                resultat.<span style="color: black;">then</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">resolve</span><span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">break</span></pre></div></div>

<p>Maintenant, créons un code asynchrone:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">threading</span> <span style="color: #ff7700;font-weight:bold;">import</span> Timer
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> func1<span style="color: black;">&#40;</span>v1<span style="color: black;">&#41;</span>:
    <span style="color: #808080; font-style: italic;"># On dit complètement artificiellement d'afficher le résultat</span>
    <span style="color: #808080; font-style: italic;"># de la fonction dans 3 secondes, sans bloquer histoire d'avoir</span>
    <span style="color: #808080; font-style: italic;"># un peu de nonbloquitude dans notre code et justifier l'asynchrone.</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> callback1<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v1<span style="color: black;">&#41;</span>
    t = Timer<span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span>, callback1<span style="color: black;">&#41;</span>
    t.<span style="color: black;">start</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> func2<span style="color: black;">&#40;</span>v2<span style="color: black;">&#41;</span>:
    <span style="color: #808080; font-style: italic;"># Le même, mais pour 2 secondes</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> callback2<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v2<span style="color: black;">&#41;</span>
    t = Timer<span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span>, callback2<span style="color: black;">&#41;</span>
    t.<span style="color: black;">start</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Deux fonctions normales</span>
<span style="color: #ff7700;font-weight:bold;">def</span> func3<span style="color: black;">&#40;</span>v3<span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v3<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> func4<span style="color: black;">&#40;</span>v4<span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v4<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Et si on les enchaines...</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Je commence'</span><span style="color: black;">&#41;</span>
func1<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Juste après'</span><span style="color: black;">&#41;</span>
func2<span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>
func3<span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>
func4<span style="color: black;">&#40;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># ... le résultat est bien désordonné :</span>
&nbsp;
<span style="color: #808080; font-style: italic;">## Je commence</span>
<span style="color: #808080; font-style: italic;">## Juste après</span>
<span style="color: #808080; font-style: italic;">## 3</span>
<span style="color: #808080; font-style: italic;">## 4</span>
<span style="color: #808080; font-style: italic;">## 2</span>
<span style="color: #808080; font-style: italic;">## 1</span></pre></div></div>

<p>Parfois c&#8217;est ce que l&#8217;on veut, que les choses s’exécutent dans le désordre, sans bloquer.</p>
<p>Mais quand on a des fonctions qui dépendent les unes des autres, au milieu d&#8217;un code asynchrone, on veut qu&#8217;elles se transmettent le résultat les unes aux autres au bon moment. Pour cela, utilisons notre promesse :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">threading</span> <span style="color: #ff7700;font-weight:bold;">import</span> Timer
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;"># La mise en place de promesses suppose que le code </span>
<span style="color: #808080; font-style: italic;"># écrit en fasse explicitement usage. Notre code est</span>
<span style="color: #808080; font-style: italic;"># définitivement lié à cette manière de faire.</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> func1<span style="color: black;">&#40;</span>v1<span style="color: black;">&#41;</span>:
    <span style="color: #808080; font-style: italic;"># Notre fonction doit créer la promesse et la retourner</span>
    p = Promise<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> callback1<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v1<span style="color: black;">&#41;</span>
        <span style="color: #808080; font-style: italic;"># Dans le callback, elle doit dire quand la promesse est tenue</span>
        p.<span style="color: black;">resolve</span><span style="color: black;">&#40;</span>v1<span style="color: black;">&#41;</span>
    t = Timer<span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span>, callback1<span style="color: black;">&#41;</span>
    t.<span style="color: black;">start</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> p
&nbsp;
<span style="color: #808080; font-style: italic;"># On lance la première fonction.</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Je commence'</span><span style="color: black;">&#41;</span>
promise = func1<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Juste après'</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On ajoute des callbacks à notre promesse.</span>
&nbsp;
@promise.<span style="color: black;">then</span>
<span style="color: #ff7700;font-weight:bold;">def</span> func2<span style="color: black;">&#40;</span>v2<span style="color: black;">&#41;</span>:
    p = Promise<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> callback2<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        <span style="color: #808080; font-style: italic;"># Pour justifier l’enchainement des fonctions, on fait en sorte que</span>
        <span style="color: #808080; font-style: italic;"># chaque fonction attend le résultat de la précédente, et</span>
        <span style="color: #808080; font-style: italic;"># l'incrémente de 1.</span>
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v2 + <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
        p.<span style="color: black;">resolve</span><span style="color: black;">&#40;</span>v2 + <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
    t = Timer<span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span>, callback2<span style="color: black;">&#41;</span>
    t.<span style="color: black;">start</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># Ce callback retourne lui-même une promesse, qui sera fusionnée</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> p
&nbsp;
<span style="color: #808080; font-style: italic;"># Ces callbacks ne retournent pas de promesses, et seront chainés</span>
<span style="color: #808080; font-style: italic;"># normalement</span>
@promise.<span style="color: black;">then</span>
<span style="color: #ff7700;font-weight:bold;">def</span> func3<span style="color: black;">&#40;</span>v3<span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v3 + <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> v3 + <span style="color: #ff4500;">1</span>
&nbsp;
@promise.<span style="color: black;">then</span>
<span style="color: #ff7700;font-weight:bold;">def</span> func4<span style="color: black;">&#40;</span>v4<span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>v4 + <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Nos fonctions s'exécutent dans le bon ordre, mais bien de manière</span>
<span style="color: #808080; font-style: italic;"># asynchrone par rapport au reste du programme.</span>
&nbsp;
<span style="color: #808080; font-style: italic;">## Je commence</span>
<span style="color: #808080; font-style: italic;">## Juste après</span>
<span style="color: #808080; font-style: italic;">## 1</span>
<span style="color: #808080; font-style: italic;">## 2</span>
<span style="color: #808080; font-style: italic;">## 3</span>
<span style="color: #808080; font-style: italic;">## 4</span></pre></div></div>

<p>Notez bien :</p>
<ul>
<li>Le résultat &#8220;1&#8243; n&#8217;apparait que trois secondes après &#8220;Juste après&#8221;. Les fonctions sont donc bien non bloquantes.</li>
<li>Le resultat &#8220;2&#8243; apparait deux secondes après &#8220;1&#8243;: c&#8217;est aussi asynchrone, MAIS, n&#8217;est lancé que quand la première fonction a terminé son travail.</li>
<li>La deuxième fonction retourne une promesse, qui est fusionnée: tous ses callbacks vont s&#8217;exécuter en file avant que <code>func3</code> soit lancé. </li>
</ul>
<p>Évidement, n&#8217;utilisez pas cette implémentation de promise à la maison, c&#8217;est pédagogique. Ça ne gère pas les erreurs, ni le cas où le callback est enregistré après l&#8217;arrivée du résultat, et tout un tas d&#8217;autres cas tordus.</p>
<h2>Syntaxe alternative</h2>
<p>En Python, beaucoup de frameworks ont une approche plus agréable pour gérer les promesses à grand coup de <a href="http://sametmax.com/comment-utiliser-yield-et-les-generateurs-en-python/">yield</a>. Twisted fait ça avec son <code>@inlineCallback</code>, <code>asyncio</code> avec <code>@coroutine</code>. C&#8217;est juste du sucre syntaxique pour vous rendre la vie plus facile.</p>
<p>Il s&#8217;agit de transformer une fonction en générateur, et à chaque fois qu&#8217;on appelle <code>yield</code> sur une promesse, elle est fusionnée avec la précédente. Ça donne presque l&#8217;impression d&#8217;écrire un code bloquant normal :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># un appel de fonction asyncrone typique de twisted</span>
@inlineCallback
<span style="color: #ff7700;font-weight:bold;">def</span> une_fonction<span style="color: black;">&#40;</span>data<span style="color: black;">&#41;</span>:
  data = <span style="color: #ff7700;font-weight:bold;">yield</span> func1<span style="color: black;">&#40;</span>data<span style="color: black;">&#41;</span>
  data = <span style="color: #ff7700;font-weight:bold;">yield</span> func2<span style="color: black;">&#40;</span>data<span style="color: black;">&#41;</span>
  data = <span style="color: #ff7700;font-weight:bold;">yield</span> func3<span style="color: black;">&#40;</span>data<span style="color: black;">&#41;</span>
&nbsp;
une_fonction<span style="color: black;">&#40;</span>truc<span style="color: black;">&#41;</span></pre></div></div>

<p>Les fonctions 1, 2 et 3 vont ainsi être appelées de manière asynchrone par rapport au reste du programme, mais bien s’enchainer les unes à la suite des autres.</p>
<p>Ouai, tout ce bordel parce que l&#8217;asynchrone, c&#8217;est dur, donc on essaye de le faire ressembler à du code synchrone, qui lui est facile.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-official sd-sharing"><h3 class="sd-title">Partager:</h3><div class="sd-content"><ul><li class="share-twitter"><div class="twitter_button"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&#038;counturl=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&#038;count=horizontal&#038;text=Deferred%2C%20Future%20et%20Promise%20%3A%20le%20pourquoi%2C%20le%20comment%2C%20et%20quand%20est-ce%20qu%27on%20mange%3A" style="width:101px; height:20px;"></iframe></div></li><li class="share-facebook"><div class="like_button"><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&amp;layout=button_count&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;height=21&amp;locale=en_US&amp;width=90" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:96px; height:21px;" allowTransparency="true"></iframe></div></li><li class="share-google-plus-1"><div class="googleplus1_button"><div class="g-plus" data-action="share" data-annotation="bubble" data-href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/"></div></div></li><li class="share-email"><a rel="nofollow" class="share-email sd-button" href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/?share=email" title="Click to email this to a friend"><span>Email</span></a></li><li><a href="#" class="sharing-anchor sd-button share-more"><span>More</span></a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="display: none;"><ul><li class="share-reddit"><div class="reddit_button"><iframe src="http://www.reddit.com/static/button/button1.html?width=120&amp;url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&amp;title=Deferred%2C%20Future%20et%20Promise%20%3A%20le%20pourquoi%2C%20le%20comment%2C%20et%20quand%20est-ce%20qu%27on%20mange" height="22" width="120" scrolling="no" frameborder="0"></iframe></div></li><li class="share-pinterest"><div class="pinterest_button"><a href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&#038;description=Deferred%2C%20Future%20et%20Promise%20%3A%20le%20pourquoi%2C%20le%20comment%2C%20et%20quand%20est-ce%20qu%27on%20mange&#038;media=http%3A%2F%2Fsametmax.com%2Fwp-content%2Fuploads%2F2014%2F06%2FD8GwE.png" class="pin-it-button" count-layout="horizontal"> Pin It</a></div></li><li class="share-end"></li><li class="share-tumblr"><a target="" href="http://www.tumblr.com/share/link/?url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&name=Deferred%2C%20Future%20et%20Promise%20%3A%20le%20pourquoi%2C%20le%20comment%2C%20et%20quand%20est-ce%20qu%27on%20mange" title="Share on Tumblr" style="display:inline-block; text-indent:-9999px; overflow:hidden; width:62px; height:20px; background:url('http://platform.tumblr.com/v1/share_2.png') top left no-repeat transparent;">Share on Tumblr</a></li><li class="share-digg"><div class="digg_button"><a rel="nofollow" class="DiggThisButton DiggCompact share-digg sd-button" href="http://digg.com/submit?url=http%3A%2F%2Fsametmax.com%2Fdeferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange%2F&amp;title=Deferred%2C%20Future%20et%20Promise%20%3A%20le%20pourquoi%2C%20le%20comment%2C%20et%20quand%20est-ce%20qu%27on%20mange" title="Click to Digg this post"><span>Digg</span></a></div></li><li class="share-end"></li><li class="share-pocket"><div class="pocket_button"><a href="https://getpocket.com/save" class="pocket-btn" data-lang="en" data-save-url="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/" data-pocket-count="horizontal" >Pocket</a></div></li><li class="share-end"></li></ul></div></div></div></div></div><p>No related posts.</p><p class="wp-flattr-button"><a href="http://sametmax.com/?flattrss_redirect&amp;id=10418&amp;md5=adf0568366c6b0f00340cf1accd3fc68" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>											</div> <!-- end .entry -->
			
					
						
			<!-- You can start editing here. -->

	<div id="comment-section" class="clearfix">
		<h3 id="comments">18 comments</h3>
		
		
			<ol class="commentlist clearfix">
			   <li class="comment even thread-even depth-1" id="li-comment-41870">
		<div class="bottom_bg">
		   <div id="comment-41870" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/b6ef160822bd8bb88ca28e0e5bcc62d0?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Pierre</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41870">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p><span class="troll"></span>Ou sinon il y a Go! :P<br />
Le principe de ce langage est que &#8220;bloquer&#8221; ne coûte rien!</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-41879">
		<div class="bottom_bg">
		   <div id="comment-41879" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/fbc2071b5de7b18c1f08dbf569886fff?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">cym13</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41879">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Je pense avoir bien tout compris donc je suis content, d&#8217;autant que j&#8217;ai vraiment besoin de me mettre la tête dans les différentes façon de gérer l&#8217;asynchrone un de ses jours et que vous m&#8217;y aidez bien.</p>
<p>Deux remarques quand même: je suis pas convaincu que mélanger &#8220;promesse&#8221; et &#8220;promise&#8221; au fil du tuto soit du plus clair pour un débutant complet. Aussi, je n&#8217;aime pas le javascript. Je suis tout à fait conscient de la démarche pédagogique à l&#8217;œuvre et du fait que le js est très au point sur l&#8217;asynchrone là où python pèche, mais je n&#8217;aime quand même pas ça. Vivement que vous soyez suffisamment à l&#8217;aise avec asyncio pour faire un vrai article dessus !</p>
<p>Allez, comme je n&#8217;aime pas critiquer dans le vide, je vous <a href="http://thedailyentertainment.files.wordpress.com/2012/07/presentcat_180d58_3101629.jpg" rel="nofollow">offre un chat.</a></p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment even thread-even depth-1" id="li-comment-41892">
		<div class="bottom_bg">
		   <div id="comment-41892" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/9165f021b46958f7eaf9398591ee1d5e?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Anb</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41892">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Petite faute d&#8217;accord au début de l&#8217;article (sous le code imbitable)</p>
<blockquote><p>Entre en jeu les promesses (promises). Ou les deferred. Ou les futures.</p></blockquote>
<p>&#8220;Entrent&#8221; &#8230;</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-41901">
		<div class="bottom_bg">
		   <div id="comment-41901" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://0.gravatar.com/avatar/c5df2a9b2b3e1897bf84b85e84dcd4ee?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">herison</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41901">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Salut, </p>
<p>Juste pour être sur d&#8217;avoir pigé la fusion&#8230;</p>
<p>Si j&#8217;ai 2 callbacks cb1 et cb2 sur une promise p1 et que cb1 retourne une promise p2 attachée à un autre callback cb3</p>
<p>p1.then(cb1).then(cb2)<br />
Les choses vont se chaîner comme ceci cb1 -&gt; cb3 -&gt; cb2 ?</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-41910">
		<div class="bottom_bg">
		   <div id="comment-41910" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='Sam' src='http://sametmax.com/wp-content/uploads/2012/02/Sam_avatar.jpg' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Sam</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41910">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@herison : oui.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-41993">
		<div class="bottom_bg">
		   <div id="comment-41993" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://0.gravatar.com/avatar/235f5f4ffd3736018800ef8064551a3f?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">akersof</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-41993">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>C&#8217;est aussi super utile pour le traitement des erreurs lors d&#8217;une chaine de callback.<br />
Lorsqu&#8217;on fait du code asynchrone, donc travailler avec des I/O systeme, et qu&#8217;on chain les appels de callback on ne sait plus trop ou on en est déjà dans notre code, et encore pire dans le traitement de l&#8217;erreur, quelle callback qui a foirée, quelle erreur, etc<br />
Twisted offre la possibilité non seulement d&#8217;ajouter une callback aux deferred mais aussi ce qu&#8217;ils appellent une errback, meme principe qu&#8217;une callback mais ca sera une erreur :).<br />
Sous javascript ES6 va introduite dans le core les promises.<br />
Node.js avait au debut intégrer cela mais ils ont préféré le retirer du core et laisser des devs de libs les créer.<br />
Pour le javascript je recommande bluebird, qui est le trendy et qui monte qui monte, ou sinon Q (utilisable coté serveur et browsser)</p>
<p>Bon je finis sur l&#8217;alternative evidement, certains ne veulent pas utiliser de promises car ils n&#8217;aiment pas ca.. sous node.js il y a le module async qui ne fonctionne pas avec le meme princpe d&#8217;un object qui est le deferred, mais rend l&#8217;ecriture d&#8217;un code asynchrone plus.. horizontal je dirais :)</p>
<p>Voila utilisez les deferred/promises, dur au debut mais une fois qu&#8217;on sait s&#8217;en servir on en peut plus s&#8217;en passer :);<br />
On se rend compte de leur utilité lorsqu&#8217;on ecrit une grosse app aynchrone et les promises sont une maniere efficace d&#8217;eviter ce qu&#8217;on appelle dans le milieu &#8220;callback hell&#8221;</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment even thread-even depth-1" id="li-comment-42004">
		<div class="bottom_bg">
		   <div id="comment-42004" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/f6d78ffbc6b66f7806839688ec57f27d?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">fab</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42004">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Quand est-ce qu&#8217;on mange ? La stratégie de l&#8217;échec ?</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-42005">
		<div class="bottom_bg">
		   <div id="comment-42005" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/f6d78ffbc6b66f7806839688ec57f27d?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">fab</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42005">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>En parlant du module async en JavaScript, il y a la fonction auto qui est chouette et qui rend service.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment even thread-even depth-1" id="li-comment-42014">
		<div class="bottom_bg">
		   <div id="comment-42014" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://0.gravatar.com/avatar/c321fbc4a92a34254bd9596960e27236?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Naouak</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42014">04/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p><span class="relis"></span>Je veux pas être méchant mais :<br />
Les promises ne sont pas un truc de jQuery.</p>
<p>Le premier code est infect non pas parce qu&#8217;il utilise des callback mais parce qu&#8217;il est juste mal pensé. Le callback-hell est assez souvent un problème de la part du développeur pas du principe. D&#8217;ailleurs le javascript à des mécanismes simple pour l&#8217;évite.</p>
<p>En fait, juste en séparant simplement le code du premier en actions atomiques, on arrive ça :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">$<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #003366; font-weight: bold;">function</span> fetchSession<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/sessions/last'</span><span style="color: #339933;">,</span> manageSession<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>  
  <span style="color: #009900;">&#125;</span>
&nbsp;
  <span style="color: #003366; font-weight: bold;">function</span> startAppAndInitUI<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    startApp<span style="color: #009900;">&#40;</span>initUi<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span>
&nbsp;
  <span style="color: #003366; font-weight: bold;">function</span> manageSession<span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>session.<span style="color: #660066;">device</span> <span style="color: #339933;">!=</span> currentDevice<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      fetchAndLoadContext<span style="color: #009900;">&#40;</span>session.<span style="color: #660066;">id</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
      startAppAndInitUI<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
  <span style="color: #009900;">&#125;</span>
&nbsp;
  <span style="color: #003366; font-weight: bold;">function</span> fetchAndLoadContext<span style="color: #009900;">&#40;</span>sid<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/session/ '</span> <span style="color: #339933;">+</span> sid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'/context'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>context<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>loadContext<span style="color: #009900;">&#40;</span>startAppAndInitUI<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span>
&nbsp;
  $.<span style="color: #660066;">post</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/auth/token'</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    saveToken<span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    fetchSession<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>  
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Je suis sûr qu&#8217;avec le vrai contexte de l&#8217;application on peut faire un meilleur truc que ça d&#8217;ailleurs.</p>
<p>Le second exemple, est pas bon, les deux callbacks sont lancés en même temps et non l&#8217;un après l&#8217;autre. Il aurait fallut récupérer la nouvelle promise pour faire le second then.</p>
<p>Le &#8220;plus beau code&#8221; utilise pas vraiment bien les promises.<br />
Voila une meilleure utilisation :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">$<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// create new token</span>
  $.<span style="color: #660066;">post</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/auth/token'</span><span style="color: #009900;">&#41;</span> 
  <span style="color: #006600; font-style: italic;">// then save token and get last session</span>
  .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    saveToken<span style="color: #009900;">&#40;</span>token<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #000066; font-weight: bold;">return</span> $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/sessions/last'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span> 
  <span style="color: #006600; font-style: italic;">// then init session</span>
  .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>session.<span style="color: #660066;">device</span> <span style="color: #339933;">!=</span> currentDevice<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      <span style="color: #000066; font-weight: bold;">return</span> $.<span style="color: #660066;">get</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'/session/ '</span> <span style="color: #339933;">+</span> session.<span style="color: #660066;">id</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'/context'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span>loadContext<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    startApp<span style="color: #009900;">&#40;</span>initUi<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Quelle différence ? Les appels de then à partir du deuxième.<br />
Globalement, on finit par faire tout le temps la même chose. Pourquoi écrire deux fois l&#8217;appel quand on peut juste le chaîner ?</p>
<p>Et pour finir, il me semble (je suis pas spécialiste en Python) que ta classe promise ne fait pas son boulot.<br />
L&#8217;un des avantages (occulté de cet article) des promises est qu&#8217;il permet aussi de stocker le résultat d&#8217;une opération asynchrone. Et donc si on ajoute un callback après que l&#8217;opération asynchrone soit finie, le callback est quand même lancé. Ça permet de mutualiser une opération asynchrone récurrente (comme par exemple à tout hasard une authentification).</p>
<p>Au final, l&#8217;article montre pas vraiment les meilleurs points des promises ce qui est juste dommage. (le parrallélisme, le race, la gestion d&#8217;erreur, la réutilisation&#8230; d&#8217;ailleurs l&#8217;article de HTML5rocks montre des usages plus intéressants (<a href="http://www.html5rocks.com/en/tutorials/es6/promises/" rel="nofollow">Article sur les promises</a>))</p>
<p>PS: ce trombone est chiant.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-42379">
		<div class="bottom_bg">
		   <div id="comment-42379" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='Sam' src='http://sametmax.com/wp-content/uploads/2012/02/Sam_avatar.jpg' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Sam</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42379">05/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@Naouak: tu es complètement passé à côté du fait que :</p>
<p>- je ne dis pas que les promis vient de jquery, mais qu&#8217;on les retrouve dedans et aussi ailleurs. Je ne parle pas d&#8217;origine.<br />
- l&#8217;article est clairement pédagogique, le but n&#8217;est pas de faire au mieux mais de faire passer une notion. Les exemples sont volontairement imparfaits pour faire passer la notion.<br />
- pour l&#8217;implémentation Python, je dis en toute lettre à la fin que ça n&#8217;adresse pas ce problème.</p>
<p>Bref, un tampon pour toi.</p>
<p>Je subodore que tu es très jeune, puisque tu ne reconnais pas le trombonne. Ce qui explique sans doute le côté emporté.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment even thread-even depth-1" id="li-comment-42393">
		<div class="bottom_bg">
		   <div id="comment-42393" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://0.gravatar.com/avatar/e5176cded08b65b91099dc61f31d43c8?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn"><a href='http://kyoku57.org' rel='external nofollow' class='url'>Kyoku57</a></span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42393">05/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Sympa l&#8217;article. J&#8217;ai tout compris :-) L&#8217;asynchrone est un monde bien particulier.</p>
<p>PS : En parlant des tampons &#8230; en aurais-tu un à la sphaigne ou en en cheveux de cherokee ?</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-42395">
		<div class="bottom_bg">
		   <div id="comment-42395" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='Sam' src='http://sametmax.com/wp-content/uploads/2012/02/Sam_avatar.jpg' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Sam</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42395">05/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@fab : je très clair, fab.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment even thread-even depth-1" id="li-comment-42420">
		<div class="bottom_bg">
		   <div id="comment-42420" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/f6d78ffbc6b66f7806839688ec57f27d?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">fab</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42420">05/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@Sam : en effet je me rend compte qu&#8217;une petite explication s&#8217;impose. La fonction auto permet de définir une suite de fonctions asynchrones à lancer sans se soucier de qui doit attendre quoi juste en définissant des dépendances entre elles.</p>
<p>C&#8217;est assez bien expliqué ici : <a href="http://jakub.fedyczak.net/post/async-auto-best-feature-of-node-async/" rel="nofollow">http://jakub.fedyczak.net/post/async-auto-best-feature-of-node-async/</a> avec un graphique qui permet de visualiser dans quel ordre vont s&#8217;exécuter les fonctions.</p>
<p>Notamment on voit les chemins d&#8217;exécution en parallèle, dans l&#8217;exemple du lien il y en a trois qui se lancent dès que les dépendances sont exécutées, et qui se rejoignent à la fin pour obtenir le résultat voulu.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-42429">
		<div class="bottom_bg">
		   <div id="comment-42429" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/f6d78ffbc6b66f7806839688ec57f27d?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">fab</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-42429">05/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@Sam : &#8230; ta chatte, ta chatte !</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment byuser comment-author-kontre even thread-even depth-1" id="li-comment-43507">
		<div class="bottom_bg">
		   <div id="comment-43507" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/b93cc4fb6413bbe5c837530662bee9b4?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn"><a href='https://github.com/Nodd' rel='external nofollow' class='url'>kontre</a></span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-43507">06/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Ça y est, je vois l&#8217;intérêt du truc. Merci Sam !</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-43753">
		<div class="bottom_bg">
		   <div id="comment-43753" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://0.gravatar.com/avatar/c4825da112287158f6b0ac9ef3ac1f04?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">furankun</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-43753">06/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>De mon côté j&#8217;ai une question de noob qui n&#8217;a rien à voir: dans l&#8217;exempel python à ne pas reproduire tu utilises &#8220;@promise.then&#8221; pour ajouter une étape à ta chaîne de callback; je croyais qu&#8217;il fallait déclarer &#8220;then&#8221; en @classfunction pour pouvoir faire ça? oui je code en 2.7 et je ne comprends toujours rien aux @classfunction et @staticfuntion.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-43766">
		<div class="bottom_bg">
		   <div id="comment-43766" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='Sam' src='http://sametmax.com/wp-content/uploads/2012/02/Sam_avatar.jpg' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Sam</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-43766">06/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>Non, j&#8217;utilise then est une méthode qui me sert ici de décorateur, pas de @classmethod.</p>
<p>Pour plus de détail sur la POO :</p>
<p><a href="http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-1/" rel="nofollow">http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-1/</a></p>
<p>Mais c&#8217;est un exemple très avancé ici, donc ne t&#8217;inquiète pas si @promise.then ne te parle pas.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48028">
		<div class="bottom_bg">
		   <div id="comment-48028" class="comment-body clearfix">
				<div class="alignleft authordata">
					<img alt='' src='http://1.gravatar.com/avatar/5e27901840ca85707727f5ed339ad31f?s=60&amp;d=retro&amp;r=X' class='avatar avatar-60 photo' height='60' width='60' />					
					<div class="clear"></div>
					<div class="comment-author vcard">
						<span class="fn">Duckie</span><br/>
						<div class="comment-meta commentmetadata"><a href="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#comment-48028">10/06/2014		</a></div>
					</div>
				</div>
				
				<div class="comment-wrap">
					
										
					<div class="comment-content"><p>@Pierre : Le blocage est coûteux indépendamment du langage puisque le temps perdu provient d&#8217;éléments non maîtrisable au sein du logiciel (par exemple, une bande passante faible). C&#8217;est juste que Go force à réfléchir &#8220;par flux&#8221; et donc à faire de l&#8217;asynchrone sans qu&#8217;on s&#8217;en rende trop compte.</p>
<p>@Sam: Pour la culture, C++11 voit l&#8217;introduction dans le standard C++ de std::future, std::promise, std::async, et toute la famille qui va bien. Ces concepts sont donc aussi présents en C++ en standard.</p>
</div> <!-- end comment-content-->
									</div> <!-- end comment-wrap-->  
			</div> <!-- end comment-body-->
		</div> <!-- end .bottom_bg-->
</li>
		</ol>
		
			
		
<div>
<p class="rss-comments">
<a href="./feed/" title="Flux RSS des commentaires">Flux RSS des commentaires</a>
</p>
</div>
									<div id="respond">
				<h3 id="reply-title"><span>Leave a Reply</span> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://sametmax.com/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><script type="text/javascript">var edInserted; if (!edInserted) {edToolbar(); edInserted = true;}</script>
<textarea id="comment" name="comment-c7f60e2d0" cols="45" rows="8" aria-required="true"></textarea>
<script type="text/javascript">var edCanvas = document.getElementById('comment');</script><textarea name="comment" rows="1" cols="1" style="display:none"></textarea></p><input type="hidden" name="comment-replaced" value="true" />						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre lang=&quot;&quot; line=&quot;&quot; escaped=&quot;&quot; highlight=&quot;&quot;&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Submit Comment" />
							<input type='hidden' name='comment_post_ID' value='10418' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="63a808bea0" /></p><script src="http://sametmax.com/?live-comment-preview.js" type="text/javascript"></script><div id="commentPreview"></div><p style="display:none;"><input type="text" name="nxts" value="1406210963" /><input type="text" name="nxts_signed" value="da8ca5087f531df104e0667cf23102f38a6907ea" /><input type="text" name="228e2b7a6790488619fa" value="51acc900d67d6ca7fa91" /><input type="text" name="890984ee8b8a9051de66ea1068704" value="" /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments" style="display: inline;">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts by email.</label></p>					</form>
							</div><!-- #respond -->
						</div> <!-- end comment-section -->

<div>
<p><a href="#" id="playmario">Jouer à mario en attendant que les autres répondent</a></p>





<script type="text/javascript">
    if (typeof jQuery !== 'undefined'){
        jQuery('#playmario').click(function(e){
            jQuery(this).replaceWith('<iframe src="http://www.florian-rappl.de/html5/projects/SuperMario/" style="width:500px;height:450px;overflow:hidden"></iframe><p>En HTML5 canvas :-) http://www.codeproject.com/Articles/396959/Mario5</p>');
            e.preventDefault()
        });
    }
</script>
</div>				</div> <!-- end #content-area -->	
	
<div id="sidebar" class="clearfix">
	<div id="widget-readability-buttons-id-2" class="widget sidebar-block widget-readability-buttons"><!-- This file is used to markup the public facing widget. -->
<h3 class="widgettitle">Une lecture plus fastoche ?</h3><p class="readability-wrapper"> 
  <div
    class="rdbWrapper"
    data-show-read="1"
    data-show-send-to-kindle="0"
    data-show-print="1"
    data-show-email="0"
    data-orientation="0"
    data-version="1"
    data-text-color="#"
    data-bg-color="#">
  </div>
  <script>(function() {var s = document.getElementsByTagName("script")[0],rdb = document.createElement("script"); rdb.type = "text/javascript"; rdb.async = true; rdb.src = document.location.protocol + "//www.readability.com/embed.js"; s.parentNode.insertBefore(rdb, s); })();</script>
</p></div> <!-- end .widget --><div id="text-7" class="widget sidebar-block widget_text"><h3 class="widgettitle"> </h3>			<div class="textwidget"><img src="http://www.adobe.com/images/pdficon_small.png" width="16" height="16"/> <a href="http://pdfcrowd.com/url_to_pdf/">Télécharger cette page en PDF</a> </div>
		</div> <!-- end .widget --><div id="text-4" class="widget sidebar-block widget_text"><h3 class="widgettitle"> </h3>			<div class="textwidget"><a href="http://sametmax.com/appel-a-contributeurs-impertinents/"><img src="http://sametmax.com/wp-content/uploads/2012/07/contributeur.png" width="288px" style="vertical-align: middle;margin-top:-40px;margin-bottom:10px;"></a> </div>
		</div> <!-- end .widget --><div id="text-3" class="widget sidebar-block widget_text"><h3 class="widgettitle"> </h3>			<div class="textwidget"><a href="http://twitter.com/#!/sam_et_max"><img src="http://sametmax.com/wp-content/uploads/2012/05/twitter_icon.png" width="70px" style="vertical-align: middle;margin-top:-40px;"></a>&nbsp;Follow us <a href="http://twitter.com/sam_et_max">@sam_et_max</a></div>
		</div> <!-- end .widget --><div id="blog_subscription-3" class="widget sidebar-block jetpack_subscription_widget"><h3 class="widgettitle"><label for="subscribe-field">Souscrire à nos conneries</label></h3>
		<form action="" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-3">
			<p id="subscribe-text">Entrez votre adresse mail et vous recevrez une notification à chaque nouvel article.</p><p>Rejoignez les 343 abonnés</p>

			<p id="subscribe-email"><input type="text" placeholder="françis@ça-mousse.com" name="email" style="width: 95%; padding: 1px 2px" id="subscribe-field" onclick="if ( this.value == 'Email Address' ) { this.value = ''; }" onblur="if ( this.value == '' ) { this.value = 'Email Address'; }" /></p>

			<p id="subscribe-submit">
				<input type="hidden" name="action" value="subscribe" />
				<input type="hidden" name="source" value="http://sametmax.com/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/" />
				<input type="hidden" name="sub-type" value="widget" />
				<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
								<input type="submit" value="J&#039;adhère bon dieu!" name="jetpack_subscriptions_widget" />
			</p>
		</form>

		
</div> <!-- end .widget --> 

	<div id="popular-tabbed" class="widget"> 
		<h3 class="widgettitle">Posts Populaires</h3>
		<ul>
																						<li><a href="http://sametmax.com/on-a-un-nouveau-projet-et-on-a-besoin-dune-info-sur-vous/">On a un nouveau projet et on a besoin d&#8217;UNE info sur vous</a> (267)</li>																														<li><a href="http://sametmax.com/entreprendre-en-france-autopsie-dun-echec/">Entreprendre en France, Autopsie d&#8217;un échec.</a> (114)</li>																														<li><a href="http://sametmax.com/un-gros-troll-de-plus-sur-javacscript/">Un gros Troll de plus sur Javascript</a> (109)</li>																														<li><a href="http://sametmax.com/fizzbuzz-en-python/">FizzBuzz en Python</a> (99)</li>																														<li><a href="http://sametmax.com/beaucoup-de-femmes-sont-de-mauvais-coups/">Beaucoup de femmes sont de mauvais coups</a> (97)</li>																														<li><a href="http://sametmax.com/une-journee-dans-un-fkk-maison-close-allemande/">Une journée dans un FKK (maison close Allemande)</a> (91)</li>																														<li><a href="http://sametmax.com/fetons-le-depart-de-max/">Fêtons le départ de Max</a> (87)</li>																														<li><a href="http://sametmax.com/on-est-en-2013-on-a-marche-sur-la-lune-mais-on-a-toujours-pas/">On est en 2013, on a marché sur la lune, mais on a toujours pas&#8230;</a> (85)</li>													</ul>
	</div> <!-- end #recent-tabbed -->
	 
<div id="tag_cloud-3" class="widget sidebar-block widget_tag_cloud"><h3 class="widgettitle">TagCloud</h3><div class="tagcloud"><a href='http://sametmax.com/tag/bash/' class='tag-link-14' title='16 topics' style='font-size: 11.185628742515pt;'>bash</a>
<a href='http://sametmax.com/tag/bitcoin/' class='tag-link-320' title='6 topics' style='font-size: 8pt;'>bitcoin</a>
<a href='http://sametmax.com/tag/blog/' class='tag-link-107' title='17 topics' style='font-size: 11.437125748503pt;'>blog</a>
<a href='http://sametmax.com/tag/bottle/' class='tag-link-307' title='6 topics' style='font-size: 8pt;'>bottle</a>
<a href='http://sametmax.com/tag/cache/' class='tag-link-333' title='10 topics' style='font-size: 9.5928143712575pt;'>cache</a>
<a href='http://sametmax.com/tag/comprehension-lists/' class='tag-link-20' title='7 topics' style='font-size: 8.4191616766467pt;'>comprehension-lists</a>
<a href='http://sametmax.com/tag/css/' class='tag-link-188' title='8 topics' style='font-size: 8.8383233532934pt;'>css</a>
<a href='http://sametmax.com/tag/cul-2/' class='tag-link-33' title='10 topics' style='font-size: 9.5928143712575pt;'>cul</a>
<a href='http://sametmax.com/tag/decorator/' class='tag-link-265' title='7 topics' style='font-size: 8.4191616766467pt;'>decorator</a>
<a href='http://sametmax.com/tag/django/' class='tag-link-28' title='72 topics' style='font-size: 16.467065868263pt;'>django</a>
<a href='http://sametmax.com/tag/email/' class='tag-link-37' title='6 topics' style='font-size: 8pt;'>email</a>
<a href='http://sametmax.com/tag/encoding/' class='tag-link-54' title='7 topics' style='font-size: 8.4191616766467pt;'>encoding</a>
<a href='http://sametmax.com/tag/error/' class='tag-link-213' title='6 topics' style='font-size: 8pt;'>error</a>
<a href='http://sametmax.com/tag/fun/' class='tag-link-44' title='6 topics' style='font-size: 8pt;'>fun</a>
<a href='http://sametmax.com/tag/git/' class='tag-link-18' title='32 topics' style='font-size: 13.616766467066pt;'>git</a>
<a href='http://sametmax.com/tag/html/' class='tag-link-486' title='7 topics' style='font-size: 8.4191616766467pt;'>html</a>
<a href='http://sametmax.com/tag/http/' class='tag-link-204' title='7 topics' style='font-size: 8.4191616766467pt;'>http</a>
<a href='http://sametmax.com/tag/import/' class='tag-link-215' title='8 topics' style='font-size: 8.8383233532934pt;'>import</a>
<a href='http://sametmax.com/tag/ipython/' class='tag-link-164' title='9 topics' style='font-size: 9.2574850299401pt;'>ipython</a>
<a href='http://sametmax.com/tag/iterable/' class='tag-link-217' title='9 topics' style='font-size: 9.2574850299401pt;'>iterable</a>
<a href='http://sametmax.com/tag/javascript/' class='tag-link-96' title='37 topics' style='font-size: 14.119760479042pt;'>javascript</a>
<a href='http://sametmax.com/tag/jquery/' class='tag-link-112' title='8 topics' style='font-size: 8.8383233532934pt;'>jquery</a>
<a href='http://sametmax.com/tag/lambda/' class='tag-link-292' title='7 topics' style='font-size: 8.4191616766467pt;'>lambda</a>
<a href='http://sametmax.com/tag/linux/' class='tag-link-238' title='6 topics' style='font-size: 8pt;'>linux</a>
<a href='http://sametmax.com/tag/meta/' class='tag-link-102' title='98 topics' style='font-size: 17.640718562874pt;'>meta</a>
<a href='http://sametmax.com/tag/mysql/' class='tag-link-82' title='7 topics' style='font-size: 8.4191616766467pt;'>mysql</a>
<a href='http://sametmax.com/tag/nginx/' class='tag-link-183' title='13 topics' style='font-size: 10.51497005988pt;'>nginx</a>
<a href='http://sametmax.com/tag/nsfw/' class='tag-link-319' title='14 topics' style='font-size: 10.766467065868pt;'>nsfw</a>
<a href='http://sametmax.com/tag/php/' class='tag-link-199' title='6 topics' style='font-size: 8pt;'>php</a>
<a href='http://sametmax.com/tag/poo/' class='tag-link-549' title='12 topics' style='font-size: 10.179640718563pt;'>poo</a>
<a href='http://sametmax.com/tag/python/' class='tag-link-4' title='329 topics' style='font-size: 22pt;'>python</a>
<a href='http://sametmax.com/tag/redis/' class='tag-link-196' title='7 topics' style='font-size: 8.4191616766467pt;'>redis</a>
<a href='http://sametmax.com/tag/ruby/' class='tag-link-325' title='8 topics' style='font-size: 8.8383233532934pt;'>ruby</a>
<a href='http://sametmax.com/tag/server/' class='tag-link-185' title='6 topics' style='font-size: 8pt;'>server</a>
<a href='http://sametmax.com/tag/sexe/' class='tag-link-175' title='6 topics' style='font-size: 8pt;'>sexe</a>
<a href='http://sametmax.com/tag/shell/' class='tag-link-202' title='8 topics' style='font-size: 8.8383233532934pt;'>shell</a>
<a href='http://sametmax.com/tag/ssh/' class='tag-link-206' title='6 topics' style='font-size: 8pt;'>ssh</a>
<a href='http://sametmax.com/tag/sublime-text/' class='tag-link-76' title='8 topics' style='font-size: 8.8383233532934pt;'>sublime text</a>
<a href='http://sametmax.com/tag/twitter/' class='tag-link-371' title='7 topics' style='font-size: 8.4191616766467pt;'>twitter</a>
<a href='http://sametmax.com/tag/ubuntu/' class='tag-link-255' title='13 topics' style='font-size: 10.51497005988pt;'>ubuntu</a>
<a href='http://sametmax.com/tag/unicode/' class='tag-link-53' title='6 topics' style='font-size: 8pt;'>unicode</a>
<a href='http://sametmax.com/tag/unit-tests/' class='tag-link-302' title='6 topics' style='font-size: 8pt;'>unit tests</a>
<a href='http://sametmax.com/tag/unpacking/' class='tag-link-180' title='6 topics' style='font-size: 8pt;'>unpacking</a>
<a href='http://sametmax.com/tag/virtualenv/' class='tag-link-259' title='7 topics' style='font-size: 8.4191616766467pt;'>virtualenv</a>
<a href='http://sametmax.com/tag/yield/' class='tag-link-287' title='8 topics' style='font-size: 8.8383233532934pt;'>yield</a><div class="tag_cloud_footer"><a href="/les-tags/">All Tags</a></div></div>
</div> <!-- end .widget --><div id="archives-2" class="widget sidebar-block widget_archive"><h3 class="widgettitle">Archives</h3>		<ul>
			<li><a href='http://sametmax.com/2014/07/' title='July 2014'>July 2014</a>&nbsp;(10)</li>
	<li><a href='http://sametmax.com/2014/06/' title='June 2014'>June 2014</a>&nbsp;(25)</li>
	<li><a href='http://sametmax.com/2014/05/' title='May 2014'>May 2014</a>&nbsp;(14)</li>
	<li><a href='http://sametmax.com/2014/04/' title='April 2014'>April 2014</a>&nbsp;(10)</li>
	<li><a href='http://sametmax.com/2014/03/' title='March 2014'>March 2014</a>&nbsp;(23)</li>
	<li><a href='http://sametmax.com/2014/02/' title='February 2014'>February 2014</a>&nbsp;(27)</li>
	<li><a href='http://sametmax.com/2014/01/' title='January 2014'>January 2014</a>&nbsp;(17)</li>
	<li><a href='http://sametmax.com/2013/12/' title='December 2013'>December 2013</a>&nbsp;(27)</li>
	<li><a href='http://sametmax.com/2013/11/' title='November 2013'>November 2013</a>&nbsp;(25)</li>
	<li><a href='http://sametmax.com/2013/10/' title='October 2013'>October 2013</a>&nbsp;(27)</li>
	<li><a href='http://sametmax.com/2013/09/' title='September 2013'>September 2013</a>&nbsp;(1)</li>
	<li><a href='http://sametmax.com/2013/08/' title='August 2013'>August 2013</a>&nbsp;(31)</li>
	<li><a href='http://sametmax.com/2013/07/' title='July 2013'>July 2013</a>&nbsp;(32)</li>
	<li><a href='http://sametmax.com/2013/06/' title='June 2013'>June 2013</a>&nbsp;(24)</li>
	<li><a href='http://sametmax.com/2013/05/' title='May 2013'>May 2013</a>&nbsp;(30)</li>
	<li><a href='http://sametmax.com/2013/04/' title='April 2013'>April 2013</a>&nbsp;(31)</li>
	<li><a href='http://sametmax.com/2013/03/' title='March 2013'>March 2013</a>&nbsp;(33)</li>
	<li><a href='http://sametmax.com/2013/02/' title='February 2013'>February 2013</a>&nbsp;(29)</li>
	<li><a href='http://sametmax.com/2013/01/' title='January 2013'>January 2013</a>&nbsp;(34)</li>
	<li><a href='http://sametmax.com/2012/12/' title='December 2012'>December 2012</a>&nbsp;(32)</li>
	<li><a href='http://sametmax.com/2012/11/' title='November 2012'>November 2012</a>&nbsp;(36)</li>
	<li><a href='http://sametmax.com/2012/10/' title='October 2012'>October 2012</a>&nbsp;(35)</li>
	<li><a href='http://sametmax.com/2012/09/' title='September 2012'>September 2012</a>&nbsp;(36)</li>
	<li><a href='http://sametmax.com/2012/08/' title='August 2012'>August 2012</a>&nbsp;(37)</li>
	<li><a href='http://sametmax.com/2012/07/' title='July 2012'>July 2012</a>&nbsp;(33)</li>
	<li><a href='http://sametmax.com/2012/06/' title='June 2012'>June 2012</a>&nbsp;(24)</li>
	<li><a href='http://sametmax.com/2012/05/' title='May 2012'>May 2012</a>&nbsp;(31)</li>
	<li><a href='http://sametmax.com/2012/04/' title='April 2012'>April 2012</a>&nbsp;(20)</li>
	<li><a href='http://sametmax.com/2012/03/' title='March 2012'>March 2012</a>&nbsp;(10)</li>
	<li><a href='http://sametmax.com/2012/02/' title='February 2012'>February 2012</a>&nbsp;(14)</li>
		</ul>
</div> <!-- end .widget --><div id="rss_links-2" class="widget sidebar-block widget_rss_links"><h3 class="widgettitle">Flux RSS</h3><p><a href="http://sametmax.com/feed/" title="Subscribe to Posts"><img src="http://sametmax.com/wp-content/plugins/jetpack/_inc/images/rss/green-small.png" alt="RSS Feed" /></a>&nbsp;<a href="http://sametmax.com/feed/" title="Subscribe to Posts">RSS - Posts</a></p>
</div> <!-- end .widget --><div id="text-6" class="widget sidebar-block widget_text"><h3 class="widgettitle">Planet Python fr</h3>			<div class="textwidget"><a href="http://sametmax.com/planet-python-fr/">Sélection d'articles sur Python du Web français</a></div>
		</div> <!-- end .widget --><div id="text-5" class="widget sidebar-block widget_text"><h3 class="widgettitle"> Envoyez des sioux</h3>			<div class="textwidget"><p><img src="http://sametmax.com/wp-content/uploads/2013/07/bitcoin.png" width="16" height="16"/> On adooooore les bitcoins :</p>

<p>

<a href="bitcoin:19zAHPPuce4BAhsdy9KaFwVLurEJXMhMAn?amount=1X8&label=SamEtMax">19zAHPPuce4BAhsdy9KaFwVLurEJXMhMAn</a>

</p></div>
		</div> <!-- end .widget --></div> <!-- end sidebar -->	</div> <!-- end #content --> 
	
	 <div id="footer" >
		<div id="footer-content">
			
								
				<ul id="menu-bottom-menu" class="bottom-menu"><li id="menu-item-2391" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2391"><a href="http://sametmax.com/contactez-nous/">Contactez-nous</a></li>
</ul>			
			<p id="copyright">Designed by  <a href="http://www.elegantthemes.com" title="Elegant Themes">Elegant WordPress Themes</a></p>
		</div> <!-- end #footer-content -->
	</div> <!-- end #footer -->
</div> <!-- end #page-wrap -->
	 
				
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>
	<script type="text/javascript" src="http://sametmax.com/wp-content/themes/Minimal/js/jquery.cycle.all.min.js"></script> 
	<script type="text/javascript" src="http://sametmax.com/wp-content/themes/Minimal/js/jquery.easing.1.3.js"></script>	
	<script type="text/javascript" src="http://sametmax.com/wp-content/themes/Minimal/js/superfish.js"></script>	
	<script type="text/javascript">
	//<![CDATA[
		jQuery.noConflict();
	
		jQuery('ul.superfish').superfish({ 
			delay:       200,                            // one second delay on mouseout 
			animation:   {opacity:'show',height:'show'},  // fade-in and slide-down animation 
			speed:       'fast',                          // faster animation speed 
			autoArrows:  true,                           // disable generation of arrow mark-up 
			dropShadows: false                            // disable drop shadows 
		}).find("> li > ul > li:last-child, > li > ul > li > ul > li:last-child, > li > ul > li > ul > li > ul > li:last-child").addClass("last-nav-element");
		
		jQuery(".js #featured, .js div#tabbed").css("display","block");

				
		var $featured_content = jQuery('#featured_content'),
			$tabbed_area = jQuery('div#tabbed'),
			$controllers = jQuery('div#controllers'),
			$comments = jQuery('ol.commentlist');
		
		et_search_bar();
		
		if ($featured_content.length) {
			$featured_content.cycle({
									timeout: 3000				,
				speed: 300,
				cleartypeNoBg: true,
				prev:   'a#left_arrow', 
				next:   'a#right_arrow',
				pager:  'div#controllers',
				fx: 'fade'
			});
			
			var controllersWidth = $controllers.width(),
				controllersLeft = Math.round((960 - controllersWidth) / 2);
			if (controllersWidth < 960) $controllers.css('padding-left',controllersLeft);
		};
		
		if ($tabbed_area.length) {
			$tabbed_area.tabs({ fx: { opacity: 'toggle' } });
		};
		
		if ($comments.length) {
			$comments.find(">li").after('<span class="bottom_bg"></span>');
		};
		

		<!---- Random tag line ---->		

var tagLine = function(){
    var tagLines =  [
        'Deux programmeurs qui se sortent les doigts du code',
        '10 ko de js rien que pour charger ce message',
        'Des articles pour geeks qui mettent les points sur les G',
        "Aucun hipster n'a été violenté à l'écriture de ce blog",
        'La programmation avec un grand C',
        'Ornithorynque fuchsia hydrophobe',
        'Python, Django, Git, et du Cul',
        'Nous croisons les effluves',
        'CMB DTC IRL CQFD',
        'Tuent des chatons depuis 1997',
        'Reticulating splines',
        'Error: unexpected end of stupid tag line',
        'Les bikinis et les ordinateurs épargnent les spéculations',
        'F5',
        '<3 (oYo)',
        'Rien que des obsédés du serpent !',
        "Je sers la science et c'est ma joie",
        'On peut tout génie génétiquer!',
        "Réparateurs d'harmonicas, professeurs de plongée",
        "Il faut mettre d'urgence un frein à l'immobilisme!",
        'Ho mon dieu! Ils ont tué Sam, enfoirés!',
        "L'étincelle qui fait déborder le vase",
        'A poil les putes !',
        'Bannis de Reddit !',
        "Bannis de l'AFPY !",
        'Bannis de Claire Chazal!',
        'Bannis de Jean-Pierre Pernaud !',
        'Bannis de Norton !',
        'Et si on faisait des camps pour que les gens puissent se concentrer?',
        'Article.objects.create(type=random.choice(("dev", "cul")))',
        'Le choc des mots, le poids des algos',
        'Kedzalcoilt, le serpent à poil'
    ];
    return tagLines[Math.ceil(Math.random() * 1000000000) % tagLines.length];
};

jQuery('#slogan').show().text(tagLine());

// forcer la redirection faire l'image en full size au click
jQuery('.wp-post-image').click(function(e){e.preventDefault(); window.location.href = jQuery(e.target).attr('src')});

// mettre clippy sur les comments

jQuery(function(){
    var message = "";
    var $comment = jQuery('#comment');
    topagent = null;

    $comment.keyup(function(){

        var content = jQuery(this).val();

        if (content.search(/(^|\s+)(php|vim|emacs|windows|pas?\s*libre)([.!?]|\s+)/i) != -1){
            message = "Il semble que vous teniez de propos trollesques. Attention, nous avons des tampons, et nous n'hésiterons pas à nous en servir !"
        }

        if (content.search(/(^|\s+)(me (tuer|suicider|tirer une balle|pendre|flinguer))([.!?]|\s+)/i) != -1){
            message = "Il semble que vous teniez de propos suicidaires. Sam & Max défendent la liberté d'expression. Allez aux bouts de vos idées !"
        }

        if (content.search(/(^|\s+)(connards?|enculés?|enfoirés?|fils? de pute?)([.!?]|\s+)/i) != -1){
            message = "Il semble que vous teniez des propos injurieux. Ne voulez-vous pas plutôt écrire une lettre d'insultes directement aux auteurs, via le formulaire de contact ?"
        }

        if (content.search(/(^|\s+)(culs?|nichons?|bite|chatte|sodomie|levrette|sexe)([.!?]|\s+)/i) != -1){
            message = "Il semble que vous teniez des propos graveleux. Pourriez-vous donner plus de détails ?"
        }

        if (content.search(/\>\>\>/i) != -1){
            message = "Le triple chevron ne passe pas dans les comments. Désolé :-( Utilisez »» à la place."
        }

        if (content.length > 2000){
            message = "Il semble que vous écriviez un roman. Vous réalisez que ceux qui vont répondre ne l'auront pas lu jusqu'au bout ?"
        }

        if (message){
            $comment.unbind();

            jQuery("<link/>", {
               rel: "stylesheet",
               type: "text/css",
               href: "http://sametmax.com/wp-content/uploads/2012/07/clippy.css"
            }).appendTo("head").one('load ready', function(){
                jQuery.getScript("http://sametmax.com/wp-content/uploads/2012/07/clippy.min_1.js", function(){
                    clippy.load('Clippy', function(agent) {
                        agent.show();
                        var offset = $comment.offset();
                        var left = offset.left + $comment.width() + 10;
                        var top = offset.top;

                        jQuery('.clippy').css({position:'absolute',
                                               display:'block',
                                               left: left, top: top})

                        jQuery('.clippy-balloon').css({position:'absolute',
                                                       display:'block',
                                                       left: left,
                                                       top: top - 50})

                        agent.speak(message);
                        setInterval(function(){agent.stop(); agent.animate()}, 20000);
                    });

                });

            });

        }

    });
});


		<!---- Search Bar Improvements ---->
		function et_search_bar(){
			var $searchform = jQuery('#header div#search-form'),
				$searchinput = $searchform.find("input#searchinput"),
				searchvalue = $searchinput.val();
				
			$searchinput.focus(function(){
				if (jQuery(this).val() === searchvalue) jQuery(this).val("");
			}).blur(function(){
				if (jQuery(this).val() === "") jQuery(this).val(searchvalue);
			});
		};
		
	//]]>	




<!-- Piwik -->

var pkBaseURL = (("https:" == document.location.protocol) ? "https://88.191.153.127:7777/" : "http://88.191.153.127:7777/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}



	</script>
<noscript>
<img src="http://88.191.153.127:7777/piwik.php?idsite=1&amp;rec=1" style="border:0" alt="" />
</noscript>
		<div style="display:none">
	<div class="grofile-hash-map-b6ef160822bd8bb88ca28e0e5bcc62d0">
	</div>
	<div class="grofile-hash-map-fbc2071b5de7b18c1f08dbf569886fff">
	</div>
	<div class="grofile-hash-map-9165f021b46958f7eaf9398591ee1d5e">
	</div>
	<div class="grofile-hash-map-c5df2a9b2b3e1897bf84b85e84dcd4ee">
	</div>
	<div class="grofile-hash-map-bf9ecde8f5e286de6ce5c80206cf9dd6">
	</div>
	<div class="grofile-hash-map-235f5f4ffd3736018800ef8064551a3f">
	</div>
	<div class="grofile-hash-map-f6d78ffbc6b66f7806839688ec57f27d">
	</div>
	<div class="grofile-hash-map-c321fbc4a92a34254bd9596960e27236">
	</div>
	<div class="grofile-hash-map-e5176cded08b65b91099dc61f31d43c8">
	</div>
	<div class="grofile-hash-map-b93cc4fb6413bbe5c837530662bee9b4">
	</div>
	<div class="grofile-hash-map-c4825da112287158f6b0ac9ef3ac1f04">
	</div>
	<div class="grofile-hash-map-5e27901840ca85707727f5ed339ad31f">
	</div>
	</div>
		<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
					<script type="text/javascript">
			  (function() {
			    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
			    po.src = 'https://apis.google.com/js/plusone.js';
			    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
			  })();
			</script>
				<div id="sharing_email" style="display: none;">
		<form action="/deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange/" method="post">
			<label for="target_email">Send to Email Address</label>
			<input type="text" name="target_email" id="target_email" value="" />

			
				<label for="source_name">Your Name</label>
				<input type="text" name="source_name" id="source_name" value="" />

				<label for="source_email">Your Email Address</label>
				<input type="text" name="source_email" id="source_email" value="" />

			
			
			<img style="float: right; display: none" class="loading" src="http://sametmax.com/wp-content/plugins/jetpack/modules/sharedaddy/images/loading.gif" alt="loading" width="16" height="16" />
			<input type="submit" value="Send Email" class="sharing_send" />
			<a href="#cancel" class="sharing_cancel">Cancel</a>

			<div class="errors errors-1" style="display: none;">
				Post was not sent - check your email addresses!			</div>

			<div class="errors errors-2" style="display: none;">
				Email check failed, please try again			</div>

			<div class="errors errors-3" style="display: none;">
				Sorry, your blog cannot share posts by email.			</div>
		</form>
	</div>
					<script type="text/javascript">
				// Pinterest shared resources
				var s = document.createElement("script");
				s.type = "text/javascript";
				s.async = true;
				s.src = window.location.protocol + "//assets.pinterest.com/js/pinit.js";
				var x = document.getElementsByTagName("script")[0];
				x.parentNode.insertBefore(s, x);
				// if 'Pin it' button has 'counts' make container wider
				jQuery(window).load( function(){ jQuery( 'li.share-pinterest a span:visible' ).closest( '.share-pinterest' ).width( '80px' ); } );
			</script>
		<script type="text/javascript" src="http://platform.tumblr.com/v1/share.js"></script>		<script>
		// Don't use Pocket's default JS as it we need to force init new Pocket share buttons loaded via JS.
		function jetpack_sharing_pocket_init() {
			jQuery.getScript( 'https://widgets.getpocket.com/v1/j/btn.js?v=1' );
		}
		jQuery( document ).on( 'ready', jetpack_sharing_pocket_init );
		jQuery( document.body ).on( 'post-load', jetpack_sharing_pocket_init );
		</script>
		<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/contact-form-7/includes/js/jquery.form.min.js?ver=3.15'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var _wpcf7 = {"loaderUrl":"http:\/\/sametmax.com\/wp-content\/plugins\/contact-form-7\/images\/ajax-loader.gif","sending":"Sending ..."};
/* ]]> */
</script>
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=3.3'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201430'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pollsL10n = {"ajax_url":"http:\/\/sametmax.com\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/wp-polls/polls-js.js?ver=2.63'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2014Julaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.3.1'></script>
<script type='text/javascript' src='http://sametmax.com/wp-content/themes/Minimal/epanel/page_templates/js/fancybox/jquery.easing-1.3.pack.js?ver=1.3.4'></script>
<script type='text/javascript' src='http://sametmax.com/wp-content/themes/Minimal/epanel/page_templates/js/fancybox/jquery.fancybox-1.3.4.pack.js?ver=1.3.4'></script>
<script type='text/javascript' src='http://sametmax.com/wp-content/themes/Minimal/epanel/page_templates/js/et-ptemplates-frontend.js?ver=1.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var recaptcha_options = {"lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='http://sametmax.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.js?ver=20121205'></script>

	<script src="http://stats.wordpress.com/e-201430.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:2.6.1',blog:'32490438',post:'10418',tz:'0'});
	var load_cmc = function(){linktracker_init(32490438,10418,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script>	
</body>
</html>
