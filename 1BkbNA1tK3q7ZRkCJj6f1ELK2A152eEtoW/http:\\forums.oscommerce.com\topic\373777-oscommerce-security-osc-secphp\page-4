http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4
HTTP/1.1 200 OK
Server: nginx
Date: Thu, 24 Jul 2014 04:23:42 GMT
Content-Type: text/html;charset=UTF-8
Connection: close
Set-Cookie: session_id=c1a85dbd6a2de7a7e13404a0728c85e0; path=/; domain=.oscommerce.com; httponly
Set-Cookie: modpids=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; domain=.oscommerce.com
Cache-Control: no-cache, must-revalidate, max-age=0
Expires: Wed, 23 Jul 2014 04:23:42 GMT
Pragma: no-cache
Content-Encoding: gzip
Vary: Accept-Encoding

<!DOCTYPE html>
	<html lang="en"  xmlns:fb="http://www.facebook.com/2008/fbml">
	<head>
		<meta charset="UTF-8" />
		<title>Oscommerce Security - Osc_Sec.php - Page 4 - Security - osCommerce Support Forum</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<link rel="shortcut icon" href='http://forums.oscommerce.com/favicon.ico' />
		<link rel="image_src" href='http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png' />
		<script type='text/javascript'>
		//<![CDATA[
			jsDebug			= 0; /* Must come before JS includes */
			DISABLE_AJAX	= parseInt(0); /* Disables ajax requests where text is sent to the DB; helpful for charset issues */
			inACP			= false;
			var isRTL		= false;
			var rtlIe		= '';
			var rtlFull		= '';
		//]]>
		</script>
		
	
				
			<link rel="stylesheet" type="text/css" title="Main" media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/calendar_select.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_common.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_styles.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css"  href="http://forums.oscommerce.com/public/style_css/prettify.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	
	

<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" title='Main' media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_ie.css" />
<![endif]-->
<!--[if lte IE 8]>
	<style type='text/css'>
		.ipb_table { table-layout: fixed; }
		.ipsLayout_content { width: 99.5%; }
	</style>
<![endif]-->

	<style type='text/css'>
		img.bbc_img { max-width: 100% !important; }
	</style>

		<meta property="og:title" content="Oscommerce Security - Osc_Sec.php - Page 4 - Security"/>
		<meta property="og:site_name" content="osCommerce Support Forum"/>
		<meta property="og:type" content="article" />
		
	
		
		
			<meta property="og:updated_time" content="1306062383" />
		
		
		
		
	

		
		
			<meta name="keywords" content="Oscommerce,Security,Osc_Secphp,HiI,installed,OSC_SEC,25r2,nearly,ready,German,shop,/thumbsupgif&#039;,class=&#039;bbc_emoticon&#039;,alt=&#039;thumbsup&#039;,May,please,change,GETcleanup,filter,because,filters" />
		
		
		
		
	

		
		
			<meta name="description" content="Page 4 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: Hi&#33;I just installed OSC_SEC 2.5r2 on my nearly ready German shop.  /thumbsup.gif class=bbc_emoticon alt=:thumbsup: /> May you please change the  &#036;GETcleanup filter, because it filters German umlauts, like ö Ö ä Ä Ü ü if set to &#036;GETcleanup = 1This is the same if the umlauts are html coded, eg. ü = &amp;uuml;  Thank you in advance.Regards" />
		
		
		
			<meta property="og:description" content="Page 4 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: Hi&#33;I just installed OSC_SEC 2.5r2 on my nearly ready German shop.  /thumbsup.gif class=bbc_emoticon alt=:thumbsup: /> May you please change the  &#036;GETcleanup filter, because it filters German umlauts, like ö Ö ä Ä Ü ü if set to &#036;GETcleanup = 1This is the same if the umlauts are html coded, eg. ü = &amp;uuml;  Thank you in advance.Regards" />
		
		
	

		
		
			<meta name="identifier-url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" />
		
		
			<meta property="og:url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" />
		
		
		
	

<meta property="og:image" content="http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png"/>
		
		
		
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prototype.js'></script>
	
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/ipb.js?ipbv=f0051d8914fe132bc0130fe6bbd729c6&amp;load=quickpm,hovercard,sharelinks,topic,rating,like'></script>
	
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/scriptaculous/scriptaculous-cache.js'></script>
	
	<script type="text/javascript" src='http://forums.oscommerce.com/cache/lang_cache/1/ipb.lang.js?nck=fb99e14e49767998a66e3b7a9956074d' charset='UTF-8'></script>


	
		
			
			
			
			
				<link id="ipsCanonical" rel="canonical" href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" />
			
		

			
			
			
			
				<link rel='stylesheet' type='text/css' title='Main' media='print' href='http://forums.oscommerce.com/public/style_css/css_1/ipb_print.css' />
			
		

			
			
			
			
				<link rel='first' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' />
			
		

			
			
			
			
				<link rel='prev' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3' />
			
		

			
			
			
			
				<link rel='next' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5' />
			
		

			
			
			
			
				<link rel='last' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28' />
			
		

			
			
			
			
				<link rel='up' href='http://forums.oscommerce.com/forum/76-security/' />
			
		

			
			
			
			
				<link rel='author' href='http://forums.oscommerce.com/user/288489-taipo/' />
			
		
	

	



<script type='text/javascript'>
	//<![CDATA[
		/* ---- URLs ---- */
		ipb.vars['base_url'] 			= 'http://forums.oscommerce.com/index.php?s=c1a85dbd6a2de7a7e13404a0728c85e0&';
		ipb.vars['board_url']			= 'http://forums.oscommerce.com';
		ipb.vars['img_url'] 			= "http://forums.oscommerce.com/public/style_images/master";
		ipb.vars['loading_img'] 		= 'http://forums.oscommerce.com/public/style_images/master/loading.gif';
		ipb.vars['active_app']			= 'forums';
		ipb.vars['upload_url']			= 'http://forums.oscommerce.com/uploads';
		/* ---- Member ---- */
		ipb.vars['member_id']			= parseInt( 0 );
		ipb.vars['is_supmod']			= parseInt( 0 );
		ipb.vars['is_admin']			= parseInt( 0 );
		ipb.vars['secure_hash'] 		= '880ea6a14ea49e853634fbdc5015a024';
		ipb.vars['session_id']			= 'c1a85dbd6a2de7a7e13404a0728c85e0';
		ipb.vars['twitter_id']			= 0;
		ipb.vars['fb_uid']				= 0;
		ipb.vars['auto_dst']			= parseInt( 0 );
		ipb.vars['dst_in_use']			= parseInt(  );
		ipb.vars['is_touch']			= false;
		ipb.vars['member_group']		= {"g_mem_info":"1"}
		/* ---- cookies ----- */
		ipb.vars['cookie_id'] 			= '';
		ipb.vars['cookie_domain'] 		= '.oscommerce.com';
		ipb.vars['cookie_path']			= '/';
		/* ---- Rate imgs ---- */
		ipb.vars['rate_img_on']			= 'http://forums.oscommerce.com/public/style_images/master/star.png';
		ipb.vars['rate_img_off']		= 'http://forums.oscommerce.com/public/style_images/master/star_off.png';
		ipb.vars['rate_img_rated']		= 'http://forums.oscommerce.com/public/style_images/master/star_rated.png';
		/* ---- Uploads ---- */
		ipb.vars['swfupload_swf']		= 'http://forums.oscommerce.com/public/js/3rd_party/swfupload/swfupload.swf';
		ipb.vars['swfupload_enabled']	= true;
		ipb.vars['use_swf_upload']		= ( '' == 'flash' ) ? true : false;
		ipb.vars['swfupload_debug']		= false;
		/* ---- other ---- */
		ipb.vars['highlight_color']     = "#ade57a";
		ipb.vars['charset']				= "UTF-8";
		ipb.vars['time_offset']			= "0";
		ipb.vars['hour_format']			= "24";
		ipb.vars['seo_enabled']			= 1;
		
		ipb.vars['seo_params']			= {"start":"-","end":"\/","varBlock":"?","varPage":"page-","varSep":"&","varJoin":"="};
		
		/* Templates/Language */
		ipb.templates['inlineMsg']		= "";
		ipb.templates['ajax_loading'] 	= "<div id='ajax_loading'><img src='http://forums.oscommerce.com/public/style_images/master/ajax_loading.gif' alt='" + ipb.lang['loading'] + "' /></div>";
		ipb.templates['close_popup']	= "<img src='http://forums.oscommerce.com/public/style_images/master/close_popup.png' alt='x' />";
		ipb.templates['rss_shell']		= new Template("<ul id='rss_menu' class='ipbmenu_content'>#{items}</ul>");
		ipb.templates['rss_item']		= new Template("<li><a href='#{url}' title='#{title}'>#{title}</a></li>");
		
		ipb.templates['autocomplete_wrap'] = new Template("<ul id='#{id}' class='ipb_autocomplete' style='width: 250px;'></ul>");
		ipb.templates['autocomplete_item'] = new Template("<li id='#{id}' data-url='#{url}'><img src='#{img}' alt='' class='ipsUserPhoto ipsUserPhoto_mini' />&nbsp;&nbsp;#{itemvalue}</li>");
		ipb.templates['page_jump']		= new Template("<div id='#{id}_wrap' class='ipbmenu_content'><h3 class='bar'>Jump to page</h3><p class='ipsPad'><input type='text' class='input_text' id='#{id}_input' size='8' /> <input type='submit' value='Go' class='input_submit add_folder' id='#{id}_submit' /></p></div>");
		ipb.templates['global_notify'] 	= new Template("<div class='popupWrapper'><div class='popupInner'><div class='ipsPad'>#{message} #{close}</div></div></div>");
		
		
		ipb.templates['header_menu'] 	= new Template("<div id='#{id}' class='ipsHeaderMenu boxShadow'></div>");
		
		Loader.boot();
	//]]>
	</script>
	</head>
	<body id='ipboard_body'>
		<p id='content_jump' class='hide'><a id='top'></a><a href='#j_content' title='Jump to content' accesskey='m'>Jump to content</a></p>
		<div id='ipbwrapper'>
			<!-- ::: TOP BAR: Sign in / register or user drop down and notification alerts ::: -->
			<div id='header_bar' class='clearfix'>
				<div class='main_width'>
					<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	$('nav_app_ipchat').down('a').observe( 'click', function(e) {
		var _chatUrl	= $('nav_app_ipchat').down('a').href;
	
		if( _chatUrl.charAt( _chatUrl.length - 1 ) == '#' )
		{
			_chatUrl	= _chatUrl.substr( 0, _chatUrl.length - 1 );
		}
	
		if( _chatUrl.indexOf('?') != '-1' )
		{
			_chatUrl	+= '&_popup=1';
		}
		else
		{
			_chatUrl	+= '?_popup=1';
		}
		
		window.open( _chatUrl, "chatpopout", "status=0,toolbar=0,location=1,menubar=0,directories=0,resizable=1,scrollbars=1,height=550,width=750" );
		
		Event.stop(e);
		return false;
	});
});
</script>
					<div id='user_navigation' class='not_logged_in'>
							
							<ul class='ipsList_inline right'>
								<li>
									<span class='services'>
										
										
										
									</span>
									&nbsp;&nbsp;&nbsp;&nbsp;
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login' title='Sign In' id='sign_in'>Sign In</a>&nbsp;&nbsp;&nbsp;
								</li>
								<li>
									<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Create Account' id='register_link'>Create Account</a>
								</li>
							</ul>
						</div>
				</div>
			</div>
			<!-- ::: BRANDING STRIP: Logo and search box ::: -->
			<div id='branding'>
				<div class='main_width'>
					<div id='logo'>
						
<div id='chat-tab-count-wrap'><span id='chat-tab-count' class='ipsHasNotifications' title='' style='display:none;'>1</span></div>
<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	var _thisHtml	= $('nav_app_ipchat').down('a').innerHTML;
	_thisHtml = _thisHtml + $('chat-tab-count-wrap').innerHTML;
	$('nav_app_ipchat').down('a').update( _thisHtml ).setStyle( { position: 'relative' } );
	$('chat-tab-count-wrap').remove();
	$('chat-tab-count').show();
});
</script>

							<a href='http://forums.oscommerce.com' title='Go to community index' rel="home" accesskey='1'><img src='http://forums.oscommerce.com/public/style_images/1_oscommerce_white_fill.png' alt='Logo' /></a>
						
					</div>
					
						<div id='search' class='right'>
	<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=search&amp;fromMainBar=1" method="post" id='search-box' >
		<fieldset>
			<label for='main_search' class='hide'>Search</label>
			<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;search_in=forums' title='Advanced Search' accesskey='4' rel="search" id='adv_search' class='right'>Advanced</a>
			<span id='search_wrap' class='right'>
				<input type='text' id='main_search' name='search_term' class='inactive' size='17' tabindex='100' />
				<span class='choice ipbmenu clickable' id='search_options' style='display: none'></span>
				<ul id='search_options_menucontent' class='ipbmenu_content ipsPad' style='display: none'>
					<li class='title'><strong>Search section:</strong></li>
					<li class='special'>
							<label for='s_topic' title='This topic'>
								<input type='radio' name='search_app' value="forums:topic:373777" class='input_radio' id='s_topic' checked="checked" /><strong>This topic</strong>
							</label>
						</li>
					
					
					<li class='app'><label for='s_forums' title='Forums'><input type='radio' name='search_app' class='input_radio' id='s_forums' value="forums"  />Forums</label></li>
					<li class='app'><label for='s_members' title='Members'><input type='radio' name='search_app' class='input_radio' id='s_members' value="members"  />Members</label></li>
					<li class='app'><label for='s_core' title='Help Files'><input type='radio' name='search_app' class='input_radio' id='s_core' value="core"  />Help Files</label></li>
					
						
					

						
					

						
					

						<li class='app'>
								<label for='s_calendar' title='Calendar'>
									<input type='radio' name='search_app' class='input_radio' id='s_calendar' value="calendar"  />Calendar
								</label>
							</li>
					

						
					

						
					

						<li class='app'>
								<label for='s_tracker' title='Bug Reports'>
									<input type='radio' name='search_app' class='input_radio' id='s_tracker' value="tracker"  />Bug Reports
								</label>
							</li>
					

						
					

						
					

						
					
				</ul>
				<input type='submit' class='submit_input clickable' value='Search' />
			</span>
			
		</fieldset>
	</form>
</div>
					
				</div>
			</div>
			<!-- ::: APPLICATION TABS ::: -->
			<div id='primary_nav' class='clearfix'>
				<div class='main_width'>
					<ul class='ipsList_inline' id='community_app_menu'>
						
							<li class='right'>
								<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=navigation&amp;inapp=forums" rel="quickNavigation" accesskey='9' id='quickNavLaunch' title='Open Quick Navigation'><span>&nbsp;</span></a>
							</li>
						
						<li id='nav_explore' class='right'>
							<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=viewNewContent&amp;search_app=forums' accesskey='2' title='View New Content'>View New Content</a>
						</li>
            <li id='nav_menu_300' class="left skip_moremenu ">
              <a id='nav_menu_300_trigger' href='http://www.oscommerce.com' title='' >Website <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_300_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com' title='' >Website</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Products' title='' >Downloads</a></li>
                        <li class='submenu_li'><a href='http://addons.oscommerce.com' title='' >Add-Ons</a></li>
                        <li class='submenu_li'><a href='http://shops.oscommerce.com' title='' >Live Shops</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_300_trigger'), $('nav_menu_300_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_300' } );
                  });
                </script>
            </li>
						
            <li id='nav_menu_400' class="left skip_moremenu ">
              <a id='nav_menu_400_trigger' href='http://www.oscommerce.com/Services' title='' >Services <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_400_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&hosting' title='' >Hosting</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&developers' title='' >Developers</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&templates' title='' >Templates</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&books' title='' >Books</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&payment' title='' >Payment</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&shipping' title='' >Shipping</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&marketing' title='' >Marketing</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&crm' title='' >CRM</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_400_trigger'), $('nav_menu_400_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_400' } );
                  });
                </script>
            </li>
            <li id='nav_menu_500' class="left skip_moremenu ">
              <a id='nav_menu_500_trigger' href='http://forums.oscommerce.com/subscriptions/' title='' >Customers <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_500_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        
                        <li class='submenu_li'><a href='http://www.oscommerce.com/_&Sponsorship' title='' >Community Sponsorships</a></li>
                        
                        <li class='submenu_li'><a href='https://ssl.oscommerce.com/Account&Partner' title='' >Partner Dashboard</a></li>
                        <li class='submenu_li'><a href='http://forums.oscommerce.com/forum/85-support-tickets/' title='' >Support Tickets (Discontinued)</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_500_trigger'), $('nav_menu_500_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_500' } );
                  });
                </script>
            </li>
						
								
									
								

									
								

									
								

									
								

									
								

									
																				<li id='nav_app_ipchat' class="left "><a href='http://forums.oscommerce.com/chat/' title='Go to Live Chat'>Live Chat</a></li>
									
								

									
																				<li id='nav_app_tracker' class="left "><a href='http://forums.oscommerce.com/tracker/' title='Go to Bug Reports'>Bug Reports</a></li>
									
								

									
								

									
								

									
								
							
      <li id='nav_app_ccs' class="left "><a href='http://library.oscommerce.com' title='Go to Documentation' >Documentation</a></li>
						<li id='nav_other_apps' style='display: none'>
							<a href='#' class='ipbmenu' id='more_apps'>More <img src='http://forums.oscommerce.com/public/style_images/master/useropts_arrow.png' /></a>
						</li>
					</ul>
				</div>
			</div>
			
			<!-- ::: MAIN CONTENT AREA ::: -->
			<div id='content' class='clearfix'>
				<!-- ::: NAVIGATION BREADCRUMBS ::: -->
				<div id='secondary_navigation' class='clearfix'>
						<ol class='breadcrumb top ipsList_inline left'>
														<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<a href='http://forums.oscommerce.com/' itemprop="url">
										<span itemprop="title">osCommerce Support Forum</span>
									</a>
								</li>
								
							
								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x' itemprop="url"><span itemprop="title">osCommerce Online Merchant v2.x</span></a>
								</li>
								
							

								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security' itemprop="url"><span itemprop="title">Security</span></a>
								</li>
								
							
						</ol>
					</div>
					<br />
				<noscript>
					<div class='message error'>
						<strong>Javascript Disabled Detected</strong>
						<p>You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality.</p>
					</div>
					<br />
				</noscript>
				<!-- ::: CONTENT ::: -->
				
					<div class='ipsAd'><style type="text/css">
#osCCS { margin-top: 5px; clear: both; min-height: 65px; }
#osCCSDesc { font-size: 0.95em; padding-left: 480px; margin-top: -60px; padding-top: 4px; min-height: 60px; }
</style>

<div class='general_box'>
  <div style="float: right; margin-top: -6px;">
<a href="http://www.oscommerce.com/Services&amp;hosting" target="_blank" class="ipsButton_secondary">Hosting</a>
<a href="http://www.oscommerce.com/Services&amp;developers" target="_blank" class="ipsButton_secondary">Developers</a>
<a href="http://www.oscommerce.com/Services&amp;templates" target="_blank" class="ipsButton_secondary">Templates</a>
<a href="http://www.oscommerce.com/Services&amp;books" target="_blank" class="ipsButton_secondary">Books</a>
<a href="http://www.oscommerce.com/Services&amp;payment" target="_blank" class="ipsButton_secondary">Payment</a>
<a href="http://www.oscommerce.com/Services&amp;shipping" target="_blank" class="ipsButton_secondary">Shipping</a>
<a href="http://www.oscommerce.com/Services&amp;marketing" target="_blank" class="ipsButton_secondary">Marketing</a>
<a href="http://www.oscommerce.com/Services&amp;crm" target="_blank" class="ipsButton_secondary">CRM</a>
  </div>
  <p><span style='font-size: 0.95em; font-weight: bold;'><a href='http://www.oscommerce.com/Services' target='_blank'>Our Partners</a></span></p>
  <div id="osCCS" style="display: block;"></div>
</div>

<br /></div>
				
				




<script type="text/javascript">
//<![CDATA[
	ipb.topic.inSection    = 'topicview';
	ipb.topic.topic_id     = 373777;
	ipb.topic.forum_id     = 76;
	ipb.topic.redirectPost = 1;
	ipb.topic.start_id     = 60;
	ipb.topic.page_id      = 4;
	ipb.topic.topPid       = 0;
	ipb.topic.counts       = { postTotal: 542,
							  curStart:  ipb.topic.start_id,
							  perPage:   20 };
	//Search Setup
	ipb.vars['search_type']			= 'forum';
	ipb.vars['search_type_id']		= 76;
	ipb.vars['search_type_2']		= 'topic';
	ipb.vars['search_type_id_2']	= 373777;
	
	
	// Delete stuff set up
	ipb.topic.deleteUrls['hardDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=04&f=76&t=373777&page=4&auth_key=880ea6a14ea49e853634fbdc5015a024&p=#{pid}" );
	ipb.topic.deleteUrls['softDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=postchoice&tact=sdelete&t=373777&f=76&auth_key=880ea6a14ea49e853634fbdc5015a024&selectedpids[#{pid}]=#{pid}&pid=#{pid}" );
	
	
	ipb.topic.modPerms	  = [];
	
	
	ipb.templates['post_moderation'] = new Template("<div id='comment_moderate_box' class='ipsFloatingAction' style='display: none'><span class='desc'>With <span id='comment_count'>#{count}</span> checked posts: </span><select id='tactInPopup' class='input_select'><option value='approve'>Approve</option><option value='delete'>Hide</option><option value='sundelete'>Unhide</option><option value='deletedo'>Delete</option><option value='merge'>Merge</option><option value='split'>Split</option><option value='move'>Move</option></select>&nbsp;&nbsp;<input type='button' class='input_submit' id='submitModAction' value='Go' /></div>");
	
//]]>
</script>





	<a href='http://forums.oscommerce.com/user/288489-taipo/' class='ipsUserPhotoLink left'>

<img src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' alt='Photo' class='ipsUserPhoto ipsUserPhoto_medium' />

	</a>

<div itemscope itemtype="http://schema.org/Article" class='ipsBox_withphoto'>
	<span itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating" class='rating ipsType_smaller'>
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			<span id='rating_text'>
				
					<span itemprop="ratingCount" id='rating_hits'>2</span> <span>votes</span>
					<meta itemprop="ratingValue" content="5" />
				
			</span>
			
		</span>
	<h1 itemprop="name" class='ipsType_pagetitle'>Oscommerce Security - Osc_Sec.php</h1>
	<div class='desc lighter blend_links'>
		 Started by <span itemprop="creator"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>, <span itemprop="dateCreated" datetime="2011-04-10">Apr 10 2011 11:04</span>
	</div>
	
	<meta itemprop="interactionCount" content="UserComments:542" />
</div>



<br />
<div class='topic_controls'>
	<div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0714763001'>
					<a href='#'>Page 4 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0714763001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-2" title="Oscommerce Security - Osc_Sec.php - Page 2">2</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Page 3">3</a>
						</li>
				

					
						<li class='page active'>4</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Page 5">5</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Page 6">6</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div>
	


	<ul class='topic_buttons'>
			<li class='disabled'><span>Please log in to reply</span></li>
			
			
		</ul>
</div>

<div class='maintitle clear clearfix'>
	<span class='ipsType_small'>
		541 replies to this topic
	</span>
	
</div>

<div class='topic hfeed clear clearfix'>
	
	

	<div class='ipsBox'>
		<div class='ipsBox_container' id='ips_Posts'>
			
				<!--post:1583956-->

<div class='post_block hentry clear clearfix  ' id='post_id_1583956'>
		<a id='entry1583956'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1583956' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1583956' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #61'>
					
					#61
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #61' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T10:37:32+00:00">20 May 2011 - 10:37</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Hi&#33;<br /><br />I just installed OSC_SEC 2.5r2 on my nearly ready German shop.  /thumbsup.gif' class='bbc_emoticon' alt=':thumbsup:' /> <br /><br />May you please change the  <em class='bbc'>&#036;GETcleanup filter</em>, because it filters German umlauts, like <strong class='bbc'>ö Ö ä Ä Ü ü</strong> if set to &#036;GETcleanup = 1<br /><br />This is the same if the umlauts are html coded, eg. <strong class='bbc'>ü</strong> = <strong class='bbc'>&amp;uuml;  </strong><br /><br />Thank you in advance.<br /><br /><br />Regards
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1583956'>
				<ul class='ipsList_inline'>
					<li id="like_post_1583956" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1583956', { domLikeStripId: 'like_post_1583956', app: 'forums', type: 'pid', typeid: '1583956' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1583956' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1583956);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1583956') )
	{
		$('multiq_1583956').show();
	}
	
	if( $('toggle_post_1583956') )
	{
		$('toggle_post_1583956').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1583956] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1583964-->

<div class='post_block hentry clear clearfix  ' id='post_id_1583964'>
		<a id='entry1583964'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1583964' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1583964' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #62'>
					
					#62
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #62' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T11:28:46+00:00">20 May 2011 - 11:28</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Are the umlauts just on the vowels or are there more. What is the full set?
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1583964'>
				<ul class='ipsList_inline'>
					<li id="like_post_1583964" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1583964', { domLikeStripId: 'like_post_1583964', app: 'forums', type: 'pid', typeid: '1583964' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1583964' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1583964);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1583964') )
	{
		$('multiq_1583964').show();
	}
	
	if( $('toggle_post_1583964') )
	{
		$('toggle_post_1583964').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1583964] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1583969-->

<div class='post_block hentry clear clearfix  ' id='post_id_1583969'>
		<a id='entry1583969'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1583969' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1583969' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #63'>
					
					#63
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #63' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T11:41:41+00:00">20 May 2011 - 11:41</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1583964" data-time="1305890926"><p>Are the umlauts just on the vowels or are there more. What is the full set?<br /></p></blockquote><br />Hi&#33;<br /><br />In Germany we have a <strong class='bbc'>ß</strong> character, too.<br />So all the special charcters we need here are:<br /><br /><strong class='bbc'>ö Ö ä Ä ü Ü ß </strong> and the <strong class='bbc'>€ = &amp;euro;</strong> sign. <br /><br /><br />It would be a good idea to add a way to add more special characters (some table or similar).<br />Other countries will need other special characters, too.<br /><br />Regards <br /><br />popsel
					
					<br />
					<p class='edit'>
							<strong>Edited by popsel, 20 May 2011 - 11:52.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1583969'>
				<ul class='ipsList_inline'>
					<li id="like_post_1583969" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1583969', { domLikeStripId: 'like_post_1583969', app: 'forums', type: 'pid', typeid: '1583969' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1583969' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1583969);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1583969') )
	{
		$('multiq_1583969').show();
	}
	
	if( $('toggle_post_1583969') )
	{
		$('toggle_post_1583969').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1583969] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1583970-->

<div class='post_block hentry clear clearfix  ' id='post_id_1583970'>
		<a id='entry1583970'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1583970' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1583970' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #64'>
					
					#64
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #64' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T11:58:32+00:00">20 May 2011 - 11:58</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Try this out for now.<br /><br />Scroll to about line 720 in osc_sec.php and find the function below:<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes&#91; &#036;key &#93; = preg_replace(&quot;/&#91;^ a-zA-Z0-9@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;value ) );
                }
          }
     } else {
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }</pre><br />Replace with this:<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                }
          }
     } else {
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }</pre><br />See if that works for you.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1583970'>
				<ul class='ipsList_inline'>
					<li id="like_post_1583970" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1583970', { domLikeStripId: 'like_post_1583970', app: 'forums', type: 'pid', typeid: '1583970' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1583970' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1583970);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1583970') )
	{
		$('multiq_1583970').show();
	}
	
	if( $('toggle_post_1583970') )
	{
		$('toggle_post_1583970').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1583970] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1583975-->

<div class='post_block hentry clear clearfix  ' id='post_id_1583975'>
		<a id='entry1583975'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1583975' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1583975' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #65'>
					
					#65
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #65' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T12:30:53+00:00">20 May 2011 - 12:30</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1583970" data-time="1305892712"><p>Try this out for now.<br /><br />Scroll to about line 720 in osc_sec.php and find the function below:<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes&#91; &#036;key &#93; = preg_replace(&quot;/&#91;^ a-zA-Z0-9@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;value ) );
                }
          }
     } else {
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }</pre><br />Replace with this:<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                }
          }
     } else {
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }</pre><br />See if that works for you.<br /></p></blockquote><br />Hi&#33;<br /><br />This works for input to forms like Order Editor V5.09, which is already a big success.<br />It is not working if the special chars are HTML coded. eg. <strong class='bbc'>&amp;uuml;</strong> is still filtered.<br /><br />Thank you for very fast reply.<br /><br />Regards<br /><br />Popsel
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1583975'>
				<ul class='ipsList_inline'>
					<li id="like_post_1583975" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1583975', { domLikeStripId: 'like_post_1583975', app: 'forums', type: 'pid', typeid: '1583975' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1583975' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1583975);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1583975') )
	{
		$('multiq_1583975').show();
	}
	
	if( $('toggle_post_1583975') )
	{
		$('toggle_post_1583975').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1583975] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584033-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584033'>
		<a id='entry1584033'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584033' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584033' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #66'>
					
					#66
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #66' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="274157" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/274157-hostricity/' title='View Profile'><span itemprop="name">hostricity</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">hostricity</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/274157-hostricity/" title="View Profile: hostricity" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/ebf30a2adec146374254de1fdce1c3e1?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			30 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Geoff Staples</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@hostricity' ); return false;" title="@hostricity">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T19:12:27+00:00">20 May 2011 - 19:12</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					I&#39;ve installed OSC SEC on a customer site, but I cannot figure out how to test it.<br />
<br />
I&#39;m using OSC 2.2 RC2.<br />
<br />
Could someone suggest some url strings that would get me banned?<br />
<br />
Note: I have the admin directory Apache password protected, so I&#39;m talking about testing the catalog, not the admin.<br />
<br />
Thanks,<br />
<br />
Geoff
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584033'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584033" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584033', { domLikeStripId: 'like_post_1584033', app: 'forums', type: 'pid', typeid: '1584033' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1584033' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584033);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584033') )
	{
		$('multiq_1584033').show();
	}
	
	if( $('toggle_post_1584033') )
	{
		$('toggle_post_1584033').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584033] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584053-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584053'>
		<a id='entry1584053'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584053' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584053' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #67'>
					
					#67
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #67' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="274157" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/274157-hostricity/' title='View Profile'><span itemprop="name">hostricity</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">hostricity</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/274157-hostricity/" title="View Profile: hostricity" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/ebf30a2adec146374254de1fdce1c3e1?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			30 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Geoff Staples</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@hostricity' ); return false;" title="@hostricity">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T21:00:24+00:00">20 May 2011 - 21:00</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;hostricity&#39;" data-cid="1584033" data-time="1305918747"><p>I&#39;ve installed OSC SEC on a customer site, but I cannot figure out how to test it.<br /><br />...<br /><br />Thanks,<br /><br />Geoff<br /></p></blockquote><br />I did discover that OSC SEC gave an error message in Admin that it couldn&#39;t write to the htaccess file. I changed the permissions and the error message went away, but nothing was actually written to the .htaccess. <br /><br />Is it correct that OSC SEC won&#39;t write anything to the .htaccess until it actually has an ip to ban?<br /><br />Anyway, I haven&#39;t as yet figured out what url string I could use to cause my ip to be banned or to generate an email.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584053'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584053" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584053', { domLikeStripId: 'like_post_1584053', app: 'forums', type: 'pid', typeid: '1584053' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1584053' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584053);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584053') )
	{
		$('multiq_1584053').show();
	}
	
	if( $('toggle_post_1584053') )
	{
		$('toggle_post_1584053').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584053] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584066-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584066'>
		<a id='entry1584066'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584066' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584066' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #68'>
					
					#68
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #68' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T21:42:26+00:00">20 May 2011 - 21:42</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Try something like:<br /><pre class='prettyprint lang-auto linenums:0'>http&#58;//www.yourdomain.com/catalog/admin/categories.php/login.php?cookies=1</pre>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584066'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584066" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584066', { domLikeStripId: 'like_post_1584066', app: 'forums', type: 'pid', typeid: '1584066' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584066' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584066);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584066') )
	{
		$('multiq_1584066').show();
	}
	
	if( $('toggle_post_1584066') )
	{
		$('toggle_post_1584066').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584066] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584067-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584067'>
		<a id='entry1584067'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584067' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584067' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #69'>
					
					#69
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #69' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-20T21:48:39+00:00">20 May 2011 - 21:48</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;popsel&#39;" data-cid="1583975" data-time="1305894653"><p>Hi&#33;<br /><br />This works for input to forms like Order Editor V5.09, which is already a big success.<br />It is not working if the special chars are HTML coded. eg. <strong class='bbc'>&amp;uuml;</strong> is still filtered.<br /><br />Thank you for very fast reply.<br /><br />Regards<br /><br />Popsel<br /></p></blockquote><br />I guess what I will need to test this is a scenario or addon that tries to put &amp;uuml; into a GET request. Keep in mind that &amp;uuml; and other html coded umlauts are not filtered in form variables (POST requests). At the moment I am hesitant to allow the &#39;&amp;&#39; and &#39;;&#39; as whitelisted characters by themselves because they, well at least the &#39;;&#39; is a regularly used character in attempts to inject into the database.<br /><br />If you can give me a scenario that I can test and simulate here I might be able to come up with a better method of allowing the German characters through the GET whitelist.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584067'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584067" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584067', { domLikeStripId: 'like_post_1584067', app: 'forums', type: 'pid', typeid: '1584067' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584067' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584067);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584067') )
	{
		$('multiq_1584067').show();
	}
	
	if( $('toggle_post_1584067') )
	{
		$('toggle_post_1584067').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584067] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584098-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584098'>
		<a id='entry1584098'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584098' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584098' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #70'>
					
					#70
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #70' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T08:10:38+00:00">21 May 2011 - 08:10</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584067" data-time="1305928119"><p>I guess what I will need to test this is a scenario or addon that tries to put &amp;uuml; into a GET request. Keep in mind that &amp;uuml; and other html coded umlauts are not filtered in form variables (POST requests). At the moment I am hesitant to allow the &#39;&amp;&#39; and &#39;;&#39; as whitelisted characters by themselves because they, well at least the &#39;;&#39; is a regularly used character in attempts to inject into the database.<br /><br />If you can give me a scenario that I can test and simulate here I might be able to come up with a better method of allowing the German characters through the GET whitelist.<br /></p></blockquote><br />Hi&#33;<br /><br />I noticed the missing umlaut characters when the <em class='bbc'>Discount Coupon Codes V3.34</em> addon shows error messages.<br />After translating the text constants to German the html coded umlauts are truncated, <br />eg. input string is: <strong class='bbc'>&amp;uuml;</strong><br />this is cut down to: <strong class='bbc'>uuml</strong>  (missing the first and last character). <br />The <strong class='bbc'><span  style='color: #FF0000'> &amp; </span></strong> and<strong class='bbc'><span  style='color: #FF0000'> ; </span></strong> characters are filtered, so the browser shows <strong class='bbc'><span  style='color: #FF0000'>uuml</span></strong> instead of <strong class='bbc'><span  style='color: #FF0000'>ü</span></strong><br /><br />The message string is provided this way:<br /><br />These are the German translations in catalog&#092;includes&#092;languages&#092;german.php:<br /><pre class='prettyprint lang-auto linenums:0'>//kgt - discount coupons
define(&#39;ENTRY_DISCOUNT_COUPON_ERROR&#39;, &#39;Der eingegebene Gutscheincode ist ung&amp;uuml;ltig.&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_AVAILABLE_ERROR&#39;, &#39;Der eingegebene Gutscheincode ist nicht mehr g&amp;uuml;ltig.&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_USE_ERROR&#39;, &#39;Unsere Aufzeichnungen zeigen, dass Sie diesen Gutschein-Code bereits %s Mal benutzt haben.  Sie d&amp;uuml;rfen diesen Code nicht mehr als %s Mal verwenden.&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_MIN_PRICE_ERROR&#39;, &#39;Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt %s und wurde noch nicht erreicht&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_MIN_QUANTITY_ERROR&#39;, &#39;Die minimale Anzahl der Produkte zur Benutzung dieses Gutscheines ist %s&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_EXCLUSION_ERROR&#39;, &#39;Einige oder alle der Produkte im Warenkorb sind von der Verrechnung mit diesem Gutschein ausgeschlossen.&#39; );
define(&#39;ENTRY_DISCOUNT_COUPON&#39;, &#39;Gutschein-Code:&#39;);
define(&#39;ENTRY_DISCOUNT_COUPON_SHIPPING_CALC_ERROR&#39;, &#39;Die Ihnen berechneten Versandkosten wurden ge&amp;auml;ndert.&#39;);
//end kgt - discount coupons
?&gt;</pre><br />If conditions are met eg. entering a wrong coupon code in frontend (checkout_payment.php) text constants are send from<br />catalog&#092;includes&#092;classes&#092;discount_coupon.php in the function <em class='bbc'>get_coupon()</em> <br />example: look how the constant ENTRY_DISCOUNT_COUPON_ERROR is send here:<br /><pre class='prettyprint lang-auto linenums:0'>
    function get_coupon( &#036;code, &#036;delivery ) {
      global &#036;customer_id; //needed for customer_exclusions
      &#036;check_code_query = tep_db_query( &#036;sql = &quot;SELECT dc.*
                                                FROM &quot; . TABLE_DISCOUNT_COUPONS . &quot; dc
                                                WHERE coupons_id = &#39;&quot;.tep_db_input( &#036;code ).&quot;&#39;
                                                  AND ( coupons_date_start &lt;= CURDATE() OR coupons_date_start IS NULL )
                                                  AND ( coupons_date_end &gt;= CURDATE() OR coupons_date_end IS NULL )&quot; );
      if( tep_db_num_rows( &#036;check_code_query ) &#33;= 1 ) { //if no rows are returned, then they haven&#39;t entered a valid code
        &#036;this-&gt;message( ENTRY_DISCOUNT_COUPON_ERROR ); //display the error message
      } else {
        //customer_exclusions
        &#036;check_user_query = tep_db_query( &#036;sql = &#39;SELECT dc2u.customers_id
</pre><br />So the output should be <br /> Der eingegebene Gutscheincode ist <span class='bbc_underline'>ungültig</span><br />but it is:<br /> Der eingegebene Gutscheincode ist <span class='bbc_underline'>unguumlltig</span>.<br /><br />So IMHO the fiter should block the single problematic chars, like <span  style='color: #FF0000'><strong class='bbc'>&amp; ;</strong></span> but bypass umlaut strings like <span  style='color: #FF0000'><strong class='bbc'>&amp;uuml;</strong></span> if they are exactly written as a refrence pattern.<br /><br /><br />Regards<br /><br />Popsel
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584098'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584098" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584098', { domLikeStripId: 'like_post_1584098', app: 'forums', type: 'pid', typeid: '1584098' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584098' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584098);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584098') )
	{
		$('multiq_1584098').show();
	}
	
	if( $('toggle_post_1584098') )
	{
		$('toggle_post_1584098').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584098] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584111-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584111'>
		<a id='entry1584111'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584111' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584111' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #71'>
					
					#71
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #71' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T09:33:57+00:00">21 May 2011 - 09:33</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Ok thanks for that. That gives me something to work with.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584111'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584111" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584111', { domLikeStripId: 'like_post_1584111', app: 'forums', type: 'pid', typeid: '1584111' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584111' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584111);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584111') )
	{
		$('multiq_1584111').show();
	}
	
	if( $('toggle_post_1584111') )
	{
		$('toggle_post_1584111').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584111] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584128-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584128'>
		<a id='entry1584128'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584128' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584128' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #72'>
					
					#72
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #72' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T12:34:58+00:00">21 May 2011 - 12:34</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584111" data-time="1305970437"><p>Ok thanks for that. That gives me something to work with.<br /></p></blockquote><br />Hi&#33;<br /><br />I just noticed another problem with filtering:<br />In Germany we use comma as separator between Euro and cents. So the system is set according to it.<br />I set up a discount coupon to be used with a mimimal order value of 10 EURO.<br />Now, with &#036;GETcleanup = 0, after adding an amount of 9 EURO to the cart and entering the coupon code I get an <br />error message <br /> (translated to English) ... minimal order is <strong class='bbc'>10,00 €</strong> ... <br />This is like it should be.<br />After setting &#036;GETcleanup = 1; there is a funny message with the same conditions I get:<br /> (translated to English) ... minimal order is <strong class='bbc'>1000</strong> ...  (the comma and the € sign is missing)<br />This can be really confusing to a customer, isn`t it ?<br /><br />Regards<br /><br />Popsel
					
					<br />
					<p class='edit'>
							<strong>Edited by popsel, 21 May 2011 - 12:39.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584128'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584128" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584128', { domLikeStripId: 'like_post_1584128', app: 'forums', type: 'pid', typeid: '1584128' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584128' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584128);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584128') )
	{
		$('multiq_1584128').show();
	}
	
	if( $('toggle_post_1584128') )
	{
		$('toggle_post_1584128').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584128] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584142-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584142'>
		<a id='entry1584142'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584142' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584142' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #73'>
					
					#73
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #73' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T14:16:19+00:00">21 May 2011 - 14:16</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Try this out and let me know if it works for you.<br /><br />Replace the code I gave you above with this:<br /><br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                     &#036;nodes = getCleaner( &#036;nodes );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,ßäöüÄÖÜ€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	 &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	 &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;tolist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre>
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 21 May 2011 - 14:20.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584142'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584142" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584142', { domLikeStripId: 'like_post_1584142', app: 'forums', type: 'pid', typeid: '1584142' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584142' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584142);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584142') )
	{
		$('multiq_1584142').show();
	}
	
	if( $('toggle_post_1584142') )
	{
		$('toggle_post_1584142').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584142] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584149-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584149'>
		<a id='entry1584149'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584149' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584149' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #74'>
					
					#74
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #74' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T15:10:52+00:00">21 May 2011 - 15:10</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584142" data-time="1305987379"><p>Try this out and let me know if it works for you.<br /><br />Replace the code I gave you above with this:<br /><br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                     &#036;nodes = getCleaner( &#036;nodes );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,ßäöüÄÖÜ€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	 &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	 &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;tolist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre></p></blockquote><br />Hi&#33;<br /><br />Thanks for your engagement.<br /><br />After a quick check I get this display in the frontend with Firefox:<br /><strong class='bbc'>Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt 10,00 und wurde noch nicht erreicht.</strong><br /><br />checking the generated html code with Firebug shows <strong class='bbc'><span  style='color: #FF0000'>amp</span></strong> inside the umlaut strings ?&#33; <br /><strong class='bbc'>&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert f&amp;<span  style='color: #FF0000'>amp</span>;uuml;r diesen Gutschein betr&amp;<span  style='color: #FF0000'>amp</span>;auml;gt 10,00 und wurde noch nicht erreicht.&lt;/td&gt;</strong><br /><br />hmm.. but the comma inside the 10,00 is now visible  /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /><br /><br />Here is a realtime html editor, suitable to show how the strings are displayed from browser:<br /><a href='http://htmledit.squarefree.com/' class='bbc_url' title='External link' rel='nofollow external'>http://htmledit.squarefree.com/</a><br />To simulate it you may copy this original output string into the window to see the result:<br /><br />&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt  10,00  und wurde noch nicht erreicht.&lt;/td&gt;
					
					<br />
					<p class='edit'>
							<strong>Edited by popsel, 21 May 2011 - 15:24.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584149'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584149" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584149', { domLikeStripId: 'like_post_1584149', app: 'forums', type: 'pid', typeid: '1584149' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584149' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584149);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584149') )
	{
		$('multiq_1584149').show();
	}
	
	if( $('toggle_post_1584149') )
	{
		$('toggle_post_1584149').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584149] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584150-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584150'>
		<a id='entry1584150'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584150' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584150' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #75'>
					
					#75
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #75' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T15:31:34+00:00">21 May 2011 - 15:31</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;popsel&#39;" data-cid="1584149" data-time="1305990652"><p>To simulate it you may copy this original output string into the window to see the result:<br /><br />&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt  10,00  und wurde noch nicht erreicht.&lt;/td&gt;<br /></p></blockquote><br />Sorry, the way I did copy was wrong. It should be:<br /><br />Der Mindestbestellwert f&amp;amp;uuml;r diesen Gutschein betr&amp;amp;auml;gt  10,00  und wurde noch nicht erreicht.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584150'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584150" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584150', { domLikeStripId: 'like_post_1584150', app: 'forums', type: 'pid', typeid: '1584150' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584150' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584150);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584150') )
	{
		$('multiq_1584150').show();
	}
	
	if( $('toggle_post_1584150') )
	{
		$('toggle_post_1584150').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584150] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584182-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584182'>
		<a id='entry1584182'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584182' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584182' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #76'>
					
					#76
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #76' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-21T21:18:42+00:00">21 May 2011 - 21:18</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Try this. Replace this part of the code above:<br /><pre class='prettyprint lang-auto linenums:0'>
  /** 
  * Called above, this will clean up 
  * values but not interfere with umlauts 
  */ 
  function getCleaner(&#036;string, &#036;conv=1) { 
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; .  
         &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; .  
         &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; ); 
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;&quot;); 
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro&quot;); 
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) { 
       if ( &#036;conv &gt; 0 ) { 
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string); 
       } else { 
           &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;tolist&#91;&#036;wr&#93;, &#036;string); 
       } 
    } 
    return &#036;string; 
}
</pre><br />With the following:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	             &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro,ae,oe,ue,Ae,Oe,Ue,euro,szlig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre><br />This probably could be written in simpler terms, but in the end, its the result that matters.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584182'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584182" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584182', { domLikeStripId: 'like_post_1584182', app: 'forums', type: 'pid', typeid: '1584182' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584182' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584182);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584182') )
	{
		$('multiq_1584182').show();
	}
	
	if( $('toggle_post_1584182') )
	{
		$('toggle_post_1584182').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584182] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584209-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584209'>
		<a id='entry1584209'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584209' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584209' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #77'>
					
					#77
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #77' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T07:27:36+00:00">22 May 2011 - 07:27</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584182" data-time="1306012722"><p>Try this. Replace this part of the code above:<br /><pre class='prettyprint lang-auto linenums:0'>
  /** 
  * Called above, this will clean up 
  * values but not interfere with umlauts 
  */ 
  function getCleaner(&#036;string, &#036;conv=1) { 
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; .  
         &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; .  
         &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; ); 
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;&quot;); 
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro&quot;); 
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) { 
       if ( &#036;conv &gt; 0 ) { 
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string); 
       } else { 
           &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;tolist&#91;&#036;wr&#93;, &#036;string); 
       } 
    } 
    return &#036;string; 
}
</pre><br />With the following:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	             &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,szlig,euro,ae,oe,ue,Ae,Oe,Ue,euro,szlig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;szlig;,&amp;euro;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre><br />This probably could be written in simpler terms, but in the end, its the result that matters.<br /></p></blockquote><br />Hi&#33;<br /><br />I checked with the same conditions, but the result did not change  /huh.gif' class='bbc_emoticon' alt=':huh:' /> <br /><br />Frontend output is this:<br />Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt 10,00 und wurde noch nicht erreicht.<br /><br />Firebug analysis is showing that Firefox is getting this string:<br />&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert f&amp;amp;uuml;r diesen Gutschein betr&amp;amp;auml;gt 10,00 und wurde noch nicht erreicht.&lt;/td&gt;<br /><br />That`s why Firefox does not display umlauts. The generated code <strong class='bbc'>f&amp;amp;uuml;r</strong> provides a display of<strong class='bbc'> f&amp;uuml;r</strong> instead of the desired output: <strong class='bbc'>für</strong><br /><br />So I was trying to find out the conditions to get the desired output.<br /><br />If <em class='bbc'>&#036;nonGETPOSTReqs = 1</em> and umlauts are not coded like <strong class='bbc'>&amp;uuml;</strong> but normal written as <strong class='bbc'>ü</strong> <br /><pre class='prettyprint lang-auto linenums:0'>define(&#39;ENTRY_DISCOUNT_COUPON_MIN_PRICE_ERROR&#39;, &#39;Der Mindestbestellwert für diesen Gutschein beträgt %s und wurde noch nicht erreicht&#39;);</pre>and this line is disabled for testing<br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
          foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
                      scrubster( &#036;value );
                } else {
                     &#036;nodes = getCleaner( &#036;nodes );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );   
          // Next line disabled for testing:
         // &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,ßäöüÄÖÜ€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }
</pre>	<br /><br />then I receive this (perfect) frontend output:<br />Der Mindestbestellwert für diesen Gutschein beträgt 10,00 € und wurde noch nicht erreicht.<br /><br />Looking into the code using Firebug shows this:<br />&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert für diesen Gutschein beträgt 10,00 € und wurde noch nicht erreicht.&lt;/td&gt;<br /><br /><span class='bbc_underline'>From this view I think there are 2 problems:</span><br />1. The filter function (scrubster) sometimes still filters standard written umlauts (ö ä ü Ö Ä Ü €)<br />   To show that, enabling the above disabled line, in function <em class='bbc'>scrubster </em>shows this result:<br />   Frontend ouput:<br />     Der Mindestbestellwert fr diesen Gutschein betrgt 10,00 und wurde noch nicht erreicht.<br />   Firebug analysis: <br />     &lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert fr diesen Gutschein betrgt 10,00 und wurde noch nicht erreicht.&lt;/td&gt;<br /><br />2. If umlauts are html coded in the message string, they are not bypassed correctly. So the browser shows the code for umlauts but not the umlauts special character itself.<br /><br />Hopefully this research can help you to fix this problem.<br /><br />Thanks again for your patience.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584209'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584209" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584209', { domLikeStripId: 'like_post_1584209', app: 'forums', type: 'pid', typeid: '1584209' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584209' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584209);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584209') )
	{
		$('multiq_1584209').show();
	}
	
	if( $('toggle_post_1584209') )
	{
		$('toggle_post_1584209').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584209] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584211-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584211'>
		<a id='entry1584211'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584211' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584211' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #78'>
					
					#78
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #78' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T08:13:53+00:00">22 May 2011 - 08:13</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Ok that does help a bit.<br /><br />Try this for size:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	             &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig,axe,oxe,uxe,Axe,Oxe,Uxe,euxro,szlxig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre><br />Hopefully this might work. It should work where umlauts are html coded and are in actual form. Where it probably will not work is where you want to display the html encoded umlaut. But that would be rare in osCommerce one would think.
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 22 May 2011 - 08:14.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584211'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584211" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584211', { domLikeStripId: 'like_post_1584211', app: 'forums', type: 'pid', typeid: '1584211' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584211' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584211);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584211') )
	{
		$('multiq_1584211').show();
	}
	
	if( $('toggle_post_1584211') )
	{
		$('toggle_post_1584211').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584211] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584220-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584220'>
		<a id='entry1584220'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584220' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584220' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #79'>
					
					#79
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #79' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T10:45:28+00:00">22 May 2011 - 10:45</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584211" data-time="1306052033"><p>Ok that does help a bit.<br /><br />Try this for size:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	             &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig,axe,oxe,uxe,Axe,Oxe,Uxe,euxro,szlxig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre><br />Hopefully this might work. It should work where umlauts are html coded and are in actual form. Where it probably will not work is where you want to display the html encoded umlaut. But that would be rare in osCommerce one would think.<br /></p></blockquote><br />Ok, we have to see where the problem occurs. It still doesn&#39;t provide the right output.<br />With actual version I have:<br /><br />Frontend showing: <br />Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt 10,00 und wurde noch nicht erreicht.<br /><br />Firebug showing:<br />&lt;td class=&quot;headerError&quot;&gt;Der Mindestbestellwert f&amp;amp;uuml;r diesen Gutschein betr&amp;amp;auml;gt 10,00 und wurde noch nicht erreicht.&lt;/td&gt;<br /><br />I added a logfile to see whats going in and out of function <em class='bbc'>scrubster</em><br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
    unlink(&quot;scrubster.txt&quot;);                  // Erase old logfile first
    &#036;file = fopen(&quot;scrubster.txt&quot;, &quot;a+&quot;);     // Open debug file
    fwrite(&#036;file, &#39;in =&#39;.&#036;nodes.chr(10));     // Write input to file

     if ( is_array( &#036;nodes ) ) {
          foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
                      scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }

    fwrite(&#036;file, &#39;out=&#39;.&#036;nodes.chr(10).chr(13));             // Write output to file and add new Line
    fclose(&#036;file);     // Close file

    return &#036;nodes;
  }

</pre><br />This is the result:<br /><pre class='prettyprint lang-auto linenums:0'>
in =Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt  10,00 € und wurde noch nicht erreicht.
out=Der Mindestbestellwert f&amp;uuml;r diesen Gutschein betr&amp;auml;gt  10,00  und wurde noch nicht erreicht.
</pre><br />So we see that nothing beside the € sign is changed. The changes must appear elsewhere.<br />(If I do the same test with normal umlauts they are filtered in the output.)<br /><br />Is there any further prcosessing of these strings inside OSC_SEC beside the function <em class='bbc'>scrubster</em> ?
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584220'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584220" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584220', { domLikeStripId: 'like_post_1584220', app: 'forums', type: 'pid', typeid: '1584220' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584220' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584220);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584220') )
	{
		$('multiq_1584220').show();
	}
	
	if( $('toggle_post_1584220') )
	{
		$('toggle_post_1584220').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584220] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584223-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584223'>
		<a id='entry1584223'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584223' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4#entry1584223' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #80'>
					
					#80
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #80' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T11:06:23+00:00">22 May 2011 - 11:06</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					Nothing else filters the GET requests. The two other actions that happen are 1/ back in the osc.php the setlocale( LC_TIME, &quot;en_NZ&quot; ); is where setlocale determines the time, so unless that has been changed to the wrong settings it should not interfere with the output, and the other place is where &#036;_REQUEST is reset as a merge of &#036;_GET and &#036;_POST vars. see:  &#036;_REQUEST = array_merge( &#036;_GET, &#036;_POST );<br />
<br />
The difficulty I am having in trying to debug this is that it tests correct on my test system here. And by the looks of the output it is reporting correctly. The only other thing is the way the browser may be converting the output itself. What is the charset set to in the html head of your page, the DOCTYPE and what is the charset set to in your browser?<br />
<br />
ps if you dont mind, can you PM me the url to your website so I can see it for myself?
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 22 May 2011 - 11:19.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584223'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584223" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584223', { domLikeStripId: 'like_post_1584223', app: 'forums', type: 'pid', typeid: '1584223' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584223' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584223);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584223') )
	{
		$('multiq_1584223').show();
	}
	
	if( $('toggle_post_1584223') )
	{
		$('toggle_post_1584223').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584223] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			
		</div>
	</div>

<hr />
<div class='topic_controls clear ipsPad_top_bottom_half'>
	
		<div class='left'><div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0714763001'>
					<a href='#'>Page 4 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0714763001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-2" title="Oscommerce Security - Osc_Sec.php - Page 2">2</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Page 3">3</a>
						</li>
				

					
						<li class='page active'>4</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Page 5">5</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Page 6">6</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div></div>
	
	<div class='ipsPad_top_slimmer right'>
		
		<a href='http://forums.oscommerce.com/forum/76-security/' class="ipsType_small desc">Back to Security</a>
		
	</div>
</div>

<!-- Close topic -->
</div>
<!-- BOTTOM BUTTONS -->

	<br />
	<div class='clear clearfix left'>
		

	<ul class='topic_share left shareButtons ipsList_inline'>
	
		<li><a href="http://forums.oscommerce.com/index.php?sharelink=twitter;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Twitter" class='_slink' id='slink_twitter'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/twitter.png" /></a></li>
	

		
				<li class='fbLike'><div class="fb-like" data-href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" data-send="false" data-layout="button_count" data-width="150" data-show-faces="false" data-action="like"></div><div id="fb-root"></div></li>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=203307189516";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
			
	

		
				<script type="text/javascript" src="https://apis.google.com/js/plusone.js">
	
		{lang: 'en-GB'}
	
</script>
<li><div class='googlePlusOne'><g:plusone count="false" size="small"></g:plusone></div></li>
			
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=digg;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Digg" class='_slink' id='slink_digg'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/digg.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=delicious;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Del.icio.us" class='_slink' id='slink_delicious'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/delicious.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=reddit;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Reddit" class='_slink' id='slink_reddit'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/reddit.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=stumble;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via StumbleUpon" class='_slink' id='slink_stumble'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/stumble.png" /></a></li>
	

		
	
	</ul>
	<script type="text/javascript">
		ipb.sharelinks.url   = "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/";
		ipb.sharelinks.title = "Oscommerce Security - Osc_Sec.php";
		ipb.sharelinks.bname = "osCommerce Support Forum";
	</script>

	</div>
	<br />

<!-- SAME TAGGED -->

<!-- ACTIVE USERS -->



	<script type="text/javascript" src="http://forums.oscommerce.com/public/js/3rd_party/prettify/prettify.js"></script>
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prettify/lang-sql.js'></script>
	<!-- By default we load generic code, php, css, sql and xml/html; load others here if desired -->
	<script type="text/javascript">
	//<![CDATA[
		Event.observe( window, 'load', function(e){ prettyPrint() });
	//]]>
	</script>
<div id='multiQuoteInsert' style='display: none;' class='ipsFloatingAction'>
	<span class='ipsButton no_width' id='mqbutton'>Reply to quoted posts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#' id='multiQuoteClear' class='ipsType_smaller desc' title='Clear the posts you have selected with MultiQuote'>Clear</a> &nbsp;&nbsp;&nbsp;
</div>
<form id="modform" method="post" action="http://forums.oscommerce.com/index.php?">
	<input type="hidden" name="app" value="forums" />
	<input type="hidden" name="module" value="moderate" />
	<input type="hidden" name="section" value="moderate" />
	<input type="hidden" name="do" value="postchoice" />
	<input type="hidden" name="f" value="76" />
	<input type="hidden" name="t" value="373777" />
	<input type="hidden" name="auth_key" value="880ea6a14ea49e853634fbdc5015a024" />
	<input type="hidden" name="st" value="" />
	<input type="hidden" name="page" value="4" />
	<input type="hidden" value="" name="selectedpidsJS" id='selectedpidsJS' />
	<input type="hidden" name="tact" id="tact" value="" />
</form>
				
					<div class='ipsAd'><script>
var oscGetPartnerBannerUrl = 'http://www.oscommerce.com/index.php?RPC&Website&Index&GetPartnerBanner';
if ( typeof oscForumID != 'undefined' ) {
  oscGetPartnerBannerUrl = oscGetPartnerBannerUrl + '&forumid=' + oscForumID;
}
document.write('<script src="' + oscGetPartnerBannerUrl + '"><\/script>');
</script></div>
				
				<ol class='breadcrumb bottom ipsList_inline left clearfix clear'>
											<li><a href='http://forums.oscommerce.com/'>osCommerce Support Forum</a></li>
							
						
							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x'><span>osCommerce Online Merchant v2.x</span></a></li>
							
						

							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security'><span>Security</span></a></li>
							
						

					
					<li class='right ipsType_smaller'>
						<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
					</li>
					
					<li class='right ipsType_smaller'>
							<a href='http://forums.oscommerce.com/index.php?app=forums&amp;module=extras&amp;section=boardrules' title='Forum Rules'>Forum Rules</a> &middot; 
						</li>
				</ol>
			</div>
			<!-- ::: FOOTER (Change skin, language, mark as read, etc) ::: -->
			<div id='footer_utilities' class='main_width clearfix clear'>
				<a rel="nofollow" href='#top' id='backtotop' title='Go to top'><img src='http://forums.oscommerce.com/public/style_images/master/top.png' alt='' /></a>
				<ul class='ipsList_inline left'>
					<li>
						<img src='http://forums.oscommerce.com/public/style_images/master/feed.png' alt='RSS Feed' id='rss_feed' class='clickable' />
					</li>
					
							
								<li>
									<a rel="nofollow" id='new_skin' href='#' title='Change Theme'>Change Theme</a>
									<ul id='new_skin_menucontent' class='ipbmenu_content with_checks' style='display: none'>
										
											<li class='selected'>
												<a href='#' data-clicklaunch='changeSkin' data-skinid='1'>IP.Board</a>
											</li>
										

											<li >
												<a href='#' data-clicklaunch='changeSkin' data-skinid='3'>IP.Board Mobile</a>
											</li>
										
									</ul>
								</li>
							
					
					
					<li>
						<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=help" title='View help' rel="help" accesskey='6'>Help</a>
					</li>
				</ul>
				<!-- Copyright Information -->
        				  <p id='copyright'>
        				  	<a href='http://www.invisionpower.com/apps/board/' title='Community Forum Software by Invision Power Services'>Community Forum Software by IP.Board</a></p>
		<!-- / Copyright -->
			</div>
			
			
			
				<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/lightbox.js'></script>
<script type='text/javascript'>
//<![CDATA[
	// Lightbox Configuration
	LightboxOptions = Object.extend({
	    fileLoadingImage:        'http://forums.oscommerce.com/public/style_images/master/lightbox/loading.gif',
	    fileBottomNavCloseImage: 'http://forums.oscommerce.com/public/style_images/master/lightbox/closelabel.gif',
	    overlayOpacity: 0.8,   // controls transparency of shadow overlay
	    animate: true,         // toggles resizing animations
	    resizeSpeed: 10,        // controls the speed of the image resizing animations (1=slowest and 10=fastest)
	    borderSize: 10,         //if you adjust the padding in the CSS, you will need to update this variable
		// When grouping images this is used to write: Image # of #.
		// Change it for non-english localization
		labelImage: "Image",
		labelOf: "of"
	}, window.LightboxOptions || {});
/* Watch for a lightbox image and set up our downloadbutton watcher */
document.observe('click', (function(event){
    var target = event.findElement('a[rel*="lightbox"]') || event.findElement('area[rel*="lightbox"]') || event.findElement('span[rel*="lightbox"]');
    if (target) {
        event.stop();
        gbl_addDownloadButton();
    }
}).bind(this));
var _to    = '';
var _last  = '';
function gbl_addDownloadButton()
{
	if ( typeof( ipsLightbox.lightboxImage ) != 'undefined' && ipsLightbox.lightboxImage.src )
	{
		if ( _last != ipsLightbox.lightboxImage.src )
		{
			if ( ! $('gbl_d') )
			{
				$('bottomNav').insert( { top: "<div id='gbl_d' style='text-align:right;padding-bottom:4px;'></div>" } );
			}
			
			$('gbl_d').update( "<a href='"+ ipsLightbox.lightboxImage.src + "' target='_blank'><img src='http://forums.oscommerce.com/public/style_images/master/lightbox/download-icon.png' /></a>" );
			
			_last = ipsLightbox.lightboxImage.src;
		}
	}
	
	/* Check for init and then keep checking for new image */
	_to = setTimeout( "gbl_addDownloadButton()", 1000 );
}
//]]>
</script>
			
			<div id='inline_login_form' style="display:none">
		<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login&amp;do=process" method="post" id='login'>
				<input type='hidden' name='auth_key' value='880ea6a14ea49e853634fbdc5015a024' />
				<input type="hidden" name="referer" value="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" />
				<h3>Sign In</h3>
				
				<br />
				<div class='ipsForm ipsForm_horizontal'>
					<fieldset>
						<ul>
							<li class='ipsField'>
								<div class='ipsField_content'>
									Need an account? <a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Register now!'>Register now!</a>
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_username' class='ipsField_title'>Username or email:</label>
								<div class='ipsField_content'>
									<input id='ips_username' type='text' class='input_text' name='ips_username' size='30' tabindex='0' />
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_password' class='ipsField_title'>Forum Password</label>
								<div class='ipsField_content'>
									<input id='ips_password' type='password' class='input_text' name='ips_password' size='30' tabindex='0' /><br />
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=lostpass' title='Retrieve password'>I've forgotten my password</a>
								</div>
							</li>
							<li class='ipsField ipsField_checkbox'>
								<input type='checkbox' id='inline_remember' checked='checked' name='rememberMe' value='1' class='input_check' tabindex='0' />
								<div class='ipsField_content'>
									<label for='inline_remember'>
										<strong>Remember me</strong><br />
										<span class='desc lighter'>This is not recommended for shared computers</span>
									</label>
								</div>
							</li>
							
							
							<li class='ipsPad_top ipsForm_center desc ipsType_smaller'>
								<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
							</li>
							
						</ul>
					</fieldset>
					
					<div class='ipsForm_submit ipsForm_center'>
						<input type='submit' class='ipsButton' value='Sign In' tabindex='0' />
					</div>
				</div>
			</form>
	</div>
		</div>
		
		
		<script type='text/javascript'>
			if( $('primary_nav') ){	ipb.global.activateMainMenu(); }
		</script>
			</body>
</html>
