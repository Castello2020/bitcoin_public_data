http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5
HTTP/1.1 200 OK
Server: nginx
Date: Wed, 23 Jul 2014 21:55:05 GMT
Content-Type: text/html;charset=UTF-8
Connection: close
Set-Cookie: session_id=bcfda12af0a8a9278deec04320b5e97c; path=/; domain=.oscommerce.com; httponly
Set-Cookie: modpids=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; domain=.oscommerce.com
Cache-Control: no-cache, must-revalidate, max-age=0
Expires: Tue, 22 Jul 2014 21:55:05 GMT
Pragma: no-cache
Content-Encoding: gzip
Vary: Accept-Encoding

<!DOCTYPE html>
	<html lang="en"  xmlns:fb="http://www.facebook.com/2008/fbml">
	<head>
		<meta charset="UTF-8" />
		<title>Oscommerce Security - Osc_Sec.php - Page 5 - Security - osCommerce Support Forum</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<link rel="shortcut icon" href='http://forums.oscommerce.com/favicon.ico' />
		<link rel="image_src" href='http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png' />
		<script type='text/javascript'>
		//<![CDATA[
			jsDebug			= 0; /* Must come before JS includes */
			DISABLE_AJAX	= parseInt(0); /* Disables ajax requests where text is sent to the DB; helpful for charset issues */
			inACP			= false;
			var isRTL		= false;
			var rtlIe		= '';
			var rtlFull		= '';
		//]]>
		</script>
		
	
				
			<link rel="stylesheet" type="text/css" title="Main" media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/calendar_select.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_common.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_styles.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css"  href="http://forums.oscommerce.com/public/style_css/prettify.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	
	

<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" title='Main' media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_ie.css" />
<![endif]-->
<!--[if lte IE 8]>
	<style type='text/css'>
		.ipb_table { table-layout: fixed; }
		.ipsLayout_content { width: 99.5%; }
	</style>
<![endif]-->

	<style type='text/css'>
		img.bbc_img { max-width: 100% !important; }
	</style>

		<meta property="og:title" content="Oscommerce Security - Osc_Sec.php - Page 5 - Security"/>
		<meta property="og:site_name" content="osCommerce Support Forum"/>
		<meta property="og:type" content="article" />
		
	
		
		
			<meta property="og:updated_time" content="1306225159" />
		
		
		
		
	

		
		
			<meta name="keywords" content="Oscommerce,Security,Osc_Secphp,Nothing,else,filters,GET,requests,The,two,other,actions,happen,are,back,oscphp,setlocale,LC_TIME,en_NZ,determines" />
		
		
		
		
	

		
		
			<meta name="description" content="Page 5 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: Nothing else filters the GET requests. The two other actions that happen are 1/ back in the osc.php the setlocale( LC_TIME, &#34;en_NZ&#34; ); is where setlocale determines the time, so unless that has been changed to the wrong settings it should not interfere with the output, and the other place is where &#036;_REQUEST is reset as a merge of &#036;_GET and &#036;_POST vars. see:  &#036;_REQUEST = array_merge( &#036;_GE..." />
		
		
		
			<meta property="og:description" content="Page 5 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: Nothing else filters the GET requests. The two other actions that happen are 1/ back in the osc.php the setlocale( LC_TIME, &#34;en_NZ&#34; ); is where setlocale determines the time, so unless that has been changed to the wrong settings it should not interfere with the output, and the other place is where &#036;_REQUEST is reset as a merge of &#036;_GET and &#036;_POST vars. see:  &#036;_REQUEST = array_merge( &#036;_GE..." />
		
		
	

		
		
			<meta name="identifier-url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" />
		
		
			<meta property="og:url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" />
		
		
		
	

<meta property="og:image" content="http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png"/>
		
		
		
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prototype.js'></script>
	
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/ipb.js?ipbv=f0051d8914fe132bc0130fe6bbd729c6&amp;load=quickpm,hovercard,sharelinks,topic,rating,like'></script>
	
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/scriptaculous/scriptaculous-cache.js'></script>
	
	<script type="text/javascript" src='http://forums.oscommerce.com/cache/lang_cache/1/ipb.lang.js?nck=fb99e14e49767998a66e3b7a9956074d' charset='UTF-8'></script>


	
		
			
			
			
			
				<link id="ipsCanonical" rel="canonical" href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" />
			
		

			
			
			
			
				<link rel='stylesheet' type='text/css' title='Main' media='print' href='http://forums.oscommerce.com/public/style_css/css_1/ipb_print.css' />
			
		

			
			
			
			
				<link rel='first' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' />
			
		

			
			
			
			
				<link rel='prev' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4' />
			
		

			
			
			
			
				<link rel='next' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6' />
			
		

			
			
			
			
				<link rel='last' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28' />
			
		

			
			
			
			
				<link rel='up' href='http://forums.oscommerce.com/forum/76-security/' />
			
		

			
			
			
			
				<link rel='author' href='http://forums.oscommerce.com/user/288489-taipo/' />
			
		
	

	



<script type='text/javascript'>
	//<![CDATA[
		/* ---- URLs ---- */
		ipb.vars['base_url'] 			= 'http://forums.oscommerce.com/index.php?s=bcfda12af0a8a9278deec04320b5e97c&';
		ipb.vars['board_url']			= 'http://forums.oscommerce.com';
		ipb.vars['img_url'] 			= "http://forums.oscommerce.com/public/style_images/master";
		ipb.vars['loading_img'] 		= 'http://forums.oscommerce.com/public/style_images/master/loading.gif';
		ipb.vars['active_app']			= 'forums';
		ipb.vars['upload_url']			= 'http://forums.oscommerce.com/uploads';
		/* ---- Member ---- */
		ipb.vars['member_id']			= parseInt( 0 );
		ipb.vars['is_supmod']			= parseInt( 0 );
		ipb.vars['is_admin']			= parseInt( 0 );
		ipb.vars['secure_hash'] 		= '880ea6a14ea49e853634fbdc5015a024';
		ipb.vars['session_id']			= 'bcfda12af0a8a9278deec04320b5e97c';
		ipb.vars['twitter_id']			= 0;
		ipb.vars['fb_uid']				= 0;
		ipb.vars['auto_dst']			= parseInt( 0 );
		ipb.vars['dst_in_use']			= parseInt(  );
		ipb.vars['is_touch']			= false;
		ipb.vars['member_group']		= {"g_mem_info":"1"}
		/* ---- cookies ----- */
		ipb.vars['cookie_id'] 			= '';
		ipb.vars['cookie_domain'] 		= '.oscommerce.com';
		ipb.vars['cookie_path']			= '/';
		/* ---- Rate imgs ---- */
		ipb.vars['rate_img_on']			= 'http://forums.oscommerce.com/public/style_images/master/star.png';
		ipb.vars['rate_img_off']		= 'http://forums.oscommerce.com/public/style_images/master/star_off.png';
		ipb.vars['rate_img_rated']		= 'http://forums.oscommerce.com/public/style_images/master/star_rated.png';
		/* ---- Uploads ---- */
		ipb.vars['swfupload_swf']		= 'http://forums.oscommerce.com/public/js/3rd_party/swfupload/swfupload.swf';
		ipb.vars['swfupload_enabled']	= true;
		ipb.vars['use_swf_upload']		= ( '' == 'flash' ) ? true : false;
		ipb.vars['swfupload_debug']		= false;
		/* ---- other ---- */
		ipb.vars['highlight_color']     = "#ade57a";
		ipb.vars['charset']				= "UTF-8";
		ipb.vars['time_offset']			= "0";
		ipb.vars['hour_format']			= "24";
		ipb.vars['seo_enabled']			= 1;
		
		ipb.vars['seo_params']			= {"start":"-","end":"\/","varBlock":"?","varPage":"page-","varSep":"&","varJoin":"="};
		
		/* Templates/Language */
		ipb.templates['inlineMsg']		= "";
		ipb.templates['ajax_loading'] 	= "<div id='ajax_loading'><img src='http://forums.oscommerce.com/public/style_images/master/ajax_loading.gif' alt='" + ipb.lang['loading'] + "' /></div>";
		ipb.templates['close_popup']	= "<img src='http://forums.oscommerce.com/public/style_images/master/close_popup.png' alt='x' />";
		ipb.templates['rss_shell']		= new Template("<ul id='rss_menu' class='ipbmenu_content'>#{items}</ul>");
		ipb.templates['rss_item']		= new Template("<li><a href='#{url}' title='#{title}'>#{title}</a></li>");
		
		ipb.templates['autocomplete_wrap'] = new Template("<ul id='#{id}' class='ipb_autocomplete' style='width: 250px;'></ul>");
		ipb.templates['autocomplete_item'] = new Template("<li id='#{id}' data-url='#{url}'><img src='#{img}' alt='' class='ipsUserPhoto ipsUserPhoto_mini' />&nbsp;&nbsp;#{itemvalue}</li>");
		ipb.templates['page_jump']		= new Template("<div id='#{id}_wrap' class='ipbmenu_content'><h3 class='bar'>Jump to page</h3><p class='ipsPad'><input type='text' class='input_text' id='#{id}_input' size='8' /> <input type='submit' value='Go' class='input_submit add_folder' id='#{id}_submit' /></p></div>");
		ipb.templates['global_notify'] 	= new Template("<div class='popupWrapper'><div class='popupInner'><div class='ipsPad'>#{message} #{close}</div></div></div>");
		
		
		ipb.templates['header_menu'] 	= new Template("<div id='#{id}' class='ipsHeaderMenu boxShadow'></div>");
		
		Loader.boot();
	//]]>
	</script>
	</head>
	<body id='ipboard_body'>
		<p id='content_jump' class='hide'><a id='top'></a><a href='#j_content' title='Jump to content' accesskey='m'>Jump to content</a></p>
		<div id='ipbwrapper'>
			<!-- ::: TOP BAR: Sign in / register or user drop down and notification alerts ::: -->
			<div id='header_bar' class='clearfix'>
				<div class='main_width'>
					<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	$('nav_app_ipchat').down('a').observe( 'click', function(e) {
		var _chatUrl	= $('nav_app_ipchat').down('a').href;
	
		if( _chatUrl.charAt( _chatUrl.length - 1 ) == '#' )
		{
			_chatUrl	= _chatUrl.substr( 0, _chatUrl.length - 1 );
		}
	
		if( _chatUrl.indexOf('?') != '-1' )
		{
			_chatUrl	+= '&_popup=1';
		}
		else
		{
			_chatUrl	+= '?_popup=1';
		}
		
		window.open( _chatUrl, "chatpopout", "status=0,toolbar=0,location=1,menubar=0,directories=0,resizable=1,scrollbars=1,height=550,width=750" );
		
		Event.stop(e);
		return false;
	});
});
</script>
					<div id='user_navigation' class='not_logged_in'>
							
							<ul class='ipsList_inline right'>
								<li>
									<span class='services'>
										
										
										
									</span>
									&nbsp;&nbsp;&nbsp;&nbsp;
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login' title='Sign In' id='sign_in'>Sign In</a>&nbsp;&nbsp;&nbsp;
								</li>
								<li>
									<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Create Account' id='register_link'>Create Account</a>
								</li>
							</ul>
						</div>
				</div>
			</div>
			<!-- ::: BRANDING STRIP: Logo and search box ::: -->
			<div id='branding'>
				<div class='main_width'>
					<div id='logo'>
						
<div id='chat-tab-count-wrap'><span id='chat-tab-count' class='ipsHasNotifications' title='' style='display:none;'>2</span></div>
<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	var _thisHtml	= $('nav_app_ipchat').down('a').innerHTML;
	_thisHtml = _thisHtml + $('chat-tab-count-wrap').innerHTML;
	$('nav_app_ipchat').down('a').update( _thisHtml ).setStyle( { position: 'relative' } );
	$('chat-tab-count-wrap').remove();
	$('chat-tab-count').show();
});
</script>

							<a href='http://forums.oscommerce.com' title='Go to community index' rel="home" accesskey='1'><img src='http://forums.oscommerce.com/public/style_images/1_oscommerce_white_fill.png' alt='Logo' /></a>
						
					</div>
					
						<div id='search' class='right'>
	<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=search&amp;fromMainBar=1" method="post" id='search-box' >
		<fieldset>
			<label for='main_search' class='hide'>Search</label>
			<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;search_in=forums' title='Advanced Search' accesskey='4' rel="search" id='adv_search' class='right'>Advanced</a>
			<span id='search_wrap' class='right'>
				<input type='text' id='main_search' name='search_term' class='inactive' size='17' tabindex='100' />
				<span class='choice ipbmenu clickable' id='search_options' style='display: none'></span>
				<ul id='search_options_menucontent' class='ipbmenu_content ipsPad' style='display: none'>
					<li class='title'><strong>Search section:</strong></li>
					<li class='special'>
							<label for='s_topic' title='This topic'>
								<input type='radio' name='search_app' value="forums:topic:373777" class='input_radio' id='s_topic' checked="checked" /><strong>This topic</strong>
							</label>
						</li>
					
					
					<li class='app'><label for='s_forums' title='Forums'><input type='radio' name='search_app' class='input_radio' id='s_forums' value="forums"  />Forums</label></li>
					<li class='app'><label for='s_members' title='Members'><input type='radio' name='search_app' class='input_radio' id='s_members' value="members"  />Members</label></li>
					<li class='app'><label for='s_core' title='Help Files'><input type='radio' name='search_app' class='input_radio' id='s_core' value="core"  />Help Files</label></li>
					
						
					

						
					

						
					

						<li class='app'>
								<label for='s_calendar' title='Calendar'>
									<input type='radio' name='search_app' class='input_radio' id='s_calendar' value="calendar"  />Calendar
								</label>
							</li>
					

						
					

						
					

						<li class='app'>
								<label for='s_tracker' title='Bug Reports'>
									<input type='radio' name='search_app' class='input_radio' id='s_tracker' value="tracker"  />Bug Reports
								</label>
							</li>
					

						
					

						
					

						
					
				</ul>
				<input type='submit' class='submit_input clickable' value='Search' />
			</span>
			
		</fieldset>
	</form>
</div>
					
				</div>
			</div>
			<!-- ::: APPLICATION TABS ::: -->
			<div id='primary_nav' class='clearfix'>
				<div class='main_width'>
					<ul class='ipsList_inline' id='community_app_menu'>
						
							<li class='right'>
								<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=navigation&amp;inapp=forums" rel="quickNavigation" accesskey='9' id='quickNavLaunch' title='Open Quick Navigation'><span>&nbsp;</span></a>
							</li>
						
						<li id='nav_explore' class='right'>
							<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=viewNewContent&amp;search_app=forums' accesskey='2' title='View New Content'>View New Content</a>
						</li>
            <li id='nav_menu_300' class="left skip_moremenu ">
              <a id='nav_menu_300_trigger' href='http://www.oscommerce.com' title='' >Website <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_300_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com' title='' >Website</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Products' title='' >Downloads</a></li>
                        <li class='submenu_li'><a href='http://addons.oscommerce.com' title='' >Add-Ons</a></li>
                        <li class='submenu_li'><a href='http://shops.oscommerce.com' title='' >Live Shops</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_300_trigger'), $('nav_menu_300_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_300' } );
                  });
                </script>
            </li>
						
            <li id='nav_menu_400' class="left skip_moremenu ">
              <a id='nav_menu_400_trigger' href='http://www.oscommerce.com/Services' title='' >Services <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_400_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&hosting' title='' >Hosting</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&developers' title='' >Developers</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&templates' title='' >Templates</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&books' title='' >Books</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&payment' title='' >Payment</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&shipping' title='' >Shipping</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&marketing' title='' >Marketing</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&crm' title='' >CRM</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_400_trigger'), $('nav_menu_400_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_400' } );
                  });
                </script>
            </li>
            <li id='nav_menu_500' class="left skip_moremenu ">
              <a id='nav_menu_500_trigger' href='http://forums.oscommerce.com/subscriptions/' title='' >Customers <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_500_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        
                        <li class='submenu_li'><a href='http://www.oscommerce.com/_&Sponsorship' title='' >Community Sponsorships</a></li>
                        
                        <li class='submenu_li'><a href='https://ssl.oscommerce.com/Account&Partner' title='' >Partner Dashboard</a></li>
                        <li class='submenu_li'><a href='http://forums.oscommerce.com/forum/85-support-tickets/' title='' >Support Tickets (Discontinued)</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_500_trigger'), $('nav_menu_500_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_500' } );
                  });
                </script>
            </li>
						
								
									
								

									
								

									
								

									
								

									
								

									
																				<li id='nav_app_ipchat' class="left "><a href='http://forums.oscommerce.com/chat/' title='Go to Live Chat'>Live Chat</a></li>
									
								

									
																				<li id='nav_app_tracker' class="left "><a href='http://forums.oscommerce.com/tracker/' title='Go to Bug Reports'>Bug Reports</a></li>
									
								

									
								

									
								

									
								
							
      <li id='nav_app_ccs' class="left "><a href='http://library.oscommerce.com' title='Go to Documentation' >Documentation</a></li>
						<li id='nav_other_apps' style='display: none'>
							<a href='#' class='ipbmenu' id='more_apps'>More <img src='http://forums.oscommerce.com/public/style_images/master/useropts_arrow.png' /></a>
						</li>
					</ul>
				</div>
			</div>
			
			<!-- ::: MAIN CONTENT AREA ::: -->
			<div id='content' class='clearfix'>
				<!-- ::: NAVIGATION BREADCRUMBS ::: -->
				<div id='secondary_navigation' class='clearfix'>
						<ol class='breadcrumb top ipsList_inline left'>
														<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<a href='http://forums.oscommerce.com/' itemprop="url">
										<span itemprop="title">osCommerce Support Forum</span>
									</a>
								</li>
								
							
								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x' itemprop="url"><span itemprop="title">osCommerce Online Merchant v2.x</span></a>
								</li>
								
							

								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security' itemprop="url"><span itemprop="title">Security</span></a>
								</li>
								
							
						</ol>
					</div>
					<br />
				<noscript>
					<div class='message error'>
						<strong>Javascript Disabled Detected</strong>
						<p>You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality.</p>
					</div>
					<br />
				</noscript>
				<!-- ::: CONTENT ::: -->
				
					<div class='ipsAd'><style type="text/css">
#osCCS { margin-top: 5px; clear: both; min-height: 65px; }
#osCCSDesc { font-size: 0.95em; padding-left: 480px; margin-top: -60px; padding-top: 4px; min-height: 60px; }
</style>

<div class='general_box'>
  <div style="float: right; margin-top: -6px;">
<a href="http://www.oscommerce.com/Services&amp;hosting" target="_blank" class="ipsButton_secondary">Hosting</a>
<a href="http://www.oscommerce.com/Services&amp;developers" target="_blank" class="ipsButton_secondary">Developers</a>
<a href="http://www.oscommerce.com/Services&amp;templates" target="_blank" class="ipsButton_secondary">Templates</a>
<a href="http://www.oscommerce.com/Services&amp;books" target="_blank" class="ipsButton_secondary">Books</a>
<a href="http://www.oscommerce.com/Services&amp;payment" target="_blank" class="ipsButton_secondary">Payment</a>
<a href="http://www.oscommerce.com/Services&amp;shipping" target="_blank" class="ipsButton_secondary">Shipping</a>
<a href="http://www.oscommerce.com/Services&amp;marketing" target="_blank" class="ipsButton_secondary">Marketing</a>
<a href="http://www.oscommerce.com/Services&amp;crm" target="_blank" class="ipsButton_secondary">CRM</a>
  </div>
  <p><span style='font-size: 0.95em; font-weight: bold;'><a href='http://www.oscommerce.com/Services' target='_blank'>Our Partners</a></span></p>
  <div id="osCCS" style="display: block;"></div>
</div>

<br /></div>
				
				




<script type="text/javascript">
//<![CDATA[
	ipb.topic.inSection    = 'topicview';
	ipb.topic.topic_id     = 373777;
	ipb.topic.forum_id     = 76;
	ipb.topic.redirectPost = 1;
	ipb.topic.start_id     = 80;
	ipb.topic.page_id      = 5;
	ipb.topic.topPid       = 0;
	ipb.topic.counts       = { postTotal: 542,
							  curStart:  ipb.topic.start_id,
							  perPage:   20 };
	//Search Setup
	ipb.vars['search_type']			= 'forum';
	ipb.vars['search_type_id']		= 76;
	ipb.vars['search_type_2']		= 'topic';
	ipb.vars['search_type_id_2']	= 373777;
	
	
	// Delete stuff set up
	ipb.topic.deleteUrls['hardDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=04&f=76&t=373777&page=5&auth_key=880ea6a14ea49e853634fbdc5015a024&p=#{pid}" );
	ipb.topic.deleteUrls['softDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=postchoice&tact=sdelete&t=373777&f=76&auth_key=880ea6a14ea49e853634fbdc5015a024&selectedpids[#{pid}]=#{pid}&pid=#{pid}" );
	
	
	ipb.topic.modPerms	  = [];
	
	
	ipb.templates['post_moderation'] = new Template("<div id='comment_moderate_box' class='ipsFloatingAction' style='display: none'><span class='desc'>With <span id='comment_count'>#{count}</span> checked posts: </span><select id='tactInPopup' class='input_select'><option value='approve'>Approve</option><option value='delete'>Hide</option><option value='sundelete'>Unhide</option><option value='deletedo'>Delete</option><option value='merge'>Merge</option><option value='split'>Split</option><option value='move'>Move</option></select>&nbsp;&nbsp;<input type='button' class='input_submit' id='submitModAction' value='Go' /></div>");
	
//]]>
</script>





	<a href='http://forums.oscommerce.com/user/288489-taipo/' class='ipsUserPhotoLink left'>

<img src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' alt='Photo' class='ipsUserPhoto ipsUserPhoto_medium' />

	</a>

<div itemscope itemtype="http://schema.org/Article" class='ipsBox_withphoto'>
	<span itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating" class='rating ipsType_smaller'>
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			<span id='rating_text'>
				
					<span itemprop="ratingCount" id='rating_hits'>2</span> <span>votes</span>
					<meta itemprop="ratingValue" content="5" />
				
			</span>
			
		</span>
	<h1 itemprop="name" class='ipsType_pagetitle'>Oscommerce Security - Osc_Sec.php</h1>
	<div class='desc lighter blend_links'>
		 Started by <span itemprop="creator"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>, <span itemprop="dateCreated" datetime="2011-04-10">Apr 10 2011 11:04</span>
	</div>
	
	<meta itemprop="interactionCount" content="UserComments:542" />
</div>



<br />
<div class='topic_controls'>
	<div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0229139001'>
					<a href='#'>Page 5 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0229139001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Page 3">3</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Page 4">4</a>
						</li>
				

					
						<li class='page active'>5</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Page 6">6</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Page 7">7</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div>
	


	<ul class='topic_buttons'>
			<li class='disabled'><span>Please log in to reply</span></li>
			
			
		</ul>
</div>

<div class='maintitle clear clearfix'>
	<span class='ipsType_small'>
		541 replies to this topic
	</span>
	
</div>

<div class='topic hfeed clear clearfix'>
	
	

	<div class='ipsBox'>
		<div class='ipsBox_container' id='ips_Posts'>
			
				<!--post:1584227-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584227'>
		<a id='entry1584227'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584227' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584227' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #81'>
					
					#81
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #81' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T11:40:25+00:00">22 May 2011 - 11:40</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:47 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584223" data-time="1306062383"><p>Nothing else filters the GET requests. The two other actions that happen are 1/ back in the osc.php the setlocale( LC_TIME, &quot;en_NZ&quot; ); is where setlocale determines the time, so unless that has been changed to the wrong settings it should not interfere with the output, and the other place is where &#036;_REQUEST is reset as a merge of &#036;_GET and &#036;_POST vars. see:  &#036;_REQUEST = array_merge( &#036;_GET, &#036;_POST );<br /><br />The difficulty I am having in trying to debug this is that it tests correct on my test system here. And by the looks of the output it is reporting correctly. The only other thing is the way the browser may be converting the output itself. What is the charset set to in the html head of your page, and what is the charset set to in your browser?<br /><br />ps if you dont mind, can you PM me the url to your website so I can see it for myself?<br /></p></blockquote><br />Ok, the site is using<br /><br /><em class='bbc'>&lt;&#33;doctype html public &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;<br />&lt;html dir=&quot;LTR&quot; lang=&quot;de&quot;&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;</em><br /><br />and the browser is switching according to it (iso-8859-1). <br /><br />Hmm...<br />I see this filtering is a problematic topic. I am just a PHP beginner but had this idea for a workaround:<br />What if we had a global flag for disable the filter once, until the string is sent.<br />At the place where a problematc string is send, just before set the filter disable flag, send the string and the <br />filter activates itself after sending one string.<br />Here is my proposal, you are welcome to make it better or safer  /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' />  <br /><pre class='prettyprint lang-auto linenums:0'>
/*
   Inside the problematic function, just before the string is send add:  
     &#036;oscsec_filter_once_off=true; 
   This disables the filter once. After the string is sent the filter is automatic switched on again. 
*/

  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
    global &#036;oscsec_filter_once_off;  // Flag can be set in any function   
  
    if (&#33;&#036;oscsec_filter_once_off)    // If &#036;oscsec_filter_once_off is set to TRUE skip filtering one time
    {
        /*    For testing only
        unlink(&quot;scrubster.txt&quot;);                  // Erase old logfile first
        &#036;file = fopen(&quot;scrubster.txt&quot;, &quot;a+&quot;);     // Open debug file
        fwrite(&#036;file, &#39;in =&#39;.&#036;nodes.chr(10));     // Write input to file
        */
    
         if ( is_array( &#036;nodes ) ) {
              foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                    if ( is_array( &#036;value ) ) {
                          scrubster( &#036;value );
                    } else {
                          &#036;nodes = getCleaner( &#036;nodes, TRUE );
                          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                          &#036;nodes = getCleaner( &#036;nodes, FALSE );
                    }
              }
         } else {
              &#036;nodes = getCleaner( &#036;nodes, TRUE );
              &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
              &#036;nodes = getCleaner( &#036;nodes, FALSE );
        }
        /*    For testing only
        fwrite(&#036;file, &#39;out=&#39;.&#036;nodes.chr(10).chr(13));             // Write output to file and add new Line
        fclose(&#036;file);     // Close file
        */
     } 
     &#036;oscsec_filter_once_off = False;   // Now automatic enable filtering again for security   
   return &#036;nodes;
  }

</pre><br />Sorry, there is no web access to my store. I hope to be able to open it in august.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584227'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584227" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584227', { domLikeStripId: 'like_post_1584227', app: 'forums', type: 'pid', typeid: '1584227' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584227' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584227);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584227') )
	{
		$('multiq_1584227').show();
	}
	
	if( $('toggle_post_1584227') )
	{
		$('toggle_post_1584227').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584227] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584233-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584233'>
		<a id='entry1584233'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584233' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584233' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #82'>
					
					#82
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #82' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T12:17:40+00:00">22 May 2011 - 12:17</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:47 +0000-->To give you some idea of the issue we are facing, have a look at my test site <a href='http://warbeast.netne.net/' class='bbc_url' title='External link' rel='nofollow external'>http://warbeast.netne.net/</a>. On the top right where you log in I have displayed the same message we are testing with. This has been defined into the includes/language/english.php file and is displaying correctly in both IE and FF. This site is running the latest version of osC_Sec.php. Are those characters displaying correctly in your browser?<br /><br />Here is what I am seeing...<br />[img]http://i53.tinypic.com/2po8nie.jpg[/img]<br /><br />So I am not able to replicate the problem you are having on your site without seeing your site sorry.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584233'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584233" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584233', { domLikeStripId: 'like_post_1584233', app: 'forums', type: 'pid', typeid: '1584233' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584233' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584233);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584233') )
	{
		$('multiq_1584233').show();
	}
	
	if( $('toggle_post_1584233') )
	{
		$('toggle_post_1584233').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584233] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584244-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584244'>
		<a id='entry1584244'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584244' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584244' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #83'>
					
					#83
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #83' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T13:46:47+00:00">22 May 2011 - 13:46</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:47 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584233" data-time="1306066660"><p>To give you some idea of the issue we are facing, have a look at my test site <a href='http://warbeast.netne.net/' class='bbc_url' title='External link' rel='nofollow external'>http://warbeast.netne.net/</a>. On the top right where you log in I have displayed the same message we are testing with. This has been defined into the includes/language/english.php file and is displaying correctly in both IE and FF. This site is running the latest version of osC_Sec.php. Are those characters displaying correctly in your browser?<br /><br />Here is what I am seeing...<br />[img]http://i53.tinypic.com/2po8nie.jpg[/img]<br /><br />So I am not able to replicate the problem you are having on your site without seeing your site sorry.<br /></p></blockquote><br />OK, which data I should enter (coupon code) goods value, test customer data ?
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584244'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584244" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584244', { domLikeStripId: 'like_post_1584244', app: 'forums', type: 'pid', typeid: '1584244' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584244' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584244);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584244') )
	{
		$('multiq_1584244').show();
	}
	
	if( $('toggle_post_1584244') )
	{
		$('toggle_post_1584244').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584244] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584327-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584327'>
		<a id='entry1584327'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584327' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584327' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #84'>
					
					#84
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #84' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T21:20:38+00:00">22 May 2011 - 21:20</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:47 +0000-->I am not sure what you are asking. All I did was enter the German string you were testing, into one of the defined constants in my sites english.php file to see how it is displaying the umlauts. It is not an accurate test because I have not installed the addons you are using. The only other way I can test osC_Sec to try and replicate the conditions you are experiencing is to install all the addons you have installed. If I can replicate the results you are getting then I can find out what is causing the code to display incorrectly.<br />
<br />
In the meantime if you have to, set &#036;GETcleanup to 0 which will disable it.<br />
<br />
By the way, which version of osCommerce are you using?
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584327'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584327" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584327', { domLikeStripId: 'like_post_1584327', app: 'forums', type: 'pid', typeid: '1584327' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584327' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584327);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584327') )
	{
		$('multiq_1584327').show();
	}
	
	if( $('toggle_post_1584327') )
	{
		$('toggle_post_1584327').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584327] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584330-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584330'>
		<a id='entry1584330'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584330' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584330' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #85'>
					
					#85
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #85' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T21:24:32+00:00">22 May 2011 - 21:24</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:47 +0000--><blockquote class='ipsBlockquote' data-author="&#39;popsel&#39;" data-cid="1584244" data-time="1306072007"><p>OK, which data I should enter (coupon code) goods value, test customer data ?<br /></p></blockquote><br />@Taipo<br /><br />Dear Taipo,<br /><br />I don`t know, why your code works on your site and doesn`t show the same result on my site.<br />I see this is a problematic situation for both of us - <br />if you can not reproduce the faulty displayed messages you can`t find a fix for it.<br />If I would have the same output like you, then I woudn`t have a reason to bother you.<br /><br />Anyway, finally I found a workaround (tested with IE6, FF 4.01 and Chrome 11) to display <br />all the problematic messages in the right way here, too /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /> <br /><br />So again, thank you very much for support.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584330'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584330" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584330', { domLikeStripId: 'like_post_1584330', app: 'forums', type: 'pid', typeid: '1584330' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584330' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584330);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584330') )
	{
		$('multiq_1584330').show();
	}
	
	if( $('toggle_post_1584330') )
	{
		$('toggle_post_1584330').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584330] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584332-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584332'>
		<a id='entry1584332'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584332' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584332' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #86'>
					
					#86
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #86' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T21:33:09+00:00">22 May 2011 - 21:33</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584327" data-time="1306099238"><p>I am not sure what you are asking. All I did was enter the German string you were testing...<br /></p></blockquote><br />Yes, this is not the same situation. I thought you have installed the same plugin, too. Then I would need to log in as a customer and need a valid coupon code for testing  /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /> <br /><br /><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584327" data-time="1306099238"><p>In the meantime if you have to, set &#036;GETcleanup to 0 which will disable it.<br /></p></blockquote>With my workaround I can leave it at &#036;GETcleanup=1 to keep it more secure. <br /><br /><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584327" data-time="1306099238"><p>By the way, which version of osCommerce are you using?<br /></p></blockquote><br />I am using OSC V2.2rc2a
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584332'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584332" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584332', { domLikeStripId: 'like_post_1584332', app: 'forums', type: 'pid', typeid: '1584332' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584332' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584332);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584332') )
	{
		$('multiq_1584332').show();
	}
	
	if( $('toggle_post_1584332') )
	{
		$('toggle_post_1584332').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584332] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584335-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584335'>
		<a id='entry1584335'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584335' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584335' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #87'>
					
					#87
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #87' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-22T21:50:24+00:00">22 May 2011 - 21:50</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;popsel&#39;" data-cid="1584332" data-time="1306099989"><p>Yes, this is not the same situation. I thought you have installed the same plugin, too. Then I would need to log in as a customer and need a valid coupon code for testing  /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /> <br /><br /><br />With my workaround I can leave it at &#036;GETcleanup=1 to keep it more secure. <br /><br /><br /><br />I am using OSC V2.2rc2a<br /></p></blockquote><br />Finally I can show some pics how it looks with my workaround:<br /><br />[IMG]http://i53.tinypic.com/16c6eys.jpg[/IMG]<br /><br />[IMG]http://i53.tinypic.com/219qkra.jpg[/IMG]
					
					<br />
					<p class='edit'>
							<strong>Edited by popsel, 22 May 2011 - 21:53.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584335'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584335" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584335', { domLikeStripId: 'like_post_1584335', app: 'forums', type: 'pid', typeid: '1584335' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584335' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584335);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584335') )
	{
		$('multiq_1584335').show();
	}
	
	if( $('toggle_post_1584335') )
	{
		$('toggle_post_1584335').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584335] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584359-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584359'>
		<a id='entry1584359'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584359' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584359' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #88'>
					
					#88
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #88' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T02:11:00+00:00">23 May 2011 - 02:11</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->I would still like to get to the bottom of this if possible even just for my own reference. Can you give me a list of every addon you are using. I see you have listed Discount Coupon Codes V3.34 and Order Editor V5.09 so far. Once I have that list I can set up a test scenario here and activate the German language and try to replicate the issue you have brought up.<br />
<br />
It seems that perhaps one of those addons is reacting to another section of osC_Sec.php other than the section we are working on. I would like to find out which part of that code that is causing the problem.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584359'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584359" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584359', { domLikeStripId: 'like_post_1584359', app: 'forums', type: 'pid', typeid: '1584359' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584359' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584359);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584359') )
	{
		$('multiq_1584359').show();
	}
	
	if( $('toggle_post_1584359') )
	{
		$('toggle_post_1584359').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584359] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584373-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584373'>
		<a id='entry1584373'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584373' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584373' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #89'>
					
					#89
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #89' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T05:38:24+00:00">23 May 2011 - 05:38</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584359" data-time="1306116660"><p>I would still like to get to the bottom of this if possible even just for my own reference. Can you give me a list of every addon you are using. I see you have listed Discount Coupon Codes V3.34 and Order Editor V5.09 so far. Once I have that list I can set up a test scenario here and activate the German language and try to replicate the issue you have brought up.<br /><br />It seems that perhaps one of those addons is reacting to another section of osC_Sec.php other than the section we are working on. I would like to find out which part of that code that is causing the problem.<br /></p></blockquote><br />Hi&#33;<br /><br />I have a heavy modified shop with tons of addons and some own things.<br />You will have a lot of fun  /biggrin.gif' class='bbc_emoticon' alt=':D' />  :<br /><br /><br /><strong class='bbc'> Add 3 Images with Admin <br /> Add Qty to listings (Mengeneingabebox) <br /> Admin German 2.2MS2 <br /> Admin Reports Count Reset <br /> über Skype anrufen <br /> AGB Zustimmung <br /> AJAX Attribute Manager ++ <br /> All In One FCK Editor WYSIWYG Editor <br /> Anti Robot Validation <br /> Artikelnummer automatisch hochzählen lassen <br /> Auto Update Currencies V 1.0 <br /> Banner Manager für Rc2.2a <br /> Banner Picture Hack in Banner Manager <br /> Better SEO Images V1.1 <br /> Box Caching erweitern <br /> Center Shop (Shopbreite begrenzen) <br /> change date format <br /> CK EDITOR nightly &amp;  Install Instructions +++ <br /> Counter Reset V1.0 <br /> Cronjob on Windows Xampp <br /> CSS hover enlarged image popup MOD <br /> CSS MENU OK <br /> Cycling products +++ <br /> Database Optimizer V 1.0 <br /> Datenschutz Zustimmung in Popup <br /> Datum auf DEUTSCH UMSTELLEN <br /> Delete Category Images V 1.0 <br /> Discount Coupon Codes +++ <br /> Easy Tool Tip text balloon ++ <br /> EUR-Zeichen in QSCommerce <br /> Extra pages-info box w admin <br /> Falsche Rundung von osCommerce - gelöst&#33; P <br /> Faster Page Loads, Less DB queries <br /> FCK Player Plugin &amp; Free Video to Flash Converter <br /> Flash Banners <br /> Flash Videos in den Hintergrund bringen <br /> Hermes Export <br /> HTML Status Update Auto-emailer with product images and links +++ <br /> HTML-Befehle Übersicht <br /> If price = 0.00 dont display price <br /> Image Check <br /> Image Hack Protection <br /> Image Upload Resizer <br /> Impressum <br /> Länderliste DE oben <br /> Leerzeichen bei Währung &amp; Preis <br /> Low Stock Report <br /> Mp3_preview_with_Flash_player_v1.0 <br /> MWST und Versandkostenanzeige <br /> Nachnamen bei den Bewertungen nicht mehr anzeigen <br /> Order Editor 5.09b <br /> OS COMMERCE How to install a contribution <br /> Page Cache 1.6 <br /> Payment Type Charge <br /> PaymethodsQuickinfobox <br /> Preisauszeichnungsverordnung MWST und Versandkostenanzeige <br /> Products thumbnail image display and popups on the admin <br /> Punkt statt Komma am Num. Ziffernblock <br /> Pure CSS Image Swap On Hover For osC Buttons <br /> Rechnungslayout über Admin + Texteingabe in Rechnung <br /> Report Missing &amp; unassinged Images <br /> Review Notification <br /> Sales Report Between Two Dates <br /> Scrolling Bestsellers <br /> Send Admin HTML e-mails <br /> SEO Assistant <br /> SEO images v.0.99 <br /> Skype Contact <br /> Store Mode (Open  Closed  Maintenance) <br /> Vorschau bei neuem Produkt oder bei Update überspringen <br /> Widerrufsbelehrung <br /> XPricesPerProduct +++ <br /> X-Sell (Produktverlinkung NEUE VERSION) <br /> Zones International Default  Zonesworld Version_v2.zip <br /> OSC_SEC(urity) latest version with fix<br /> SiteMonitor <br /></strong><br /><br />I don`t want to bother you again, but if you like to know about other problemns I had with OSC_SEC:<br /><br />So far I had to find workarounds because these addons in combination with OSC_SEC did not work in my shop: <br /><em class='bbc'>Rechnungslayout über Admin + Texteingabe in Rechnung </em> <br /><em class='bbc'> AJAX Attribute Manager</em>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584373'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584373" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584373', { domLikeStripId: 'like_post_1584373', app: 'forums', type: 'pid', typeid: '1584373' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584373' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584373);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584373') )
	{
		$('multiq_1584373').show();
	}
	
	if( $('toggle_post_1584373') )
	{
		$('toggle_post_1584373').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584373] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584379-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584379'>
		<a id='entry1584379'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584379' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584379' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #90'>
					
					#90
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #90' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T06:25:14+00:00">23 May 2011 - 06:25</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->The problem with the AJAX Attrib Manager will probably also be linked to the &#036;GETcleanup issue as well.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584379'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584379" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584379', { domLikeStripId: 'like_post_1584379', app: 'forums', type: 'pid', typeid: '1584379' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584379' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584379);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584379') )
	{
		$('multiq_1584379').show();
	}
	
	if( $('toggle_post_1584379') )
	{
		$('toggle_post_1584379').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584379] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584386-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584386'>
		<a id='entry1584386'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584386' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584386' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #91'>
					
					#91
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #91' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T08:23:28+00:00">23 May 2011 - 08:23</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584359" data-time="1306116660"><p>I would still like to get to the bottom of this if possible even just for my own reference. Can you give me a list of every addon you are using. I see you have listed Discount Coupon Codes V3.34 and Order Editor V5.09 so far. Once I have that list I can set up a test scenario here and activate the German language and try to replicate the issue you have brought up.<br /><br />It seems that perhaps one of those addons is reacting to another section of osC_Sec.php other than the section we are working on. I would like to find out which part of that code that is causing the problem.<br /></p></blockquote><br />Hi&#33;<br /><br />I see, even after a lot of posts, it may be still unclear for you, why it doesn`t work ?<br /><br />Your code could not help me to fix this problem  because, even after all these changes,<br /> it filters <span class='bbc_underline'>uncoded</span> umlaut characters (ä ü ....) and the € sign.<br /><br />That is the reason why it did not work for me and I had to find a workaround.<br /><br />If you still don`t have enough you may continue investigating it /wink.gif' class='bbc_emoticon' alt=';)' />
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584386'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584386" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584386', { domLikeStripId: 'like_post_1584386', app: 'forums', type: 'pid', typeid: '1584386' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584386' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584386);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584386') )
	{
		$('multiq_1584386').show();
	}
	
	if( $('toggle_post_1584386') )
	{
		$('toggle_post_1584386').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584386] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584387-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584387'>
		<a id='entry1584387'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584387' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584387' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #92'>
					
					#92
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #92' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T08:36:40+00:00">23 May 2011 - 08:36</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->I did not realise it was affecting the uncoded umlauts. This <em class='bbc'>may</em> work better then:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                    &#036;nodes = getCleaner( &#036;nodes, TRUE );
                    &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                    &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
	             &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig,axe,oxe,uxe,Axe,Oxe,Uxe,euxro,szlxig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}
</pre><br />As you saw in your debug print out that you did, the cleaner actually did not affect the encoded umlauts, yet they were still displaying incorrectly afterward.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584387'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584387" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584387', { domLikeStripId: 'like_post_1584387', app: 'forums', type: 'pid', typeid: '1584387' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584387' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584387);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584387') )
	{
		$('multiq_1584387').show();
	}
	
	if( $('toggle_post_1584387') )
	{
		$('toggle_post_1584387').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584387] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584395-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584395'>
		<a id='entry1584395'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584395' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584395' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #93'>
					
					#93
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #93' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T09:32:16+00:00">23 May 2011 - 09:32</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584387" data-time="1306139800"><p>I did not realise it was affecting the uncoded umlauts. This <em class='bbc'>may</em> work better then:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
 	if ( is_array( &#036;nodes ) ) {
  	foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  	      	scrubster( &#036;value );
                } else {
                    &#036;nodes = getCleaner( &#036;nodes, TRUE );
                    &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                    &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
 	} else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,äöüÄÖÜ€ß=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
          	&#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
                 &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig,axe,oxe,uxe,Axe,Oxe,Uxe,euxro,szlxig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
   	if ( &#036;conv &gt; 0 ) {
       	&#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
   	} else {
       &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
   	}
    }
    return &#036;string;
}
</pre><br />As you saw in your debug print out that you did, the cleaner actually did not affect the encoded umlauts, yet they were still displaying incorrectly afterward.<br /></p></blockquote><br />Hi&#33;<br /><br />I did a quick test, and the <span class='bbc_underline'>uncoded</span> umlauts are still gone after passing OSC_SEC. <br />You can test it yourself with a logging function like I did.<br />Feed OSC_SEC with some uncoced umlaut strings and look into the debug file output  what is left over - very simple method.<br />If there are missing umlaut or € sign chars then something is wrong. <br />That is the reason why it works for me <span class='bbc_underline'>if filtering is disabled</span> / OSC_SEC is bypassed.<br /><br />For now I have to continue developing my store - there is still a lot of work to do.<br />So I have no more time for tests with this topic.<br />Actually my workaround is working for me,  so I will stick to it.<br /><br />If you can find a way to fix the problem, it would be great if you could include this in the next official OSC_SEC update.<br /><br /><br />Cheers&#33;
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584395'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584395" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584395', { domLikeStripId: 'like_post_1584395', app: 'forums', type: 'pid', typeid: '1584395' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584395' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584395);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584395') )
	{
		$('multiq_1584395').show();
	}
	
	if( $('toggle_post_1584395') )
	{
		$('toggle_post_1584395').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584395] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584401-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584401'>
		<a id='entry1584401'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584401' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584401' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #94'>
					
					#94
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #94' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T10:21:12+00:00">23 May 2011 - 10:21</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->Unfortunately we are constantly getting two different sets of results from the same piece of script. There must be other variables involved that are outside of what osC_Sec does as my testing has no problems in displaying the uncoded ulmauts, so I am unable to assist any more with this sorry. However I think as it stands, the code above does improve the way osC_Sec filters the ulmauts so I will leave it in the next version when it is released. Sorry I could not be of more assistance to you.
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 23 May 2011 - 10:32.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584401'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584401" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584401', { domLikeStripId: 'like_post_1584401', app: 'forums', type: 'pid', typeid: '1584401' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584401' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584401);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584401') )
	{
		$('multiq_1584401').show();
	}
	
	if( $('toggle_post_1584401') )
	{
		$('toggle_post_1584401').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584401] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584407-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584407'>
		<a id='entry1584407'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584407' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584407' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #95'>
					
					#95
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #95' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T11:00:32+00:00">23 May 2011 - 11:00</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->For Reference this is a test.<br />Settings:<br />- Character encoding in your browser set to Western(ISO-8859-1)<br />- in includes/language/yourlanguage.php set define(&#39;CHARSET&#39;, &#39;iso-8859-1&#39;);<br /><br />In application_top.php, after<br /><pre class='prettyprint lang-auto linenums:0'>require(&#39;includes/osc_sec.php&#39;);</pre><br />paste this code:<br /><pre class='prettyprint lang-auto linenums:0'>
echo scrubster( &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;auml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß &#91;w&#93;(o)%3Cr%3Ek|i*n^g&quot; );
</pre><br />You should see the resulting text when you load your site.<br /><br /><blockquote class='ipsBlockquote' ><p>ä,ö,ü,Ä,Ö,Ü,€,ß,ä,ä,ü,Ä,Ö,Ü,€,ß,ä,ö,ü,Ä,Ö,Ü,€,ß working</p></blockquote>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584407'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584407" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584407', { domLikeStripId: 'like_post_1584407', app: 'forums', type: 'pid', typeid: '1584407' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584407' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584407);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584407') )
	{
		$('multiq_1584407').show();
	}
	
	if( $('toggle_post_1584407') )
	{
		$('toggle_post_1584407').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584407] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584425-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584425'>
		<a id='entry1584425'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584425' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584425' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #96'>
					
					#96
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #96' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="125658" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/125658-rdva/' title='View Profile'><span itemprop="name">rdva</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">rdva</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/125658-rdva/" title="View Profile: rdva" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/bd33a186fbbad9983f288c6bf52c916b?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">rdva</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Saint-Petersburg, Russia</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@rdva' ); return false;" title="@rdva">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T13:36:38+00:00">23 May 2011 - 13:36</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->Taipo, i have similar to popsel&#39;s problem with russian language. Function scrubster() filters out all non-latin symbols. All russian symbols is non-latin. The workaround (for me) is:<br /><br />find<br /><pre class='prettyprint lang-auto linenums:0'>preg_replace(&quot;/&#91;^ a-zA-Z0-9?=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );</pre>replace with<br /><pre class='prettyprint lang-auto linenums:0'>preg_replace(&quot;/&#91;^ a-zA-Zа-яА-Я0-9?=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );</pre><br />Can u see the difference? Is your browser correctly display cyrilic symbols?
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584425'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584425" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584425', { domLikeStripId: 'like_post_1584425', app: 'forums', type: 'pid', typeid: '1584425' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1584425' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584425);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584425') )
	{
		$('multiq_1584425').show();
	}
	
	if( $('toggle_post_1584425') )
	{
		$('toggle_post_1584425').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584425] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584444-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584444'>
		<a id='entry1584444'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584444' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584444' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #97'>
					
					#97
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #97' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T14:53:45+00:00">23 May 2011 - 14:53</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584407" data-time="1306148432"><p>For Reference this is a test.<br />Settings:<br />- Character encoding in your browser set to Western(ISO-8859-1)<br />- in includes/language/yourlanguage.php set define(&#39;CHARSET&#39;, &#39;iso-8859-1&#39;);<br /><br />In application_top.php, after<br /><pre class='prettyprint lang-auto linenums:0'>require(&#39;includes/osc_sec.php&#39;);</pre><br />paste this code:<br /><pre class='prettyprint lang-auto linenums:0'>
echo scrubster( &quot;ä,ö,ü,Ä,Ö,Ü,€,ß,&amp;auml;,&amp;auml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß &#91;w&#93;(o)%3Cr%3Ek|i*n^g&quot; );
</pre><br />You should see the resulting text when you load your site.<br /><br /><br /></p></blockquote><br />Taipo, I get this with your test (CHARSET&#39;, &#39;iso-8859-1&#39;) in languages/german.php and same setting in FF:<br />[img]http://i52.tinypic.com/1pcu2s.png[/img]<br /><br />with this code in scrubster:<br /><pre class='prettyprint lang-auto linenums:0'>
     	if ( is_array( &#036;nodes ) ) {
          	foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                	if ( is_array( &#036;value ) ) {
                      	scrubster( &#036;value );
                	} else {
                      	&#036;nodes = getCleaner( &#036;nodes, TRUE );
                      	&#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) ); 
                      	&#036;nodes = getCleaner( &#036;nodes, FALSE );
                	}
          	}
     	} else {
          	&#036;nodes = getCleaner( &#036;nodes, TRUE );
          	&#036;nodes = preg_replace(&quot;/&#91;^ a-zA-Z0-9?,=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          	&#036;nodes = getCleaner( &#036;nodes, FALSE );
    	}
</pre><br />and this code in getCleaner:<br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */   
  function getCleaner(&#036;string, &#036;conv=1) {
	&#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
              	&#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . 
                 	&#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
	&#036;tolist = explode(&quot;,&quot;, &quot;ä,ö,ü,Ä,Ö,Ü,€,ß,&amp;auml;,&amp;auml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
	&#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig,axe,oxe,uxe,Axe,Oxe,Uxe,euxro,szlxig&quot;);
	&#036;finlist = explode(&quot;,&quot;, &quot;ä,ö,ü,Ä,Ö,Ü,€,ß,ä,ö,ü,Ä,Ö,Ü,€,ß,ä,ö,ü,Ä,Ö,Ü,€,ß&quot;);
	for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
   	if ( &#036;conv &gt; 0 ) {
       	&#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
   	} else {
       	&#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
   	}
	}
	return &#036;string;
}

</pre>
					
					<br />
					<p class='edit'>
							<strong>Edited by popsel, 23 May 2011 - 15:01.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584444'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584444" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584444', { domLikeStripId: 'like_post_1584444', app: 'forums', type: 'pid', typeid: '1584444' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584444' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584444);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584444') )
	{
		$('multiq_1584444').show();
	}
	
	if( $('toggle_post_1584444') )
	{
		$('toggle_post_1584444').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584444] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584549-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584549'>
		<a id='entry1584549'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584549' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584549' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #98'>
					
					#98
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #98' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-23T23:31:52+00:00">23 May 2011 - 23:31</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->I have changed the cleanup syntax below. This may render some more of the non-english char items than the previous one. Using the perl compatible regular expressions will hopefully allow the browser character settings to make a better determination of what is displayed and what isn&#39;t. However this may not work on some locale settings.<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;ouml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}</pre>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584549'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584549" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584549', { domLikeStripId: 'like_post_1584549', app: 'forums', type: 'pid', typeid: '1584549' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584549' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584549);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584549') )
	{
		$('multiq_1584549').show();
	}
	
	if( $('toggle_post_1584549') )
	{
		$('toggle_post_1584549').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584549] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584591-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584591'>
		<a id='entry1584591'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584591' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584591' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #99'>
					
					#99
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #99' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T07:27:39+00:00">24 May 2011 - 07:27</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584549" data-time="1306193512"><p>I have changed the cleanup syntax below. This may render some more of the non-english char items than the previous one. Using the perl compatible regular expressions will hopefully allow the browser character settings to make a better determination of what is displayed and what isn&#39;t. However this may not work on some locale settings.<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
 	if ( is_array( &#036;nodes ) ) {
  	foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
        		scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
 	} else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
          	&#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;ouml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
   	if ( &#036;conv &gt; 0 ) {
   		&#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
   	} else {
   	&#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
   	}
    }
    return &#036;string;
}</pre></p></blockquote><br />Hi&#33;<br /><br />Using the code above I get now in FF:<br />ä,ö,ü,Ä,Ö,Ü,€,ß,ä,ä,ü,Ä,Ö,Ü,€,ß,Ã,Ã,Ã,Ã,Ã,Ãœ,â‚¬,ÃŸ working  <br /><br />and under real conditions FF outputs:<br />Der Mindestbestellwert für diesen Gutschein beträgt  10,00  und wurde noch nicht erreicht<br /><br />This is looking good, but where is the<strong class='bbc'> <span  style='font-size: 14px'>€</span></strong> sign ?<br /><br />For your information:<br />The biggest problem with osc_sec for me was the fact, it filtered umlauts in Order Editor.<br />After changing an address with unlauts and a page reload the umlauts were gone.<br />This was a really heavy limitation and making Order Editor close to useless.<br />After your very first code change I could work with Order Editor and umlauts /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /><br />Displaying an error message with wrong chars, which only some people may see,<br />is not that much important. So I was happy at the end to find a workaround for that.<br /><br /><br /><span class='bbc_underline'>Actually the situation changed:</span><br /><br />The error messages display nearly perfect (beside the € sign),<br />but in Order Editior I have the same problem again:<br />All umlauts are removed aftter changing it and a page reload [img]http://forums.oscommerce.com/public/style_emoticons/default/crying.gif[/img]
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584591'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584591" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584591', { domLikeStripId: 'like_post_1584591', app: 'forums', type: 'pid', typeid: '1584591' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584591' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584591);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584591') )
	{
		$('multiq_1584591').show();
	}
	
	if( $('toggle_post_1584591') )
	{
		$('toggle_post_1584591').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584591] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584602-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584602'>
		<a id='entry1584602'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584602' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5#entry1584602' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #100'>
					
					#100
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #100' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T08:19:19+00:00">24 May 2011 - 08:19</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Fri, 18 Jul 2014 16:11:48 +0000-->I think the problem again is that for some reason some of these addons are calling constant defined variables via HTTP_GET_VARS instead of just calling the defined item directly.<br /><br />However, these are some of the issues we have to face when working around each others addons.<br /><br />Try this one out then. It is a bit of the old (as in a bit of the original fix) and a bit of the new.<br /><br />Replace the entire piece above with this. It should at a guess, cause the order editor to work better.<br /><br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) );
                }
          }
     } else {
          &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }
</pre>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584602'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584602" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584602', { domLikeStripId: 'like_post_1584602', app: 'forums', type: 'pid', typeid: '1584602' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584602' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584602);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584602') )
	{
		$('multiq_1584602').show();
	}
	
	if( $('toggle_post_1584602') )
	{
		$('toggle_post_1584602').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584602] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			
		</div>
	</div>

<hr />
<div class='topic_controls clear ipsPad_top_bottom_half'>
	
		<div class='left'><div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0229139001'>
					<a href='#'>Page 5 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0229139001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-3" title="Oscommerce Security - Osc_Sec.php - Page 3">3</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Page 4">4</a>
						</li>
				

					
						<li class='page active'>5</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Page 6">6</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Page 7">7</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div></div>
	
	<div class='ipsPad_top_slimmer right'>
		
		<a href='http://forums.oscommerce.com/forum/76-security/' class="ipsType_small desc">Back to Security</a>
		
	</div>
</div>

<!-- Close topic -->
</div>
<!-- BOTTOM BUTTONS -->

	<br />
	<div class='clear clearfix left'>
		

	<ul class='topic_share left shareButtons ipsList_inline'>
	
		<li><a href="http://forums.oscommerce.com/index.php?sharelink=twitter;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Twitter" class='_slink' id='slink_twitter'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/twitter.png" /></a></li>
	

		
				<li class='fbLike'><div class="fb-like" data-href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" data-send="false" data-layout="button_count" data-width="150" data-show-faces="false" data-action="like"></div><div id="fb-root"></div></li>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=203307189516";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
			
	

		
				<script type="text/javascript" src="https://apis.google.com/js/plusone.js">
	
		{lang: 'en-GB'}
	
</script>
<li><div class='googlePlusOne'><g:plusone count="false" size="small"></g:plusone></div></li>
			
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=digg;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Digg" class='_slink' id='slink_digg'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/digg.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=delicious;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Del.icio.us" class='_slink' id='slink_delicious'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/delicious.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=reddit;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Reddit" class='_slink' id='slink_reddit'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/reddit.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=stumble;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via StumbleUpon" class='_slink' id='slink_stumble'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/stumble.png" /></a></li>
	

		
	
	</ul>
	<script type="text/javascript">
		ipb.sharelinks.url   = "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/";
		ipb.sharelinks.title = "Oscommerce Security - Osc_Sec.php";
		ipb.sharelinks.bname = "osCommerce Support Forum";
	</script>

	</div>
	<br />

<!-- SAME TAGGED -->

<!-- ACTIVE USERS -->



	<script type="text/javascript" src="http://forums.oscommerce.com/public/js/3rd_party/prettify/prettify.js"></script>
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prettify/lang-sql.js'></script>
	<!-- By default we load generic code, php, css, sql and xml/html; load others here if desired -->
	<script type="text/javascript">
	//<![CDATA[
		Event.observe( window, 'load', function(e){ prettyPrint() });
	//]]>
	</script>
<div id='multiQuoteInsert' style='display: none;' class='ipsFloatingAction'>
	<span class='ipsButton no_width' id='mqbutton'>Reply to quoted posts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#' id='multiQuoteClear' class='ipsType_smaller desc' title='Clear the posts you have selected with MultiQuote'>Clear</a> &nbsp;&nbsp;&nbsp;
</div>
<form id="modform" method="post" action="http://forums.oscommerce.com/index.php?">
	<input type="hidden" name="app" value="forums" />
	<input type="hidden" name="module" value="moderate" />
	<input type="hidden" name="section" value="moderate" />
	<input type="hidden" name="do" value="postchoice" />
	<input type="hidden" name="f" value="76" />
	<input type="hidden" name="t" value="373777" />
	<input type="hidden" name="auth_key" value="880ea6a14ea49e853634fbdc5015a024" />
	<input type="hidden" name="st" value="" />
	<input type="hidden" name="page" value="5" />
	<input type="hidden" value="" name="selectedpidsJS" id='selectedpidsJS' />
	<input type="hidden" name="tact" id="tact" value="" />
</form>
				
					<div class='ipsAd'><script>
var oscGetPartnerBannerUrl = 'http://www.oscommerce.com/index.php?RPC&Website&Index&GetPartnerBanner';
if ( typeof oscForumID != 'undefined' ) {
  oscGetPartnerBannerUrl = oscGetPartnerBannerUrl + '&forumid=' + oscForumID;
}
document.write('<script src="' + oscGetPartnerBannerUrl + '"><\/script>');
</script></div>
				
				<ol class='breadcrumb bottom ipsList_inline left clearfix clear'>
											<li><a href='http://forums.oscommerce.com/'>osCommerce Support Forum</a></li>
							
						
							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x'><span>osCommerce Online Merchant v2.x</span></a></li>
							
						

							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security'><span>Security</span></a></li>
							
						

					
					<li class='right ipsType_smaller'>
						<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
					</li>
					
					<li class='right ipsType_smaller'>
							<a href='http://forums.oscommerce.com/index.php?app=forums&amp;module=extras&amp;section=boardrules' title='Forum Rules'>Forum Rules</a> &middot; 
						</li>
				</ol>
			</div>
			<!-- ::: FOOTER (Change skin, language, mark as read, etc) ::: -->
			<div id='footer_utilities' class='main_width clearfix clear'>
				<a rel="nofollow" href='#top' id='backtotop' title='Go to top'><img src='http://forums.oscommerce.com/public/style_images/master/top.png' alt='' /></a>
				<ul class='ipsList_inline left'>
					<li>
						<img src='http://forums.oscommerce.com/public/style_images/master/feed.png' alt='RSS Feed' id='rss_feed' class='clickable' />
					</li>
					
							
								<li>
									<a rel="nofollow" id='new_skin' href='#' title='Change Theme'>Change Theme</a>
									<ul id='new_skin_menucontent' class='ipbmenu_content with_checks' style='display: none'>
										
											<li class='selected'>
												<a href='#' data-clicklaunch='changeSkin' data-skinid='1'>IP.Board</a>
											</li>
										

											<li >
												<a href='#' data-clicklaunch='changeSkin' data-skinid='3'>IP.Board Mobile</a>
											</li>
										
									</ul>
								</li>
							
					
					
					<li>
						<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=help" title='View help' rel="help" accesskey='6'>Help</a>
					</li>
				</ul>
				<!-- Copyright Information -->
        				  <p id='copyright'>
        				  	<a href='http://www.invisionpower.com/apps/board/' title='Community Forum Software by Invision Power Services'>Community Forum Software by IP.Board</a></p>
		<!-- / Copyright -->
			</div>
			
			
			
				<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/lightbox.js'></script>
<script type='text/javascript'>
//<![CDATA[
	// Lightbox Configuration
	LightboxOptions = Object.extend({
	    fileLoadingImage:        'http://forums.oscommerce.com/public/style_images/master/lightbox/loading.gif',
	    fileBottomNavCloseImage: 'http://forums.oscommerce.com/public/style_images/master/lightbox/closelabel.gif',
	    overlayOpacity: 0.8,   // controls transparency of shadow overlay
	    animate: true,         // toggles resizing animations
	    resizeSpeed: 10,        // controls the speed of the image resizing animations (1=slowest and 10=fastest)
	    borderSize: 10,         //if you adjust the padding in the CSS, you will need to update this variable
		// When grouping images this is used to write: Image # of #.
		// Change it for non-english localization
		labelImage: "Image",
		labelOf: "of"
	}, window.LightboxOptions || {});
/* Watch for a lightbox image and set up our downloadbutton watcher */
document.observe('click', (function(event){
    var target = event.findElement('a[rel*="lightbox"]') || event.findElement('area[rel*="lightbox"]') || event.findElement('span[rel*="lightbox"]');
    if (target) {
        event.stop();
        gbl_addDownloadButton();
    }
}).bind(this));
var _to    = '';
var _last  = '';
function gbl_addDownloadButton()
{
	if ( typeof( ipsLightbox.lightboxImage ) != 'undefined' && ipsLightbox.lightboxImage.src )
	{
		if ( _last != ipsLightbox.lightboxImage.src )
		{
			if ( ! $('gbl_d') )
			{
				$('bottomNav').insert( { top: "<div id='gbl_d' style='text-align:right;padding-bottom:4px;'></div>" } );
			}
			
			$('gbl_d').update( "<a href='"+ ipsLightbox.lightboxImage.src + "' target='_blank'><img src='http://forums.oscommerce.com/public/style_images/master/lightbox/download-icon.png' /></a>" );
			
			_last = ipsLightbox.lightboxImage.src;
		}
	}
	
	/* Check for init and then keep checking for new image */
	_to = setTimeout( "gbl_addDownloadButton()", 1000 );
}
//]]>
</script>
			
			<div id='inline_login_form' style="display:none">
		<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login&amp;do=process" method="post" id='login'>
				<input type='hidden' name='auth_key' value='880ea6a14ea49e853634fbdc5015a024' />
				<input type="hidden" name="referer" value="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" />
				<h3>Sign In</h3>
				
				<br />
				<div class='ipsForm ipsForm_horizontal'>
					<fieldset>
						<ul>
							<li class='ipsField'>
								<div class='ipsField_content'>
									Need an account? <a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Register now!'>Register now!</a>
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_username' class='ipsField_title'>Username or email:</label>
								<div class='ipsField_content'>
									<input id='ips_username' type='text' class='input_text' name='ips_username' size='30' tabindex='0' />
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_password' class='ipsField_title'>Forum Password</label>
								<div class='ipsField_content'>
									<input id='ips_password' type='password' class='input_text' name='ips_password' size='30' tabindex='0' /><br />
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=lostpass' title='Retrieve password'>I've forgotten my password</a>
								</div>
							</li>
							<li class='ipsField ipsField_checkbox'>
								<input type='checkbox' id='inline_remember' checked='checked' name='rememberMe' value='1' class='input_check' tabindex='0' />
								<div class='ipsField_content'>
									<label for='inline_remember'>
										<strong>Remember me</strong><br />
										<span class='desc lighter'>This is not recommended for shared computers</span>
									</label>
								</div>
							</li>
							
							
							<li class='ipsPad_top ipsForm_center desc ipsType_smaller'>
								<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
							</li>
							
						</ul>
					</fieldset>
					
					<div class='ipsForm_submit ipsForm_center'>
						<input type='submit' class='ipsButton' value='Sign In' tabindex='0' />
					</div>
				</div>
			</form>
	</div>
		</div>
		
		
		<script type='text/javascript'>
			if( $('primary_nav') ){	ipb.global.activateMainMenu(); }
		</script>
			</body>
</html>
