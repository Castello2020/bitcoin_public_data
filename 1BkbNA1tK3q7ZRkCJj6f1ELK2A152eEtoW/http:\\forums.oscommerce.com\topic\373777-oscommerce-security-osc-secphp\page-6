http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6
HTTP/1.1 200 OK
Server: nginx
Date: Thu, 24 Jul 2014 12:21:14 GMT
Content-Type: text/html;charset=UTF-8
Connection: close
Set-Cookie: session_id=86a5c96e819a51f015668b1991c0d724; path=/; domain=.oscommerce.com; httponly
Set-Cookie: modpids=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; domain=.oscommerce.com
Cache-Control: no-cache, must-revalidate, max-age=0
Expires: Wed, 23 Jul 2014 12:21:14 GMT
Pragma: no-cache
Content-Encoding: gzip
Vary: Accept-Encoding

<!DOCTYPE html>
	<html lang="en"  xmlns:fb="http://www.facebook.com/2008/fbml">
	<head>
		<meta charset="UTF-8" />
		<title>Oscommerce Security - Osc_Sec.php - Page 6 - Security - osCommerce Support Forum</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<link rel="shortcut icon" href='http://forums.oscommerce.com/favicon.ico' />
		<link rel="image_src" href='http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png' />
		<script type='text/javascript'>
		//<![CDATA[
			jsDebug			= 0; /* Must come before JS includes */
			DISABLE_AJAX	= parseInt(0); /* Disables ajax requests where text is sent to the DB; helpful for charset issues */
			inACP			= false;
			var isRTL		= false;
			var rtlIe		= '';
			var rtlFull		= '';
		//]]>
		</script>
		
	
				
			<link rel="stylesheet" type="text/css" title="Main" media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/calendar_select.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_common.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css" title="Main" media="screen,print" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_styles.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	

				
			<link rel="stylesheet" type="text/css"  href="http://forums.oscommerce.com/public/style_css/prettify.css?ipbv=f0051d8914fe132bc0130fe6bbd729c6" />
		
	
	

<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" title='Main' media="screen" href="http://forums.oscommerce.com/public/style_css/css_1/ipb_ie.css" />
<![endif]-->
<!--[if lte IE 8]>
	<style type='text/css'>
		.ipb_table { table-layout: fixed; }
		.ipsLayout_content { width: 99.5%; }
	</style>
<![endif]-->

	<style type='text/css'>
		img.bbc_img { max-width: 100% !important; }
	</style>

		<meta property="og:title" content="Oscommerce Security - Osc_Sec.php - Page 6 - Security"/>
		<meta property="og:site_name" content="osCommerce Support Forum"/>
		<meta property="og:type" content="article" />
		
	
		
		
			<meta property="og:updated_time" content="1306756517" />
		
		
		
		
	

		
		
			<meta name="keywords" content="Oscommerce,Security,Osc_Secphp,works,Windows,test,server,Linux,production,serverI,have,changed,cleanup,syntax,below,This,may,render,some,more" />
		
		
		
		
	

		
		
			<meta name="description" content="Page 6 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: It works at Windows (my test server) and do not works at Linux (production server).I have changed the cleanup syntax below. This may render some more of the non-english char items than the previous one. Using the perl compatible regular expressions will hopefully allow the browser character settings to make a better determination of what is displayed and what isn&#39;t. However this may not work on some locale settings...." />
		
		
		
			<meta property="og:description" content="Page 6 of 28 - Oscommerce Security - Osc_Sec.php - posted in Security: It works at Windows (my test server) and do not works at Linux (production server).I have changed the cleanup syntax below. This may render some more of the non-english char items than the previous one. Using the perl compatible regular expressions will hopefully allow the browser character settings to make a better determination of what is displayed and what isn&#39;t. However this may not work on some locale settings...." />
		
		
	

		
		
			<meta name="identifier-url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" />
		
		
			<meta property="og:url" content="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" />
		
		
		
	

<meta property="og:image" content="http://forums.oscommerce.com/public/style_images/master/oscommerce_meta.png"/>
		
		
		
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prototype.js'></script>
	
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/ipb.js?ipbv=f0051d8914fe132bc0130fe6bbd729c6&amp;load=quickpm,hovercard,sharelinks,topic,rating,like'></script>
	
		<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/scriptaculous/scriptaculous-cache.js'></script>
	
	<script type="text/javascript" src='http://forums.oscommerce.com/cache/lang_cache/1/ipb.lang.js?nck=fb99e14e49767998a66e3b7a9956074d' charset='UTF-8'></script>


	
		
			
			
			
			
				<link id="ipsCanonical" rel="canonical" href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" />
			
		

			
			
			
			
				<link rel='stylesheet' type='text/css' title='Main' media='print' href='http://forums.oscommerce.com/public/style_css/css_1/ipb_print.css' />
			
		

			
			
			
			
				<link rel='first' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' />
			
		

			
			
			
			
				<link rel='prev' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5' />
			
		

			
			
			
			
				<link rel='next' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7' />
			
		

			
			
			
			
				<link rel='last' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28' />
			
		

			
			
			
			
				<link rel='up' href='http://forums.oscommerce.com/forum/76-security/' />
			
		

			
			
			
			
				<link rel='author' href='http://forums.oscommerce.com/user/288489-taipo/' />
			
		
	

	



<script type='text/javascript'>
	//<![CDATA[
		/* ---- URLs ---- */
		ipb.vars['base_url'] 			= 'http://forums.oscommerce.com/index.php?s=86a5c96e819a51f015668b1991c0d724&';
		ipb.vars['board_url']			= 'http://forums.oscommerce.com';
		ipb.vars['img_url'] 			= "http://forums.oscommerce.com/public/style_images/master";
		ipb.vars['loading_img'] 		= 'http://forums.oscommerce.com/public/style_images/master/loading.gif';
		ipb.vars['active_app']			= 'forums';
		ipb.vars['upload_url']			= 'http://forums.oscommerce.com/uploads';
		/* ---- Member ---- */
		ipb.vars['member_id']			= parseInt( 0 );
		ipb.vars['is_supmod']			= parseInt( 0 );
		ipb.vars['is_admin']			= parseInt( 0 );
		ipb.vars['secure_hash'] 		= '880ea6a14ea49e853634fbdc5015a024';
		ipb.vars['session_id']			= '86a5c96e819a51f015668b1991c0d724';
		ipb.vars['twitter_id']			= 0;
		ipb.vars['fb_uid']				= 0;
		ipb.vars['auto_dst']			= parseInt( 0 );
		ipb.vars['dst_in_use']			= parseInt(  );
		ipb.vars['is_touch']			= false;
		ipb.vars['member_group']		= {"g_mem_info":"1"}
		/* ---- cookies ----- */
		ipb.vars['cookie_id'] 			= '';
		ipb.vars['cookie_domain'] 		= '.oscommerce.com';
		ipb.vars['cookie_path']			= '/';
		/* ---- Rate imgs ---- */
		ipb.vars['rate_img_on']			= 'http://forums.oscommerce.com/public/style_images/master/star.png';
		ipb.vars['rate_img_off']		= 'http://forums.oscommerce.com/public/style_images/master/star_off.png';
		ipb.vars['rate_img_rated']		= 'http://forums.oscommerce.com/public/style_images/master/star_rated.png';
		/* ---- Uploads ---- */
		ipb.vars['swfupload_swf']		= 'http://forums.oscommerce.com/public/js/3rd_party/swfupload/swfupload.swf';
		ipb.vars['swfupload_enabled']	= true;
		ipb.vars['use_swf_upload']		= ( '' == 'flash' ) ? true : false;
		ipb.vars['swfupload_debug']		= false;
		/* ---- other ---- */
		ipb.vars['highlight_color']     = "#ade57a";
		ipb.vars['charset']				= "UTF-8";
		ipb.vars['time_offset']			= "0";
		ipb.vars['hour_format']			= "24";
		ipb.vars['seo_enabled']			= 1;
		
		ipb.vars['seo_params']			= {"start":"-","end":"\/","varBlock":"?","varPage":"page-","varSep":"&","varJoin":"="};
		
		/* Templates/Language */
		ipb.templates['inlineMsg']		= "";
		ipb.templates['ajax_loading'] 	= "<div id='ajax_loading'><img src='http://forums.oscommerce.com/public/style_images/master/ajax_loading.gif' alt='" + ipb.lang['loading'] + "' /></div>";
		ipb.templates['close_popup']	= "<img src='http://forums.oscommerce.com/public/style_images/master/close_popup.png' alt='x' />";
		ipb.templates['rss_shell']		= new Template("<ul id='rss_menu' class='ipbmenu_content'>#{items}</ul>");
		ipb.templates['rss_item']		= new Template("<li><a href='#{url}' title='#{title}'>#{title}</a></li>");
		
		ipb.templates['autocomplete_wrap'] = new Template("<ul id='#{id}' class='ipb_autocomplete' style='width: 250px;'></ul>");
		ipb.templates['autocomplete_item'] = new Template("<li id='#{id}' data-url='#{url}'><img src='#{img}' alt='' class='ipsUserPhoto ipsUserPhoto_mini' />&nbsp;&nbsp;#{itemvalue}</li>");
		ipb.templates['page_jump']		= new Template("<div id='#{id}_wrap' class='ipbmenu_content'><h3 class='bar'>Jump to page</h3><p class='ipsPad'><input type='text' class='input_text' id='#{id}_input' size='8' /> <input type='submit' value='Go' class='input_submit add_folder' id='#{id}_submit' /></p></div>");
		ipb.templates['global_notify'] 	= new Template("<div class='popupWrapper'><div class='popupInner'><div class='ipsPad'>#{message} #{close}</div></div></div>");
		
		
		ipb.templates['header_menu'] 	= new Template("<div id='#{id}' class='ipsHeaderMenu boxShadow'></div>");
		
		Loader.boot();
	//]]>
	</script>
	</head>
	<body id='ipboard_body'>
		<p id='content_jump' class='hide'><a id='top'></a><a href='#j_content' title='Jump to content' accesskey='m'>Jump to content</a></p>
		<div id='ipbwrapper'>
			<!-- ::: TOP BAR: Sign in / register or user drop down and notification alerts ::: -->
			<div id='header_bar' class='clearfix'>
				<div class='main_width'>
					<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	$('nav_app_ipchat').down('a').observe( 'click', function(e) {
		var _chatUrl	= $('nav_app_ipchat').down('a').href;
	
		if( _chatUrl.charAt( _chatUrl.length - 1 ) == '#' )
		{
			_chatUrl	= _chatUrl.substr( 0, _chatUrl.length - 1 );
		}
	
		if( _chatUrl.indexOf('?') != '-1' )
		{
			_chatUrl	+= '&_popup=1';
		}
		else
		{
			_chatUrl	+= '?_popup=1';
		}
		
		window.open( _chatUrl, "chatpopout", "status=0,toolbar=0,location=1,menubar=0,directories=0,resizable=1,scrollbars=1,height=550,width=750" );
		
		Event.stop(e);
		return false;
	});
});
</script>
					<div id='user_navigation' class='not_logged_in'>
							
							<ul class='ipsList_inline right'>
								<li>
									<span class='services'>
										
										
										
									</span>
									&nbsp;&nbsp;&nbsp;&nbsp;
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login' title='Sign In' id='sign_in'>Sign In</a>&nbsp;&nbsp;&nbsp;
								</li>
								<li>
									<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Create Account' id='register_link'>Create Account</a>
								</li>
							</ul>
						</div>
				</div>
			</div>
			<!-- ::: BRANDING STRIP: Logo and search box ::: -->
			<div id='branding'>
				<div class='main_width'>
					<div id='logo'>
						
<div id='chat-tab-count-wrap'><span id='chat-tab-count' class='ipsHasNotifications' title='' style='display:none;'>2</span></div>
<script type='text/javascript'>
// And then move
document.observe("dom:loaded", function(){
	var _thisHtml	= $('nav_app_ipchat').down('a').innerHTML;
	_thisHtml = _thisHtml + $('chat-tab-count-wrap').innerHTML;
	$('nav_app_ipchat').down('a').update( _thisHtml ).setStyle( { position: 'relative' } );
	$('chat-tab-count-wrap').remove();
	$('chat-tab-count').show();
});
</script>

							<a href='http://forums.oscommerce.com' title='Go to community index' rel="home" accesskey='1'><img src='http://forums.oscommerce.com/public/style_images/1_oscommerce_white_fill.png' alt='Logo' /></a>
						
					</div>
					
						<div id='search' class='right'>
	<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=search&amp;fromMainBar=1" method="post" id='search-box' >
		<fieldset>
			<label for='main_search' class='hide'>Search</label>
			<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;search_in=forums' title='Advanced Search' accesskey='4' rel="search" id='adv_search' class='right'>Advanced</a>
			<span id='search_wrap' class='right'>
				<input type='text' id='main_search' name='search_term' class='inactive' size='17' tabindex='100' />
				<span class='choice ipbmenu clickable' id='search_options' style='display: none'></span>
				<ul id='search_options_menucontent' class='ipbmenu_content ipsPad' style='display: none'>
					<li class='title'><strong>Search section:</strong></li>
					<li class='special'>
							<label for='s_topic' title='This topic'>
								<input type='radio' name='search_app' value="forums:topic:373777" class='input_radio' id='s_topic' checked="checked" /><strong>This topic</strong>
							</label>
						</li>
					
					
					<li class='app'><label for='s_forums' title='Forums'><input type='radio' name='search_app' class='input_radio' id='s_forums' value="forums"  />Forums</label></li>
					<li class='app'><label for='s_members' title='Members'><input type='radio' name='search_app' class='input_radio' id='s_members' value="members"  />Members</label></li>
					<li class='app'><label for='s_core' title='Help Files'><input type='radio' name='search_app' class='input_radio' id='s_core' value="core"  />Help Files</label></li>
					
						
					

						
					

						
					

						<li class='app'>
								<label for='s_calendar' title='Calendar'>
									<input type='radio' name='search_app' class='input_radio' id='s_calendar' value="calendar"  />Calendar
								</label>
							</li>
					

						
					

						
					

						<li class='app'>
								<label for='s_tracker' title='Bug Reports'>
									<input type='radio' name='search_app' class='input_radio' id='s_tracker' value="tracker"  />Bug Reports
								</label>
							</li>
					

						
					

						
					

						
					
				</ul>
				<input type='submit' class='submit_input clickable' value='Search' />
			</span>
			
		</fieldset>
	</form>
</div>
					
				</div>
			</div>
			<!-- ::: APPLICATION TABS ::: -->
			<div id='primary_nav' class='clearfix'>
				<div class='main_width'>
					<ul class='ipsList_inline' id='community_app_menu'>
						
							<li class='right'>
								<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=navigation&amp;inapp=forums" rel="quickNavigation" accesskey='9' id='quickNavLaunch' title='Open Quick Navigation'><span>&nbsp;</span></a>
							</li>
						
						<li id='nav_explore' class='right'>
							<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=search&amp;do=viewNewContent&amp;search_app=forums' accesskey='2' title='View New Content'>View New Content</a>
						</li>
            <li id='nav_menu_300' class="left skip_moremenu ">
              <a id='nav_menu_300_trigger' href='http://www.oscommerce.com' title='' >Website <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_300_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com' title='' >Website</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Products' title='' >Downloads</a></li>
                        <li class='submenu_li'><a href='http://addons.oscommerce.com' title='' >Add-Ons</a></li>
                        <li class='submenu_li'><a href='http://shops.oscommerce.com' title='' >Live Shops</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_300_trigger'), $('nav_menu_300_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_300' } );
                  });
                </script>
            </li>
						
            <li id='nav_menu_400' class="left skip_moremenu ">
              <a id='nav_menu_400_trigger' href='http://www.oscommerce.com/Services' title='' >Services <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_400_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&hosting' title='' >Hosting</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&developers' title='' >Developers</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&templates' title='' >Templates</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&books' title='' >Books</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&payment' title='' >Payment</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&shipping' title='' >Shipping</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&marketing' title='' >Marketing</a></li>
                        <li class='submenu_li'><a href='http://www.oscommerce.com/Services&crm' title='' >CRM</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_400_trigger'), $('nav_menu_400_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_400' } );
                  });
                </script>
            </li>
            <li id='nav_menu_500' class="left skip_moremenu ">
              <a id='nav_menu_500_trigger' href='http://forums.oscommerce.com/subscriptions/' title='' >Customers <span class='dropdownIndicator'></span></a>
              <div id='nav_menu_500_menucontent' class='submenu_container clearfix boxShadow' style='display: none'>
                  <div class="left">
                    <ul class="submenu_links">
                        
                        <li class='submenu_li'><a href='http://www.oscommerce.com/_&Sponsorship' title='' >Community Sponsorships</a></li>
                        
                        <li class='submenu_li'><a href='https://ssl.oscommerce.com/Account&Partner' title='' >Partner Dashboard</a></li>
                        <li class='submenu_li'><a href='http://forums.oscommerce.com/forum/85-support-tickets/' title='' >Support Tickets (Discontinued)</a></li>
                    </ul>
                  </div>
                </div>
                <script type='text/javascript'>
                  document.observe("dom:loaded", function(){
                    new ipb.Menu( $('nav_menu_500_trigger'), $('nav_menu_500_menucontent'), { eventType: 'mouseover', closeOnMouseout: 'nav_menu_500' } );
                  });
                </script>
            </li>
						
								
									
								

									
								

									
								

									
								

									
								

									
																				<li id='nav_app_ipchat' class="left "><a href='http://forums.oscommerce.com/chat/' title='Go to Live Chat'>Live Chat</a></li>
									
								

									
																				<li id='nav_app_tracker' class="left "><a href='http://forums.oscommerce.com/tracker/' title='Go to Bug Reports'>Bug Reports</a></li>
									
								

									
								

									
								

									
								
							
      <li id='nav_app_ccs' class="left "><a href='http://library.oscommerce.com' title='Go to Documentation' >Documentation</a></li>
						<li id='nav_other_apps' style='display: none'>
							<a href='#' class='ipbmenu' id='more_apps'>More <img src='http://forums.oscommerce.com/public/style_images/master/useropts_arrow.png' /></a>
						</li>
					</ul>
				</div>
			</div>
			
			<!-- ::: MAIN CONTENT AREA ::: -->
			<div id='content' class='clearfix'>
				<!-- ::: NAVIGATION BREADCRUMBS ::: -->
				<div id='secondary_navigation' class='clearfix'>
						<ol class='breadcrumb top ipsList_inline left'>
														<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<a href='http://forums.oscommerce.com/' itemprop="url">
										<span itemprop="title">osCommerce Support Forum</span>
									</a>
								</li>
								
							
								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x' itemprop="url"><span itemprop="title">osCommerce Online Merchant v2.x</span></a>
								</li>
								
							

								<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class='nav_sep'>&rarr;</span>
									 <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security' itemprop="url"><span itemprop="title">Security</span></a>
								</li>
								
							
						</ol>
					</div>
					<br />
				<noscript>
					<div class='message error'>
						<strong>Javascript Disabled Detected</strong>
						<p>You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality.</p>
					</div>
					<br />
				</noscript>
				<!-- ::: CONTENT ::: -->
				
					<div class='ipsAd'><style type="text/css">
#osCCS { margin-top: 5px; clear: both; min-height: 65px; }
#osCCSDesc { font-size: 0.95em; padding-left: 480px; margin-top: -60px; padding-top: 4px; min-height: 60px; }
</style>

<div class='general_box'>
  <div style="float: right; margin-top: -6px;">
<a href="http://www.oscommerce.com/Services&amp;hosting" target="_blank" class="ipsButton_secondary">Hosting</a>
<a href="http://www.oscommerce.com/Services&amp;developers" target="_blank" class="ipsButton_secondary">Developers</a>
<a href="http://www.oscommerce.com/Services&amp;templates" target="_blank" class="ipsButton_secondary">Templates</a>
<a href="http://www.oscommerce.com/Services&amp;books" target="_blank" class="ipsButton_secondary">Books</a>
<a href="http://www.oscommerce.com/Services&amp;payment" target="_blank" class="ipsButton_secondary">Payment</a>
<a href="http://www.oscommerce.com/Services&amp;shipping" target="_blank" class="ipsButton_secondary">Shipping</a>
<a href="http://www.oscommerce.com/Services&amp;marketing" target="_blank" class="ipsButton_secondary">Marketing</a>
<a href="http://www.oscommerce.com/Services&amp;crm" target="_blank" class="ipsButton_secondary">CRM</a>
  </div>
  <p><span style='font-size: 0.95em; font-weight: bold;'><a href='http://www.oscommerce.com/Services' target='_blank'>Our Partners</a></span></p>
  <div id="osCCS" style="display: block;"></div>
</div>

<br /></div>
				
				




<script type="text/javascript">
//<![CDATA[
	ipb.topic.inSection    = 'topicview';
	ipb.topic.topic_id     = 373777;
	ipb.topic.forum_id     = 76;
	ipb.topic.redirectPost = 1;
	ipb.topic.start_id     = 100;
	ipb.topic.page_id      = 6;
	ipb.topic.topPid       = 0;
	ipb.topic.counts       = { postTotal: 542,
							  curStart:  ipb.topic.start_id,
							  perPage:   20 };
	//Search Setup
	ipb.vars['search_type']			= 'forum';
	ipb.vars['search_type_id']		= 76;
	ipb.vars['search_type_2']		= 'topic';
	ipb.vars['search_type_id_2']	= 373777;
	
	
	// Delete stuff set up
	ipb.topic.deleteUrls['hardDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=04&f=76&t=373777&page=6&auth_key=880ea6a14ea49e853634fbdc5015a024&p=#{pid}" );
	ipb.topic.deleteUrls['softDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=postchoice&tact=sdelete&t=373777&f=76&auth_key=880ea6a14ea49e853634fbdc5015a024&selectedpids[#{pid}]=#{pid}&pid=#{pid}" );
	
	
	ipb.topic.modPerms	  = [];
	
	
	ipb.templates['post_moderation'] = new Template("<div id='comment_moderate_box' class='ipsFloatingAction' style='display: none'><span class='desc'>With <span id='comment_count'>#{count}</span> checked posts: </span><select id='tactInPopup' class='input_select'><option value='approve'>Approve</option><option value='delete'>Hide</option><option value='sundelete'>Unhide</option><option value='deletedo'>Delete</option><option value='merge'>Merge</option><option value='split'>Split</option><option value='move'>Move</option></select>&nbsp;&nbsp;<input type='button' class='input_submit' id='submitModAction' value='Go' /></div>");
	
//]]>
</script>





	<a href='http://forums.oscommerce.com/user/288489-taipo/' class='ipsUserPhotoLink left'>

<img src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' alt='Photo' class='ipsUserPhoto ipsUserPhoto_medium' />

	</a>

<div itemscope itemtype="http://schema.org/Article" class='ipsBox_withphoto'>
	<span itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating" class='rating ipsType_smaller'>
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			
				<img src='http://forums.oscommerce.com/public/style_images/master/star.png' alt='*' class='rate_img' />
			
			
			<span id='rating_text'>
				
					<span itemprop="ratingCount" id='rating_hits'>2</span> <span>votes</span>
					<meta itemprop="ratingValue" content="5" />
				
			</span>
			
		</span>
	<h1 itemprop="name" class='ipsType_pagetitle'>Oscommerce Security - Osc_Sec.php</h1>
	<div class='desc lighter blend_links'>
		 Started by <span itemprop="creator"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>, <span itemprop="dateCreated" datetime="2011-04-10">Apr 10 2011 11:04</span>
	</div>
	
	<meta itemprop="interactionCount" content="UserComments:542" />
</div>



<br />
<div class='topic_controls'>
	<div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0770539001'>
					<a href='#'>Page 6 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0770539001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Page 4">4</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Page 5">5</a>
						</li>
				

					
						<li class='page active'>6</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Page 7">7</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-8" title="Oscommerce Security - Osc_Sec.php - Page 8">8</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div>
	


	<ul class='topic_buttons'>
			<li class='disabled'><span>Please log in to reply</span></li>
			
			
		</ul>
</div>

<div class='maintitle clear clearfix'>
	<span class='ipsType_small'>
		541 replies to this topic
	</span>
	
</div>

<div class='topic hfeed clear clearfix'>
	
	

	<div class='ipsBox'>
		<div class='ipsBox_container' id='ips_Posts'>
			
				<!--post:1584629-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584629'>
		<a id='entry1584629'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584629' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1584629' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #101'>
					
					#101
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #101' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="125658" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/125658-rdva/' title='View Profile'><span itemprop="name">rdva</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">rdva</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/125658-rdva/" title="View Profile: rdva" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/bd33a186fbbad9983f288c6bf52c916b?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">rdva</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Saint-Petersburg, Russia</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@rdva' ); return false;" title="@rdva">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T09:40:18+00:00">24 May 2011 - 09:40</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->It works at Windows (my test server) and do not works at Linux (production server).<br /><br /><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584549" data-time="1306193512"><p>I have changed the cleanup syntax below. This may render some more of the non-english char items than the previous one. Using the perl compatible regular expressions will hopefully allow the browser character settings to make a better determination of what is displayed and what isn&#39;t. However this may not work on some locale settings.<br /><br /><pre class='prettyprint lang-auto linenums:0'>/**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
     if ( is_array( &#036;nodes ) ) {
	  foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  		      scrubster( &#036;value );
                } else {
                      &#036;nodes = getCleaner( &#036;nodes, TRUE );
                      &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
                      &#036;nodes = getCleaner( &#036;nodes, FALSE );
                }
          }
     } else {
          &#036;nodes = getCleaner( &#036;nodes, TRUE );
          &#036;nodes = preg_replace(&quot;/&#91;^&#092;w&#092;s?,€=@%:{}&#092;/_.-&#93;/i&quot;, &quot;&quot;, urldecode( &#036;nodes ) );
          &#036;nodes = getCleaner( &#036;nodes, FALSE );
    }
    return &#036;nodes;
  }

  /**
  * Called above, this will clean up
  * values but not interfere with umlauts
  */
  function getCleaner(&#036;string, &#036;conv=1) {
    &#036;x = md5( &#036;_SERVER&#91;&quot;REMOTE_ADDR&quot;&#93; . &#036;_SERVER&#91;&quot;HTTP_USER_AGENT&quot;&#93; . 
	          &#036;_SERVER&#91;&quot;HTTP_HOST&quot;&#93; . &#036;_SERVER&#91;&quot;DOCUMENT_ROOT&quot;&#93; . &#036;_SERVER&#91;&quot;SERVER_SOFTWARE&quot;&#93; . &#036;_SERVER&#91;&quot;PATH&quot;&#93; );
    &#036;tolist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;amp;auml;,&amp;amp;ouml;,&amp;amp;uuml;,&amp;amp;Auml;,&amp;amp;Ouml;,&amp;amp;Uuml;,&amp;amp;euro;,&amp;amp;szlig&quot;);
    &#036;fromlist = explode(&quot;,&quot;, &quot;ae,oe,ue,Ae,Oe,Ue,euro,szlig,ae,oe,ue,Ae,Oe,Ue,euro,szlig&quot;);
    &#036;finlist = explode(&quot;,&quot;, &quot;&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;,&amp;auml;,&amp;ouml;,&amp;uuml;,&amp;Auml;,&amp;Ouml;,&amp;Uuml;,&amp;euro;,&amp;szlig;&quot;);
    for(&#036;wr=0;&#036;wr&lt;=count(&#036;tolist);&#036;wr++) {
       if ( &#036;conv &gt; 0 ) {
           &#036;string = str_replace(&#036;tolist&#91;&#036;wr&#93;, &#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;string);
       } else {
	   &#036;string = str_replace(&#036;x.&#036;fromlist&#91;&#036;wr&#93;, &#036;finlist&#91;&#036;wr&#93;, &#036;string);
       }
    }
    return &#036;string;
}</pre></p></blockquote>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584629'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584629" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584629', { domLikeStripId: 'like_post_1584629', app: 'forums', type: 'pid', typeid: '1584629' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1584629' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584629);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584629') )
	{
		$('multiq_1584629').show();
	}
	
	if( $('toggle_post_1584629') )
	{
		$('toggle_post_1584629').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584629] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584641-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584641'>
		<a id='entry1584641'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584641' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1584641' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #102'>
					
					#102
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #102' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T10:41:36+00:00">24 May 2011 - 10:41</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Try the last version I put up if you get a chance. Below is a slightly modified version which replaces the previous two functions.<br /><br /><pre class='prettyprint lang-auto linenums:0'>
  /** 
  * Clean up GET request vars 
  * as well as multidimensional arrays 
  */ 
  setlocale(LC_CTYPE, &#39;C&#39;);
  function scrubster( &#036;nodes ) { 
     if ( is_array( &#036;nodes ) ) { 
          foreach( &#036;nodes as &#036;key=&gt;&#036;value ) { 
                if ( is_array( &#036;value ) ) { 
                      scrubster( &#036;value ); 
                } else { 
                      &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) ); 
                } 
          } 
     } else { 
          &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) ); 
    } 
    return &#036;nodes; 
  }
</pre><br />I have uploaded it to a production server here: <a href='http://warbeast.netne.net/' class='bbc_url' title='External link' rel='nofollow external'>http://warbeast.netne.net/</a><br /><br />This is what I am seeing in FF<br /><br />[img]http://i53.tinypic.com/28hctjo.jpg[/img]<br /><br />The test code I am using in application_top.php below the osc_sec.php require include is:<br /><br /><pre class='prettyprint lang-auto linenums:0'>echo  &quot;ABCDEFGabcdefg,=,.,@,:,{,},_,-ä,ö,ü,Ä,Ö,Ü,€,ß &#91;w&#93;(o)%3Cr%3Ek|i*n^g&quot;;
echo &quot;&lt;br&gt;&#092;n&quot;;
echo scrubster( &quot;ABCDEFGabcdefg,=,.,@,:,{,},_,-ä,ö,ü,Ä,Ö,Ü,€,ß &#91;w&#93;(o)%3Cr%3Ek|i*n^g&quot; );</pre><br />In my browser it is displaying correctly. However using the PCRE method of filtering can run into probs depending on the servers locale settings.
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 24 May 2011 - 10:42.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584641'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584641" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584641', { domLikeStripId: 'like_post_1584641', app: 'forums', type: 'pid', typeid: '1584641' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584641' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584641);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584641') )
	{
		$('multiq_1584641').show();
	}
	
	if( $('toggle_post_1584641') )
	{
		$('toggle_post_1584641').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584641] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584676-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584676'>
		<a id='entry1584676'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584676' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1584676' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #103'>
					
					#103
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #103' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="292674" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/292674-popsel/' title='View Profile'><span itemprop="name">popsel</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">popsel</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/292674-popsel/" title="View Profile: popsel" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/0580282dca295e8c744c379a03e6560e?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			23 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Hans Lang</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Germany</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@popsel' ); return false;" title="@popsel">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T14:41:36+00:00">24 May 2011 - 14:41</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1584602" data-time="1306225159"><p>I think the problem again is that for some reason some of these addons are calling constant defined variables via HTTP_GET_VARS instead of just calling the defined item directly.<br /><br />However, these are some of the issues we have to face when working around each others addons.<br /><br />Try this one out then. It is a bit of the old (as in a bit of the original fix) and a bit of the new.<br /><br />Replace the entire piece above with this. It should at a guess, cause the order editor to work better.<br /><br /><pre class='prettyprint lang-auto linenums:0'>
  /**
  * Clean up GET request vars
  * as well as multidimensional arrays
  */
  function scrubster( &#036;nodes ) {
 	if ( is_array( &#036;nodes ) ) {
  	foreach( &#036;nodes as &#036;key=&gt;&#036;value ) {
                if ( is_array( &#036;value ) ) {
  	      	scrubster( &#036;value );
                } else {
                      &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) );
                }
          }
 	} else {
          &#036;nodes = preg_replace(&#39;/&#91;^&#092;w&#092;s?,äöüÄÖÜ€ß=@%:{}&#092;/.-&#93;/i&#39;, &#39;&#39;, urldecode( &#036;nodes ) );
    }
    return &#036;nodes;
  }
</pre></p></blockquote><br />Hi&#33;<br /><br />FF with test line shows:<br />auml,ouml,uuml,Auml,Ouml,Uuml,euro,szlig,ampauml,ampauml,ampuuml,ampAuml,ampOuml,ampUuml,ampeuro,ampszlig,Ã¤,Ã¶,Ã¼,Ã„,Ã–,Ãœ,â‚¬,ÃŸ  working  <br /><br />I did a test and Order Editor is working again /rolleyes.gif' class='bbc_emoticon' alt=':rolleyes:' /><br /><br />FF (Coupon Codes shows):<br />Der Mindestbestellwert für diesen Gutschein beträgt  10,00  und wurde noch nicht erreicht <br /><br /><span  style='font-size: 14px'><strong class='bbc'>€ </strong></span>sign is still filtered, but beside it looks good.<br />I did a test with Coupon Codes and Order Editor only. <br />These made most problems in combination with osc_sec.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584676'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584676" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584676', { domLikeStripId: 'like_post_1584676', app: 'forums', type: 'pid', typeid: '1584676' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="292674">
	
	<!--signature-cached-Mon, 31 Mar 2014 09:42:25 +0000-->Best regards<br />
<br />
Popsel
</div>
				
				
				
			
				<ul id='postControlsNormal_1584676' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584676);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584676') )
	{
		$('multiq_1584676').show();
	}
	
	if( $('toggle_post_1584676') )
	{
		$('toggle_post_1584676').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584676] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1584768-->

<div class='post_block hentry clear clearfix  ' id='post_id_1584768'>
		<a id='entry1584768'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1584768' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1584768' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #104'>
					
					#104
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #104' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-24T21:02:03+00:00">24 May 2011 - 21:02</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->That may have to be the final balance in the end I think. Its not the optimum, but at least the main function is working. <br />
<br />
In the end that filter is not as crucial to the security of 2.2.x as the other non-optional parts of osC_Sec. The optional sections are optional for that reason, if they create a conflict they can at least be switched off unless, like yourself, you know how to code your way around them.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1584768'>
				<ul class='ipsList_inline'>
					<li id="like_post_1584768" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1584768', { domLikeStripId: 'like_post_1584768', app: 'forums', type: 'pid', typeid: '1584768' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1584768' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1584768);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1584768') )
	{
		$('multiq_1584768').show();
	}
	
	if( $('toggle_post_1584768') )
	{
		$('toggle_post_1584768').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1584768] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585113-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585113'>
		<a id='entry1585113'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585113' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585113' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #105'>
					
					#105
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #105' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-26T10:46:16+00:00">26 May 2011 - 10:46</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->osC_Sec_2.5[r3] Updated<br />Whats New?<br />- GET cleanup now better presents special characters<br />- Added the osC_Sec version to the diagnostic email. If you have allowed a diagnostic email to be sent, it will now include which version of osC_Sec you are using.<br />- Changed the whitelisting function to the perl compatible regular expression<br />- Added more blacklisted items to the form filtering (&#036;_POST requests)<br /><br />NOTE: For users upgrading from osC_Sec_2.5[r2] you only need replace the osc_sec.php with the one contained in this zip file.<br /><br />Download from: <a href='http://www.oscommerce.com/community/contributions,7834' class='bbc_url' title='External link' rel='nofollow external'>http://www.oscommerc...tributions,7834</a>
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585113'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585113" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585113', { domLikeStripId: 'like_post_1585113', app: 'forums', type: 'pid', typeid: '1585113' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585113' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585113);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585113') )
	{
		$('multiq_1585113').show();
	}
	
	if( $('toggle_post_1585113') )
	{
		$('toggle_post_1585113').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585113] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585491-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585491'>
		<a id='entry1585491'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585491' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585491' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #106'>
					
					#106
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #106' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T11:11:59+00:00">29 May 2011 - 11:11</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Hi,<br /><br />I have been trying to implement this addon but have been encountering errors and I am hoping you can help me with them.<br /><br /><strong class='bbc'>Firstly, I keep getting the error </strong><br />####### OSC_SEC.PHP WARNING: Please enable write access to your shop catalogs .htaccess file thanks #######<br />at the top of the front end and the admin backend pages.  Which .htaccess should I be providing write access to and what level access should I be giving it?  I have tried updating the one in the includes folder (I set it to 777 to ensure that it was completely open) and the error does not go.<br /><br /><strong class='bbc'>Secondly:</strong><br />I get the following errors on the website front end<br />Notice: Undefined variable: getHexvars in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 245<br /><br />Notice: Undefined variable: _SESSION in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 397<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php:50) in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 404<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php:50) in /var/www/vhosts/*Website*/httpdocs/includes/functions/sessions.php on line 102<br /><br />The website works regardless of the errors.<br /><br /><strong class='bbc'>Finally, I get the following errors when I access the website/admin page</strong><br />Notice: Undefined variable: getHexvars in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 245<br /><br />Notice: Undefined variable: _SESSION in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 397<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php:50) in /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php on line 404<br /><br />Notice: Constant SESSION_FORCE_COOKIE_USE already defined in /var/www/vhosts/*Website*/httpdocs/*admin*/includes/application_top.php on line 85<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php:50) in /var/www/vhosts/*Website*/httpdocs/*admin*/includes/functions/sessions.php on line 102<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /var/www/vhosts/*Website*/httpdocs/includes/osc_sec.php:50) in /var/www/vhosts/*Website*/httpdocs/*admin*/includes/functions/general.php on line 22<br /><br />I am unable to access the admin pages due to these errors.<br /><br />I will have to disable the addon for now as the client will no doubt want to access the admin page tomorrow.  If you have any suggestions please let me know.  If you need any additional information, please let me know.<br /><br />Thanks in advance<br /><br />Simon
					
					<br />
					<p class='edit'>
							<strong>Edited by SimonLG, 29 May 2011 - 11:14.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585491'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585491" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585491', { domLikeStripId: 'like_post_1585491', app: 'forums', type: 'pid', typeid: '1585491' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585491' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585491);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585491') )
	{
		$('multiq_1585491').show();
	}
	
	if( $('toggle_post_1585491') )
	{
		$('toggle_post_1585491').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585491] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585495-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585495'>
		<a id='entry1585495'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585495' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585495' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #107'>
					
					#107
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #107' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T11:26:03+00:00">29 May 2011 - 11:26</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000--><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585491" data-time="1306667519"><p>Hi,<br /><br />I have been trying to implement this addon but have been encountering errors and I am hoping you can help me with them.<br /><br /><strong class='bbc'>Firstly, I keep getting the error </strong><br />####### OSC_SEC.PHP WARNING: Please enable write access to your shop catalogs .htaccess file thanks #######<br />at the top of the front end and the admin backend pages.  Which .htaccess should I be providing write access to and what level access should I be giving it?  I have tried updating the one in the includes folder (I set it to 777 to ensure that it was completely open) and the error does not go.<br /></p></blockquote><br />The htaccess in the root directory of your store is the one that needs to be made writable. Probably a setting of 666 would do it. But try 644 first, if no go then 666.<br /><br /><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585491" data-time="1306667519"><p><strong class='bbc'>Secondly:</strong><br />I get the following errors on the website front end<br />Notice: Undefined variable: getHexvars in /path_to/includes/osc_sec.php on line 245<br /><br />Notice: Undefined variable: _SESSION in /path_to/includes/osc_sec.php on line 397<br /></p></blockquote><br />Are you running this on a test server? Generally the production servers have error notices disabled.<br /><br /><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585491" data-time="1306667519"><p>Warning: Cannot modify header information - headers already s<br />ent by (output started at /path_to/includes/osc_sec.php:50) in /path_to/osc_sec.php on line 404<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /path_to/includes/osc_sec.php:50) in /path_to/includes/functions/sessions.php on line 102<br /></p></blockquote><br />These will probably disappear once you set the htaccess to writable.<br /><br /><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585491" data-time="1306667519"><p><strong class='bbc'>Finally, I get the following errors when I access the website/admin page</strong><br />Notice: Undefined variable: getHexvars in /path_to/includes/osc_sec.php on line 245<br /><br />Notice: Undefined variable: _SESSION in /path_to/includes/osc_sec.php on line 397<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /path_to/includes/osc_sec.php:50) in /path_to/includes/osc_sec.php on line 404<br /><br />Notice: Constant SESSION_FORCE_COOKIE_USE already defined in /path_to/admin/includes/application_top.php on line 85<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /path_to/includes/osc_sec.php:50) in /path_to/admin/includes/functions/sessions.php on line 102<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /path_to/includes/osc_sec.php:50) in /path_to/admin/includes/functions/general.php on line 22<br /></p></blockquote><br />Most of those will disappear once you correct the htaccess issue.<br /><br />Let me know if there are any errors left after you have corrected those.<br /><br />If you cannot change the server settings for error notices then add this line to osC_Sec.php<br /><br />At the top find:<br /><pre class='prettyprint lang-auto linenums:0'>&#036;currentVersion = &quot;2.5.&#91;r3&#93;&quot;;</pre><br />In the line above it add the following:<br /><pre class='prettyprint lang-auto linenums:0'>error_reporting(6135);</pre>
					
					<br />
					<p class='edit'>
							<strong>Edited by Jan Zonjee, 30 May 2011 - 10:59.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585495'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585495" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585495', { domLikeStripId: 'like_post_1585495', app: 'forums', type: 'pid', typeid: '1585495' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585495' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585495);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585495') )
	{
		$('multiq_1585495').show();
	}
	
	if( $('toggle_post_1585495') )
	{
		$('toggle_post_1585495').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585495] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585497-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585497'>
		<a id='entry1585497'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585497' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585497' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #108'>
					
					#108
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #108' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T11:56:39+00:00">29 May 2011 - 11:56</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Wow, thanks for the quick reply.<br />
<br />
I changed the code so that the errors were appearing on the screen, this is something that I was toggling on/off to see what was happening.<br />
<br />
I am actually in the process of restoring the files back to before I started to change everything because there seems to be some problems with the code now.  Once I have done that I will try installing it all again and I will let you know if I have any issues,<br />
<br />
Thanks<br />
<br />
Simon
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585497'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585497" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585497', { domLikeStripId: 'like_post_1585497', app: 'forums', type: 'pid', typeid: '1585497' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585497' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585497);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585497') )
	{
		$('multiq_1585497').show();
	}
	
	if( $('toggle_post_1585497') )
	{
		$('toggle_post_1585497').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585497] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585499-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585499'>
		<a id='entry1585499'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585499' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585499' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #109'>
					
					#109
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #109' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T12:06:16+00:00">29 May 2011 - 12:06</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Generally error notices are not something that affects the way the site runs. If you would rather not add the error code above, which will turn off notices, then try this way.<br /><br />In the line under:<br /><pre class='prettyprint lang-auto linenums:0'>&#036;oscsec_ipPass = 1;</pre><br />Add:<br /><pre class='prettyprint lang-auto linenums:0'>&#036;getHexvars = &quot;&quot;;</pre><br />That way you can still toggle error notices off and on.
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 29 May 2011 - 12:06.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585499'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585499" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585499', { domLikeStripId: 'like_post_1585499', app: 'forums', type: 'pid', typeid: '1585499' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585499' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585499);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585499') )
	{
		$('multiq_1585499').show();
	}
	
	if( $('toggle_post_1585499') )
	{
		$('toggle_post_1585499').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585499] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585505-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585505'>
		<a id='entry1585505'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585505' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585505' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #110'>
					
					#110
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #110' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T13:33:10+00:00">29 May 2011 - 13:33</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Hi,<br />
<br />
Unfortunately this has not worked.  I have updated the .htaccess file to permission 644 and then 666 with no luck.  i still get the error message.<br />
<br />
When I installed the addon, I had to modify the installation process slightly.  Firstly I was getting an error that the code couldn&#39;t access something at httpdocsincludes/osc_sec.php.  I had to change the line &quot;require(DIR_FS_CATALOG . &#39;includes/osc_sec.php&#39;);&quot; in the includes directory version of the application_top.php to   &quot;require(DIR_FS_CATALOG . &#39;/includes/osc_sec.php&#39;);&quot;<br />
<br />
I then got an error in the includes/osc_sec.php file.  I had to change line 15 from &quot;  include(DIR_FS_CATALOG . &#39;includes/osc.php&#39;);&quot; to   &quot;include(DIR_FS_CATALOG . &#39;/includes/osc.php&#39;);&quot;<br />
<br />
I don&#39;t know if they are in any way significant, but I am at a loss. Let me know if you can think of anything.<br />
<br />
The only other thing that I might mention is, for the line of code that I need to replace (as per your install instructions), in the includes version of that file, the following code appears under the comment <br />
// set php_self in the local scope<br />
  if (&#33;isset(&#036;PHP_SELF)) &#036;PHP_SELF = &#036;HTTP_SERVER_VARS[&#39;PHP_SELF&#39;];<br />
<br />
  if (&#036;request_type == &#39;NONSSL&#39;) {<br />
    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTP_CATALOG);<br />
  } else {<br />
    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTPS_CATALOG);<br />
<br />
When I changed it, I set it to:<br />
// set php_self in the local scope<br />
//  if (&#33;isset(&#036;PHP_SELF)) &#036;PHP_SELF = &#036;HTTP_SERVER_VARS[&#39;PHP_SELF&#39;];<br />
<br />
// set php_self in the local scope<br />
  if ( empty( &#036;PHP_SELF ) ) &#036;PHP_SELF = ( ( ( strlen( ini_get(&#39;cgi.fix_pathinfo&#39; ) ) &gt; 0 ) &amp;&amp; ( ( bool ) ini_get(&#39;cgi.fix_pathinfo&#39; ) == false ) ) || &#33;isset( &#036;HTTP_SERVER_VARS[&#39;SCRIPT_NAME&#39; ] ) ) ? basename( &#036;HTTP_SERVER_VARS[ &#39;PHP_SELF&#39; ] ) : basename( &#036;HTTP_SERVER_VARS[ &#39;SCRIPT_NAME&#39; ] );<br />
<br />
<br />
  if (&#036;request_type == &#39;NONSSL&#39;) {<br />
    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTP_CATALOG);<br />
  } else {<br />
    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTPS_CATALOG);<br />
  }<br />
<br />
I am assuming that this is correct.<br />
<br />
Thanks<br />
<br />
Simon
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585505'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585505" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585505', { domLikeStripId: 'like_post_1585505', app: 'forums', type: 'pid', typeid: '1585505' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585505' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585505);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585505') )
	{
		$('multiq_1585505').show();
	}
	
	if( $('toggle_post_1585505') )
	{
		$('toggle_post_1585505').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585505] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585508-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585508'>
		<a id='entry1585508'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585508' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585508' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #111'>
					
					#111
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #111' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T13:47:39+00:00">29 May 2011 - 13:47</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000--><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585505" data-time="1306675990"><p>Hi,<br /><br />Unfortunately this has not worked.  I have updated the .htaccess file to permission 644 and then 666 with no luck.  i still get the error message.<br /><br />When I installed the addon, I had to modify the installation process slightly.  Firstly I was getting an error that the code couldn&#39;t access something at httpdocsincludes/osc_sec.php.  I had to change the line &quot;require(DIR_FS_CATALOG . &#39;includes/osc_sec.php&#39;);&quot; in the includes directory version of the application_top.php to   &quot;require(DIR_FS_CATALOG . &#39;/includes/osc_sec.php&#39;);&quot;<br /><br />I then got an error in the includes/osc_sec.php file.  I had to change line 15 from &quot;  include(DIR_FS_CATALOG . &#39;includes/osc.php&#39;);&quot; to   &quot;include(DIR_FS_CATALOG . &#39;/includes/osc.php&#39;);&quot;<br /></p></blockquote><br />The easiest fix for this is to replace the require statement with the direct path to osc_sec.php.<br /><br />Use this example instead:<br /><br /><pre class='prettyprint lang-auto linenums:0'>require(&#39;/home/youruser/public_html/includes/osc_sec.php&#39;);</pre><br />Replacing the path (/home/....) above with the actual path to the osc_sec file in the includes directory. Place this code in both application_top.php files replacing the one you have used already.<br /><br />Also in osc.php replace the following also with the entire path<br /><br /><pre class='prettyprint lang-auto linenums:0'>&#036;htaccessfile = DIR_FS_CATALOG . &quot;.htaccess&quot;;</pre><br />with:<br /><br /><pre class='prettyprint lang-auto linenums:0'>&#036;htaccessfile = &quot;/home/youruser/public_html/.htaccess&quot;;</pre><br />and replace:<br /><br /><pre class='prettyprint lang-auto linenums:0'>&#036;ipTrappedURL = DIR_FS_CATALOG . &quot;banned/IP_Trapped.txt&quot;;</pre><br />with:<br /><br /><pre class='prettyprint lang-auto linenums:0'>&#036;ipTrappedURL = &quot;/home/youruser/public_html/banned/IP_Trapped.txt&quot;;</pre><br />(replacing the path above with your own site path.<br /><br /><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585505" data-time="1306675990"><p>The only other thing that I might mention is, for the line of code that I need to replace (as per your install instructions), in the includes version of that file, the following code appears under the comment <br />// set php_self in the local scope<br />  if (&#33;isset(&#036;PHP_SELF)) &#036;PHP_SELF = &#036;HTTP_SERVER_VARS[&#39;PHP_SELF&#39;];<br /><br />  if (&#036;request_type == &#39;NONSSL&#39;) {<br />    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTP_CATALOG);<br />  } else {<br />    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTPS_CATALOG);<br /><br />When I changed it, I set it to:<br />// set php_self in the local scope<br />//  if (&#33;isset(&#036;PHP_SELF)) &#036;PHP_SELF = &#036;HTTP_SERVER_VARS[&#39;PHP_SELF&#39;];<br /><br />// set php_self in the local scope<br />  if ( empty( &#036;PHP_SELF ) ) &#036;PHP_SELF = ( ( ( strlen( ini_get(&#39;cgi.fix_pathinfo&#39; ) ) &gt; 0 ) &amp;&amp; ( ( bool ) ini_get(&#39;cgi.fix_pathinfo&#39; ) == false ) ) || &#33;isset( &#036;HTTP_SERVER_VARS[&#39;SCRIPT_NAME&#39; ] ) ) ? basename( &#036;HTTP_SERVER_VARS[ &#39;PHP_SELF&#39; ] ) : basename( &#036;HTTP_SERVER_VARS[ &#39;SCRIPT_NAME&#39; ] );<br /><br /><br />  if (&#036;request_type == &#39;NONSSL&#39;) {<br />    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTP_CATALOG);<br />  } else {<br />    define(&#39;DIR_WS_CATALOG&#39;, DIR_WS_HTTPS_CATALOG);<br />  }<br /><br />I am assuming that this is correct.<br /></p></blockquote><br />That is correct.
					
					<br />
					<p class='edit'>
							<strong>Edited by Taipo, 29 May 2011 - 13:49.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585508'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585508" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585508', { domLikeStripId: 'like_post_1585508', app: 'forums', type: 'pid', typeid: '1585508' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585508' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585508);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585508') )
	{
		$('multiq_1585508').show();
	}
	
	if( $('toggle_post_1585508') )
	{
		$('toggle_post_1585508').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585508] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585509-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585509'>
		<a id='entry1585509'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585509' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585509' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #112'>
					
					#112
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #112' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T13:53:50+00:00">29 May 2011 - 13:53</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->After a quick rethink. The issue is that in your configure files there is a forward slash missing in the DIR_FS_CATALOG setting. So ignore all that above for now and try adding a trailing slash to DIR_FS_CATALOG.<br /><br />Example: (includes/configure.php)<br /><br />change:<br /><pre class='prettyprint lang-auto linenums:0'>define(&#39;DIR_FS_CATALOG&#39;, &#39;/home/yourusername/public_html/catalog&#39;);</pre><br />to:<br /><pre class='prettyprint lang-auto linenums:0'>define(&#39;DIR_FS_CATALOG&#39;, &#39;/home/yourusername/public_html/catalog/&#39;);</pre><br />and see if that does not cause more problems than it fixes.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585509'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585509" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585509', { domLikeStripId: 'like_post_1585509', app: 'forums', type: 'pid', typeid: '1585509' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585509' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585509);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585509') )
	{
		$('multiq_1585509').show();
	}
	
	if( $('toggle_post_1585509') )
	{
		$('toggle_post_1585509').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585509] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585512-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585512'>
		<a id='entry1585512'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585512' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585512' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #113'>
					
					#113
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #113' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T14:32:26+00:00">29 May 2011 - 14:32</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Hi Taipo,<br /><br />I changed the files as per the post about setting the full path, and the site is still returning errors (actually warnings rather than errors).<br /><br />Then I noticed your last post so I reversed the changes I made and changes the DIR_FS_CATALOG and tried again.  The same warnings appeared (with the error logging showing on the screen).<br /><br />Here are the warnings.  The site is working ok, so my question is, do these warnings indicate a problem with the addon not working?  If it is working then I am happy to ignore the warnings.<br /><br /><strong class='bbc'>Website</strong><br /><br />Notice: Undefined variable: _SESSION in /path_to/includes/osc_sec.php on line 400<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /path_to/includes/osc_sec.php:400) in /path_to/includes/osc_sec.php on line 407<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /path_to/includes/osc_sec.php:400) in /path_to/includes/functions/sessions.php on line 102<br /><br /><br /><strong class='bbc'>Admin back end</strong><br /><br />Notice: Undefined variable: _SESSION in /path_to/includes/osc_sec.php on line 400<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /path_to/includes/osc_sec.php:400) in /path_to/includes/osc_sec.php on line 407<br /><br />Notice: Constant SESSION_FORCE_COOKIE_USE already defined in /path_to/admin/includes/application_top.php on line 86<br /><br />Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /path_to/includes/osc_sec.php:400) in /path_to/admin/includes/functions/sessions.php on line 102<br /><br />Warning: Cannot modify header information - headers already sent by (output started at /path_to/includes/osc_sec.php:400) in /path_to/admin/includes/functions/general.php on line 22
					
					<br />
					<p class='edit'>
							<strong>Edited by Jan Zonjee, 30 May 2011 - 10:56.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585512'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585512" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585512', { domLikeStripId: 'like_post_1585512', app: 'forums', type: 'pid', typeid: '1585512' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585512' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585512);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585512') )
	{
		$('multiq_1585512').show();
	}
	
	if( $('toggle_post_1585512') )
	{
		$('toggle_post_1585512').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585512] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585560-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585560'>
		<a id='entry1585560'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585560' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585560' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #114'>
					
					#114
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #114' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-29T21:17:24+00:00">29 May 2011 - 21:17</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Since correcting the &#39;DIR_WS_CATALOG&#39; in configure.php files in both includes directories seems to have fixed the other issues (these are different warnings), it is probably a good idea at this point to upload a fresh copy of osC_Sec to your server.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585560'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585560" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585560', { domLikeStripId: 'like_post_1585560', app: 'forums', type: 'pid', typeid: '1585560' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585560' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585560);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585560') )
	{
		$('multiq_1585560').show();
	}
	
	if( $('toggle_post_1585560') )
	{
		$('toggle_post_1585560').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585560] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585628-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585628'>
		<a id='entry1585628'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585628' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585628' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #115'>
					
					#115
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #115' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T10:22:38+00:00">30 May 2011 - 10:22</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Heya Taipo,<br />
<br />
I have reuploaded the files but the error messages still appear.<br />
<br />
Thanks<br />
<br />
Simon
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585628'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585628" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585628', { domLikeStripId: 'like_post_1585628', app: 'forums', type: 'pid', typeid: '1585628' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585628' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585628);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585628') )
	{
		$('multiq_1585628').show();
	}
	
	if( $('toggle_post_1585628') )
	{
		$('toggle_post_1585628').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585628] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585629-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585629'>
		<a id='entry1585629'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585629' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585629' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #116'>
					
					#116
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #116' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T10:37:56+00:00">30 May 2011 - 10:37</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->If you are still getting the error notices then add this to osc_sec.php<br /><br />Find:<br /><pre class='prettyprint lang-auto linenums:0'>&#036;currentVersion = &quot;2.5.&#91;r3&#93;&quot;;</pre><br />on the next line add<br /><pre class='prettyprint lang-auto linenums:0'>error_reporting(6135);</pre><br />That will leave the session errors. <br /><br />In osc.php find<br /><pre class='prettyprint lang-auto linenums:0'>&#036;testExpiredCookie = 1;</pre><br />change this to<br /><pre class='prettyprint lang-auto linenums:0'>&#036;testExpiredCookie = 0;</pre><br />Let me know what errors are left after that.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585629'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585629" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585629', { domLikeStripId: 'like_post_1585629', app: 'forums', type: 'pid', typeid: '1585629' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585629' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585629);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585629') )
	{
		$('multiq_1585629').show();
	}
	
	if( $('toggle_post_1585629') )
	{
		$('toggle_post_1585629').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585629] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585631-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585631'>
		<a id='entry1585631'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585631' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585631' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #117'>
					
					#117
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #117' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T10:49:20+00:00">30 May 2011 - 10:49</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000-->Heya,<br />
<br />
No errors appearing now.<br />
<br />
Does that mean that it is working correctly, or does it just mean that we have hidden the errors?<br />
<br />
Thanks<br />
<br />
Simon
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585631'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585631" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585631', { domLikeStripId: 'like_post_1585631', app: 'forums', type: 'pid', typeid: '1585631' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585631' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585631);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585631') )
	{
		$('multiq_1585631').show();
	}
	
	if( $('toggle_post_1585631') )
	{
		$('toggle_post_1585631').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585631] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585635-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585635'>
		<a id='entry1585635'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585635' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585635' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #118'>
					
					#118
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #118' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="107146" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/107146-mauriziomagnino/' title='View Profile'><span itemprop="name">mauriziomagnino</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">mauriziomagnino</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/107146-mauriziomagnino/" title="View Profile: mauriziomagnino" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-107146.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			11 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">maurizio magnino</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Location:</span><span class='fc'>Italy</span>
						</li>
					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@mauriziomagnino' ); return false;" title="@mauriziomagnino">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T11:15:26+00:00">30 May 2011 - 11:15</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					all ok.<br />
this contrib is fantastic &#33;
					
					<br />
					<p class='edit'>
							<strong>Edited by mauriziomagnino, 30 May 2011 - 11:24.</strong>
							
						</p>
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585635'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585635" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585635', { domLikeStripId: 'like_post_1585635', app: 'forums', type: 'pid', typeid: '1585635' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585635' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585635);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585635') )
	{
		$('multiq_1585635').show();
	}
	
	if( $('toggle_post_1585635') )
	{
		$('toggle_post_1585635').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585635] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585650-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585650'>
		<a id='entry1585650'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585650' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585650' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #119'>
					
					#119
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #119' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="288489" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/288489-taipo/' title='View Profile'><span itemprop="name">Taipo</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">Taipo</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/288489-taipo/" title="View Profile: Taipo" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://forums.oscommerce.com/uploads/av-288489.jpg?_r=0' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			794 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Te Taipo</span>
						</li>
					
				

					
						<li>
							<span class='ft'>Gender:</span><span class='fc'>Male</span>
						</li>
					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@Taipo' ); return false;" title="@Taipo">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T11:41:29+00:00">30 May 2011 - 11:41</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000--><blockquote class='ipsBlockquote' data-author="&#39;SimonLG&#39;" data-cid="1585631" data-time="1306752560"><p>Heya,<br /><br />No errors appearing now.<br /><br />Does that mean that it is working correctly, or does it just mean that we have hidden the errors?<br /><br />Thanks<br /><br />Simon<br /></p></blockquote><br />As I explained earlier the notices are not errors to be concerned about and in the properly configured production server they would be disabled by default. The expired cookie test is a tripwire I added in to catch out spam bots. It is clashing with some other code in your website so it is best disabled. It is not critical to the operation of osC_Sec which is why it is an optional component that can be switched off.
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585650'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585650" class='ipsLikeBar_info' >
							<a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name  " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a> likes this
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585650', { domLikeStripId: 'like_post_1585650', app: 'forums', type: 'pid', typeid: '1585650' }, parseInt('1') );
</script>
				
								
				
					<div class="signature" data-memberid="288489">
	
	<!--signature-cached-Sun, 15 Jun 2014 19:51:21 +0000-->- Stop Oscommerce hacks dead in their tracks with <a href='http://addons.oscommerce.com/info/8283' class='bbc_url' title='External link' rel='nofollow external'>osC_Sec</a> (see discussion <a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/' class='bbc_url' title=''>here</a>)<br />- Another discussion about infected files <a href='http://forums.oscommerce.com/topic/372970-malware-cookie-usagephp-explained/' class='bbc_url' title=''>::here::</a><br />- A discussion on file permissions <a href='http://forums.oscommerce.com/topic/373047-a-chat-about-file-permissions/' class='bbc_url' title=''>::here::</a><br />- Site hacked? Should you upgrade or not, some thoughts <a href='http://forums.oscommerce.com/topic/373373-site-hacked-should-you-upgrade-or-try-to-fix-it-as-it-is/' class='bbc_url' title=''>::here::</a><br />- Fix the admin login bypass exploit <a href='http://forums.oscommerce.com/topic/380144-fixing-the-admin-login-bypass-exploit/' class='bbc_url' title=''>here</a><br />- <a href='http://pastebin.com/D76C73SJ' class='bbc_url' title='External link' rel='nofollow external'>Pareto Security</a>: New security addon I am developing, a remake of osC_Sec in PHP 5 with a number of fixes<br />- BTC:1BkbNA1tK3q7ZRkCJj6f1ELK2A152eEtoW
</div>
				
				
				
			
				<ul id='postControlsNormal_1585650' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585650);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585650') )
	{
		$('multiq_1585650').show();
	}
	
	if( $('toggle_post_1585650') )
	{
		$('toggle_post_1585650').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585650] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:1585651-->

<div class='post_block hentry clear clearfix  ' id='post_id_1585651'>
		<a id='entry1585651'></a>
		
	
		
		<div class='post_wrap' >
			
				<h3 class='row2'>
			
				<span class='post_id right ipsType_small desc blend_links'>
					
						<a itemprop="replyToUrl" data-entry-pid='1585651' href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6#entry1585651' rel='bookmark' title='Oscommerce Security - Osc_Sec.php: post #120'>
					
					#120
					<img src='http://forums.oscommerce.com/public/style_images/master/icon_share.png' class='small' title='Oscommerce Security - Osc_Sec.php: post #120' />
					</a>
				</span>
				
				 &nbsp;
					<span itemprop="creator name" class="author vcard"><a hovercard-ref="member" hovercard-id="293051" data-ipb="noparse" class="_hovertrigger url fn name " href='http://forums.oscommerce.com/user/293051-simonlg/' title='View Profile'><span itemprop="name">SimonLG</span></a></span>
				
			
				
			</h3>
			<div class='author_info'>
				<div itemscope itemtype="http://schema.org/Person" class='user_details'>
	<span class='hide' itemprop="name">SimonLG</span>
	<ul class='basic_info'>
		
		<li class='avatar'>
				
				<a itemprop="url" href="http://forums.oscommerce.com/user/293051-simonlg/" title="View Profile: SimonLG" class='ipsUserPhotoLink'>
				
				
					<img itemprop="image" src='http://www.gravatar.com/avatar/f8c3aab1c379b5a30f2cc7a790578e12?s=100&amp;d=http%3A%2F%2Fforums.oscommerce.com%2Fpublic%2Fstyle_images%2Fmaster%2Fprofile%2Fdefault_large.png' class='ipsUserPhoto ipsUserPhoto_large' />
				
				
				</a>
				
			</li>
		<li class='group_title'>
			Members
		</li>
		
		
		<li class='post_count desc lighter'>
			9 posts
		</li>
		
		
	</ul>
	
	
		<ul class='custom_fields'>
			
				
					
						<li>
							<span class="ft">Real Name:</span><span class="fc">Simon</span>
						</li>
					
				

					
				

					
				
			
		</ul>
	<ul class="custom_fields"><li><a href="#" onClick="ipb.textEditor.getEditor( ipb.textEditor.getCurrentEditorId() ).insert( '@SimonLG' ); return false;" title="@SimonLG">@Mention</a>
</li></ul>
	
</div>
			</div>
			<div class='post_body'>
				<p class='posted_info desc lighter ipsType_small'>
					Posted <abbr class="published" itemprop="commentTime" title="2011-05-30T11:55:17+00:00">30 May 2011 - 11:55</abbr>
					
				</p>
				
				<div itemprop="commentText" class='post entry-content '>
					<!--cached-Sat, 19 Jul 2014 04:56:35 +0000--><blockquote class='ipsBlockquote' data-author="&#39;Taipo&#39;" data-cid="1585650" data-time="1306755689"><p>As I explained earlier the notices are not errors to be concerned about and in the properly configured production server they would be disabled by default. The expired cookie test is a tripwire I added in to catch out spam bots. It is clashing with some other code in your website so it is best disabled. It is not critical to the operation of osC_Sec which is why it is an optional component that can be switched off.<br /></p></blockquote><br /><br />In that case, I am a happy man.<br /><br />Thank you so much for your help&#33;<br /><br />Simon
					
					<br />
					
				</div>
				
				
				<div class='ipsLikeBar right clearfix' id='rep_post_1585651'>
				<ul class='ipsList_inline'>
					<li id="like_post_1585651" class='ipsLikeBar_info' style="display:none">
							
						</li>
					
				</ul>
			</div>
<script type='text/javascript'>
	ipb.global.registerReputation( 'rep_post_1585651', { domLikeStripId: 'like_post_1585651', app: 'forums', type: 'pid', typeid: '1585651' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id='postControlsNormal_1585651' class='post_controls clear clearfix' >
					<li class='top hide'><a href='#ipboard_body' class='top' title='Back to top'>Back to top</a></li>
					
					
					
					
					
					
				</ul>
				
			</div>
		</div>
	</div>
		
		
		<hr />
		
		
<script type="text/javascript">
var pid = parseInt(1585651);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_1585651') )
	{
		$('multiq_1585651').show();
	}
	
	if( $('toggle_post_1585651') )
	{
		$('toggle_post_1585651').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[1585651] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			
		</div>
	</div>

<hr />
<div class='topic_controls clear ipsPad_top_bottom_half'>
	
		<div class='left'><div class='pagination clearfix left '>
		<ul class='ipsList_inline back left'>
			<li class='first'><a href='http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-1' title='Oscommerce Security - Osc_Sec.php - Go to first page' rel='start'>&laquo; <!--First--></a></li>
			<li class='prev'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Previous page" rel='prev'>Prev</a></li>
		</ul>
		<ul class='ipsList_inline left pages'>
			<li class='pagejump clickable pj0770539001'>
					<a href='#'>Page 6 of 28 <!--<img src='http://forums.oscommerce.com/public/style_images/master/dropdown.png' alt='+' />--></a>
					<script type='text/javascript'>
						ipb.global.registerPageJump( '0770539001', { url: "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/", stKey: 'st', perPage: 20, totalPages: 28, anchor: '' } );
					</script>
				</li>
			
				
					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-4" title="Oscommerce Security - Osc_Sec.php - Page 4">4</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-5" title="Oscommerce Security - Osc_Sec.php - Page 5">5</a>
						</li>
				

					
						<li class='page active'>6</li>
					
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Page 7">7</a>
						</li>
				

					<li class='page'>
							<a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-8" title="Oscommerce Security - Osc_Sec.php - Page 8">8</a>
						</li>
				
			
		</ul>
		<ul class='ipsList_inline forward left'>
			<li class='next'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-7" title="Oscommerce Security - Osc_Sec.php - Next page" rel='next'>Next</a></li>
			<li class='last'><a href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-28" title="Oscommerce Security - Osc_Sec.php - Go to last page" rel='last'>&raquo;</a></li>
		</ul>
	</div></div>
	
	<div class='ipsPad_top_slimmer right'>
		
		<a href='http://forums.oscommerce.com/forum/76-security/' class="ipsType_small desc">Back to Security</a>
		
	</div>
</div>

<!-- Close topic -->
</div>
<!-- BOTTOM BUTTONS -->

	<br />
	<div class='clear clearfix left'>
		

	<ul class='topic_share left shareButtons ipsList_inline'>
	
		<li><a href="http://forums.oscommerce.com/index.php?sharelink=twitter;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Twitter" class='_slink' id='slink_twitter'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/twitter.png" /></a></li>
	

		
				<li class='fbLike'><div class="fb-like" data-href="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" data-send="false" data-layout="button_count" data-width="150" data-show-faces="false" data-action="like"></div><div id="fb-root"></div></li>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=203307189516";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
			
	

		
				<script type="text/javascript" src="https://apis.google.com/js/plusone.js">
	
		{lang: 'en-GB'}
	
</script>
<li><div class='googlePlusOne'><g:plusone count="false" size="small"></g:plusone></div></li>
			
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=digg;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Digg" class='_slink' id='slink_digg'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/digg.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=delicious;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Del.icio.us" class='_slink' id='slink_delicious'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/delicious.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=reddit;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via Reddit" class='_slink' id='slink_reddit'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/reddit.png" /></a></li>
	

		<li><a href="http://forums.oscommerce.com/index.php?sharelink=stumble;aHR0cDovL2ZvcnVtcy5vc2NvbW1lcmNlLmNvbS90b3BpYy8zNzM3Nzctb3Njb21tZXJjZS1zZWN1cml0eS1vc2Mtc2VjcGhwLw,,;T3Njb21tZXJjZSBTZWN1cml0eSAtIE9zY19TZWMucGhw" rel="nofollow" target="_blank" title="Share this link via StumbleUpon" class='_slink' id='slink_stumble'><img src="http://forums.oscommerce.com/public/style_extra/sharelinks/stumble.png" /></a></li>
	

		
	
	</ul>
	<script type="text/javascript">
		ipb.sharelinks.url   = "http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/";
		ipb.sharelinks.title = "Oscommerce Security - Osc_Sec.php";
		ipb.sharelinks.bname = "osCommerce Support Forum";
	</script>

	</div>
	<br />

<!-- SAME TAGGED -->

<!-- ACTIVE USERS -->



	<script type="text/javascript" src="http://forums.oscommerce.com/public/js/3rd_party/prettify/prettify.js"></script>
	<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/prettify/lang-sql.js'></script>
	<!-- By default we load generic code, php, css, sql and xml/html; load others here if desired -->
	<script type="text/javascript">
	//<![CDATA[
		Event.observe( window, 'load', function(e){ prettyPrint() });
	//]]>
	</script>
<div id='multiQuoteInsert' style='display: none;' class='ipsFloatingAction'>
	<span class='ipsButton no_width' id='mqbutton'>Reply to quoted posts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#' id='multiQuoteClear' class='ipsType_smaller desc' title='Clear the posts you have selected with MultiQuote'>Clear</a> &nbsp;&nbsp;&nbsp;
</div>
<form id="modform" method="post" action="http://forums.oscommerce.com/index.php?">
	<input type="hidden" name="app" value="forums" />
	<input type="hidden" name="module" value="moderate" />
	<input type="hidden" name="section" value="moderate" />
	<input type="hidden" name="do" value="postchoice" />
	<input type="hidden" name="f" value="76" />
	<input type="hidden" name="t" value="373777" />
	<input type="hidden" name="auth_key" value="880ea6a14ea49e853634fbdc5015a024" />
	<input type="hidden" name="st" value="" />
	<input type="hidden" name="page" value="6" />
	<input type="hidden" value="" name="selectedpidsJS" id='selectedpidsJS' />
	<input type="hidden" name="tact" id="tact" value="" />
</form>
				
					<div class='ipsAd'><script>
var oscGetPartnerBannerUrl = 'http://www.oscommerce.com/index.php?RPC&Website&Index&GetPartnerBanner';
if ( typeof oscForumID != 'undefined' ) {
  oscGetPartnerBannerUrl = oscGetPartnerBannerUrl + '&forumid=' + oscForumID;
}
document.write('<script src="' + oscGetPartnerBannerUrl + '"><\/script>');
</script></div>
				
				<ol class='breadcrumb bottom ipsList_inline left clearfix clear'>
											<li><a href='http://forums.oscommerce.com/'>osCommerce Support Forum</a></li>
							
						
							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/25-oscommerce-online-merchant-v2-x/' title='Return to osCommerce Online Merchant v2.x'><span>osCommerce Online Merchant v2.x</span></a></li>
							
						

							<li><span class='nav_sep'>&rarr;</span> <a href='http://forums.oscommerce.com/forum/76-security/' title='Return to Security'><span>Security</span></a></li>
							
						

					
					<li class='right ipsType_smaller'>
						<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
					</li>
					
					<li class='right ipsType_smaller'>
							<a href='http://forums.oscommerce.com/index.php?app=forums&amp;module=extras&amp;section=boardrules' title='Forum Rules'>Forum Rules</a> &middot; 
						</li>
				</ol>
			</div>
			<!-- ::: FOOTER (Change skin, language, mark as read, etc) ::: -->
			<div id='footer_utilities' class='main_width clearfix clear'>
				<a rel="nofollow" href='#top' id='backtotop' title='Go to top'><img src='http://forums.oscommerce.com/public/style_images/master/top.png' alt='' /></a>
				<ul class='ipsList_inline left'>
					<li>
						<img src='http://forums.oscommerce.com/public/style_images/master/feed.png' alt='RSS Feed' id='rss_feed' class='clickable' />
					</li>
					
							
								<li>
									<a rel="nofollow" id='new_skin' href='#' title='Change Theme'>Change Theme</a>
									<ul id='new_skin_menucontent' class='ipbmenu_content with_checks' style='display: none'>
										
											<li class='selected'>
												<a href='#' data-clicklaunch='changeSkin' data-skinid='1'>IP.Board</a>
											</li>
										

											<li >
												<a href='#' data-clicklaunch='changeSkin' data-skinid='3'>IP.Board Mobile</a>
											</li>
										
									</ul>
								</li>
							
					
					
					<li>
						<a href="http://forums.oscommerce.com/index.php?app=core&amp;module=help" title='View help' rel="help" accesskey='6'>Help</a>
					</li>
				</ul>
				<!-- Copyright Information -->
        				  <p id='copyright'>
        				  	<a href='http://www.invisionpower.com/apps/board/' title='Community Forum Software by Invision Power Services'>Community Forum Software by IP.Board</a></p>
		<!-- / Copyright -->
			</div>
			
			
			
				<script type='text/javascript' src='http://forums.oscommerce.com/public/js/3rd_party/lightbox.js'></script>
<script type='text/javascript'>
//<![CDATA[
	// Lightbox Configuration
	LightboxOptions = Object.extend({
	    fileLoadingImage:        'http://forums.oscommerce.com/public/style_images/master/lightbox/loading.gif',
	    fileBottomNavCloseImage: 'http://forums.oscommerce.com/public/style_images/master/lightbox/closelabel.gif',
	    overlayOpacity: 0.8,   // controls transparency of shadow overlay
	    animate: true,         // toggles resizing animations
	    resizeSpeed: 10,        // controls the speed of the image resizing animations (1=slowest and 10=fastest)
	    borderSize: 10,         //if you adjust the padding in the CSS, you will need to update this variable
		// When grouping images this is used to write: Image # of #.
		// Change it for non-english localization
		labelImage: "Image",
		labelOf: "of"
	}, window.LightboxOptions || {});
/* Watch for a lightbox image and set up our downloadbutton watcher */
document.observe('click', (function(event){
    var target = event.findElement('a[rel*="lightbox"]') || event.findElement('area[rel*="lightbox"]') || event.findElement('span[rel*="lightbox"]');
    if (target) {
        event.stop();
        gbl_addDownloadButton();
    }
}).bind(this));
var _to    = '';
var _last  = '';
function gbl_addDownloadButton()
{
	if ( typeof( ipsLightbox.lightboxImage ) != 'undefined' && ipsLightbox.lightboxImage.src )
	{
		if ( _last != ipsLightbox.lightboxImage.src )
		{
			if ( ! $('gbl_d') )
			{
				$('bottomNav').insert( { top: "<div id='gbl_d' style='text-align:right;padding-bottom:4px;'></div>" } );
			}
			
			$('gbl_d').update( "<a href='"+ ipsLightbox.lightboxImage.src + "' target='_blank'><img src='http://forums.oscommerce.com/public/style_images/master/lightbox/download-icon.png' /></a>" );
			
			_last = ipsLightbox.lightboxImage.src;
		}
	}
	
	/* Check for init and then keep checking for new image */
	_to = setTimeout( "gbl_addDownloadButton()", 1000 );
}
//]]>
</script>
			
			<div id='inline_login_form' style="display:none">
		<form action="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=login&amp;do=process" method="post" id='login'>
				<input type='hidden' name='auth_key' value='880ea6a14ea49e853634fbdc5015a024' />
				<input type="hidden" name="referer" value="http://forums.oscommerce.com/topic/373777-oscommerce-security-osc-secphp/page-6" />
				<h3>Sign In</h3>
				
				<br />
				<div class='ipsForm ipsForm_horizontal'>
					<fieldset>
						<ul>
							<li class='ipsField'>
								<div class='ipsField_content'>
									Need an account? <a href="http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=register" title='Register now!'>Register now!</a>
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_username' class='ipsField_title'>Username or email:</label>
								<div class='ipsField_content'>
									<input id='ips_username' type='text' class='input_text' name='ips_username' size='30' tabindex='0' />
								</div>
							</li>
							<li class='ipsField ipsField_primary'>
								<label for='ips_password' class='ipsField_title'>Forum Password</label>
								<div class='ipsField_content'>
									<input id='ips_password' type='password' class='input_text' name='ips_password' size='30' tabindex='0' /><br />
									<a href='http://forums.oscommerce.com/index.php?app=core&amp;module=global&amp;section=lostpass' title='Retrieve password'>I've forgotten my password</a>
								</div>
							</li>
							<li class='ipsField ipsField_checkbox'>
								<input type='checkbox' id='inline_remember' checked='checked' name='rememberMe' value='1' class='input_check' tabindex='0' />
								<div class='ipsField_content'>
									<label for='inline_remember'>
										<strong>Remember me</strong><br />
										<span class='desc lighter'>This is not recommended for shared computers</span>
									</label>
								</div>
							</li>
							
							
							<li class='ipsPad_top ipsForm_center desc ipsType_smaller'>
								<a rel="nofollow" href='http://forums.oscommerce.com/privacypolicy/'>Privacy Policy</a>
							</li>
							
						</ul>
					</fieldset>
					
					<div class='ipsForm_submit ipsForm_center'>
						<input type='submit' class='ipsButton' value='Sign In' tabindex='0' />
					</div>
				</div>
			</form>
	</div>
		</div>
		
		
		<script type='text/javascript'>
			if( $('primary_nav') ){	ipb.global.activateMainMenu(); }
		</script>
			</body>
</html>
