http://josephmate.wordpress.com/
HTTP/1.1 200 OK
Server: nginx
Date: Tue, 22 Jul 2014 19:38:15 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Vary: Accept-Encoding
Vary: Cookie
X-hacker: If you're reading this, you should visit automattic.com/jobs and apply to join the fun, mention this header.
X-Pingback: http://josephmate.wordpress.com/xmlrpc.php
Link: <http://wp.me/MFtN>; rel=shortlink
Content-Encoding: gzip

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Joseph Mate&#039;s Blog | What is Joseph working on?</title>
<link rel="stylesheet" href="http://s2.wp.com/wp-content/themes/pub/journalist-13/style.css?m=1386301037g" type="text/css" media="screen" />
<link rel="pingback" href="http://josephmate.wordpress.com/xmlrpc.php" />
<meta name="google-site-verification" content="k-vRl-G0cWOAuS5K0_22zrhCUydCVLq5BjwlqJyOb8Y" />
<link rel="alternate" type="application/rss+xml" title="Joseph Mate&#039;s Blog &raquo; Feed" href="http://josephmate.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Joseph Mate&#039;s Blog &raquo; Comments Feed" href="http://josephmate.wordpress.com/comments/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-0' href='http://s2.wp.com/_static/??-eJx9ketuwyAMhV9ozM0WTfsz7VkouI5TgxEQRX37kXSXVp34dw46n/EF1mScxoqxQlhMkoU4FiiBBS8p64yu3rtnV8oT/I8Jn7HAjDVZdza7e4gfRekPUCL0ulRzUhFdYWVP2P3Dacb2HpKtWyKgZ4uCocV6WEhvP9Qmp9bgd28MUSs3pPyKXiFCNaLOVtZ4Z8xJLOcemnEbvkmClrqxD1Cd2kAFphFI9GilV/W6srKXvGpDmb2x0bcTlO5WbllS9Rmt36f/DB/DeBiH4eX98Dp/AfBTzj8=' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJyFj1kOwjAMRC+ESVuBxA/iLF3cyCEbcUIEpyfQgtikfnlkv/HYInvonY1oo1AsjOtIIyTG0MrSA7KjWyteicKR7XUakO+gOiUMl7ksAmBIhjbi2pB9wm+p3nE0yFwi/0w/o8ieCfMipjD6tj9CQKbrz9ZOOwleJ0mWRdESB5cijE5rl0WmQWL89pj0ckzA481JQpeMh/mwg9nXm6ra7uqmatQNYEyEBw=='></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://josephmate.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://josephmate.wordpress.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />
<link rel='shortlink' href='http://wp.me/MFtN' />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Joseph Mate&#039;s Blog" />
<meta property="og:description" content="What is Joseph working on?" />
<meta property="og:url" content="http://josephmate.wordpress.com/" />
<meta property="og:site_name" content="Joseph Mate&#039;s Blog" />
<meta property="og:image" content="http://wordpress.com/i/blank.jpg?m=1383295312g" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />
<link rel="shortcut icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1405977958g" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1405977958g" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="http://s0.wp.com/i/webclip.png?m=1391188133g" />
<link rel='openid.server' href='http://josephmate.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='http://josephmate.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="http://josephmate.wordpress.com/osd.xml" title="Joseph Mate&#039;s Blog" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com" />
<meta name="application-name" content="Joseph Mate&#039;s Blog" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="What is Joseph working on?" /><meta name="msapplication-task" content="name=Subscribe;action-uri=http://josephmate.wordpress.com/feed/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="title" content="Joseph Mate&#039;s Blog on WordPress.com" />
<meta name="description" content="What is Joseph working on? (by Joseph)" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="home blog mp6 highlander-enabled highlander-light">
<div id="container">
<div id="skip">
	<p><a href="#content" title="Skip to site content">Skip to content</a></p>
	<p><a href="#search" title="Skip to search" accesskey="s">Skip to search - Accesskey = s</a></p>
</div>
	<h1><a href="http://josephmate.wordpress.com/">Joseph Mate&#039;s Blog</a></h1>

<div id="content">
<div class="post-250 post type-post status-publish format-standard hentry category-uncategorized tag-briss tag-cropping tag-kindle tag-pdf">
		<h2 id="post-250">
					<a href="http://josephmate.wordpress.com/2014/04/27/reading-books-and-technical-papers-on-the-kindle-method-2/" rel="bookmark">Reading Books and Technical Papers on the Kindle (Method&nbsp;2)</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a> by Joseph on April 27, 2014	</div>
	<div class="main">
		<p>I&#8217;m trying to read a book similar to <a title="Elements of Statistical Learning" href="http://www.amazon.com/Elements-Statistical-Learning-Prediction-Statistics-ebook/dp/B00475AS2E/ref=sr_1_1?ie=UTF8&amp;qid=1398537686&amp;sr=8-1&amp;keywords=elements+of+statistical+learning" target="_blank">Elements of Statistical Learning</a> (aside: the book is freely available by one of the authors, Professor Rob Tibshirani, <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/" target="_blank">here</a>) on my Kindle, but the method I outlined in my previous post does not work that well. Moreover, look at all the wasted space on the left and right margins!</p>
<p><a href="http://josephmate.files.wordpress.com/2014/04/wasted_space.jpg"><img class="size-medium wp-image-251 aligncenter" src="http://josephmate.files.wordpress.com/2014/04/wasted_space.jpg?w=222&#038;h=300" alt="Wasted Space" width="222" height="300" /></a></p>
<p>No matter what settings you apply (rotating and/or zooming), I have this margin that&#8217;s driving me nuts. Fortunately, after googling for PDF cropper, I came across <a title="briss" href="http://briss.sourceforge.net/" target="_blank">briss</a>. Briss is a PDF cropper that automatically crops the margins, and is able to automatically detect exceptions like left and right pages, or even if images are overflowing. Below is a screenshot from running briss on Elements of Statistical Learning.</p>
<p><a href="http://josephmate.files.wordpress.com/2014/04/briss.png"><img class="size-medium wp-image-252 aligncenter" src="http://josephmate.files.wordpress.com/2014/04/briss.png?w=300&#038;h=144" alt="briss" width="300" height="144" /></a>Briss in this case detected the title page should be handled separately. Additionally, it detected that there is separate formatting for the margins of the even and odd pages.</p>
<p>Now the final step is getting it to display on this kindle. Unfortunately, in portrait mode there is still a margin because the Kindle tries to display the entire page.</p>
<p><a href="http://josephmate.files.wordpress.com/2014/04/kportrait.jpg"><img class="size-medium wp-image-255 aligncenter" src="http://josephmate.files.wordpress.com/2014/04/kportrait.jpg?w=216&#038;h=300" alt="kportrait"   /></a></p>
<p>As a result, you need to switch to landscape mode by going to &#8216;Zoom &amp; Contrast&#8217;</p>
<p><a href="http://josephmate.files.wordpress.com/2014/04/klandscape.jpg"><img class="size-medium wp-image-256 aligncenter" src="http://josephmate.files.wordpress.com/2014/04/klandscape.jpg?w=300&#038;h=199" alt="klandscape" width="300" height="199" /></a></p>
<p>Viola! No more wasted space. Now you have no excuse not to read those technical books you&#8217;ve been putting off the last couple of months!</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/briss/" rel="tag">Briss</a>, <a href="http://josephmate.wordpress.com/tag/cropping/" rel="tag">Cropping</a>, <a href="http://josephmate.wordpress.com/tag/kindle/" rel="tag">Kindle</a>, <a href="http://josephmate.wordpress.com/tag/pdf/" rel="tag">PDF</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2014/04/27/reading-books-and-technical-papers-on-the-kindle-method-2/#respond" title="Comment on Reading Books and Technical Papers on the Kindle (Method&nbsp;2)">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-199 post type-post status-publish format-standard hentry category-uncategorized tag-kindle tag-papers tag-pdf">
		<h2 id="post-199">
					<a href="http://josephmate.wordpress.com/2014/01/07/reading-technical-papers-on-kindle/" rel="bookmark">Reading Technical Papers on the&nbsp;Kindle</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a> by Joseph on January 7, 2014	</div>
	<div class="main">
		<h2>Introduction</h2>
<p>I have a <a href="http://www.amazon.com/Kindle-Ereader-ebook-reader/dp/B007HCCNJU">Kindle with a 6&#8221; screen</a> and reading technical papers is difficult. However, I am fortunate that most of the papers I read follow the 2-column format. As a result, there is a technique available to make reading technical papers less painful. I have only tested this with my Kindle. I will be demonstrating the method using the <a href="http://people.cs.uchicago.edu/~tga/pubs/sigmod-linkbench-2013.pdf" target="_blank">LinkBench</a> technical paper from SIGMOD. These instructions may also work for the <a href="http://www.amazon.com/gp/product/B00AWH595M/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00AWH595M&amp;linkCode=as2&amp;tag=josmat0a-20">Kindle Paperwhite</a><img class="guunnzjwgwduriapmbce xuydnvuboswgclptwrso" style="border:none !important;margin:0!important;" alt="" src="http://ir-na.amazon-adsystem.com/e/ir?t=josmat0a-20&amp;l=as2&amp;o=1&amp;a=B00AWH595M" width="1" height="1" border="0" /> as well. Please leave a comment letting me know if it does.</p>
<h2>The Quirks of the Kindle</h2>
<p>This technique involves, changing the the orientation, the zoom, and properly using the arrow keys to navigate the page. You can use it without making any modifications to the Kindle or the document you want to read.</p>
<ol>
<li>
<h3>Open up the document</h3>
<p><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112103.jpg"><br />
<img class="alignnone size-medium wp-image-211" alt="20140105_112103" src="http://josephmate.files.wordpress.com/2014/01/20140105_112103.jpg?w=225&#038;h=300" width="225" height="300" /></a></li>
<li>
<h3>Hit the Menu button to bring up hidden options <a href="http://josephmate.files.wordpress.com/2014/01/menubtn.jpg"><img class="alignnone size-full wp-image-213" alt="menubtn" src="http://josephmate.files.wordpress.com/2014/01/menubtn.jpg?w=50" /></a></h3>
</li>
<li>
<h3>Select &#8216;Zoom &amp; Contrast&#8217;</h3>
<p><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112243.jpg"><img class="alignnone size-medium wp-image-218" alt="20140105_112243" src="http://josephmate.files.wordpress.com/2014/01/20140105_112243.jpg?w=226&#038;h=300" width="226" height="300" /></a></li>
<li>
<h3>Select 200%</h3>
<p><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112629.jpg"><img class="alignnone size-medium wp-image-219" alt="20140105_112629" src="http://josephmate.files.wordpress.com/2014/01/20140105_112629.jpg?w=300&#038;h=112" width="300" height="112" /></a></li>
<li>
<h3>Using the arrow keys <a href="http://josephmate.files.wordpress.com/2014/01/arrow.jpg"><img class="alignnone  wp-image-229" alt="arrow" src="http://josephmate.files.wordpress.com/2014/01/arrow.jpg?w=48&#038;h=46" width="48" height="46" /></a>, position rectangle in top left corner</h3>
<p><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112653.jpg"><img class="alignnone size-medium wp-image-220" alt="20140105_112653" src="http://josephmate.files.wordpress.com/2014/01/20140105_112653.jpg?w=229&#038;h=300" width="229" height="300" /></a><br />
<a href="http://josephmate.files.wordpress.com/2014/01/20140105_112710.jpg"><img class="alignnone size-medium wp-image-221" alt="20140105_112710" src="http://josephmate.files.wordpress.com/2014/01/20140105_112710.jpg?w=231&#038;h=300"   /></a></li>
<li>
<h3>To go to the second column, <b>do not</b> use the right arrow key <a href="http://josephmate.files.wordpress.com/2014/01/arrow.jpg"><img alt="arrow" src="http://josephmate.files.wordpress.com/2014/01/arrow.jpg?w=48&#038;h=46" width="48" height="46" /></a></h3>
<p>Intuitively, you would go to the right side in order to view the second column by pressing the right arrow two times. However, on the second press, the Kindle is not smart enough to realize it viewing beyond the bounds of the document. As a result, it repositions as if the document kept going to the right.</p>
<table>
<tbody>
<tr>
<td><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112722.jpg"><img class="alignnone size-medium wp-image-222" alt="20140105_112722" src="http://josephmate.files.wordpress.com/2014/01/20140105_112722.jpg?w=226&#038;h=300" width="226" height="300" /></a></td>
<td><a href="http://josephmate.files.wordpress.com/2014/01/20140105_112731.jpg"><img class="alignnone size-medium wp-image-223" alt="20140105_112731" src="http://josephmate.files.wordpress.com/2014/01/20140105_112731.jpg?w=234&#038;h=300"   /></a></td>
</tr>
</tbody>
</table>
</li>
<li>
<h3>To go to the second column, use the left arrow key <a href="http://josephmate.files.wordpress.com/2014/01/arrow.jpg"><img alt="arrow" src="http://josephmate.files.wordpress.com/2014/01/arrow.jpg?w=48&#038;h=46" width="48" height="46" /></a></h3>
<p>Here we are playing a trick on the Kindle to do the right thing. It wraps around and properly displays the second column. To go back to the first column we need to use the right arrow key.<br />
<a href="http://josephmate.files.wordpress.com/2014/01/20140105_112742.jpg"><img class="alignnone size-medium wp-image-224" alt="20140105_112742" src="http://josephmate.files.wordpress.com/2014/01/20140105_112742.jpg?w=236&#038;h=300" width="236" height="300" /></a></li>
</ol>
<h2>Conclusions</h2>
<p>Reading two column technical documents on the Kindle is possible. It&#8217;s just not very intuitive to figure out on your own. Please let me know what Kindles and e-readers this trick works for.</p>
<h2>References</h2>
<p>Timothy G. Armstrong, Vamsi Ponnekanti, Dhruba Borthakur, and Mark Callaghan. 2013. LinkBench: a database benchmark based on the Facebook social graph. In <em>Proceedings of the 2013 ACM SIGMOD International Conference on Management of Data</em> (SIGMOD &#8217;13). ACM, New York, NY, USA, 1185-1196. DOI=10.1145/2463676.2465296 <a href="http://doi.acm.org/10.1145/2463676.2465296" rel="nofollow">http://doi.acm.org/10.1145/2463676.2465296</a> (Available <a href="http://people.cs.uchicago.edu/~tga/pubs/sigmod-linkbench-2013.pdf" target="_blank">here</a>)</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/kindle/" rel="tag">Kindle</a>, <a href="http://josephmate.wordpress.com/tag/papers/" rel="tag">Papers</a>, <a href="http://josephmate.wordpress.com/tag/pdf/" rel="tag">PDF</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2014/01/07/reading-technical-papers-on-kindle/#respond" title="Comment on Reading Technical Papers on the&nbsp;Kindle">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-197 post type-post status-publish format-standard hentry category-hadoop tag-eclipse tag-hadoop tag-mapreduce tag-rant">
		<h2 id="post-197">
					<a href="http://josephmate.wordpress.com/2014/01/06/an-eclipse-and-hadoop-pitfall/" rel="bookmark">An Eclipse and Hadoop&nbsp;Pitfall</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/hadoop/" rel="category tag">Hadoop</a> by Joseph on January 6, 2014	</div>
	<div class="main">
		<p>For one of my course projects I inherited a project that was implementing a dimensionality reduction technique in map reduce. The previous owner of the project exclusively ran it using eclipse and used <a href="http://www.amazon.com/gp/product/1935182684/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1935182684&amp;linkCode=as2&amp;tag=josmat0a-20">Mahout in Action</a><img class="vynbimwtqvcxdqgnwrdl" style="border:none !important;margin:0!important;" alt="" src="http://ir-na.amazon-adsystem.com/e/ir?t=josmat0a-20&amp;l=as2&amp;o=1&amp;a=1935182684" width="1" height="1" border="0" />&#8216;s examples as a starting point.</p>
<h2>The Problem I Inherited</h2>
<p>The following pattern was littered through most of the Hadoop jobs:</p>
<pre class="brush: java; title: ; notranslate" title="">
public class Main extends AbstractJob {

  /**
   * Some parameter to be used by the Mapper and
   * Reducer.
   */
  private static int parameter;

  public int run( String[] args ) throws Exception {
    parameter = 100;
    Job brokenJob = new Job( conf, &quot;This doesn't work!&quot; );
    brokenJob.setMapperClass( BrokenMapper.class );
    brokenJob.setReducerClass( BrokenReducer.class );
    brokenJob.setInputFormatClass( TextInputFormat.class );
    brokenJob.setOutputFormatClass( TextOutputFormat.class );
    brokenJob.setOutputKeyClass( IntWritable.class);
    brokenJob.setOutputValueClass( IntWritable.class );
    brokenJob.setMapOutputKeyClass( IntWritable.class );
    brokenJob.setMapOutputValueClass( IntWritable.class );
  }

  public static void main( String[] args ) throws Exception {
    ToolRunner.run( new Main(), args );
  }

  /**
   * This mapper is broken because it makes reference to a static
   * variable set by the JobClient, on a different JVM.
   */
  public static class BrokenMapper
    extends Mapper &lt; LongWritable, Text, IntWritable, IntWritable &gt; {

    protected void map( LongWritable key, Text value, Context context )
        throws IOException, InterruptedException {
      /**
       * Do something that makes use of static variable 'paramater'
       */
    }
  }

  /**
   * This reducer has the same problem as the above mapper.
   */
  public static class BrokenReducer
    extends Reducer&lt; IntWritable, IntWritable, IntWritable, IntWritable &gt; {

    public void reduce( IntWritable key, Iterable&lt; VectorWritable &gt; values, Context context )
        throws IOException, InterruptedException {
      /**
       * Do something that makes use of static variable 'paramater'
       */
    }
  }
}
</pre>
<p>The above code works when you run it from Eclipse. It works because using Maven, Eclipse has all of the jars that it needs in order to run. However, it does not run it using hadoop -libjar. It&#8217;s running it using java -classpath. As a result, everything defaults to the LocalJobRunner. The significance of this is that everything is running on a <strong>single</strong> JVM. As a result, the variables set by the JobClient were visible to the Mapper and Reducer. In a real Hadoop job, this is not the case. The JobClient, Mapper, and Reducers run on separate JVMs, and most likely different machines. When you run the code above, you&#8217;ll get NullPointerExceptions or weird behaviour resulting from the default values of java primitives. This results in developers unfamiliar with the MapReduce paradigm to make invalid assumptions.</p>
<h2>How I Fixed It</h2>
<p>One easy fix is to pass variables through the job configuration. Then in the setup of the Mapper and Reducer, parse the configuration. The code is given below. I have omitted a lot of code from the above example that would be redundant.</p>
<pre class="brush: java; title: ; notranslate" title="">
public static class FixedMapper
  extends Mapper &lt; LongWritable, Text, IntWritable, IntWritable &gt; {

  private int parameter;

  protected void setup(Context context)
      throws IOException, InterruptedException {
    Configuration conf = context.getConfiguration();
    // we do not use Confugration.getInt(String) because we want
    // to fail if the value is not present.
    parameter = Integer.parseInt(conf.get(&quot;parameter&quot;));
  }

  protected void map( LongWritable key, Text value, Context context )
      throws IOException, InterruptedException {
    /**
     * Do something that makes use of static variable 'paramater'
     */
  }
}
</pre>
<p>Unfortunately, this was not enough. Some of the variables passed between the mappers and reducers were matrices. They were on the order of 100s of megabytes in size. It would be a bad idea to place something so large in Hadoop job&#8217;s configuration. As a result, I saved it to the distributed cache, and loaded it in the mapper&#8217;s and reducer&#8217;s setup method.</p>
<h2>Conclusion</h2>
<p>When you&#8217;re using Eclipse, understand what it is hiding. In this case, Eclipse was hiding that it uses java -classpath to run the main class from Maven. Secondly, it was also hidden that running the main class using java instead of hadoop uses the LocalJobRunner by default. By doing so, everything runs in a single JVM and you will fail to observe where you&#8217;re exploiting that false assumption.</p>
<p>Additionally, understand the framework you&#8217;re using is valuable is valuable in avoiding similar pitfalls. In this case, there was a failure in understanding the MapReduce paradigm. The JobClient cannot shared variables with Mapper and Reducer because they run on separate JVMs. This is not an argument against Eclipse. This merely a warning. I use Eclipse for all of my Java development. However, I have compiled and run java programs from the command line. This pattern extends to any tool you&#8217;re using. For example, what are Ant and Maven hiding from you to make your life easier?</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/eclipse/" rel="tag">Eclipse</a>, <a href="http://josephmate.wordpress.com/tag/hadoop/" rel="tag">Hadoop</a>, <a href="http://josephmate.wordpress.com/tag/mapreduce/" rel="tag">MapReduce</a>, <a href="http://josephmate.wordpress.com/tag/rant/" rel="tag">Rant</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2014/01/06/an-eclipse-and-hadoop-pitfall/#respond" title="Comment on An Eclipse and Hadoop&nbsp;Pitfall">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-193 post type-post status-publish format-standard hentry category-machine-learning">
		<h2 id="post-193">
					<a href="http://josephmate.wordpress.com/2013/10/26/showing-mathematically-that-more-complexity-increases-test-error/" rel="bookmark">Showing Mathematically That More Complexity Increases Test&nbsp;Error</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/machine-learning/" rel="category tag">Machine Learning</a> by Joseph on October 26, 2013	</div>
	<div class="main">
		<p>People who understand machine learning know from experience that having to complex a model causes poor performance when you apply your models to the real world because it does not generalize. However, where does the mathematical intuition for this come from? Up until I saw today&#8217;s lecture, I only had a sense of this issue because of all the experiments I ran. Today our professor Dr. Ali Ghodsi presented a mathematical proof for a radial basis function network decreasing in test performance as a result of having too many hidden nodes. In the follow post I give the necessary background on RBFs and a summary of the proof for overfitting due to too many hidden nodes.</p>
<h2>Background &#8211; What is a Radial Basis Function Network (RBF)?</h2>
<p>It&#8217;s easy to imagine RBF as a neural network with a few differences.</p>
<ol>
<li>There is only one hidden layer.</li>
<li>There are only weights going from the input nodes to the hidden layer.</li>
<li>The activation function applied on the hidden layer is the normal distribution.</li>
<li>You cluster your data and take their mean and variance to determine the parameters for the normal distributions used in the activation function above.</li>
</ol>
<h2>Result</h2>
<p>Details of the proof are given in Professor Ghodsi&#8217;s and Dale Schuurmans&#8217;s paper: <a title="Automatic Basis Selection Techniques for RBF Networks" href="http://www.math.uwaterloo.ca/~aghodsib/papers/journalofnn.pdf" target="_blank">Ali Ghodsi, Dale Schuurmans, Automatic basis selection techniques for RBF networks, Neural Networks, Volume 16, Issues 5–6, June–July 2003, Pages 809–816</a>.</p>
<p>By assuming that the noise in the training and test data sets are guassian, the paper proves:<br />
<img src='http://s0.wp.com/latex.php?latex=%5CLarge+Error%28M%29+%3D+error%28M%29+-+N%5Csigma%5E2+%2B+2%5Csigma%28M%2B1%29+&amp;bg=fff&amp;fg=222&amp;s=0' alt='&#92;Large Error(M) = error(M) - N&#92;sigma^2 + 2&#92;sigma(M+1) ' title='&#92;Large Error(M) = error(M) - N&#92;sigma^2 + 2&#92;sigma(M+1) ' class='latex' /><br />
Where<br />
M is the number of hidden nodes<br />
N is the number of data points in the training set<br />
σ is the variance of the gaussian noise assumed to be in the data set<br />
Error(M) is the Test error as a function of the number of hidden units<br />
error(M) is the training error as a function of the number of hidden units</p>
<h2>Conclusion</h2>
<p>Hopefully now you have some mathematically intuition for why having too complex a model causes poor performance on new examples. Unfortunately, the derivation in the paper does not extend beyond RBF networks. However, the tools used in the proof might be applicable to other machine learning algorithms.</p>
	</div>
			<div class="tags">
				</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2013/10/26/showing-mathematically-that-more-complexity-increases-test-error/#respond" title="Comment on Showing Mathematically That More Complexity Increases Test&nbsp;Error">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-173 post type-post status-publish format-standard hentry category-computer-science">
		<h2 id="post-173">
					<a href="http://josephmate.wordpress.com/2013/09/20/beginning-first-term-masters/" rel="bookmark">Beginning First Term of Master&#8217;s&nbsp;Degree</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/computer-science/" rel="category tag">Computer Science</a> by Joseph on September 20, 2013	</div>
	<div class="main">
		<p>My research focus is Databases and Distributed Systems. My thesis is still undecided. One thing I have figure out though are my courses.</p>
<h2>CS848: Large Scale Data Management</h2>
<p>Firstly, I&#8217;m taking CS848: Large Scale Data Management and it fits well in my interest of Distributed Systems and Database. As part of this class we read three papers a week; write 5 paper reviews; give one presentation on a paper and lastly put together a course project.</p>
<p>The papers we will be reading for the course are available below. The topics range from batch systems like HDFS/GFS and MapReduce to datastores that provide weak isolation levels like Dynamo and Big Table to ACID databases that scale (Spanner) to graph databases.</p>
<p><a href="https://cs.uwaterloo.ca/~kdaudjee/courses/cs848/schedule.shtml" rel="nofollow">https://cs.uwaterloo.ca/~kdaudjee/courses/cs848/schedule.shtml</a></p>
<p>The paper I have chosen to present is Jan Schaffner, Tim Januschowski, Megan Kercher, Tim Kraska, Hasso Plattner, Michael J. Franklin, Dean Jacobs<br />
<strong><a href="http://cs.brown.edu/%7Ekraskat/pub/sigmod2013-RTP.pdf">RTP: Robust Tenant Placement for Elastic In-Memory Database Clusters </a></strong>SIGMOD, New York, USA, 2013</p>
<p>Stay tuned for some reviews, presentation slides, and anything else I&#8217;ve done related to the class.</p>
<h2>STAT841: Classification</h2>
<p>Secondly, I&#8217;m taking STAT841: Classification. Here we learn the derivations of common Machine Learning classification techniques like Fisher&#8217;s Discriminant Analysis, Logistic Regression, Neural Networks, and Support Vector Machines. I&#8217;ll be posting any results from lectures that I find interesting. I&#8217;m taking this course even though my focus is in Distributed Systems and Databases because having a strong foundation in Machine Learning will hopefully allow me to apply Machine Learning techniques to Distributed System problems. Additionally, I have a strong interest in Machine Learning.</p>
	</div>
			<div class="tags">
				</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2013/09/20/beginning-first-term-masters/#respond" title="Comment on Beginning First Term of Master&#8217;s&nbsp;Degree">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-160 post type-post status-publish format-standard hentry category-uncategorized tag-computer-science tag-theory">
		<h2 id="post-160">
					<a href="http://josephmate.wordpress.com/2013/02/06/determining-if-a-boolean-expression-can-be-false/" rel="bookmark">Determining If A Boolean Expression Can Be&nbsp;False</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a> by Joseph on February 6, 2013	</div>
	<div class="main">
		<p>My first hunch was that determining if a boolean expression can be false was NP complete. After trying to prove it, I came up for a proof that it&#8217;s actually in P:</p>
<p>1) We have any boolean expression S<br />
2) Using a well documented algorithm, we convert it to <a title="Conjunctive Normal Form" href="http://en.wikipedia.org/wiki/Conjunctive_normal_form">Conjunctive Normal Form</a><br />
3) Formula becomes (x<sub>1,1</sub> v x<sub>1,2</sub> v &#8230; v x<sub>1,n</sub>) Λ (x<sub>2,1</sub> v x<sub>2,2</sub> v &#8230; v x<sub>2,n</sub>) Λ &#8230; Λ (x<sub>n,1</sub> v x<sub>n,2</sub> v &#8230; v x<sub>n,n</sub>)<br />
4) Since we are trying to solve a setting of x<sub>1,1</sub> to x<sub>n,n</sub> that results in false, that is the same thing as solving for a setting that results in true in the inverted expression<br />
5) Now we have ¬((x<sub>1,1</sub> v x<sub>1,2</sub> v &#8230; v x<sub>1,n</sub>) Λ (x<sub>2,1</sub> v x<sub>2,2</sub> v &#8230; v x<sub>2,n</sub>) Λ &#8230; Λ (x<sub>n,1</sub> v x<sub>n,2</sub> v &#8230; v x<sub>n,n</sub>))<br />
6) Applying DeMorgan&#8217;s ¬(x<sub>1,1</sub> v x<sub>1,2</sub> v &#8230; v x<sub>1,n</sub>) v ¬ (x<sub>2,1</sub> v x<sub>2,2</sub> v &#8230; v x<sub>2,n</sub>) v &#8230; v ¬(x<sub>n,1</sub> v x<sub>n,2</sub> v &#8230; v x<sub>n,n</sub>))<br />
7) Applying DeMorgan&#8217;s again (¬x<sub>1,1</sub> Λ ¬x<sub>1,2</sub> Λ &#8230; Λ ¬x<sub>1,n</sub>) v (¬x<sub>2,1</sub> Λ ¬x<sub>2,2</sub> Λ &#8230; Λ ¬x<sub>2,n</sub>) v &#8230; v (¬x<sub>n,1</sub> Λ ¬x<sub>n,2 Λ</sub> &#8230; Λ ¬x<sub>n,n</sub>))<br />
8) Now we can determine a setting that results in true, by using the ANDed group that doesn&#8217;t contain a contradiction. If all the ANDed groups, contain contradictions, then there is no setting that results in true.<br />
9) This setting from step 8 that results in true for ¬S will result in false for S</p>
<p>This came up at work because we were trying to determine if a boolean expression could become false. Knowing this would allow us to make a decision on how to handle the query.</p>
<p>If I have made an error, let me know! If you&#8217;re confused about one of the steps, feel free to ask.</p>
<p>Cheers,<br />
Joseph</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/computer-science/" rel="tag">Computer Science</a>, <a href="http://josephmate.wordpress.com/tag/theory/" rel="tag">Theory</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2013/02/06/determining-if-a-boolean-expression-can-be-false/#respond" title="Comment on Determining If A Boolean Expression Can Be&nbsp;False">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-147 post type-post status-publish format-standard hentry category-java tag-hashcode tag-java-2 tag-partitioning tag-partitions">
		<h2 id="post-147">
					<a href="http://josephmate.wordpress.com/2012/04/16/pitfalls-of-integer-hashcode-and-long-hashcode-with-partitioning/" rel="bookmark">Pitfalls of Integer.hashCode() and Long.hashCode() With&nbsp;Partitioning</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/java/" rel="category tag">Java</a> by Joseph on April 16, 2012	</div>
	<div class="main">
		<h1>Problem</h1>
<p>So we want to partition our data into nice even chunks. If you use Integer.hashCode(), Long.hashCode(), or modding by the number of your partitions then the size of each partition will depend on the distribution of your data and the number of partitions. Here&#8217;s a quick example that I wrote up to demonstrate.</p>
<p>Here we have the partition size as 8 and all the numbers are even. I place each number into a bucket by taking the modulus of it. Here are the results:</p>
<pre class="brush: java; title: ; notranslate" title="">
import java.util.Random;

public class HashCodeIssue {

    private static Random random;

    public static void main(String [] args) {
        int partitions = Integer.parseInt( args[0] );
        long seed = Integer.parseInt( args[1] );
        random = new Random(seed);
        int [] buckets = new int[partitions];

        for(int c = 0; c &lt; 100000; c++) {
            buckets[hash(getNextNumber()) % partitions]++;
        }

        for(int c = 0; c&lt; buckets.length; c++) {
            System.out.println(&quot;size of bucket &quot; + c + &quot;: &quot; + buckets[c]);
        }

    }

   /**
    * Using a distribution of numbers divided evenly over
    * even numbers.
    */
    private static Integer getNextNumber() {
        return new Integer(random.nextInt(Integer.MAX_VALUE/2) * 2);
    }

   /**
    * Returning the default hashCode() implementation.
    */
    public static int hash(Integer i) {
        return i.hashCode();
    }
}
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 8 890453985
size of bucket 0: 24781
size of bucket 1: 0
size of bucket 2: 24959
size of bucket 3: 0
size of bucket 4: 25163
size of bucket 5: 0
size of bucket 6: 25097
size of bucket 7: 0
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 8 234985345
size of bucket 0: 25250
size of bucket 1: 0
size of bucket 2: 24735
size of bucket 3: 0
size of bucket 4: 24866
size of bucket 5: 0
size of bucket 6: 25149
size of bucket 7: 0
</pre>
<h1>Root Cause</h1>
<p>Lets take a look at the source code of Integer.hashCode() to find out why the numbers are not being evenly distributed, despite using a hash.</p>
<p><a title="java/lang/Integer.java" href="http://www.docjar.com/html/api/java/lang/Integer.java.html" target="_blank">java/lang/Integer.java</a></p>
<pre class="brush: java; title: ; notranslate" title="">
/**
* Returns a hash code for this {@code Integer}.
*
* @return  a hash code value for this object, equal to the
*          primitive {@code int} value represented by this
*          {@code Integer} object.
*/
public int hashCode() {
    return value;
}
</pre>
<p><a title="java/lang/Long.java" href="http://www.docjar.com/html/api/java/lang/Long.java.html" target="_blank">java/lang/Long.java</a></p>
<pre class="brush: java; title: ; notranslate" title="">
/**
 * Returns a hash code for this {@code Long}. The result is
 * the exclusive OR of the two halves of the primitive
* {@code long} value held by this {@code Long}
* object. That is, the hashcode is the value of the expression:
*
* &lt;blockquote&gt;
*  {@code (int)(this.longValue()^(this.longValue()&gt;&gt;&gt;32))}
* &lt;/blockquote&gt;
*
* @return  a hash code value for this object.
*/
public int hashCode() {
    return (int)(value ^ (value &gt;&gt;&gt; 32));
}
</pre>
<p>These hash codes are implemented for speed, as a result they don&#8217;t do a good job of jumbling up the numbers. Unfortunately, for developers who want partitions of uniform sizes, this is not a good thing. The issue is that all the values share a common divisor with the the number of partitions (4*2 and y=x*2). As a result, all the values end up in the same buckets.</p>
<h1>Solution</h1>
<p>There are a couple of solutions to this problem.</p>
<h2>1. Adjust The Number Of Partitions</h2>
<p>This seems unintuitive at first, but REDUCING the number of partitions to 7 will flatten out the sizes of our partitions because there are a lot less even numbers that share a common divisor with the prime number seven.</p>
<pre class="brush: java; title: ; notranslate" title="">
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 7 890453985
size of bucket 0: 14153
size of bucket 1: 14335
size of bucket 2: 14377
size of bucket 3: 14265
size of bucket 4: 14364
size of bucket 5: 14179
size of bucket 6: 14327
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 7 234985345
size of bucket 0: 14193
size of bucket 1: 14256
size of bucket 2: 14374
size of bucket 3: 14362
size of bucket 4: 14267
size of bucket 5: 14321
size of bucket 6: 14227
</pre>
<h2>2. Use A Better Hash</h2>
<p>Now a lot of times you have no idea what distribution of numbers you have but you still want to be able to distribution the numbers uniformly over your partitions. Or, you need a particular number of partitions that will have a common divisor with a lot of numbers coming in. A safe way to do this is to use a hash function that jumble up the numbers better. In the code above, instead of using the default hash implementation, I use the md5 hash function.</p>
<pre class="brush: java; title: ; notranslate" title="">
/**
* Hash function that uses MD5.
*/
private static int hash(Integer i, int partitions)
throws java.security.NoSuchAlgorithmException {
    MessageDigest m = MessageDigest.getInstance(&quot;MD5&quot;);
    m.reset();
    m.update(toBytes(i));
    byte[] digest = m.digest();
    BigInteger bigInt = new BigInteger(1,digest);
    return bigInt.mod(new BigInteger(1,toBytes(partitions))).abs().intValue();
}

private static byte[] toBytes(Integer ii) {
    int i = ii.intValue();
    byte[] result = new byte[4];

    result[0] = (byte) (i &gt;&gt; 24);
    result[1] = (byte) (i &gt;&gt; 16);
    result[2] = (byte) (i &gt;&gt; 8);
    result[3] = (byte) (i /*&gt;&gt; 0*/);

    return result;
}
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 8 890453985
size of bucket 0: 12629
size of bucket 1: 12510
size of bucket 2: 12550
size of bucket 3: 12470
size of bucket 4: 12689
size of bucket 5: 12339
size of bucket 6: 12311
size of bucket 7: 12502
jmate@jmate-Satellite-C650D:~/Desktop/hashcode-issue$ java HashCodeIssue 8 234985345
size of bucket 0: 12472
size of bucket 1: 12533
size of bucket 2: 12632
size of bucket 3: 12634
size of bucket 4: 12489
size of bucket 5: 12352
size of bucket 6: 12616
size of bucket 7: 12272
</pre>
<h1>Conclusion</h1>
<p>If your performance depends on the size of your partitions, you should take special care when using Integer.hashCode() or Long.hashCode(). By carefully selecting the number of partitions, you can avoid the problem. If you uncertain about the distribution of numbers you have or you cannot change the number of partitions, you should use a hash function that does a better job of jumbling up the numbers.</p>
<p>Now I realize this example was really contrived because the numbers being partitioned were even. I chose it because it&#8217;s really simple to understand and illustrate that  if you don&#8217;t use a good hash function or have the correct number of partitions, this problem is going bite you when your numbers have a special distribution. The last time I saw this problem in the real world is when the numbers we were partitioning on usually had a particular end like XXXXX7831. If you have encountered this problem, post a comment! I am interesting in hearing about it.</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/hashcode/" rel="tag">hashcode</a>, <a href="http://josephmate.wordpress.com/tag/java-2/" rel="tag">java</a>, <a href="http://josephmate.wordpress.com/tag/partitioning/" rel="tag">partitioning</a>, <a href="http://josephmate.wordpress.com/tag/partitions/" rel="tag">partitions</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2012/04/16/pitfalls-of-integer-hashcode-and-long-hashcode-with-partitioning/#respond" title="Comment on Pitfalls of Integer.hashCode() and Long.hashCode() With&nbsp;Partitioning">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-136 post type-post status-publish format-standard hentry category-fun">
		<h2 id="post-136">
					<a href="http://josephmate.wordpress.com/2012/03/12/high-fructose-corn-syrup-vs-refined-cane-sugar-coca-cola/" rel="bookmark">High Fructose Corn Syrup vs. Refined Cane Sugar Coca&nbsp;Cola</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/fun/" rel="category tag">Fun</a> by Joseph on March 12, 2012	</div>
	<div class="main">
		<h1>Motivation</h1>
<p>Recently my roommate and I got into an argument over being able to taste the difference between high fructose and cane sugar Cola. I hypothesized that you could taste the difference between the two because of the level of fructose. My roommate disagreed and claimed that fructose would taste similar to the cane sugar and that we would not be able to tell the difference. We decided to settle the dispute by performing an experiment.</p>
<div id="attachment_137" style="width: 310px" class="wp-caption alignnone"><a href="http://josephmate.files.wordpress.com/2012/03/img_20120205_155546.jpg"><img class="size-medium wp-image-137" title="Fructose vs Sucrose Experiment" src="http://josephmate.files.wordpress.com/2012/03/img_20120205_155546.jpg?w=300&#038;h=225" alt="Fructose vs Sucrose Experiment" width="300" height="225" /></a><p class="wp-caption-text">Fructose vs Sucrose Experiment</p></div>
<h1>Experiment</h1>
<p>The items used in the experiment are High Fructose Coca-Cola, Cane Sugar <a href="http://en.wikipedia.org/wiki/Mexican_Coke">Mexican Coca-Cola</a>, and tiny slips of paper to put under the cups to secretly indicate what the cup contained. Person A would fill two cups for each type of cola and mark a piece of paper to indicate what was the contents of the cup and hide it underneath the cup. After finishing person A would leave the room and person B would enter the room. Person B would then shuffle the cups without looking at the pieces of paper and call in person A when he finished. Finally, person A had to drinking each cup and write down what was inside each. After writing down all the guesses we compared the guesses to the actual contents. Before repeating the experiment we washed out all cups with water.</p>
<h1>Results</h1>
<p>First two sets of trials, both my roommate and I were guessing at about chance. However, on the third trial I noticed that one cola was more bubbly than the other. After identifying that it was the high fructose one, I was able to get the answer 100% of the time. My roommate, also following the observation was able to identify the contents 100% of the time. As a result, we called off the experiment because we were able to identify the cola without attributing it to the presence of high fructose corn syrup. We saved the remaining precious cola for consumption during dinner.</p>
<h1>Next Steps</h1>
<p>Next experiment we will try to use just pure high fructose water and cane sugar water so that we can control the level of bubbliness. Secondly, we need to cover the cups, or have person A and B blind folded, as it might be possible to identify the contents based on the colour of the liquid. Third, instead of doing the two cups for each type, to make the experiment simpler and more rigorous, we should just fill two cups with three cases: high fructose &#8211; high fructose, cane sugar &#8211; cane sugar, and high fructose &#8211; cane sugar. With the two cups for each type, by guessing the first three cups you knew what the last cup was rendering the last guess giving us no additional information.</p>
<h1>Additional Reading</h1>
<p>The consumerist has an article by Chris Morran about the difference in taste <a title="Coca Cola: We Don't Need To Make A Cane Sugar Version Because You Already Have Mexican Coke" href="http://consumerist.com/2010/10/coca-cola-we-dont-need-to-make-a-cane-sugar-version-because-you-already-have-mexican-coke.html">Coca Cola: We Don&#8217;t Need To Make A Cane Sugar Version Because You Already Have Mexican Coke</a>. They interviewed Greg Galvez, vice president and general manager of Importation and Commercialization, Coca-Cola North America. He says, &#8220;our research shows that there is no perceptible taste difference between the products. Whether sweetened with high fructose corn syrup or sugar, a Coke is a Coke and both are &#8216;the real thing.&#8221; His wording is slightly ambiguous. Is he implying that people cannot taste the difference between the Mexican Coca-cola and the regular Coca-cola or is he saying that if we control all other ingredients then we cannot taste the difference between HFCS and cane sugar?</p>
<p>The Huffington Post has already performed this experiment documented in the article <a title="Coca-Cola Taste Test: High Fructose Corn Syrup vs. Sugar" href="http://www.huffingtonpost.com/2012/03/07/coca-cola-taste-test_n_1324282.html?ref=kitchendaily">Coca-Cola Taste Test: High Fructose Corn Syrup vs. Sugar</a>. They concluded that 85% of participants could tell the difference and that 80% preferred the taste of the Mexican Cola. None of the articles I found tried to control for the differences in the non sugar ingredients.</p>
<p><a title="Is Mexican Coke the real thing? by Louise Chu" href="http://www.signonsandiego.com/uniontrib/20041109/news_1b9mexcoke.html">Is Mexican Coke the real thing? By Louise Chu</a></p>
<p><a href="http://seattletimes.nwsource.com/html/nationworld/2002076071_coke29.html">Mexican Coke a hit in U.S. By Kevin Pang</a></p>
	</div>
			<div class="tags">
				</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2012/03/12/high-fructose-corn-syrup-vs-refined-cane-sugar-coca-cola/#comments" title="Comment on High Fructose Corn Syrup vs. Refined Cane Sugar Coca&nbsp;Cola"><strong>1</strong> comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-123 post type-post status-publish format-standard hentry category-javascript-2 tag-closure tag-javascript tag-scope tag-scoping">
		<h2 id="post-123">
					<a href="http://josephmate.wordpress.com/2012/03/04/unintuitive-scoping-and-javascript-closures/" rel="bookmark">Unintuitive Scoping and Javascript&nbsp;Closures</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/javascript-2/" rel="category tag">Javascript</a> by Joseph on March 4, 2012	</div>
	<div class="main">
		<p>I had this problem at work, and have simplified it and removed all context related to the project so this article can be easily consumed. The problem arises when you try to create a closure onto a local variable initialized in a for loop.</p>
<p>I will begin with an example that matches my scoping intuition, which does not use a closure:</p>
<pre class="brush: jscript; title: ; notranslate" title="">
function setupArray() {
  var array = new Array();
  var i=0;
  for (i=0;i&lt;=4;i++) {
    var tmp;
    tmp = i + 1;
    array[i] = tmp;
  }
  return array;
}

function outputArray() {
  var array = setupArray();
  for (i=0;i&lt;=4;i++) {
    document.write(array[i] + &quot;&lt;br/&gt;&quot;);
  }
}

outputArray();
</pre>
<p>With this example, we get the output that matches our intuition:</p>
<pre class="brush: jscript; title: ; notranslate" title="">
1
2
3
4
5
</pre>
<p>Now when we modify the code to use a closure instead and we run into problems.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
function setupArray() {
  var array = new Array();
  var i=0;
  for (i=0;i&lt;=4;i++) {
    var tmp;
    tmp = i + 1;
    array[i] = function() {
      return tmp;
    }
  }
  return array;
}

function outputArray() {
  var array = setupArray();
  for (i=0;i&lt;=5;i++) {
    document.write(array[i]() + &quot;&lt;br/&gt;&quot;);
  }
}
outputArray();
</pre>
<p>Here is the output that I was not expecting.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
5
5
5
5
5
</pre>
<p>All the anonymous functions bind to the same variable reference. It is not creating a new variable for each iteration of the loop. My solution was to just place the contents of the loop into a function.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
function setupArrayEntry(i) {
  var tmp;
  tmp = i + 1;
  return function() {
    return tmp;
  }
}

function setupArray() {
  var array = new Array();
  var i=0;
  for (i=0;i&lt;=4;i++) {
    array[i] = setupArrayEntry(i);
  }
  return array;
}
</pre>
<p>This fixes the problem.</p>
<pre class="brush: jscript; title: ; notranslate" title="">
1
2
3
4
5
</pre>
<p>After posting this I did some additional research and discovered that this seems to be a common problem that developers encounter. For example, <a href="http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/">this</a> post extremely valuable in understanding what is going on. The author also provides a similar solution. Check it out!</p>
	</div>
			<div class="tags">
		Tagged with: <a href="http://josephmate.wordpress.com/tag/closure/" rel="tag">closure</a>, <a href="http://josephmate.wordpress.com/tag/javascript/" rel="tag">javascript</a>, <a href="http://josephmate.wordpress.com/tag/scope/" rel="tag">scope</a>, <a href="http://josephmate.wordpress.com/tag/scoping/" rel="tag">scoping</a> 		</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2012/03/04/unintuitive-scoping-and-javascript-closures/#respond" title="Comment on Unintuitive Scoping and Javascript&nbsp;Closures">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>


<div class="post-119 post type-post status-publish format-standard hentry category-android">
		<h2 id="post-119">
					<a href="http://josephmate.wordpress.com/2012/01/14/android-appendable-list-github/" rel="bookmark">Android Appendable List &#8211;&nbsp;Github</a>
			</h2>
	<div class="meta">
		Posted in <a href="http://josephmate.wordpress.com/category/android/" rel="category tag">Android</a> by Joseph on January 14, 2012	</div>
	<div class="main">
		<p>Hey everyone,</p>
<p>Due to some people having issues getting the code to run, I have posted the complete example code on github. Just download the code and open it up in eclipse.</p>
<p><a href="https://github.com/josephmate/AndroidAppendableList">https://github.com/josephmate/AndroidAppendableList</a><br />
If you don&#8217;t know how to use git, you can download a zip file of the sourcecode above, or run this command:<br />
git clone git://github.com/josephmate/AndroidAppendableList.git</p>
<p>Cheers,<br />
Joseph</p>
	</div>
			<div class="tags">
				</div>
		<div class="comments">
				<p><a href="http://josephmate.wordpress.com/2012/01/14/android-appendable-list-github/#respond" title="Comment on Android Appendable List &#8211;&nbsp;Github">leave a comment</a></p>
	</div>
</div>

<div class="navigation">
</div>



<div id="postnav"><a href="http://josephmate.wordpress.com/page/2/" >Older Posts &raquo;</a></div>

</div> <!-- End content -->

<div id="sidebar">
<h3>Top Posts &amp; Pages</h3><ul><li><a href="http://josephmate.wordpress.com/2012/04/16/pitfalls-of-integer-hashcode-and-long-hashcode-with-partitioning/" class="bump-view" data-bump-view="tp">Pitfalls of Integer.hashCode() and Long.hashCode() With Partitioning</a></li>
<li><a href="http://josephmate.wordpress.com/2010/01/31/mocking-modules-with-mocha/" class="bump-view" data-bump-view="tp">Mocking Modules with Mocha</a></li>
<li><a href="http://josephmate.wordpress.com/2010/01/31/ruby-permissions-and-directories/" class="bump-view" data-bump-view="tp">Ruby, Permissions and Directories</a></li>
<li><a href="http://josephmate.wordpress.com/2012/03/12/high-fructose-corn-syrup-vs-refined-cane-sugar-coca-cola/" class="bump-view" data-bump-view="tp">High Fructose Corn Syrup vs. Refined Cane Sugar Coca Cola</a></li>
</ul>				<h3>Recent Posts</h3>		<ul>
					<li>
				<a href="http://josephmate.wordpress.com/2014/04/27/reading-books-and-technical-papers-on-the-kindle-method-2/">Reading Books and Technical Papers on the Kindle (Method&nbsp;2)</a>
						</li>
					<li>
				<a href="http://josephmate.wordpress.com/2014/01/07/reading-technical-papers-on-kindle/">Reading Technical Papers on the&nbsp;Kindle</a>
						</li>
					<li>
				<a href="http://josephmate.wordpress.com/2014/01/06/an-eclipse-and-hadoop-pitfall/">An Eclipse and Hadoop&nbsp;Pitfall</a>
						</li>
					<li>
				<a href="http://josephmate.wordpress.com/2013/10/26/showing-mathematically-that-more-complexity-increases-test-error/">Showing Mathematically That More Complexity Increases Test&nbsp;Error</a>
						</li>
					<li>
				<a href="http://josephmate.wordpress.com/2013/09/20/beginning-first-term-masters/">Beginning First Term of Master&#8217;s&nbsp;Degree</a>
						</li>
				</ul>
		<h3>Archives</h3>		<ul>
	<li><a href='http://josephmate.wordpress.com/2014/04/'>April 2014</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2014/01/'>January 2014</a>&nbsp;(2)</li>
	<li><a href='http://josephmate.wordpress.com/2013/10/'>October 2013</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2013/09/'>September 2013</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2013/02/'>February 2013</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2012/04/'>April 2012</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2012/03/'>March 2012</a>&nbsp;(2)</li>
	<li><a href='http://josephmate.wordpress.com/2012/01/'>January 2012</a>&nbsp;(1)</li>
	<li><a href='http://josephmate.wordpress.com/2010/09/'>September 2010</a>&nbsp;(2)</li>
	<li><a href='http://josephmate.wordpress.com/2010/03/'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://josephmate.wordpress.com/2010/02/'>February 2010</a>&nbsp;(4)</li>
	<li><a href='http://josephmate.wordpress.com/2010/01/'>January 2010</a>&nbsp;(4)</li>
		</ul>
<form role="search" method="get" id="searchform" class="searchform" action="http://josephmate.wordpress.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form><h3><label for="subscribe-field">Follow Blog via Email</label></h3>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
											<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
<p>Join 3 other followers</p>
						<p><input type="text" name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" value="" id="subscribe-field"/></p>
					
					<p>
						<input type="hidden" name="action" value="subscribe"/>
						<input type="hidden" name="blog_id" value="11599195"/>
						<input type="hidden" name="source" value="http://josephmate.wordpress.com/"/>
						<input type="hidden" name="sub-type" value="widget"/>
						<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
						<input type="hidden" id="_wpnonce" name="_wpnonce" value="c078f14f1e" />						<input type="submit" value="Follow" />
					</p>
				</form>
			
			<div class="textwidget"><br />
<h3>Donate:</h3>
<table>
<tr>
<td><img src="http://josephmate.files.wordpress.com/2014/02/bitcoin.png?w=32" /></td>
<td>1LiE1J7uW7MfRuNyJH7ZGgKWqz5p2bt44B</td></tr>
<tr>
<td><img src="http://josephmate.files.wordpress.com/2014/02/litecoin.png?w=32" /></td><td>LNrqofRmUi3LhSvfekgzMhcEh2rXrCY3qa</td></tr>
<tr>
<td><img src="http://josephmate.files.wordpress.com/2014/02/dogecoin.jpg?w=32" /></td><td>DGQAMKXpdeguNMeK1hepCVfX4ftntjArbt</td></tr>
</table>

<h3>Contact me via Social Media:</h3>
<a href="http://www.linkedin.com/in/josephmatei">
      
          <img src="http://www.linkedin.com/img/webpromo/btn_viewmy_160x33.png" width="160" height="33" border="0" alt="View Joseph Maté's profile on LinkedIn">
        
    </a>
<!-- Facebook Badge START -->
<a href="https://www.facebook.com/mate.joseph" target="_TOP" title="Joseph Mat&#xe9;"><img src="https://badge.facebook.com/badge/122612983.3843.151224964.png" style="border:0;" /></a><br /><!-- Facebook Badge END -->

<a href="https://github.com/josephmate">
<h3>Follow me on Github</h3>
<br /><img src="http://josephmate.files.wordpress.com/2014/02/github.png?w=64" /></a></div>
		
			</div>

<div class="clearleft"></div>

<!-- begin footer -->
</div>
	<div id="footer">
	<p><a href="http://wordpress.com/?ref=footer_website">Create a free website or blog at WordPress.com</a>. <a href="http://theme.wordpress.com/themes/journalist-13/" title="Learn more about this theme">The Journalist 1.3 Theme</a>.</p>
	</div>

<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201430x'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781g'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {
			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	</div>

	<div id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id='bsub-text'>Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow &ldquo;Joseph Mate&#039;s Blog&rdquo;</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

			
			<p><input type="email" name="email" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter email address" : this.value;'  id="loggedout-follow-field"/></p>

			<input type="hidden" name="action" value="subscribe"/>
			<input type="hidden" name="blog_id" value="11599195"/>
			<input type="hidden" name="source" value="http://josephmate.wordpress.com/"/>
			<input type="hidden" name="sub-type" value="loggedout-follow"/>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="c078f14f1e" /><input type="hidden" name="_wp_http_referer" value="/" />
			<p id='bsub-subscribe-button'><input type="submit" value="Sign me up" /></p>
			</form>
					<div id='bsub-credit'><a href="http://wordpress.com/signup/?ref=lof">Powered by WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzvBKLEukqnnBYD7QSPtcW0NjS3NzMyNTI8MsAJwfYLE='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?m=1395343499g&amp;ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414g&amp;ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='http://s2.wp.com/wp-content/js/devicepx.js?m=1399919068g'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?22" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'11599195','v':'wpcom','tz':'0','user_id':'0','subd':'josephmate'});
ex_go({'crypt':'UE40eW5QN0p8M2Y/RE1LVmwrVi5vQS5fVFtfdHBbPyw1VXIrU3hWLHhzVndTdktBX0ddJnpXRjVaOTd6fj1YMX4ydzR6MmRCYnxkNmdJdV9ubHF6aS1wcyV1N3wlZlpxW2JvJSZFWDZdNTYvaHkwSW9iLzRFS08lYz1sLkgybC45by9OY3x+XzcraVZkbVRWckxtM1l1cU9BaXBDRFtGTUNHJltEZGssWWR5TWJQLjFKaT8lW01KWElEazkmeWxuS24vQmcvXUEmdyxTbnlNL1s/dkZVdHRdOU8sQVgwZl9wV3l5WC5sLGN0a1ZMJS9QakU2YXJdRUMzMGgtNklKRFd3ME5lM1VpNVJDWX49byVIZFJFN354bj1XRmVr'});
addLoadEvent(function(){linktracker_init('11599195',0);});
	</script>
<noscript><img src="http://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>
