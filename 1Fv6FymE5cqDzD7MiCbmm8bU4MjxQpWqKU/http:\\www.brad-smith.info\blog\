http://www.brad-smith.info/blog/
HTTP/1.1 200 OK
Server: cloudflare-nginx
Date: Wed, 23 Jul 2014 13:56:34 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Set-Cookie: __cfduid=de12e496cb24194161ba31d026c743e9f1406123793729; expires=Mon, 23-Dec-2019 23:50:00 GMT; path=/; domain=.brad-smith.info; HttpOnly
Vary: Accept-Encoding
X-Powered-By: PHP/5.5.14
X-Pingback: http://www.brad-smith.info/blog/xmlrpc.php
Vary: User-Agent
CF-RAY: 14e861ceccb30856-IAD
Content-Encoding: gzip

<!DOCTYPE html>
<html class="no-js" lang="en-US">
	<head>
				<link rel="profile" href="http://gmpg.org/xfn/11" />
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		
		<title>Brad Smith's Coding Blog</title>
		
				<link rel="alternate" type="application/rss+xml" title="Brad Smith&#039;s Coding Blog &raquo; Feed" href="http://www.brad-smith.info/blog/feed" />
<link rel="alternate" type="application/rss+xml" title="Brad Smith&#039;s Coding Blog &raquo; Comments Feed" href="http://www.brad-smith.info/blog/comments/feed" />
<link rel='stylesheet' id='updownupdown-css'  href='http://www.brad-smith.info/blog/wp-content/plugins/updownupdown-postcomment-voting/style/updownupdown.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='tw-bootstrap-css'  href='http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/css/bootstrap.min.css?ver=2.0.3' type='text/css' media='all' />
<link rel='stylesheet' id='the-bootstrap-css'  href='http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/style.min.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='the-bootstrap-child-css'  href='http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap-child/style.css?ver=3.9.1' type='text/css' media='all' />
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-content/plugins/updownupdown-postcomment-voting/js/updownupdown.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-content/plugins/google-captcha/js/script.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.7.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.brad-smith.info/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.brad-smith.info/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.9.1" />

<script type="text/javascript"><!--
var a2a_config=a2a_config||{},wpa2a={done:false,html_done:false,script_ready:false,script_load:function(){var a=document.createElement('script'),s=document.getElementsByTagName('script')[0];a.type='text/javascript';a.async=true;a.src='http://static.addtoany.com/menu/page.js';s.parentNode.insertBefore(a,s);wpa2a.script_load=function(){};},script_onready:function(){if(a2a.type=='page'){wpa2a.script_ready=true;if(wpa2a.html_done)wpa2a.init();}},init:function(){for(var i=0,el,target,targets=wpa2a.targets,length=targets.length;i<length;i++){el=document.getElementById('wpa2a_'+(i+1));target=targets[i];a2a_config.linkname=target.title;a2a_config.linkurl=target.url;if(el){a2a.init('page',{target:el});el.id='';}wpa2a.done=true;}wpa2a.targets=[];}};a2a_config.tracking_callback=['ready',wpa2a.script_onready];
a2a_config.onclick=1;
a2a_config.show_title=1;
//--></script>
	<link type="text/css" rel="stylesheet" href="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/styles/shCore.css" />
	<link type="text/css" rel="stylesheet" href="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/styles/shThemeDefault.css" />
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shCore.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushBash.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushCpp.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushCSharp.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushCss.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushDelphi.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushDiff.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushGroovy.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushJava.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushJScript.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushPerl.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushPhp.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushPlain.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushPython.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushRuby.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushScala.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushSql.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushVb.js"></script>
	<script type="text/javascript" src="http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/shBrushXml.js"></script>
	<script type="text/javascript">		
		SyntaxHighlighter.config.clipboardSwf = 'http://www.brad-smith.info/blog/wp-content/plugins/syntax-highlighter-and-code-prettifier/scripts/clipboard.swf';
		SyntaxHighlighter.all();
	</script>
	<script type="text/javascript">var UpDownUpDown = { ajaxurl: "http://www.brad-smith.info/blog/wp-admin/admin-ajax.php" };</script><!-- All in one Favicon 4.3 --><link rel="shortcut icon" href="http://www.brad-smith.info/favicon.ico" />
<link rel="icon" href="http://www.brad-smith.info/favicon.png" type="image/png"/>

<!-- All in One SEO Pack 2.2.1 by Michael Torbert of Semper Fi Web Design[222,321] -->
<meta name="description" itemprop="description" content="Windows apps, business systems and games in C# and C++. Real-world programming articles written by a Software Engineer from Perth, Western Australia. Covers" />

<meta name="keywords" itemprop="keywords" content="C#,C++,Windows Forms,.NET,SQL Server,Microsoft Office,programming,coding,OO,source code,software,business" />
<link rel='next' href='http://www.brad-smith.info/blog/page/2' />

<link rel="canonical" href="http://www.brad-smith.info/blog/" />
<!-- /all in one seo pack -->
	<style type="text/css">
				#branding hgroup {
			position: absolute !important;
			clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
			</style>
	<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #0088cc; }
</style>
	<!--[if lt IE 9]>
		<script src="http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/js/html5shiv.min.js" type="text/javascript"></script>
		<script src="http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/js/respond.min.js" type="text/javascript"></script>
	<![endif]-->
	<!-- Google Analytics Tracking by Google Analyticator 6.4.7.3: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">window.google_analytics_uacct = "pub-5469894184548099";</script>
<script type="text/javascript">
                var analyticsFileTypes = ['zip'];
                            var analyticsSnippet = 'enabled';
                var analyticsEventTracking = 'enabled';
            </script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-5388698-2']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
	</head>
	
	<body class="home blog custom-background content-sidebar">
		<div class="container">
			<div id="page" class="hfeed row">
								<header id="branding" role="banner" class="span12">
										<hgroup>
						<h1 id="site-title">
							<a href="http://www.brad-smith.info/blog/" title="Brad Smith&#039;s Coding Blog" rel="home">
								<span>Brad Smith&#039;s Coding Blog</span>
							</a>
						</h1>
						<h2 id="site-description">Windows apps, business systems and games in C# and C++</h2>
					</hgroup>
					
										<a id="header-image" href="http://www.brad-smith.info/blog/" title="Brad Smith&#039;s Coding Blog" rel="home">
						<img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/06/coding-blog-logo2.jpg" width="1170" height="188" alt="" />
					</a>
					
					<nav id="access" role="navigation">
						<h3 class="assistive-text">Main menu</h3>
						<div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div>
						<div class="skip-link"><a class="assistive-text" href="#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
												<div class="navbar navbar-inverse">
							<div class="navbar-inner">
								<div class="container">
									<!-- .btn-navbar is used as the toggle for collapsed navbar content -->
									<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
									</a>
																		<div class="nav-collapse">
										<div class="menu-main-container"><ul id="menu-main" class="nav"><li id="menu-item-604" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-604"><a href="http://www.brad-smith.info/blog/about">About</a></li>
<li id="menu-item-600" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-600 dropdown" data-dropdown="dropdown"><a href="http://www.brad-smith.info/blog/projects" class="dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
<ul class="dropdown-menu">
	<li id="menu-item-685" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-685"><a href="http://www.brad-smith.info/blog/projects/aba-validator">ABA/Cemtext Validator</a></li>
	<li id="menu-item-740" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-740"><a href="http://www.brad-smith.info/blog/projects/dropdown-controls">Drop-Down Controls</a></li>
	<li id="menu-item-601" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-601"><a href="http://www.brad-smith.info/blog/projects/image-collage-generator">Image Collage Generator</a></li>
	<li id="menu-item-602" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-602"><a href="http://www.brad-smith.info/blog/projects/mcnetworkcopy">mcNetworkCopy</a></li>
	<li id="menu-item-727" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-727"><a href="http://www.brad-smith.info/blog/projects/textobjectmodel">TOM Classes for .NET</a></li>
</ul>
</li>
<li id="menu-item-599" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-599"><a href="http://www.brad-smith.info/blog/copyright-information">Copyright</a></li>
<li id="menu-item-603" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-603"><a href="http://www.brad-smith.info/blog/expressions-of-interest">Expressions of Interest</a></li>
<li id="menu-item-659" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-659"><a href="http://www.brad-smith.info/blog/donations">Donations</a></li>
</ul></div>	<form id="searchform" class="navbar-search pull-right" method="get" action="http://www.brad-smith.info/blog/">
						<label for="s" class="assistive-text hidden">Search</label>
						<input type="search" class="search-query" name="s" id="s" placeholder="Search" />
					</form>								    </div>
								</div>
							</div>
						</div>
											</nav><!-- #access -->
									</header><!-- #branding -->
<section id="primary" class="span8">
		<div id="content" role="main">
		
<article id="post-748" class="post-748 post type-post status-publish format-standard hentry category-announcements tag-c tag-custom-controls tag-graphics tag-gui-design tag-windows-forms">

	
	

	<header class="page-header">

	<h1 class="entry-title"><a href="http://www.brad-smith.info/blog/archives/748" title="Permalink to ComboTreeBox Enhancements and New Project Page" rel="bookmark">ComboTreeBox Enhancements and New Project Page</a></h1>
		<div class="entry-meta">

			<span class="sep">Posted on </span><a href="http://www.brad-smith.info/blog/archives/748" title="4:30 pm" rel="bookmark"><time class="entry-date" datetime="2014-03-13T16:30:39+00:00" pubdate>March 13, 2014</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.brad-smith.info/blog/archives/author/admin" title="View all posts by Bradley Smith" rel="author">Bradley Smith</a></span></span>		<span class="sep"> | </span>
		<span class="comments-link">
			<a href="http://www.brad-smith.info/blog/archives/748#respond" title="Comment on ComboTreeBox Enhancements and New Project Page"><span class="leave-reply">Leave a reply</span></a>		</span>
		
		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->



	
	<div class="entry-content clearfix">

		<h2>Thank you!</h2>
<p>At the time of writing, my <a title="A ComboBox with a TreeView Drop-Down" href="http://www.brad-smith.info/blog/archives/193">ComboTreeBox</a> control is the most popular item on this blog. I never could have imagined that a simple Windows Forms control would attract so much attention on the web! All I can say to those who have read my article and downloaded my code is, &#8220;Thank you!&#8221; Your continued support gives me the motivation to keep writing new and interesting content.</p>
<h2>New Project Page</h2>
<p>With this in mind, i&#8217;ve decided to move both ComboTreeBox and GroupedComboBox to their own project page here: <a title="Drop-Down Controls" href="http://www.brad-smith.info/blog/projects/dropdown-controls">Drop-Down Controls</a></p>
<p>This gives them a permanent home and makes it easier for me to manage occasional updates and new features. As before, you can download binaries and source code for the controls, as well as an example application that shows off their potential.</p>
<h2>New Enhancements</h2>
<p>This reshuffling has given me an opportunity to release a few bugfixes, including a memory leak in the Buffered Paint code.</p>
<p><img class="thumbnail alignnone size-full wp-image-749" style="vertical-align: top; display: inline; border: 0; padding: 0;" alt="Normal ComboTreeBox" src="http://www.brad-smith.info/blog/wp-content/uploads/2014/03/combotreebox.png" width="249" height="152" /> <img class="thumbnail alignnone size-full wp-image-750" style="vertical-align: top; display: inline; border: 0; padding: 0;" alt="ComboTreeBox with ShowCheckBoxes set" src="http://www.brad-smith.info/blog/wp-content/uploads/2014/03/combotreebox-chk.png" width="249" height="168" /></p>
<p>I also took the opportunity to enhance the ComboTreeBox control by adding a <span class="fixed-width">ShowCheckBoxes</span> property. In this mode of operation, the normal selection rules are suspended and checkbox glyphs are drawn beside each node. You can then select multiple items, accessible via the <span class="fixed-width">CheckedNodes</span> property. This is further aligns the functionality offered by the control with that of the built-in <span class="fixed-width">TreeView</span> control.</p>
<p>Enjoy!</p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit addtoany_list a2a_target" id="wpa2a_1"><a class="a2a_dd addtoany_no_icon addtoany_share_save" href="http://www.addtoany.com/share_save">Share/Bookmark</a>
<script type="text/javascript"><!--
wpa2a.script_load();
//--></script>
</div></div>
	</div><!-- .entry-content -->

	


	<footer class="entry-meta">

		<span class="cat-links block">Posted in <a href="http://www.brad-smith.info/blog/archives/category/announcements" title="View all posts in Announcements" rel="category tag">Announcements</a>.</span>
	</footer><!-- #entry-meta -->

	

	
</article><!-- #post-748 -->


<article id="post-709" class="post-709 post type-post status-publish format-standard hentry category-utility-code tag-cc tag-com tag-interop tag-rich-text tag-win32">

	
	

	<header class="page-header">

	<h1 class="entry-title"><a href="http://www.brad-smith.info/blog/archives/709" title="Permalink to Managed Wrapper for the Text Object Model (TOM)" rel="bookmark">Managed Wrapper for the Text Object Model (TOM)</a></h1>
		<div class="entry-meta">

			<span class="sep">Posted on </span><a href="http://www.brad-smith.info/blog/archives/709" title="8:06 pm" rel="bookmark"><time class="entry-date" datetime="2014-03-11T20:06:41+00:00" pubdate>March 11, 2014</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.brad-smith.info/blog/archives/author/admin" title="View all posts by Bradley Smith" rel="author">Bradley Smith</a></span></span>		<span class="sep"> | </span>
		<span class="comments-link">
			<a href="http://www.brad-smith.info/blog/archives/709#comments" title="Comment on Managed Wrapper for the Text Object Model (TOM)"><strong>1</strong> Reply</a>		</span>
		
		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->



	
	<div class="entry-content clearfix">

		<p><img class="alignnone size-full wp-image-729" alt="Text Object Model Demo" src="http://www.brad-smith.info/blog/wp-content/uploads/2014/03/tom.jpg" width="640" height="352" /></p>
<p>I&#8217;ve recently been doing a lot of work with the WinForms RichTextBox control, trying to implement the familiar red wavy underlines associated with spell-checking. After some research, I discovered that the underlying (native) RichEdit control used by the <span class="fixed-width">RichTextBox</span> does in fact support this style of underlining. The catch? It is only accessible through the <span class="fixed-width">EM_SETCHARFORMAT</span> window message, which requires PInvoke. While it is relatively simple to set this style, there are drawbacks:</p>
<ul>
<li>High overheads associated with marshalling</li>
<li>Clunky operation, requires you to send the <span class="fixed-width">CHARFORMAT2</span> structure</li>
<li>You can only get/set the style for the selected text</li>
</ul>
<p>The last point in particular is of most concern to me, and is a serious limitation of the <span class="fixed-width">RichTextBox</span> control. Almost all of the rich text functionality is restricted to the text selected in the control. In practice, this means that any non-trivial text manipulation requires you to constantly store the current selection, select the text you wish to manipulate, apply the styles and then restore the old selection. This is slow and extremely inefficient.</p>
<p>I then looked into something called the <a title="Text Object Model" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb787607%28v=vs.85%29.aspx" target="_blank">Text Object Model</a> (or TOM). This comprises a set of COM interfaces which are implemented by the underlying RichEdit control. The functionality exposed by these interfaces is quite similar to that of the Microsoft Word object model, where you have the concept of Document, Range, Selection and so on. Importantly, TOM allows you to operate on ranges of rich text without the need to alter the selection. It also provides access to a range of functionality not otherwise available for the <span class="fixed-width">RichTextBox</span> control:</p>
<ul>
<li>Granular selection by character, word, sentence and paragraph</li>
<li>Font weights, underline styles, all-caps</li>
<li>Tab stops, list styles, full justification of text</li>
<li>Find functionality, translation to/from screen coordinates</li>
</ul>
<h2>Using the Text Object Model</h2>
<p>The TOM interfaces are:</p>
<ul>
<li><span class="fixed-width">ITextDocument</span> &#8211; Represents a top-level document, from which text ranges can be obtained.</li>
<li><span class="fixed-width">ITextRange</span> &#8211; Represents a range of rich text. Ranges can be moved, resized and styled with ease.</li>
<li><span class="fixed-width">ITextSelection</span> &#8211; Special text range that represents the selected text in the control.</li>
<li><span class="fixed-width">ITextFont</span> &#8211; Character formatting options.</li>
<li><span class="fixed-width">ITextPara</span> &#8211; Paragraph formatting options.</li>
</ul>
<p>It is relatively easy to obtain an instance of <span class="fixed-width">ITextDocument</span> from a <span class="fixed-width">RichTextBox</span> control. One simply sends the <span class="fixed-width">EM_GETOLEINTERFACE</span> message to the control. There are a number of ways that you can interact with the object that gets returned:</p>
<ol>
<li><strong>Use the <span class="fixed-width">dynamic</span> keyword to access the object&#8217;s members</strong> &#8211; this requires the least programming effort, but introduces the possibility for errors and has a number of overheads.</li>
<li><strong>Define the TOM interfaces in managed code and use COM interop</strong> &#8211; this allows you to work in a strongly-typed manner, but still has the overheads associated with marshalling. Also, the interfaces themselves are not terribly .NET-friendly, and they lack some of the conveniences that would be familiar to most .NET developers.</li>
<li><strong>Write wrapper classes for each of the TOM interfaces</strong> &#8211; while this approach requires the most coding, the end result is a fast, efficient way of accessing the TOM functionality. The calling code does not have to use COM interop and the wrapper classes can translate unfriendly constructs into more .NET-friendly ones.</li>
</ol>
<h2>My solution</h2>
<p>Needless to say, I settled for the 3rd option. I decided to implement the wrapper classes in a C++/CLI assembly, because this allowed me to access the TOM interfaces using native code, while ultimately exposing a set of managed classes. Well-written native code (that explicitly marshals data to managed code) will always be faster than COM interop, where the runtime has to apply more checks and is unable to make as many assumptions about the types it is operating on.</p>
<p>Some of the benefits offered by my wrappers include:</p>
<ul>
<li>Managed enumerations to replace integer constants and flags</li>
<li>Properties to replace Get and Set methods</li>
<li>Translation of <span class="fixed-width">HRESULT</span> codes into managed exceptions</li>
<li>Returning objects instead of pointers</li>
<li>Omission of TOM functionality not supported by the RichEdit control (e.g. text shadows, animation)</li>
<li>Use of more .NET-friendly types and nomenclature; e.g. <span class="fixed-width">IEquatable</span>, <span class="fixed-width">ToString</span>, <span class="fixed-width">IDataObject</span>, <span class="fixed-width">Color</span> and <span class="fixed-width">Point</span></li>
</ul>
<p>The top-level class in my implementation is <span class="fixed-width">TextDocument</span>, which wraps <span class="fixed-width">ITextDocument</span>. It includes a static method which creates an instance from a <span class="fixed-width">RichTextBox</span> control. Once created, you have full access to the Text Object Model functionality to manipulate the text inside the control.</p>
<h2>Usage</h2>
<p>Once obtaining a <span class="fixed-width">TextDocument</span> instance from a <span class="fixed-width">RichTextBox</span> control, working with formatted text is easy:</p>
<pre class="brush:csharp">// create a RichTextBox control in the usual way
RichTextBox rtb = new RichTextBox();

// create a TOM document object (and enable advanced typography on the control)
TextDocument doc = TextDocument.FromRichTextBox(rtb, true);
TextRange range = doc.EntireRange;

// set some text
range.Text = "This is a piece of rich text.";
range.Font.Name = "Calibri";
range.Font.Size = 16f;

// find a word and apply formatting
range.FindText("piece");
range.Font.Bold = true;
range.Font.ForeColor = Color.Red;

// insert a tab
range.Collapse(RangePosition.End);
range.Text = "\t";

// resize range and apply more formatting
range.FindText("rich");
range.MoveEnd(TextUnit.Word, 2);
range.Font.UnderlineStyle = TextUnderlineStyle.Wave;
range.Font.UnderlineColor = TextUnderlineColor.Blue;

// append raw RTF using IDataObject
range.MoveEnd(TextUnit.Story, 1);
range.Collapse(RangePosition.End);
range.SetDataObject(new DataObject(
    DataFormats.Rtf, 
    @"{\rtf1\ansi\deff0\pard \par Here is some \ul more\ul0  rich text.\par}"
));

// set paragraph formatting
doc.EntireRange.Para.Alignment = TextAlignment.Center;</pre>
<h2>Download</h2>
<p>Go to the project page here: <a title="TOM Classes for .NET" href="http://www.brad-smith.info/blog/projects/textobjectmodel">TOM Classes for .NET</a></p>
<h2>Final words</h2>
<p>This set of managed wrapper classes for the Text Object Model provides a fast and efficient way to manipulate the text in a RichTextBox control. Importantly, it solves the limitation of only being able to apply styles to the selected text in the control. As an added bonus, it also provides access to a wider range of character and paragraph formats, as well as a number of convenience methods for working with ranges of formatted text. I hope you find it useful in your own rich text applications.</p>
<h2>Additional resources</h2>
<p><a title="Text Object Model" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb787607%28v=vs.85%29.aspx" target="_blank">Text Object Model on MSDN<br />
</a><a title="Rich Text Format Specification" href="http://support.microsoft.com/kb/86999/en-gb" target="_blank">Rich Text Format Specification</a></p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit addtoany_list a2a_target" id="wpa2a_2"><a class="a2a_dd addtoany_no_icon addtoany_share_save" href="http://www.addtoany.com/share_save">Share/Bookmark</a></div></div>
	</div><!-- .entry-content -->

	


	<footer class="entry-meta">

		<span class="cat-links block">Posted in <a href="http://www.brad-smith.info/blog/archives/category/utility-code" title="View all posts in Utility code" rel="category tag">Utility code</a>.</span>
	</footer><!-- #entry-meta -->

	

	
</article><!-- #post-709 -->


<article id="post-704" class="post-704 post type-post status-publish format-standard hentry category-announcements">

	
	

	<header class="page-header">

	<h1 class="entry-title"><a href="http://www.brad-smith.info/blog/archives/704" title="Permalink to Comments working again" rel="bookmark">Comments working again</a></h1>
		<div class="entry-meta">

			<span class="sep">Posted on </span><a href="http://www.brad-smith.info/blog/archives/704" title="9:27 pm" rel="bookmark"><time class="entry-date" datetime="2014-02-25T21:27:16+00:00" pubdate>February 25, 2014</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.brad-smith.info/blog/archives/author/admin" title="View all posts by Bradley Smith" rel="author">Bradley Smith</a></span></span>		<span class="sep"> | </span>
		<span class="comments-link">
			<a href="http://www.brad-smith.info/blog/archives/704#respond" title="Comment on Comments working again"><span class="leave-reply">Leave a reply</span></a>		</span>
		
		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->



	
	<div class="entry-content clearfix">

		<p>Hi all,</p>
<p>Just a quick announcement to say that comments are working again.</p>
<p>It seems that the captcha plug-in I was using has been discontinued, including the server that validates the captchas themselves. I&#8217;ve replaced the old captcha plug-in with one that uses Google reCAPTCHA instead. This should be familiar to most users from other sites on the web. While I don&#8217;t like the clunky nature of most captchas, they are necessary on this blog given the amount of spam I receive.</p>
<p>Anyway, apologies for any inconvenience if you were unable to comment on an article. Everything should be fine now.</p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit addtoany_list a2a_target" id="wpa2a_3"><a class="a2a_dd addtoany_no_icon addtoany_share_save" href="http://www.addtoany.com/share_save">Share/Bookmark</a></div></div>
	</div><!-- .entry-content -->

	


	<footer class="entry-meta">

		<span class="cat-links block">Posted in <a href="http://www.brad-smith.info/blog/archives/category/announcements" title="View all posts in Announcements" rel="category tag">Announcements</a>.</span>
	</footer><!-- #entry-meta -->

	

	
</article><!-- #post-704 -->


<article id="post-683" class="post-683 post type-post status-publish format-standard hentry category-announcements tag-accounting tag-c tag-file-formats tag-sdks tag-windows-forms">

	
	

	<header class="page-header">

	<h1 class="entry-title"><a href="http://www.brad-smith.info/blog/archives/683" title="Permalink to ABA/Cemtext Validator now available" rel="bookmark">ABA/Cemtext Validator now available</a></h1>
		<div class="entry-meta">

			<span class="sep">Posted on </span><a href="http://www.brad-smith.info/blog/archives/683" title="2:33 am" rel="bookmark"><time class="entry-date" datetime="2013-10-21T02:33:41+00:00" pubdate>October 21, 2013</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.brad-smith.info/blog/archives/author/admin" title="View all posts by Bradley Smith" rel="author">Bradley Smith</a></span></span>		<span class="sep"> | </span>
		<span class="comments-link">
			<a href="http://www.brad-smith.info/blog/archives/683#respond" title="Comment on ABA/Cemtext Validator now available"><span class="leave-reply">Leave a reply</span></a>		</span>
		
		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->



	
	<div class="entry-content clearfix">

		<p><a href="http://www.brad-smith.info/blog/projects/aba-validator"><img class="thumbnail alignnone size-full wp-image-681" alt="ABA/Cemtext Validator" src="http://www.brad-smith.info/blog/wp-content/uploads/2013/10/aba-validator-sm.jpg" width="500" height="300" /></a></p>
<p>I&#8217;ve published an <a title="ABA/Cemtext Validator" href="http://www.brad-smith.info/blog/projects/aba-validator">ABA/Cemtext File Validator</a> in the projects section of the site.</p>
<p>This project is an SDK for reading, writing and validating ABA files. The ABA format is a de facto standard used by Australian banks and other financial institutions, allowing users to make bulk payments.</p>
<p>I hope you find it useful!</p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit addtoany_list a2a_target" id="wpa2a_4"><a class="a2a_dd addtoany_no_icon addtoany_share_save" href="http://www.addtoany.com/share_save">Share/Bookmark</a></div></div>
	</div><!-- .entry-content -->

	


	<footer class="entry-meta">

		<span class="cat-links block">Posted in <a href="http://www.brad-smith.info/blog/archives/category/announcements" title="View all posts in Announcements" rel="category tag">Announcements</a>.</span>
	</footer><!-- #entry-meta -->

	

	
</article><!-- #post-683 -->


<article id="post-640" class="post-640 post type-post status-publish format-standard hentry category-downloadable-source-code category-utility-code tag-c tag-custom-controls tag-gui-design tag-inheritance tag-interop tag-mouse tag-reader-mode tag-reflection tag-win32 tag-windows-forms">

	
	

	<header class="page-header">

	<h1 class="entry-title"><a href="http://www.brad-smith.info/blog/archives/640" title="Permalink to Enabling Reader Mode on the DataGridView (middle-click auto-scroll)" rel="bookmark">Enabling Reader Mode on the DataGridView (middle-click auto-scroll)</a></h1>
		<div class="entry-meta">

			<span class="sep">Posted on </span><a href="http://www.brad-smith.info/blog/archives/640" title="12:31 pm" rel="bookmark"><time class="entry-date" datetime="2013-08-15T12:31:30+00:00" pubdate>August 15, 2013</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.brad-smith.info/blog/archives/author/admin" title="View all posts by Bradley Smith" rel="author">Bradley Smith</a></span></span>		<span class="sep"> | </span>
		<span class="comments-link">
			<a href="http://www.brad-smith.info/blog/archives/640#respond" title="Comment on Enabling Reader Mode on the DataGridView (middle-click auto-scroll)"><span class="leave-reply">Leave a reply</span></a>		</span>
		
		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->



	
	<div class="entry-content clearfix">

		<p>&#8220;Reader Mode&#8221; &#8211; we&#8217;ve all used it, and whether we recognise it by name (or one of its many others, such as autoscroll, middle-click scroll, etc), we&#8217;ve come to expect it from the software we use the most &#8211; web browsers, text editors, e-mail clients and more. However, if you&#8217;ve been living under a rock since the mainstream adoption of the wheel mouse, let me explain how it works:</p>
<p>You activate Reader Mode by middle-clicking on a scrollable container/control. A glyph appears on the window in the location where you pressed the mouse button and the cursor changes to a scroll symbol. As you move the pointer away from the glyph, the display begins to automatically scroll in that direction. The further you move the pointer from the original location, the faster the display scrolls. (You can slow down the scroll rate by moving the pointer closer to the glyph.) This offers an alternative to continuously rotating the mouse wheel, allowing you to scroll through content while keeping your hand still.</p>
<p>Reader Mode behaves slightly differently depending on whether you release the middle button straight away, or keep it held down while scrolling. If the former is true, it goes into a sort-of &#8220;hands-free&#8221; mode where you must click again to exit. In the latter situation, it terminates when you release the middle mouse button.</p>
<h2><img class="thumbnail aligncenter size-full wp-image-648" alt="DataGridViewRM example" src="http://www.brad-smith.info/blog/wp-content/uploads/2013/08/DataGridViewRM1.gif" width="446" height="324" /></h2>
<h2>Reader Mode in Windows Forms</h2>
<p>Very few Windows Forms controls support Reader Mode as-is; the only ones i&#8217;m aware that do are <span class="fixed-width">RichTextBox</span> and <span class="fixed-width">WebBrowser</span>. Many more controls could benefit from Reader Mode support, such as:</p>
<ul class="fixed-width">
<li>Panel</li>
<li>PictureBox</li>
<li>ListView</li>
<li>TreeView</li>
<li>DataGridView</li>
</ul>
<p>It&#8217;s the latter of those that I will focus on in this article.</p>
<h2>Adding Reader Mode support</h2>
<p>So, how do we add support for Reader Mode to a control that doesn&#8217;t already have it? You might be tempted to just implement it from scratch (handling mouse events, calculating offsets, etc), but there are many reasons why this is inadvisable:</p>
<ul>
<li>Re-inventing the wheel</li>
<li>Subtle differences in behaviour easily introduced</li>
<li>Will not adapt to changes in the standard implementation</li>
<li>More complex using pure Windows Forms</li>
</ul>
<p>Thankfully, there is an API for Reader Mode which can be imported from the Windows Common Controls library (<span class="fixed-width">comctl32.dll</span>). It consists of:</p>
<ul>
<li><span class="fixed-width">READERMODEINFO</span> structure &#8211; For configuring Reader Mode behaviour.</li>
<li><span class="fixed-width">DoReaderMode()</span> function &#8211; Puts the control into Reader Mode.</li>
<li><span class="fixed-width">TranslateDispatch</span> callback &#8211; Redirects window messages while in Reader Mode, allowing you to handle them independently of normal control behaviour.</li>
<li><span class="fixed-width">ReaderScroll</span> callback &#8211; Does the grunt work, notifying the control to start scrolling or update its scroll rate.</li>
</ul>
<pre class="brush:csharp">[DllImport("comctl32.dll", SetLastError = true, EntryPoint = "#383")]
public static extern void DoReaderMode(ref InteropTypes.READERMODEINFO prmi);

public delegate bool TranslateDispatchCallbackDelegate(ref Message lpmsg);

public delegate bool ReaderScrollCallbackDelegate(ref READERMODEINFO prmi, int dx, int dy);

[Flags]
public enum ReaderModeFlags {
    None = 0x00,
    ZeroCursor = 0x01,
    VerticalOnly = 0x02,
    HorizontalOnly = 0x04
}

[StructLayout(LayoutKind.Sequential)]
public struct READERMODEINFO {
    public int cbSize;
    public IntPtr hwnd;
    public ReaderModeFlags fFlags;
    public IntPtr prc;
    public ReaderScrollCallbackDelegate pfnScroll;
    public TranslateDispatchCallbackDelegate fFlags2;
    public IntPtr lParam;
}</pre>
<p>The basic life cycle for Reader Mode, therefore, is:</p>
<ol>
<li>In the handler for the control&#8217;s <span class="fixed-width">MouseDown</span> event, check for the middle mouse button and:
<ol>
<li>Display a glyph at the location the mouse button was pressed (i&#8217;m using a <span class="fixed-width">PictureBox</span> for this).</li>
<li>Activate the mechanism used to auto-scroll the control (i&#8217;m using a <span class="fixed-width">Timer</span> for this).</li>
<li>Initialise and enter Reader Mode by calling <span class="fixed-width">DoReaderMode()</span>.</li>
</ol>
</li>
<li>The user will move the mouse pointer. In the <span class="fixed-width">ReaderScroll</span> callback:
<ol>
<li>Store the delta values (<span class="fixed-width">dx, dy</span>) so that they are visible to the auto-scroll mechanism (<span class="fixed-width">Timer</span>).</li>
<li>If either of the values changes from zero, we will need to exit Reader Mode when the mouse button is released.</li>
</ol>
</li>
<li>At regular intervals (~25ms), the auto-scroll mechanism must:
<ol>
<li>Increment (or decrement) the horizontal and/or vertical scroll bar offsets in proportion to the delta values from the previous step.</li>
</ol>
</li>
<li>The user will either release the mouse button or, in &#8220;hands-free&#8221; mode, click again. In the <span class="fixed-width">TranslateDispatch</span> callback:
<ol>
<li>If the window message corresponds to an event that will exit Reader Mode, stop the auto-scroll mechanism and hide the glyph.</li>
<li>Depending on the type of event, either allow the default Reader Mode implementation to handle the message or handle it ourselves.</li>
</ol>
</li>
<li>Reader Mode will exit based on its own internal logic.</li>
</ol>
<h2>Default Reader Mode implementation</h2>
<p>The default Reader Mode implementation is very simplistic. It will not draw the glyph, scroll the control (although it does generate the delta values) and it behaves slightly differently from the &#8220;standard&#8221; behaviour we see in most applications:</p>
<ul>
<li>No &#8220;hands-free&#8221; mode; Reader Mode always exits when the middle mouse button is released
<ul>
<li>We can overcome this by preventing the default implementation from handling the <span class="fixed-width">MouseUp</span> event until the delta values change</li>
</ul>
</li>
<li>Stops responding to user input if the mouse pointer leaves the bounds of the control&#8217;s parent window
<ul>
<li>This is avoided by preventing the default implementation from handling the <span class="fixed-width">MouseLeave</span> event</li>
</ul>
</li>
<li>Only sends non-zero delta values when the pointer goes outside the &#8216;scrolling area&#8217;
<ul>
<li>Conventional behaviour is restored by setting the &#8216;scrolling area&#8217; to the bounds* of the glyph (instead of the bounds of the control)</li>
</ul>
</li>
</ul>
<p>* &#8211; Note that the rectangle structure expected by Reader Mode is expressed in terms of left, top, right and bottom (rather than the conventional left, top, width, height representation). This gave me a nasty surprise the first time around.</p>
<h2>Applying Reader Mode to the DataGridView</h2>
<p>The <span class="fixed-width">DataGridView</span> control is an excellent candidate for Reader Mode; scrolling through pages of tabular data can be a real pain, and the additional of Reader Mode functionality would help to make the control more user-friendly.</p>
<p>The easiest method is to subclass the control. I&#8217;ve created a child class called <span class="fixed-width">DataGridViewRM</span> which adds the Reader Mode functionality and allows it to be toggled on/off via a design-time property. This effectively makes it a drop-in replacement for the original control.</p>
<p>As I eluded to above, we need to add some child controls to facilitate the behaviour; a <span class="fixed-width">PictureBox</span> and a <span class="fixed-width">Timer</span>. These must be initialised in the constructor and released in the control&#8217;s <span class="fixed-width">Dispose()</span> method.</p>
<p>In terms of actually scrolling the control, the <span class="fixed-width">DataGridView</span> uses its own logic (although its scroll bar controls are publicly-accessible, manipulating them does not scroll the control properly). It exposes two properties to allow the scroll offsets to be changed; <span class="fixed-width">HorizontalScrollingOffset</span> and <span class="fixed-width">VerticalScrollingOffset</span>. Unfortunately, through a quirk in Windows Forms, the latter property does not have a set accessor. Thankfully, it can be accessed using reflection:</p>
<pre class="brush:csharp">// for better performance, retrieve this only once (in the constructor)
PropertyInfo setVerticalScrollingOffset 
    = GetType().GetProperty("VerticalOffset", BindingFlags.NonPublic | BindingFlags.Instance);

[Browsable(false)]
public new int VerticalScrollingOffset {
    get {
        return base.VerticalScrollingOffset;
    }
    set {
        setVerticalScrollingOffset.SetValue(this, value, null);
    }
}</pre>
<p>All that remains is to handle the <span class="fixed-width">MouseDown</span> event:</p>
<pre class="brush:csharp">protected override void OnMouseDown(MouseEventArgs e) {
    if (ReaderModeEnabled) {
        if (e.Button == MouseButtons.Middle) {
            DataGridView.HitTestInfo hit = HitTest(e.X, e.Y);

            // reader mode should only be activated when the button 
            // is clicked over the scrollable part of the control
            switch (hit.Type) {
                case DataGridViewHitTestType.Cell:
                case DataGridViewHitTestType.HorizontalScrollBar:
                case DataGridViewHitTestType.None:
                case DataGridViewHitTestType.VerticalScrollBar:
                    // position and show the PictureBox
                    // start the Timer
                    // call DoReaderMode()
                    return;
                }
            }
        }

        // otherwise, process the event normally
        base.OnMouseDown(e);
}</pre>
<p>The rest of the Reader Mode implementation falls within the callback methods and the <span class="fixed-width">Timer</span>&#8216;s <span class="fixed-width">Tick</span> handler, as outlined earlier. You can view the complete implementation by downloading the source code below:</p>
<h2>Download</h2>
<p><a href="http://www.brad-smith.info/blog/wp-content/uploads/2013/08/ReaderModeDGV.zip">Source code</a> (Visual Studio 2012 solution, .NET Framework 4.0 &#8211; includes example application)</p>
<h2>Final words</h2>
<p>I hope you find this enhanced <span class="fixed-width">DataGridView</span> control useful; it demonstrates just one of many controls that can be modified to support Reader Mode. I hope my explanation makes it easy for you to implement Reader Mode in your own controls.</p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit addtoany_list a2a_target" id="wpa2a_5"><a class="a2a_dd addtoany_no_icon addtoany_share_save" href="http://www.addtoany.com/share_save">Share/Bookmark</a></div></div>
	</div><!-- .entry-content -->

	


	<footer class="entry-meta">

		<span class="cat-links block">Posted in <a href="http://www.brad-smith.info/blog/archives/category/downloadable-source-code" title="View all posts in Downloadable source code" rel="category tag">Downloadable source code</a>, <a href="http://www.brad-smith.info/blog/archives/category/utility-code" title="View all posts in Utility code" rel="category tag">Utility code</a>.</span>
	</footer><!-- #entry-meta -->

	

	
</article><!-- #post-640 -->

<nav class="pagination pagination-centered clearfix"><ul class='page-numbers'>
	<li><span class='page-numbers current'>1</span></li>
	<li><a class='page-numbers' href='http://www.brad-smith.info/blog/page/2'>2</a></li>
	<li><a class='page-numbers' href='http://www.brad-smith.info/blog/page/3'>3</a></li>
	<li><a class='page-numbers' href='http://www.brad-smith.info/blog/page/4'>4</a></li>
	<li><span class="page-numbers dots">&hellip;</span></li>
	<li><a class='page-numbers' href='http://www.brad-smith.info/blog/page/10'>10</a></li>
	<li><a class="next page-numbers" href="http://www.brad-smith.info/blog/page/2">Next &raquo;</a></li>
</ul>
</nav>	</div><!-- #content -->
	</section><!-- #primary -->

<section id="secondary" class="widget-area span4" role="complementary">
	<aside id="text-3" class="widget well widget_text">			<div class="textwidget"><a href="http://www.cloudflare.com/email-protection#94f6e7d4f6e6f5f0b9e7f9fde0fcbafdfaf2fb"><img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/03/email.png" alt="E-Mail" /></a> 
<a href="http://www.youtube.com/bradsmithcoding/"><img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/03/youtube.png" alt="YouTube Channel" /></a>  
<a href="http://www.linkedin.com/profile/view?id=173320816"><img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/03/linkedin.png" alt="LinkedIn Profile" /></a>  
<a href="http://plus.google.com/u/0/?wwc=1#111810551444363048524"><img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/03/google.png" alt="Google+ Profile" /></a> </div>
		</aside>		<aside id="recent-posts-3" class="widget well widget_recent_entries">		<h2 class="widget-title">Recent Posts</h2>		<ul>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/748">ComboTreeBox Enhancements and New Project Page</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/709">Managed Wrapper for the Text Object Model (TOM)</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/704">Comments working again</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/683">ABA/Cemtext Validator now available</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/640">Enabling Reader Mode on the DataGridView (middle-click auto-scroll)</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/635">Making the MouseWheel event conform to user&#8217;s expectations</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/619">Creating a user map with the Google Maps API</a>
						</li>
					<li>
				<a href="http://www.brad-smith.info/blog/archives/586">Using DENSE_RANK() to Build a Better Tag Cloud</a>
						</li>
				</ul>
		</aside><aside id="tag_cloud-4" class="widget well widget_tag_cloud"><h2 class="widget-title">Tag Cloud</h2><div class="tagcloud"><a href='http://www.brad-smith.info/blog/archives/tag/abstract-classes' class='tag-link-14' title='3 topics' style='font-size: 11.255813953488pt;'>abstract classes</a>
<a href='http://www.brad-smith.info/blog/archives/tag/accounting' class='tag-link-57' title='2 topics' style='font-size: 9.953488372093pt;'>accounting</a>
<a href='http://www.brad-smith.info/blog/archives/tag/appdomain' class='tag-link-62' title='2 topics' style='font-size: 9.953488372093pt;'>AppDomain</a>
<a href='http://www.brad-smith.info/blog/archives/tag/c' class='tag-link-3' title='38 topics' style='font-size: 22pt;'>C#</a>
<a href='http://www.brad-smith.info/blog/archives/tag/cc' class='tag-link-35' title='2 topics' style='font-size: 9.953488372093pt;'>C/C++</a>
<a href='http://www.brad-smith.info/blog/archives/tag/collections' class='tag-link-9' title='9 topics' style='font-size: 15.596899224806pt;'>collections</a>
<a href='http://www.brad-smith.info/blog/archives/tag/com' class='tag-link-21' title='5 topics' style='font-size: 13.209302325581pt;'>COM</a>
<a href='http://www.brad-smith.info/blog/archives/tag/comedy' class='tag-link-42' title='1 topic' style='font-size: 8pt;'>comedy</a>
<a href='http://www.brad-smith.info/blog/archives/tag/ctes' class='tag-link-18' title='1 topic' style='font-size: 8pt;'>CTEs</a>
<a href='http://www.brad-smith.info/blog/archives/tag/custom-controls' class='tag-link-20' title='12 topics' style='font-size: 16.790697674419pt;'>custom controls</a>
<a href='http://www.brad-smith.info/blog/archives/tag/data-binding' class='tag-link-27' title='10 topics' style='font-size: 16.031007751938pt;'>data binding</a>
<a href='http://www.brad-smith.info/blog/archives/tag/encryption' class='tag-link-50' title='2 topics' style='font-size: 9.953488372093pt;'>encryption</a>
<a href='http://www.brad-smith.info/blog/archives/tag/enumerators' class='tag-link-13' title='4 topics' style='font-size: 12.341085271318pt;'>enumerators</a>
<a href='http://www.brad-smith.info/blog/archives/tag/excel' class='tag-link-4' title='2 topics' style='font-size: 9.953488372093pt;'>Excel</a>
<a href='http://www.brad-smith.info/blog/archives/tag/extension-methods' class='tag-link-39' title='1 topic' style='font-size: 8pt;'>extension methods</a>
<a href='http://www.brad-smith.info/blog/archives/tag/file-formats' class='tag-link-61' title='2 topics' style='font-size: 9.953488372093pt;'>file formats</a>
<a href='http://www.brad-smith.info/blog/archives/tag/generics' class='tag-link-16' title='7 topics' style='font-size: 14.511627906977pt;'>generics</a>
<a href='http://www.brad-smith.info/blog/archives/tag/graphics' class='tag-link-28' title='14 topics' style='font-size: 17.550387596899pt;'>graphics</a>
<a href='http://www.brad-smith.info/blog/archives/tag/gui-design' class='tag-link-26' title='16 topics' style='font-size: 18.093023255814pt;'>GUI design</a>
<a href='http://www.brad-smith.info/blog/archives/tag/inheritance' class='tag-link-55' title='2 topics' style='font-size: 9.953488372093pt;'>inheritance</a>
<a href='http://www.brad-smith.info/blog/archives/tag/interfaces' class='tag-link-10' title='8 topics' style='font-size: 15.054263565891pt;'>interfaces</a>
<a href='http://www.brad-smith.info/blog/archives/tag/interop' class='tag-link-6' title='12 topics' style='font-size: 16.790697674419pt;'>Interop</a>
<a href='http://www.brad-smith.info/blog/archives/tag/linq' class='tag-link-38' title='3 topics' style='font-size: 11.255813953488pt;'>LINQ</a>
<a href='http://www.brad-smith.info/blog/archives/tag/mcml' class='tag-link-45' title='5 topics' style='font-size: 13.209302325581pt;'>MCML</a>
<a href='http://www.brad-smith.info/blog/archives/tag/media-center' class='tag-link-46' title='10 topics' style='font-size: 16.031007751938pt;'>media center</a>
<a href='http://www.brad-smith.info/blog/archives/tag/networking' class='tag-link-51' title='2 topics' style='font-size: 9.953488372093pt;'>networking</a>
<a href='http://www.brad-smith.info/blog/archives/tag/office' class='tag-link-5' title='3 topics' style='font-size: 11.255813953488pt;'>Office</a>
<a href='http://www.brad-smith.info/blog/archives/tag/physics' class='tag-link-30' title='2 topics' style='font-size: 9.953488372093pt;'>physics</a>
<a href='http://www.brad-smith.info/blog/archives/tag/recursion' class='tag-link-36' title='1 topic' style='font-size: 8pt;'>recursion</a>
<a href='http://www.brad-smith.info/blog/archives/tag/refactoring' class='tag-link-15' title='2 topics' style='font-size: 9.953488372093pt;'>refactoring</a>
<a href='http://www.brad-smith.info/blog/archives/tag/reflection' class='tag-link-24' title='6 topics' style='font-size: 13.968992248062pt;'>reflection</a>
<a href='http://www.brad-smith.info/blog/archives/tag/republished' class='tag-link-43' title='1 topic' style='font-size: 8pt;'>republished</a>
<a href='http://www.brad-smith.info/blog/archives/tag/reverse-engineering' class='tag-link-48' title='1 topic' style='font-size: 8pt;'>reverse engineering</a>
<a href='http://www.brad-smith.info/blog/archives/tag/serialisation' class='tag-link-64' title='2 topics' style='font-size: 9.953488372093pt;'>serialisation</a>
<a href='http://www.brad-smith.info/blog/archives/tag/sharepoint' class='tag-link-32' title='1 topic' style='font-size: 8pt;'>SharePoint</a>
<a href='http://www.brad-smith.info/blog/archives/tag/simulation' class='tag-link-31' title='1 topic' style='font-size: 8pt;'>simulation</a>
<a href='http://www.brad-smith.info/blog/archives/tag/sorting' class='tag-link-12' title='4 topics' style='font-size: 12.341085271318pt;'>sorting</a>
<a href='http://www.brad-smith.info/blog/archives/tag/sql' class='tag-link-17' title='4 topics' style='font-size: 12.341085271318pt;'>SQL</a>
<a href='http://www.brad-smith.info/blog/archives/tag/wcf' class='tag-link-49' title='2 topics' style='font-size: 9.953488372093pt;'>WCF</a>
<a href='http://www.brad-smith.info/blog/archives/tag/webclient' class='tag-link-53' title='1 topic' style='font-size: 8pt;'>WebClient</a>
<a href='http://www.brad-smith.info/blog/archives/tag/win32' class='tag-link-34' title='9 topics' style='font-size: 15.596899224806pt;'>Win32</a>
<a href='http://www.brad-smith.info/blog/archives/tag/windows-forms' class='tag-link-22' title='14 topics' style='font-size: 17.550387596899pt;'>Windows Forms</a>
<a href='http://www.brad-smith.info/blog/archives/tag/windows-registry' class='tag-link-23' title='3 topics' style='font-size: 11.255813953488pt;'>Windows Registry</a>
<a href='http://www.brad-smith.info/blog/archives/tag/xml' class='tag-link-37' title='4 topics' style='font-size: 12.341085271318pt;'>XML</a>
<a href='http://www.brad-smith.info/blog/archives/tag/xml-web-services' class='tag-link-33' title='1 topic' style='font-size: 8pt;'>XML web services</a></div>
</aside><aside id="categories-3" class="widget well widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-44"><a href="http://www.brad-smith.info/blog/archives/category/announcements" title="View all posts filed under Announcements">Announcements</a> (14)
</li>
	<li class="cat-item cat-item-52"><a href="http://www.brad-smith.info/blog/archives/category/coding-practices" title="View all posts filed under Coding practices">Coding practices</a> (1)
</li>
	<li class="cat-item cat-item-72"><a href="http://www.brad-smith.info/blog/archives/category/computer-science" title="View all posts filed under Computer Science">Computer Science</a> (2)
</li>
	<li class="cat-item cat-item-19"><a href="http://www.brad-smith.info/blog/archives/category/databases" title="View all posts filed under Databases">Databases</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="http://www.brad-smith.info/blog/archives/category/downloadable-source-code" title="View all posts filed under Downloadable source code">Downloadable source code</a> (14)
</li>
	<li class="cat-item cat-item-29"><a href="http://www.brad-smith.info/blog/archives/category/gui-components" title="View all posts filed under GUI components">GUI components</a> (7)
</li>
	<li class="cat-item cat-item-7"><a href="http://www.brad-smith.info/blog/archives/category/ms-office-interop" title="View all posts filed under MS Office Interop">MS Office Interop</a> (2)
</li>
	<li class="cat-item cat-item-40"><a href="http://www.brad-smith.info/blog/archives/category/republished-articles" title="View all posts filed under Republished articles">Republished articles</a> (2)
</li>
	<li class="cat-item cat-item-32"><a href="http://www.brad-smith.info/blog/archives/category/sharepoint" title="View all posts filed under SharePoint">SharePoint</a> (1)
</li>
	<li class="cat-item cat-item-56"><a href="http://www.brad-smith.info/blog/archives/category/standards" title="View all posts filed under Standards">Standards</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="http://www.brad-smith.info/blog/archives/category/utility-code" title="View all posts filed under Utility code">Utility code</a> (20)
</li>
	<li class="cat-item cat-item-78"><a href="http://www.brad-smith.info/blog/archives/category/web-development" title="View all posts filed under Web development">Web development</a> (1)
</li>
	<li class="cat-item cat-item-47"><a href="http://www.brad-smith.info/blog/archives/category/windows-media-center" title="View all posts filed under Windows Media Center">Windows Media Center</a> (9)
</li>
		</ul>
</aside><aside id="text-2" class="widget well widget_text"><h2 class="widget-title">Donations</h2>			<div class="textwidget">If you find my code/articles useful, please consider making a donation:
<div align="center" style="margin-top: 5px; margin-bottom: 5px">
    <img src="http://www.brad-smith.info/blog/wp-content/uploads/2013/10/bitcoin-donations.png" alt="QR code for Bitcoin donations" />
</div>
<div>
    Bitcoin: 1Fv6FymE5cqDzD7MiCbmm8bU4MjxQpWqKU<br />
    PayPal: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="e28091a280908386cf918f8b968acc8b8c848d">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
</div></div>
		</aside><aside id="meta-3" class="widget well widget_meta"><h2 class="widget-title">Meta</h2>			<ul>
						<li><a href="http://www.brad-smith.info/blog/wp-login.php">Log in</a></li>
			<li><a href="http://www.brad-smith.info/blog/feed" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.brad-smith.info/blog/comments/feed" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</aside><aside id="text-5" class="widget well widget_text"><h2 class="widget-title">Sponsors</h2>			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Blog Sidebar (300x250) -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-5469894184548099"
     data-ad-slot="4155866352"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</aside></section><!-- #secondary .widget-area -->
				<footer id="colophon" role="contentinfo" class="span12">
										<div id="page-footer" class="well clearfix">
						<span class="credits alignleft">&copy; 2014 <a href="http://www.brad-smith.info/blog/">Brad Smith&#039;s Coding Blog</a>, all rights reserved.</span>						<div id="site-generator">
							<a	href="http://wordpress.org/"
								title="Semantic Personal Publishing Platform"
								target="_blank"
								rel="generator">Proudly powered by WordPress</a>
						</div>
					</div><!-- #page-footer .well .clearfix -->
									</footer><!-- #colophon -->
							</div><!-- #page -->
		</div><!-- .container -->
	<!-- 30 queries. 0.478 seconds. -->
	
<script type="text/javascript"><!--
wpa2a.targets=[
{title:'ComboTreeBox Enhancements and New Project Page',url:'http://www.brad-smith.info/blog/archives/748'},
{title:'Managed Wrapper for the Text Object Model (TOM)',url:'http://www.brad-smith.info/blog/archives/709'},
{title:'Comments working again',url:'http://www.brad-smith.info/blog/archives/704'},
{title:'ABA/Cemtext Validator now available',url:'http://www.brad-smith.info/blog/archives/683'},
{title:'Enabling Reader Mode on the DataGridView (middle-click auto-scroll)',url:'http://www.brad-smith.info/blog/archives/640'}];
wpa2a.html_done=true;if(wpa2a.script_ready&&!wpa2a.done)wpa2a.init();wpa2a.script_load();
//--></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/js/bootstrap.min.js?ver=2.0.3'></script>
<script type='text/javascript' src='http://www.brad-smith.info/blog/wp-content/themes/the-bootstrap/js/the-bootstrap.min.js?ver=3.9.1'></script>
	<script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l=document.getElementsByTagName("a"),t=document.createElement("textarea");for(i=0;l.length-i;i++){try{a=l[i].getAttribute("href");if(a&&"www.cloudflare.com/email-protection"==a.substr(7 ,35)){s='';j=43;r=parseInt(a.substr(j,2),16);for(j+=2;a.length-j&&a.substr(j,1)!='X';j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}j+=1;s+=a.substr(j,a.length-j);t.innerHTML=s.replace(/</g,"&lt;").replace(/>/g,"&gt;");l[i].setAttribute("href","mailto:"+t.value);}}catch(e){}}}catch(e){}})();
/* ]]> */
</script>
</body>
</html>

