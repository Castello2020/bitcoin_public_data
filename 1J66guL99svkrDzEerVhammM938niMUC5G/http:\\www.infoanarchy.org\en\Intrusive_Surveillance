http://www.infoanarchy.org/en/Intrusive_Surveillance
HTTP/1.1 200 OK
Date: Wed, 23 Jul 2014 01:22:26 GMT
Server: Apache/2.0.54 (Unix) DAV/2 PHP/5.1.4 mod_fastcgi/2.4.2
X-Powered-By: PHP/5.1.4
Content-language: en
ETag: W/"iawiki:pcache:idhash:6437-0!1!0!0!!en!2--20100815154600"
Vary: Accept-Encoding,Cookie
Expires: -1
Cache-Control: private, must-revalidate, max-age=0
Last-modified: Sun, 15 Aug 2010 15:46:00 GMT
Content-Encoding: gzip
Connection: close
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="KEYWORDS" content="Intrusive Surveillance" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link title="Creative Commons" type="application/rdf+xml" href="/en/index.php?title=Intrusive_Surveillance&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/publicdomain/" />
    <title>Intrusive Surveillance - iA wiki</title>
    <style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/en/skins/monobook/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="/en/skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "/en/skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "/en/skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if gte IE 6]><style type="text/css">@import "/en/skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if lt IE 7]><script type="text/javascript" src="/en/skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="/en/index.php?title=-&amp;action=raw&amp;gen=js"></script>    <script type="text/javascript" src="/en/skins/common/wikibits.js"></script>
    <style type="text/css">/*<![CDATA[*/
@import "/en/index.php?title=MediaWiki:Monobook.css&action=raw&ctype=text/css&smaxage=18000";
@import "/en/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>              </head>
  <body                 class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="top"></a>
	  <div id="siteNotice"><b>Join us on IRC: #infoanarchy on irc.oftc.net &mdash; <a href="http://chump.infoanarchy.org" class='external text' title="http://chump.infoanarchy.org" rel="nofollow">channel blog</a></b><p><b>Bring back infoAnarchy, the first site to report on the coming age of abundance. Revive infoanarchy.org blog &amp; wiki - donate BTC to 1J66guL99svkrDzEerVhammM938niMUC5G</b>
</p></div>	  <h1 class="firstHeading">Intrusive Surveillance</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From iA wiki</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>THOMAS: What is this thing?
</p><p>TRINITY: We think you're bugged. Try to relax. Come on, come on...
</p><p>TRINITY: CLEAR!
</p><p>THOMAS: Jesus Christ! That thing is real?! 
</p><p>Intrusive Surveillance basically means any type of surveillance that is occurring due to some form of intrusion into your machine. As such, it is the most difficult form of "forensics" to defend against, since doing so involves the securing and hardening of your operating system against attack. While keeping up with security patches is a necessary condition to be secure, sadly it is not sufficient. In spite of this, there are several obvious indicators that someone is investigating you/watching what you do with your computer.
</p><p>I should probably start this section off by saying that if you need anonymity, you should probably reinstall your system now. Especially if you use Windows and Internet Explorer. It is way to easy for those machines to become infected with spyware if you haven't been practicing safe computing up to this point. I've even seen spyware that modifies the Internet Explorer user agent string to contain a unique 128bit identifier.
</p>
<table id='toc' class='toc'><tr><td><div id='toctitle'><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="#Root_Kits"><span class="tocnumber">1</span> <span class="toctext">Root Kits</span></a>
<ul>
<li class='toclevel-2'><a href="#Linux"><span class="tocnumber">1.1</span> <span class="toctext">Linux</span></a></li>
<li class='toclevel-2'><a href="#Mac_OS_X"><span class="tocnumber">1.2</span> <span class="toctext">Mac OS X</span></a></li>
<li class='toclevel-2'><a href="#Windows"><span class="tocnumber">1.3</span> <span class="toctext">Windows</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#Keyloggers_and_Spyware"><span class="tocnumber">2</span> <span class="toctext">Keyloggers and Spyware</span></a>
<ul>
<li class='toclevel-2'><a href="#Hardware"><span class="tocnumber">2.1</span> <span class="toctext">Hardware</span></a></li>
<li class='toclevel-2'><a href="#Software"><span class="tocnumber">2.2</span> <span class="toctext">Software</span></a>
<ul>
<li class='toclevel-3'><a href="#Windows_2"><span class="tocnumber">2.2.1</span> <span class="toctext">Windows</span></a></li>
<li class='toclevel-3'><a href="#Linux_2"><span class="tocnumber">2.2.2</span> <span class="toctext">Linux</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#General_Techniques_Against_Keyloggers"><span class="tocnumber">2.3</span> <span class="toctext">General Techniques Against Keyloggers</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#Watching_Your_Back"><span class="tocnumber">3</span> <span class="toctext">Watching Your Back</span></a></li>
<li class='toclevel-1'><a href="#Throwaway_Computing"><span class="tocnumber">4</span> <span class="toctext">Throwaway Computing</span></a></li>
<li class='toclevel-1'><a href="#Search_and_Seizure"><span class="tocnumber">5</span> <span class="toctext">Search and Seizure</span></a>
<ul>
<li class='toclevel-2'><a href="#Warranted_and_Warrantless_Search"><span class="tocnumber">5.1</span> <span class="toctext">Warranted and Warrantless Search</span></a>
<ul>
<li class='toclevel-3'><a href="#Private_Searches"><span class="tocnumber">5.1.1</span> <span class="toctext">Private Searches</span></a></li>
<li class='toclevel-3'><a href="#Searches.2FConsent_by_Employers.2FCoworkers"><span class="tocnumber">5.1.2</span> <span class="toctext">Searches/Consent by Employers/Coworkers</span></a></li>
<li class='toclevel-3'><a href="#Implied_Consent"><span class="tocnumber">5.1.3</span> <span class="toctext">Implied Consent</span></a></li>
<li class='toclevel-3'><a href="#Exigent_Searches"><span class="tocnumber">5.1.4</span> <span class="toctext">Exigent Searches</span></a></li>
<li class='toclevel-3'><a href="#No-Knock.2F.22Sneak_and_Peak.22_Searches"><span class="tocnumber">5.1.5</span> <span class="toctext">No-Knock/"Sneak and Peak" Searches</span></a></li>
<li class='toclevel-3'><a href="#Subpoena_of_ISP_Records"><span class="tocnumber">5.1.6</span> <span class="toctext">Subpoena of ISP Records</span></a></li>
<li class='toclevel-3'><a href="#Deception_of_Purpose"><span class="tocnumber">5.1.7</span> <span class="toctext">Deception of Purpose</span></a></li>
<li class='toclevel-3'><a href="#Trash_Inspection"><span class="tocnumber">5.1.8</span> <span class="toctext">Trash Inspection</span></a></li>
<li class='toclevel-3'><a href="#Retroactive_FISA_Warrants"><span class="tocnumber">5.1.9</span> <span class="toctext">Retroactive FISA Warrants</span></a></li>
<li class='toclevel-3'><a href="#Search_of_Corporate_Records"><span class="tocnumber">5.1.10</span> <span class="toctext">Search of Corporate Records</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#Civil_Procedure"><span class="tocnumber">5.2</span> <span class="toctext">Civil Procedure</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#Encrypted_Filesystems"><span class="tocnumber">6</span> <span class="toctext">Encrypted Filesystems</span></a>
<ul>
<li class='toclevel-2'><a href="#Linux_3"><span class="tocnumber">6.1</span> <span class="toctext">Linux</span></a></li>
<li class='toclevel-2'><a href="#Mac_OS"><span class="tocnumber">6.2</span> <span class="toctext">Mac OS</span></a></li>
<li class='toclevel-2'><a href="#Windows_3"><span class="tocnumber">6.3</span> <span class="toctext">Windows</span></a>
<ul>
<li class='toclevel-3'><a href="#FreeOTFE_.2F_TrueCrypt"><span class="tocnumber">6.3.1</span> <span class="toctext">FreeOTFE / TrueCrypt</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#SeizeD"><span class="tocnumber">6.4</span> <span class="toctext">SeizeD</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#Secure_Deletion"><span class="tocnumber">7</span> <span class="toctext">Secure Deletion</span></a>
<ul>
<li class='toclevel-2'><a href="#Linux_4"><span class="tocnumber">7.1</span> <span class="toctext">Linux</span></a></li>
<li class='toclevel-2'><a href="#Mac_OS_2"><span class="tocnumber">7.2</span> <span class="toctext">Mac OS</span></a></li>
<li class='toclevel-2'><a href="#Windows_4"><span class="tocnumber">7.3</span> <span class="toctext">Windows</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<p><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=1" title="Intrusive Surveillance">edit</a>]</div><a name="Root_Kits"></a><h2> Root Kits </h2>
<p>Root Kits are the most intrusive and stealthy form of system surveillance around. They are typically designed to take complete control of your operating system kernel, causing it to lie to you about what processes are running, what network connections it is making, system diagnostics, and so on. Luckily, if someone just wants to spy on you, they are much more likely to only install a keylogger rather than a full blown rootkit. However, knowing some basic info about how to detect rootkit installation is helpful for finding keyloggers as well, especially since as keyloggers grow in sophistication, the line between them and complete rootkits will blur.
</p><p>For most users, this section probably covers a threat model they do not need to worry about (although with <a href="http://www.schneier.com/blog/archives/2005/11/sonys_drm_rootk.html" class='external text' title="http://www.schneier.com/blog/archives/2005/11/sonys drm rootk.html" rel="nofollow">rootkits being used</a> by RIAA goons, this is rapidly changing). Many users will want to just skip to the section on [watching your back], which describes how to use rootkits to hide various items on your system from a fascist administrator and for plausible deniability ("a hacker did it! Who installs a rootkit on their own machine?"). Still, even in this case a read over this section is recommended, since it will tell you how to undo what you have done.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=2" title="Intrusive Surveillance">edit</a>]</div><a name="Linux"></a><h3> Linux </h3>
<dl><dd> On Linux, there are a couple of things you can do to protect yourself from rootkits. The easiest, least technical method is to do an <b>ls -laR / > dirty.list</b> on your live system, and then compare this to an <b>ls -laR /mnt/hdd > clean.list</b> on a Knoppix live CD. The command line utility diff -u clean.list dirty.list can be used to compare the two listings. The utility <a href="http://furius.ca/xxdiff/" class='external text' title="http://furius.ca/xxdiff/" rel="nofollow">xxdiff</a> may make this easier to view if there are lots of differences due to an encrypted filesystem not being mounted, proc missing, udev, etc.
</dd><dd> If you intend to audit your machine while it's live, the very first thing you need to do is ensure that your kernel hasn't been modified via a rogue driver module. While <b>lsmod</b> will list loaded modules, it is possible (and quite trivial) to remove module names from this list while keeping the module in the kernel. For this reason, if you are concerned about local surveillance, you are advised to build a kernel without module support (preferably with <a href="http://www.grsecurity.org/" class='external text' title="http://www.grsecurity.org/" rel="nofollow">grsec</a>, which adds protection against ways to force modules into a module-free kernel). This will prevent someone from loading a module that could hide processes and network connections, log keys, etc.
</dd></dl>
<dl><dd> If this is not an option (it is very difficult to get a monolithic kernel running, especially on systems that require closed-source drivers), you can perform a manual audit. I provide a couple Linux kernel modules that can aid in the auditing process. They will help you check for common ways rootkit modules hide themselves, and also can help you to ensure your kernel syscall path has not been tampered with. The ideas are based on <a href="http://www.securityfocus.com/infocus/1811" class='external text' title="http://www.securityfocus.com/infocus/1811" rel="nofollow">this Security Focus article</a> and this article on <a href="http://la-samhna.de/library/rootkits/basics.html#FLOW" class='external text' title="http://la-samhna.de/library/rootkits/basics.html#FLOW" rel="nofollow">rootkit operation</a>. All methods discussed there can be examined with those modules. The reason I created these modules is that Fedora's policy of disabling /dev/kmem has broken <a href="http://la-samhna.de/library/rootkits/detect.html" class='external text' title="http://la-samhna.de/library/rootkits/detect.html" rel="nofollow">existing utilities</a> that performed these functions. In particular, <a href="http://la-samhna.de/samhain/" class='external text' title="http://la-samhna.de/samhain/" rel="nofollow">samhain</a> is capable of performing these checks automatically for you on non-Fedora and *BSD systems.
</dd></dl>
<dl><dd> Once you know your kernel hasn't been subverted, you can check the output of <b>netstat -natup</b> to see if any strange programs have established network connections to external hosts. <b>ps xa</b> will show you all the processes running on your system. If you don't recognize something, scroogle it.
</dd></dl>
<dl><dd> To help watch for modification of your userland programs, you can run <a href="http://www.chkrootkit.org/" class='external text' title="http://www.chkrootkit.org/" rel="nofollow">Chkrootkit</a> and/or <a href="http://www.rootkit.nl/projects/rootkit_hunter.html" class='external text' title="http://www.rootkit.nl/projects/rootkit hunter.html" rel="nofollow">Rootkit Hunter</a>, and also periodically run <b>rpm -Va</b> to verify checksums of your installed packages. <a href="http://www.tripwire.org/" class='external text' title="http://www.tripwire.org/" rel="nofollow">TripWire</a> and <a href="http://aide.sf.net/" class='external text' title="http://aide.sf.net/" rel="nofollow">AIDE</a> are also options for maintaining system integrity.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=3" title="Intrusive Surveillance">edit</a>]</div><a name="Mac_OS_X"></a><h3> Mac OS X </h3>
<dl><dd> If you have a second Mac, the easiest way to scan for a rootkit that is hiding files is to run an <b>ls -laR / > dirty.list</b> on your live system and compare this to an ls -laR /path/to/disk > clean.list run from a "clean" Mac that has mounted your hard disk drive in <a href="http://guides.macrumors.com/Target_Disk_Mode" class='external text' title="http://guides.macrumors.com/Target Disk Mode" rel="nofollow">Target Disk Mode</a>. The command line utility <i>diff -u clean.list dirty.list</i> can be used to compare the two listings. Compiling the utility <a href="http://furius.ca/xxdiff/" class='external text' title="http://furius.ca/xxdiff/" rel="nofollow">xxdiff</a> may make this easier, but you have to run it in the <a href="http://www.apple.com/macosx/features/x11/" class='external text' title="http://www.apple.com/macosx/features/x11/" rel="nofollow">X windows emulator</a>, which is painful.
</dd></dl>
<dl><dd> As far as live inspection and countermeasures, unfortunately, Mac OS doesn't have the advantage Linux has in being able to compile a monolithic kernel. This means that it is much more difficult to ensure that your system integrity is still valid. Just like on Linux, it is possible to write a kernel extension that goes in and verifies that none of the system calls have been hooked, and that the keyboard interrupt vector is still intact, but I don't think such a extension has been written yet. FIXME_MAC: any takers? FIXME_MAC: how about gdb + the syscall table? Is there a map file?
</dd></dl>
<dl><dd> There is a piece of malware that exists for Mac OS X called <a href="http://www.macintouch.com/opener.html" class='external text' title="http://www.macintouch.com/opener.html" rel="nofollow">Opener</a>. It functions as a trojan, spyware, and a keylogger. It's worth searching your filesystem for it's presence. FIXME_MAC: more details on how it works..
</dd></dl>
<dl><dd> However, since opener is not a kernel-level rootkit, it can be detected with system monitoring software such as <a href="http://brianhill.dyndns.org/site/modules.php?op=modload&amp;name=News&amp;file=article&amp;sid=5&amp;mode=thread&amp;order=0&amp;thold=0" class='external text' title="http://brianhill.dyndns.org/site/modules.php?op=modload&amp;name=News&amp;file=article&amp;sid=5&amp;mode=thread&amp;order=0&amp;thold=0" rel="nofollow">CheckMate</a>. Additionally, you can check for suspicious TCP and UDP connections via <b>lsof -i TCP -i UDP</b>. However, note that kernel-level rootkits like <a href="http://packetstorm.security-guide.de/filedesc/wX.tar.html" class='external text' title="http://packetstorm.security-guide.de/filedesc/wX.tar.html" rel="nofollow">WeaponX</a> are able to make themselves invisible from these checks.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=4" title="Intrusive Surveillance">edit</a>]</div><a name="Windows"></a><h3> Windows </h3>
<dl><dd> There are a few rootkits for Windows available which are capable of hiding processes, services, files, etc. In addition, most rootkits come with some form of device driver that is installed in order for them to do their cloaking by directly manipulating kernel objects.
</dd></dl>
<dl><dd> For general rootkit detection, Sysinternals puts out a tool called <a href="http://www.sysinternals.com/Utilities/RootkitRevealer.html" class='external text' title="http://www.sysinternals.com/Utilities/RootkitRevealer.html" rel="nofollow">Rootkit Revealer</a> that uses various Windows APIs to check for inconsistencies (ie comparing raw registry data to API reported, etc). It does not use this information to detect rootkits by name, but instead prints a list of anomalies. If you have a clever rootkit implementer, be aware that they can hide among the noise.
</dd></dl>
<dl><dd> If you are interested in looking for hidden files, or executables, your best bet is to create a bootable CDROM from your Windows XP install media. You can then look through your directories after booting from this CD and ensure they match your system under normal boot. UBCD has a tool called <a href="http://www.ubcd4win.com/forum/index.php?showtopic=2424" class='external text' title="http://www.ubcd4win.com/forum/index.php?showtopic=2424" rel="nofollow">RootKitty</a> which basically compares file listings of your computer from the CD versus while it is running on a normal boot.
</dd></dl>
<dl><dd> Specific rootkit removal tools exist also. Currently the most popular of these are <a href="http://www.f-secure.com/blacklight/" class='external text' title="http://www.f-secure.com/blacklight/" rel="nofollow">BlackLight</a> and <a href="http://xfocus.net/tools/200509/1085.html" class='external text' title="http://xfocus.net/tools/200509/1085.html" rel="nofollow">ICESword</a> which both check for changes made to kernel memory to detect rootkits like FU, as well as hooks to functions in kernel space. In 3rd place is <a href="http://www.rootkit.com/vault/fuzen_op/vice.zip" class='external text' title="http://www.rootkit.com/vault/fuzen op/vice.zip" rel="nofollow">VICE</a>, which checks for hooks in commonly targeted kernel and userland functions. The main issue with VICE is that for usermode, it will spew out one hell of a lot of false positives, as it is common for the Windows DLLs to "hook" one another.
</dd></dl>
<dl><dd> The <a href="http://bagpuss.swan.ac.uk/comms/RKDetectorv0%5B1%5D.62.zip" class='external text' title="http://bagpuss.swan.ac.uk/comms/RKDetectorv0[1].62.zip" rel="nofollow">RKDetector</a> utility linked off of this <a href="http://bagpuss.swan.ac.uk/comms/hxdef.htm" class='external text' title="http://bagpuss.swan.ac.uk/comms/hxdef.htm" rel="nofollow">Hacker Defender Removal</a> page is also pretty nice. While it has been written primarily to detect the <a href="http://hxdef.czweb.org/download.php" class='external text' title="http://hxdef.czweb.org/download.php" rel="nofollow">Hacker Defender</a> rootkit, it is also capable of finding hidden processes and services that may have been cloaked by other rootkits (such as <a href="http://www.rootkit.com/project.php?id=12" class='external text' title="http://www.rootkit.com/project.php?id=12" rel="nofollow">FU</a>).
</dd></dl>
<dl><dd> Also available is <a href="http://www.greatis.com/unhackme/download.htm" class='external text' title="http://www.greatis.com/unhackme/download.htm" rel="nofollow">UnHackMe</a>, a shareware tool designed for <a href="http://www.greatis.com/unhackme/afxrootkitremoval.htm" class='external text' title="http://www.greatis.com/unhackme/afxrootkitremoval.htm" rel="nofollow">AFX removal</a>.
</dd></dl>
<dl><dd> Lastly, just like Linux and Mac OS, Windows enables you to list active Internet connections and their associated processes. <b>netstat -nab</b> should do the trick.
</dd></dl>
<dl><dd> FIXME_WIN32: Do AppInit_DLLs show up in procexp? How about other injected code? How do you know what is injected? 
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=5" title="Intrusive Surveillance">edit</a>]</div><a name="Keyloggers_and_Spyware"></a><h2> Keyloggers and Spyware </h2>
<p>If someone is out to spy on you, by far the most likely thing they will do is install a keylogger. Some keyloggers can be easy to find, some almost impossible. There are two types of keyloggers, software and hardware.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=6" title="Intrusive Surveillance">edit</a>]</div><a name="Hardware"></a><h3> Hardware </h3>
<p>The main thing to watch for is an <a href="http://www.thinkgeek.com/gadgets/electronic/5a05/" class='external text' title="http://www.thinkgeek.com/gadgets/electronic/5a05/" rel="nofollow">extra extension jack</a> coming <a href="http://www.amecisco.com/hkstandalone.htm" class='external text' title="http://www.amecisco.com/hkstandalone.htm" rel="nofollow">between</a> your keyboard and the back of your computer. However, also be wary of <a href="http://www.amecisco.com/normal_keyboard.htm" class='external text' title="http://www.amecisco.com/normal keyboard.htm" rel="nofollow">internally installable</a> keyloggers. If your physical environment can't be trusted (note that depending on your situation, this may or may not include your home), buy a new keyboard and seal it with epoxy, or some tamper evident mechanism. Also periodically check the inside of your computer for dangling pieces of electronics coming between your keyboard port and your motherboard. Normally there should only be wires or nothing at all. People have been prosecuted using keylogged data as evidence.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=7" title="Intrusive Surveillance">edit</a>]</div><a name="Software"></a><h3> Software </h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=8" title="Intrusive Surveillance">edit</a>]</div><a name="Windows_2"></a><h4> Windows </h4>
<dl><dd> Your best bet for guarding against software keyloggers in Windows is to install some form of anti-spyware software. My personal favorites are <a href="http://www.pctools.com/spyware-doctor/" class='external text' title="http://www.pctools.com/spyware-doctor/" rel="nofollow">Spyware Doctor</a>, <a href="http://www.microsoft.com/athome/security/spyware/software/default.mspx" class='external text' title="http://www.microsoft.com/athome/security/spyware/software/default.mspx" rel="nofollow">Microsoft's AntiSpyware</a>, <a href="http://www.lavasoftusa.com/software/adaware/" class='external text' title="http://www.lavasoftusa.com/software/adaware/" rel="nofollow">AdAware</a> and <a href="http://www.safer-networking.org/en/download/" class='external text' title="http://www.safer-networking.org/en/download/" rel="nofollow">SpyBot</a> (in that order), since they all provide free versions that are fully capable of removing spyware they discover and also have received good reviews on the web. Although I have not tried it, Symmatec's Antivirus+AntiSpyware is <a href="http://www.zdnet.com.au/reviews/software/security/0,39023452,39225147-9,00.htm" class='external text' title="http://www.zdnet.com.au/reviews/software/security/0,39023452,39225147-9,00.htm" rel="nofollow">supposedly very good</a> as well, though pricey.
</dd></dl>
<dl><dd> Because these scanners are unlikely to detect custom spyware, you probably should also give  Sysinternals AutoRuns a try, to catch anything that may be scheduled to run that has not been signed/verified. And of course, don't forget to use the techniques discussed in the rootkits section to detect anything that may be attempting to hide itself via a rootkit.
</dd></dl>
<dl><dd> For the technically curious and/or those concerned about custom keyloggers, there are two main types of windows keyloggers:
</dd></dl>
<ol><li> Message-Hook Based
<dl><dd> Being relatively <a href="http://www.codeguru.com/Cpp/W-P/system/keyboard/article.php/c5699/" class='external text' title="http://www.codeguru.com/Cpp/W-P/system/keyboard/article.php/c5699/" rel="nofollow">easy to code</a>, message-hook based keyloggers are the most common form available. It is estimated they comprise 90% of keylogger installs.
</dd><dd> Their simplistic nature means that they are relatively easy to detect as well. Follow the same steps involved in looking for a Windows root kit: Check for strange processes, and check the AppInit_Dlls registry key. Alternatively, you could install <a href="http://www.anti-keyloggers.com/download.html" class='external text' title="http://www.anti-keyloggers.com/download.html" rel="nofollow">this anti-keylogger</a>. It will run for 4 hours per reboot for 10 reboots before you have to pay for the registered version. It actually watches members of your message queues and notifies you when processes attach to listen for events. FIXME_WIN32: Are there more subtle ways to inject DLLs using hooks such that you can hijack, say, explorer.exe to do your keylogging? Yes. How do we enumerate them? SetWindowsHookEx with WM_DEBUG. Also&nbsp;!chkimg in kd.. <a href="https://secure.codeproject.com/system/KeyLogger.asp" class='external text' title="https://secure.codeproject.com/system/KeyLogger.asp" rel="nofollow">CodeMe</a>.
</dd></dl>
</li><li> Device Driver Based
<dl><dd>
</dd><dd> To date, I've only run into one <a href="http://www.amecisco.com/iks2000.htm" class='external text' title="http://www.amecisco.com/iks2000.htm" rel="nofollow">commercially available implementation</a> of a device driver based keylogger on Windows. Basically the way it works is it hooks itself onto your keyboard device driver and then writes the keys to a file, which can be viewed with an external program.
</dd><dd> While in theory a kernel mode driver can be made next to impossible to detect, in this case it is quite easy to find. You have a few options. The easiest thing to do is go to Control Panel, click on Keyboard, and then click on the "Driver Details..." button. That will list all the .sys files involved in making your keyboard work. The ones with a green checkmark are signed by Microsoft, and clicking on them will tell you so. If you see any that lack a green checkmark, they are most likely a keylogger. Alternatively, you can run <b>regedit.exe</b> to search your registry under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class for either "Keyboard" or "kbdclass". This is where all your device drivers live. Once you find the keyboard driver, check to make sure it ONLY has kbdclass under the UpperFilters value. If it has anything else after kbdclass (specifically the unsigned driver from control panel) edit it and remove it. Then search again for that name under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services and delete any subtrees that come up. FIXME_WIN32: Screenshots 
</dd></dl>
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=9" title="Intrusive Surveillance">edit</a>]</div><a name="Linux_2"></a><h4> Linux </h4>
<dl><dd> For Linux, the rootkit detection techniques described above apply for keyloggers as well. Most Linux keyloggers will take the form of rootkits. Also, you should watch out for trojaned binaries (use <b>rpm -Va</b> or install <a href="http://www.tripwire.org/" class='external text' title="http://www.tripwire.org/" rel="nofollow">tripwire</a> or <a href="http://aide.sf.net/" class='external text' title="http://aide.sf.net/" rel="nofollow">AIDE</a>), especially ssh. You should also keep an eye on your aliases and shell rc files (eg ~/.bashrc and ~/.bash_profile) to make sure no one is sneaking an LD_PRELOADed library in on you. Last, but <i>DEFINITELY</i> not least, you want to make sure your ~/.Xauthority file is not world readable, and that you don't have any bizarre xhost entries. It is possible to remotely <a href="http://hpux.connect.org.uk/hppd/hpux/X11/Networking/xwatchwin-1.1.1/" class='external text' title="http://hpux.connect.org.uk/hppd/hpux/X11/Networking/xwatchwin-1.1.1/" rel="nofollow">capture X events</a> (and thus <a href="http://www.acm.vt.edu/~jmaxwell/programs/xspy/xspy.html" class='external text' title="http://www.acm.vt.edu/~jmaxwell/programs/xspy/xspy.html" rel="nofollow">keystrokes</a>). 
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=10" title="Intrusive Surveillance">edit</a>]</div><a name="General_Techniques_Against_Keyloggers"></a><h3> General Techniques Against Keyloggers </h3>
<p>Keyloggers are typically pretty blind. Especially kernel and hardware keyloggers. If you are at a machine you cannot trust and do not feel like making it trustworthy, you do have some options to at least protect your passwords. For example, switching windows mid-password, cutting and pasting characters, and using the mouse to delete sections of text randomly are all effective against hardware and kernel keyloggers, which will only focus on actual keyboard events.
</p><p>Message-hook and other application-level keyloggers can also be fooled in this way, but they can attempt to do things like sort keystrokes by destination window, target only specific apps, take screenshots, and even attempt to capture cut and paste events. In fact, most commercially available software keyloggers have advanced to the point where they are able to track both cut and paste activity and sort keystrokes according to their destination window. You can still attempt to confuse them by entering keys into other fields in the same window, however.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=11" title="Intrusive Surveillance">edit</a>]</div><a name="Watching_Your_Back"></a><h2> Watching Your Back </h2>
<p>Ok, now that we know how to find and remove keyloggers and rootkits, we're going to talk about how to use them to conceal what you are doing, and to watch for evidence of nosy coworkers. Using <a href="http://hxdef.czweb.org/download.php" class='external text' title="http://hxdef.czweb.org/download.php" rel="nofollow">Hacker Defender</a> with this config file will hide an OpenVPN installation. copy <b>c:\windows\system32\cmd.exe Desktop\mycmd.exe</b> will give you a command shell on your desktop that is still able to see the Hacker Defender config files.
</p><p>Be aware that antivirus software may detect hacker defender, especially before it has a chance to run. The README advises you insert &lt;, &gt;, ", and &amp; characters randomly into the config file fields to help avoid detection, though obviously this is not fool proof. To conceal the Hacker Defender executable, you may wish to run it through <a href="http://hxdef.czweb.org/download.php" class='external text' title="http://hxdef.czweb.org/download.php" rel="nofollow">Morphine</a>, which is an executable encryptor. Even this is probably not foolproof, so use with caution if you are in an environment where the network administrator receives virus information on your PC.
</p><p>FIXME: In a future revision, write up how to turn a webcam (and/or audio mic) into a security camera, to watch over your computer while you are gone in order to catch a 3rd party in the act of installing/retrieving a hardware or software keylogger at your computer. An <a href="http://www.engadget.com/2005/02/22/how-to-turn-your-laptop-into-a-home-security-system/" class='external text' title="http://www.engadget.com/2005/02/22/how-to-turn-your-laptop-into-a-home-security-system/" rel="nofollow">excellent writeup for Mac OS</a> can be found at engadget. For Linux there is <a href="http://gspy.sourceforge.net/" class='external text' title="http://gspy.sourceforge.net/" rel="nofollow">Gspy</a>, <a href="http://www.geocities.com/neofpo/scrap.html" class='external text' title="http://www.geocities.com/neofpo/scrap.html" rel="nofollow">SCRAP</a>, and <a href="http://www.lavrsen.dk/twiki/bin/view/Motion/WebHome" class='external text' title="http://www.lavrsen.dk/twiki/bin/view/Motion/WebHome" rel="nofollow">Motion</a>. A HOWTO on building a mini computer dedicated just to video surveillance on Linux is available at <a href="http://www.magicitx.com/zoneminder/installation/part1.html" class='external text' title="http://www.magicitx.com/zoneminder/installation/part1.html" rel="nofollow">MagicITX</a>. Windows??
</p><p>On Windows, it is also possible to install monitoring software such as those <a href="http://www.programurl.com/software/spy4.htm" class='external text' title="http://www.programurl.com/software/spy4.htm" rel="nofollow">listed here</a> to monitor your computer. Promising candidates include <a href="http://www.ematrixsoft.com/pcspy.htm" class='external text' title="http://www.ematrixsoft.com/pcspy.htm" rel="nofollow">PCSpy</a>, <a href="http://www.benutec.com/products/spymypc/" class='external text' title="http://www.benutec.com/products/spymypc/" rel="nofollow">SpyMyPC</a>, <a href="http://www.relytec.com/" class='external text' title="http://www.relytec.com/" rel="nofollow">All in One Keylogger</a> and <a href="http://www.blazingtools.com/bpk.html" class='external text' title="http://www.blazingtools.com/bpk.html" rel="nofollow">BlazingTools Perfect Keylogger</a>.
</p><p>FIXME_WIN32: maybe also write a section on how to elevate privs on your own machine. Can OpenVPN be installed from a BartPE? Many people will not have Administrator access on their machines. Test on vmware. You probably can't add yourself to Administrators, since that is a Domain group.. Can you create a RunAs.. shell?
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=12" title="Intrusive Surveillance">edit</a>]</div><a name="Throwaway_Computing"></a><h2> Throwaway Computing </h2>
<p>In certain situations where you have freedom over the computer but do not trust it, you might consider using a bootable CD. The obvious choice is <a href="http://www.knoppix.org/" class='external text' title="http://www.knoppix.org/" rel="nofollow">Knoppix</a> or a <a href="http://www.knoppix.net/wiki/Knoppix_Customisations" class='external text' title="http://www.knoppix.net/wiki/Knoppix Customisations" rel="nofollow">Knoppix derivative</a>. I prefer <a href="http://new.remote-exploit.org/index.php/Auditor_main" class='external text' title="http://new.remote-exploit.org/index.php/Auditor main" rel="nofollow">Auditor Linux</a> since it automatically supports my wireless card (unlike Knoppix) and comes with lots of useful security tools right on disc. It is possible to customize Knoppix using a USB key, so a Knoppix CD+tor on your USB key might be helpful if you frequently find yourself in shady labs. The <a href="http://www.knoppix.net/wiki/Wish_List" class='external text' title="http://www.knoppix.net/wiki/Wish List" rel="nofollow">Knoppix Wishlist</a> includes Tor, so maybe that will happen someday.
</p><p>For pre-configured, pre-tested Tor environments, you can try out <a href="http://theory.kaos.to/projects.html" class='external text' title="http://theory.kaos.to/projects.html" rel="nofollow">Anonym.OS</a>, which is an OpenBSD-based boot cd that includes Tor and has everything preconfigured to use it. Alternatively, you can save yourself some effort and <a href="http://www.virtualprivacymachine.com/products.html" class='external text' title="http://www.virtualprivacymachine.com/products.html" rel="nofollow">purchase a bootable USB Key with Tor and other privacy software pre-installed</a>.
</p><p>Alternatively, you can build a <a href="http://www.nu2.nu/pebuilder/" class='external text' title="http://www.nu2.nu/pebuilder/" rel="nofollow">BartPE image</a> for the same purpose if you prefer Windows. While there are <a href="http://www.reatogo.de/BartPE/BartPE_plugins/repository.htm" class='external text' title="http://www.reatogo.de/BartPE/BartPE plugins/repository.htm" rel="nofollow">a couple</a> of <a href="http://www.bootcd.us/BartPE_Plugins_Repository.php" class='external text' title="http://www.bootcd.us/BartPE Plugins Repository.php" rel="nofollow">massive plugin</a> directories, my favorite route is to use The <a href="http://www.ubcd4win.com/" class='external text' title="http://www.ubcd4win.com/" rel="nofollow">UBCD Installer</a> (which contains many of those plugins) and then just keep any extra apps I want (such as Tor) on my USB Key. The <a href="http://torpark.nfshost.com/" class='external text' title="http://torpark.nfshost.com/" rel="nofollow">TorPark project</a> is excellent for this purpose.
</p><p>Either of these methods provide maximum protection and assurance against software trojans and viruses. In addition, you automatically get protection against cookie logging and browser history data for free.
</p><p>An alternate (and possibly more convenient for home use) method is to use <a href="http://www.vmware.com/" class='external text' title="http://www.vmware.com/" rel="nofollow">VMWare</a> (or <a href="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/" class='external text' title="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/" rel="nofollow">Xen</a>) to create an innocuous looking operating system to interact with the real world. This has the advantage that if you need to use your original setup for something, you can, but for all other communications you have a system that you wouldn't mind being attacked. Furthermore, VMWare has a feature that allows you revert to a known safe snapshot of the OS at any time, which can be useful to ensure you haven't been trojaned or acquired any persistent cookies during your session. The snapshot feature of Xen is still in development, but <a href="http://wiki.xensource.com/xenwiki/COWHowTo" class='external text' title="http://wiki.xensource.com/xenwiki/COWHowTo" rel="nofollow">various hacks</a> are possible to get the same effect.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=13" title="Intrusive Surveillance">edit</a>]</div><a name="Search_and_Seizure"></a><h2> Search and Seizure </h2>
<p>The last and most perilous threat to your privacy is when The Man <a href="http://www.ipsnews.net/interna.asp?idnews=25889" class='external text' title="http://www.ipsnews.net/interna.asp?idnews=25889" rel="nofollow">busts in</a> and <a href="http://www.indymedia.org.uk/en/2005/06/315041.html" class='external text' title="http://www.indymedia.org.uk/en/2005/06/315041.html" rel="nofollow">takes all your gear</a> (and they will take <a href="http://geeksunite.net/" class='external text' title="http://geeksunite.net/" rel="nofollow">all of it</a>). This sucks, and will often leave you without computer equipment for the <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IID2_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IID2 " rel="nofollow">better part of a year</a>. There are <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IIC1_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IIC1 " rel="nofollow">limits on scope</a> of warrants, but the courts have proved to err on the side of The Man. Of course, it is always advisable to practice good Kung Foo so that he's never able to trace you in the first place, but luck favors the prepared. You never know when <a href="http://www.freepickard.org/skinner.html" class='external text' title="http://www.freepickard.org/skinner.html" rel="nofollow">some scumbag</a> decides to turn states evidence, or some enemy of yours <a href="https://tips.fbi.gov/" class='external text' title="https://tips.fbi.gov/" rel="nofollow">decides</a> it might be funny to see you sweat out an investigation for no reason. As such, lets spend a bit of time discussing how search and seizure functions in the US.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=14" title="Intrusive Surveillance">edit</a>]</div><a name="Warranted_and_Warrantless_Search"></a><h3> Warranted and Warrantless Search </h3>
<p>There are several methods by which an Agent can obtain the legal right to search and seize your digital goods, most of which are conveniently outlined in the US DOJ <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm" rel="nofollow">Search and Seizure Manual</a> (local copy). There are a couple instances where they can get away with searching you WITHOUT A WARRANT that you might not have anticipated:
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=15" title="Intrusive Surveillance">edit</a>]</div><a name="Private_Searches"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IB4_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IB4 " rel="nofollow">Private Searches</a> </h4>
<dl><dd> These are probably the most dangerous type of warrantless search, because it is most likely to catch you off guard. Essentially a private search is a search conducted by <a href="https://tips.fbi.gov/" class='external text' title="https://tips.fbi.gov/" rel="nofollow">someone</a> who is not acting as an agent of the government (ie <a href="http://www.govexec.com/dailyfed/0405/042905nj1.htm" class='external text' title="http://www.govexec.com/dailyfed/0405/042905nj1.htm" rel="nofollow">a vigilante</a>). In this case, a neighbor, roommate, officemate, janitor, repairman, maid, sysadmin, etc can be snooping around on your computer, discover what they might think is criminal evidence (such as this HOWTO&nbsp;:), and call the police. The police are then legally authorized to repeat the search conducted by the private citizen without warrant (unless it was a search of a residence), and arrest you for both the original and any additional contraband (within the scope of the original search). Bad news all around.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=16" title="Intrusive Surveillance">edit</a>]</div><a name="Searches.2FConsent_by_Employers.2FCoworkers"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_ID1_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# ID1 " rel="nofollow">Searches/Consent by Employers/Coworkers</a> </h4>
<dl><dd> In this case, not only can employers and coworkers conduct "private searches", but they can also consent to search of your office space for you. How nice. Don't forget: you're their slave, coppertop.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=17" title="Intrusive Surveillance">edit</a>]</div><a name="Implied_Consent"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IC1c_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IC1c " rel="nofollow">Implied Consent</a> </h4>
<dl><dd> This is another beauty. If you've signed away or otherwise have been warned of a reduced right to privacy (ie through a work contract or login banner), you can be considered to implicitly consent to search. I wonder if this is why AOL changed its <a href="http://www.benstanfield.com/thrash/2005/03/aol_eavesdrops_.html" class='external text' title="http://www.benstanfield.com/thrash/2005/03/aol eavesdrops .html" rel="nofollow">Terms of Service</a> (before changing them back due to prompt public outcry, and zero corporate media coverage).
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=18" title="Intrusive Surveillance">edit</a>]</div><a name="Exigent_Searches"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IC2_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IC2 " rel="nofollow">Exigent Searches</a> </h4>
<dl><dd> If the feds have reason to believe that there is extreme urgency in obtaining the data due to either danger to person or threat of its destruction, they can search without a warrant. Thankfully "laptop batteries might be about to run out" was ruled not to be an exigent circumstance. But note that some Agent did try to use that as an excuse.. Gotta love The Man.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=19" title="Intrusive Surveillance">edit</a>]</div><a name="No-Knock.2F.22Sneak_and_Peak.22_Searches"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IIB5_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IIB5 " rel="nofollow">No-Knock/"Sneak and Peak" Searches</a> </h4>
<dl><dd> If the feds can show that there is either danger of violence or threat of destruction of evidence if they announce their search, they can obtain a "No-Knock" warrant, which allows them to barge right in if you are home or not. Also, with the passage of the Patriot Act, they are also able to conduct "Sneak and Peak" searches. Typically "Sneak and Peak" search cannot involve seizure, and the authorities must typically notify you within 90 days. For defensive techniques against "Sneak and Peak" searches, consult the section on watching your back.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=20" title="Intrusive Surveillance">edit</a>]</div><a name="Subpoena_of_ISP_Records"></a><h4> <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IIID1_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IIID1 " rel="nofollow">Subpoena of ISP Records</a> </h4>
<dl><dd> A subpoena is a court order to testify or produce evidence. The downside is it can be used if you are not suspected of a crime but instead may only have evidence relating to a crime. It is possible for the feds to obtain your ISP records, files, and "opened" emails via subpoena. However, they do have to notify you of this fact immediately, <a href="http://www.cybercrime.gov/s&amp;smanual2002.htm#_IIIG2_" class='external text' title="http://www.cybercrime.gov/s&amp;smanual2002.htm# IIIG2 " rel="nofollow">unless</a> there is fear of danger to person, flight, destruction of evidence, or otherwise jeopardizing the investigation.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=21" title="Intrusive Surveillance">edit</a>]</div><a name="Deception_of_Purpose"></a><h4> <a href="http://anonymity-portal.us/matrixmirror/misc/94JAN006-ConsentToSearchViaDeception.TXT" class='external text' title="http://anonymity-portal.us/matrixmirror/misc/94JAN006-ConsentToSearchViaDeception.TXT" rel="nofollow">Deception of Purpose</a> </h4>
<dl><dd> This little doosey was a fun one to discover. <a href="http://www.howtobeinvisible.com/" class='external text' title="http://www.howtobeinvisible.com/" rel="nofollow">How to Be Invisible</a> cites a <a href="http://anonymity-portal.us/matrixmirror/misc/94JAN006-ConsentToSearchViaDeception.TXT" class='external text' title="http://anonymity-portal.us/matrixmirror/misc/94JAN006-ConsentToSearchViaDeception.TXT" rel="nofollow">January 1994 FBI Law Enforcement Bulletin</a> that states agents may disguise themselves as utility repairmen, delivery personnel, distressed motorists, etc, and ask for entrance into your home to make a phone call, look up something on the web, etc. Once you grant them entrance, anything they happen to see (or claim to smell) in plain view can be used to go back and get an actual warrant. Good times!
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=22" title="Intrusive Surveillance">edit</a>]</div><a name="Trash_Inspection"></a><h4> Trash Inspection </h4>
<dl><dd> Ruling that there is no expectation of privacy for discarded items, the Supreme Court has held that trash is not protected by the 4th amendment. This ruling has allowed the government to tell garbage collectors that certain trash bins are to be delivered directly to their doorstep, without warrant. They do not even have to collect it themselves.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=23" title="Intrusive Surveillance">edit</a>]</div><a name="Retroactive_FISA_Warrants"></a><h4> <a href="http://www.fff.org/comment/com0601c.asp" class='external text' title="http://www.fff.org/comment/com0601c.asp" rel="nofollow">Retroactive FISA Warrants</a> </h4>
<dl><dd> The USA Patriot Act has expanded the ability for the FBI to obtain secret warrants against "terrorism" suspects. At the direction of the Attorney General, the FBI is able to conduct a secret search of your residence, phone communications, and/or Internet activity and then 72 hours later, apply for a secret search warrant to do so from the FISA court. Since the FISA court is secret, and has only turned down <a href="http://www.dailykos.com/story/2005/12/19/12305/484" class='external text' title="http://www.dailykos.com/story/2005/12/19/12305/484" rel="nofollow">4 requests in the past 5 years</a>, this power has essentially destroyed any guarantee against unreasonable search. The Patriot Act also amended <a href="http://www4.law.cornell.edu/uscode/html/uscode18/usc_sec_18_00002518----000-.html" class='external text' title="http://www4.law.cornell.edu/uscode/html/uscode18/usc sec 18 00002518----000-.html" rel="nofollow">18 USC 2518-7</a> to allow for "specially designated" law enforcement officers to conduct warrantless search and surveillance for 36 hours in situations of suspicion of organized crime, national security interest, and threat of serious physical injury to a person.
</dd></dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=24" title="Intrusive Surveillance">edit</a>]</div><a name="Search_of_Corporate_Records"></a><h4> <a href="http://www.reason.com/0311/fe.jb.show.shtml" class='external text' title="http://www.reason.com/0311/fe.jb.show.shtml" rel="nofollow">Search of Corporate Records</a> </h4>
<dl><dd> In an <a href="http://consumerlawpage.com/article/privacy.shtml" class='external text' title="http://consumerlawpage.com/article/privacy.shtml" rel="nofollow">astounding display</a> of new advances in Constitutional interpretation, the <a href="http://supreme.justia.com/us/425/435/" class='external text' title="http://supreme.justia.com/us/425/435/" rel="nofollow">Supreme Court ruled</a> in 1976 that since corporations are not natural persons, they (nor even their owners!) enjoy any protection from the search and seizure of their records. My oh my, that certainly makes it convenient to fetch just about any information on anyone. With this ruling, the US government is able to enumerate just about everything in your home simply by demanding purchase records from your credit card company. The ruling also extends to <a href="http://www.eff.org/Censorship/Indymedia/" class='external text' title="http://www.eff.org/Censorship/Indymedia/" rel="nofollow">subpoenas of logs and other files</a> at colocation providers, and also provides the basis for the "constitutionality" of National Security Letters. 
</dd></dl>
<p>It should also be noted that anything uncovered while executing a warrant is admissible in court, even if it was not what the agents were looking for.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=25" title="Intrusive Surveillance">edit</a>]</div><a name="Civil_Procedure"></a><h3> Civil Procedure </h3>
<p>In addition to the above, you need to be at least peripherally aware of the <a href="http://cyber.law.harvard.edu/digitaldiscovery/digdisc_library_4.html" class='external text' title="http://cyber.law.harvard.edu/digitaldiscovery/digdisc library 4.html" rel="nofollow">rules of discovery</a> in <a href="http://www.law.cornell.edu/wex/index.php/Civil_procedure" class='external text' title="http://www.law.cornell.edu/wex/index.php/Civil procedure" rel="nofollow">civil procedure</a>, especially if it is likely that someone may seek to sue you for damages instead of (or in addition to) pressing charges. In civil procedure, if there is reason to believe that you may have evidence supporting the plaintiffs claim, the process of discovery enables them to demand evidence/records from you. If you destroy this evidence, then not only are you potentially liable for criminal charges, but the plaintiff also is allowed to assume that the destroyed records contained the proof they sought. In the case of civil litigation by large corporations against individual people, the police are sometimes called in to immediately seize relevant materials without warning. Isn't that great?
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=26" title="Intrusive Surveillance">edit</a>]</div><a name="Encrypted_Filesystems"></a><h2> Encrypted Filesystems </h2>
<p>The solution to these perils hinges on cryptography, and each system has its own way of accomplishing this. Depending upon your threat model for The Man, you may want different levels of assuredness that he cannot obtain your data. As described above, your two main classes of threat are civil action, and criminal action.
</p><p>In the case of threat of civil action, it may be desirable to employ some form of steganographic filesystem so that the process of discovery cannot be used to assume you have destroyed incriminating evidence. Your best bet for this is <a href="http://www.freeotfe.org/" class='external text' title="http://www.freeotfe.org/" rel="nofollow">FreeOTFE</a>, which has an appealing hidden volume mode which can provide deniability for civil situations where you are compelled to give up the key during discovery. It exists for Windows, Windows Mobile, and is fully compatible with Linux.
</p><p>In a criminal situation the rules are a bit different. In the US, you may have some luck in claiming that your encryption key is protected by your <a href="http://en.wikipedia.org/wiki/United_States_Constitution/Amendment_Five" class='external text' title="http://en.wikipedia.org/wiki/United States Constitution/Amendment Five" rel="nofollow">5th amendment right</a> to not incriminate/testify against yourself. However, be aware that if you are subpoenaed to testify against another individual, you can be ordered to give up their key, unless they are <a href="http://www.law.upenn.edu/bll/ulc/ure/ev505.htm" class='external text' title="http://www.law.upenn.edu/bll/ulc/ure/ev505.htm" rel="nofollow">your spouse</a>. In the event that you are ordered to testify against someone else, you can request <a href="http://en.wikipedia.org/wiki/United_States_Constitution/Amendment_Five#Grants_of_immunity" class='external text' title="http://en.wikipedia.org/wiki/United States Constitution/Amendment Five#Grants of immunity" rel="nofollow">immunity</a> from the prosecution to protect you from any incriminating evidence found as a result of the key disclosure.
</p><p>Your ability to assert your 5th amendment right (and thus be eligible for immunity) ultimately rests with the decision of the judge. If he thinks your 5th amendment right does not apply to the key due to the lack of real threat of incrimination or some other twisted legal logic and you still refuse to surrender it, you can be sentenced to up to <a href="http://www.fsmlaw.org/fsm/code/title04/T04_Ch01.htm#119" class='external text' title="http://www.fsmlaw.org/fsm/code/title04/T04 Ch01.htm#119" rel="nofollow">6 months in jail</a> for contempt of court. Note that you can still be charged with contempt for refusing to obey even if you believe a higher court would rule in your favor. However, refusing to comply would get you a good deal of (most likely positive) press attention. Nobody likes to see people imprisoned for refusing to testify against themselves, even if some legal loophole would allow it.
</p><p>There has been <a href="http://news.zdnet.com/2100-1009_22-6073654.html" class='external text' title="http://news.zdnet.com/2100-1009 22-6073654.html" rel="nofollow">recent political maneuvering</a> in the UK to attempt to enable Part III of the <a href="http://rechten.uvt.nl/koops/cryptolaw/cls2.htm#uk_ripa" class='external text' title="http://rechten.uvt.nl/koops/cryptolaw/cls2.htm#uk ripa" rel="nofollow">Regulation of Investigatory Powers Act</a> to give the government the power to demand your keys even in the cases where it may incriminate you.
</p><p>This is particularly short sighted for a number of reasons, the most obvious being: the ramifications of the damage of trust in SSL certificates and banking communications; the inability to discern what is encrypted data and what is simply random application data; the inability to discover or prove with any certainty exactly how many passwords there are; the unspecified language as to whether key files count as password, and what happens if they are lost or destroyed; and the inability to prove that the subject hasn't legitimately forgotten the password (which, with the infrequent use patterns of filesystem passwords, is entirely possible and even common among users). The rest of the world should thank the UK if decides to take it upon itself to prove the stupidity of this action for us. I have no doubt that this measure cannot survive in any country with a legitimate constitution or other declaration of human rights, for good reason. Get ready, hilarity is about to ensue.
</p><p>So enough of that. Lets discuss filesystem cryptography on each of the 3 major platforms, as well how to erase data securely as you move it from non-encrypted storage to encrypted storage. As usual, *BSD users are left to <a href="http://www.netbsd.org/guide/en/chap-cgd.html" class='external text' title="http://www.netbsd.org/guide/en/chap-cgd.html" rel="nofollow">fend for themselves</a>. If anyone would like to submit a quick and dirty BSD writeup for this HOWTO, don't hesitate.
</p><p>Under all of the following systems, you will need to make one or more passwords for each encrypted volume. <i>You should avoid writing these passwords down at all costs</i>, but note that filesystem passwords are particularly easy to forget, since they are used infrequently. As mentioned above, this fact makes mandatory key disclosure particularly short sighted. It is very possible to forget filesystem keys and risk complete data loss. For this reason, you should mentally rehearse your passwords every day for several weeks after you create them to make sure you do not forget them. I consider myself fairly mentally competent, but I have still lost more than one encrypted volume after creating it because the password was used once for creation and then forgotten.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=27" title="Intrusive Surveillance">edit</a>]</div><a name="Linux_3"></a><h3> Linux </h3>
<p>There are three main cryptographic filesystem solutions for Linux: <a href="http://www.saout.de/tikiwiki/tiki-index.php" class='external text' title="http://www.saout.de/tikiwiki/tiki-index.php" rel="nofollow">LUKS</a> <a href="http://www.saout.de/tikiwiki/tiki-index.php" class='external text' title="http://www.saout.de/tikiwiki/tiki-index.php" rel="nofollow">dm-crypt</a> and <a href="http://www.truecrypt.org/" class='external text' title="http://www.truecrypt.org/" rel="nofollow">TrueCrypt</a>. LUKS and dm-crypt is included in all major distributions and are the Linus standard. If you want to use Truecrypt you'll normally have to mess around and go through the hassle of rebuilding your whole kernel to support it.
</p><p>Setting up LUKS is easy to do and their wiki has several good HOWTOs.
</p><p>To protect against the legal snafus mentioned above, I prefer a bit different approach than that given on the Wiki for actual device creation. I prefer to use GPG to encrypt the filesystem key, and have the passphrase I type into the keyboard be the password to the GPG key. This enables you to change the password without having to rebuild the filesystem. It also enables you to carry the key with you on a <a href="http://www.swissbit.com/" class='external text' title="http://www.swissbit.com/" rel="nofollow">USB microdrive</a> to ensure its safety and also to prevent anyone from mounting the fs even if they know the password. In emergency situations, the USB key can be destroyed, and the data can never be recovered. In this way, you can be in full compliance with a court order requiring the password for the filesystem and still not reveal your data. Note that if you destroy a key after a court demands to see it (or simply refuse to give up the password) you can be held in contempt of court and sentenced to jail time (in the US, this is <a href="http://www.fsmlaw.org/fsm/code/title04/T04_Ch01.htm#119" class='external text' title="http://www.fsmlaw.org/fsm/code/title04/T04 Ch01.htm#119" rel="nofollow">6 months or less</a>, however). However, if the key/data is a substantial portion of the prosecution's case, and the sentence you are facing is more than 6 months (or if you are a hardcore civil libertarian type), you may want to tell them to fuck off anyway. Probably would get you a good deal of (most likely positive) press attention. Nobody likes to see people imprisoned for refusing to testify against themselves, even if some legal loophole would allow it.
</p>
<dl><dt> <b>Note</b>
</dt></dl>
<dl><dt> Since The Man will usually attempt to take all of your electronic gear right away, you will have to find some mechanism to either store the key some place safe or have an instantaneous mechanism to destroy it as soon as you hear the knock. Be advised that if your key media fails, you will lose all your data. Floppies are a no-no, but can be used to provide plausible deniability.
</dt></dl>
<p>Here are the steps to generate such a key that can be destroyed on a moment's notice:
</p>
<pre>    [root@machine ~/dir]# dd if=/dev/random bs=4k count=1 | gpg -a --cipher-algo AES256 -c - &gt; /mnt/usb/keys/fs.gpg
    [root@machine ~/dir]# gpg -q -o - /mnt/usb/keys/fs.gpg | cryptsetup -v -c aes create cryptfs /dev/hdxN
    [root@machine ~/dir]# mkfs.ext3 /dev/mapper/cryptfs
    [root@machine ~/dir]# mount /dev/mapper/cryptfs /crypto
</pre>
<p>So basically what this does is get some random data for the fs key material, and use gpg and AES256 to symmetrically encrypt (-c) it with your passphrase. The next command then decrypts your key file and uses the key material to initialize the dmcrypt driver using /dev/hdxN, where x is one of a-d, and N is the partition number. Note you can also use files instead of partitions, but it is not recommended, especially if that file resides on a journaled filesystem. After that, the /dev/mapper/cryptfs block device will appear, and you can format it for whatever FS you like, and then mount it.
</p><p>For added safety, I prefer to move /var, /tmp, and /home to /crypto and create symlinks back to /, so that .bash_history and system logs aren't available to someone who might want to prove you have certain files or access times. You should run <b>telinit 1</b> before doing this, to ensure that no daemons are running and actively using those directories when you move them.
</p>
<pre>    [root@machine ~/dir]# telinit 1 [or reboot into single user mode]
    [root@machine ~/dir]# [killall rpc.idmapd]
    [root@machine ~/dir]# [umount /var/lib/nfs/rpc_pipefs]
    [root@machine ~/dir]# mv /var /tmp /home /crypto
    [root@machine ~/dir]# ln -s /crypto/* /
    [root@machine ~/dir]# [vim /etc/selinux/config]
    [root@machine ~/dir]# telinit 3 [or reboot]
</pre>
<p>On Fedora Core 4 systems, you'll need to <b>killall rpc.idmapd</b> and possibly <b>umount /var/lib/nfs/rpc_pipefs</b> before the <b>mv</b>, or just reboot into <a href="http://www.linuxgeek.net/beginners/node80.phtml" class='external text' title="http://www.linuxgeek.net/beginners/node80.phtml" rel="nofollow">single user mode</a>. In addition, this whole setup is likely to cause SELinux conflicts, so you should probably set <b>SELINUX=permissive</b> or <b>SELINUX=disabled</b> in /etc/selinux/config (or add <b>selinux=0</b> to the kernel boot parameters in /etc/grub.conf).
</p><p>Once this is complete, you'll want to make sure that your crypto fs is mounted before anything tries to use /var. The way I prefer is to create a script interface to gpg that has the right options to enable it to work from /etc/rc.d/rc.sysinit. For Fedora Core users, you can typically just call that script right after the rest of the local filesystems are mounted. Search the rc.sysinit file for "mount -a -t" or "Mounting local filesystems". You should end up somewhere near a bunch of mount -f lines and an SELINUX relabeling call. Stick a call to <b>/path/to/mount-crypto</b> right before the SELINUX stuff. If you prefer to run your system in runlevel 5 (with graphical login), you will need to edit /etc/grub.conf and remove the <b>rhgb</b> option from the kernel config line in order to be able to enter your FS password. Note that you will probably want to have a boot disk handy or be ready to do <b><a href="http://lists.debian.org/debian-user/2001/05/msg01993.html" class='external text' title="http://lists.debian.org/debian-user/2001/05/msg01993.html" rel="nofollow">linux init=/bin/bash</a></b> from the boot command line in case something goes wrong.
</p><p>Alternatively, if you don't wish to be prompted for a password at bootup because the machine is a remote server, you can use <b>chkconfig</b> or edit /etc/rc.d/rcN.d (where N is your runlevel -- type <b>runlvl</b> as root if unsure) to remove syslog, sendmail, crond, atd, and any other daemon that shows up in an <b>lsof -n | grep var and lsof -n | grep tmp</b>. In summary:
</p>
<pre>    [root@machine ~/dir]# runlvl
    [root@machine ~/dir]# lsof -n | grep var
    [root@machine ~/dir]# chkconfig --level 3 syslog off
    [root@machine ~/dir]# chkconfig --level 3 sendmail off
    [root@machine ~/dir]# chkconfig --level 3 crond off
    [root@machine ~/dir]# ...
</pre>
<p>Unfortunately, there are likely to be a crapload of daemons you're going to have to do this for, especially if you run Fedora Core 4. Once you finish this, you'll want to make a script that mounts and then starts all the needed daemons. As a starting point, you can have a look at my crypt-start and crypt-stop.
</p><p>Note that if your system is running remotely, it may not be too happy about brining sshd up for you after the unmount or upon bootup, unless you <b>mkdir -p /crypto/var/empty/sshd/</b>, and <b>mkdir -p /crypto/var/lock/subsys</b> in the <i>unmounted</i> dm-crypt directory.
</p><p>It should go without saying, but if you go through all this trouble to encrypt your harddisk, you shouldn't leave backups lying around on unencrypted media. If you have to transfer a backup to unencrypted media, tar it up, and then use <b>gpg --cipher-algo AES256 -c</b> to encrypt it. GPG does compression before encryption.
</p><p>Last, but not least, you should also consider encrypting your swap so that pieces of programs you run aren't recoverable after shutdown. I prefer to use the lazy route and just <a href="http://www.netadmintools.com/part1.html" class='external text' title="http://www.netadmintools.com/part1.html" rel="nofollow">make a swapfile</a> on the encrypted filesystem.
</p>
<dl><dt>Note
</dt></dl>
<dl><dt>An alternate procedure to protect /var and /tmp is to encrypt your entire root filesystem and place the decryption scripts on an initial ramdisk. I have not done this, because it means that you cannot reboot your servers remotely, but it requires a hell of a lot less hacking with initscripts and SELinux permissions. As you saw above, this process can get pretty involved.
</dt></dl>
<p>The Gentoo Wiki has a page on <a href="http://gentoo-wiki.com/SECURITY_Encrypting_Root_Filesystem_with_DM-Crypt" class='external text' title="http://gentoo-wiki.com/SECURITY Encrypting Root Filesystem with DM-Crypt" rel="nofollow">setting up an encrypted root filesystem</a> for Gentoo, and Linux Journal has an article on setting up an <a href="http://www.linuxjournal.com/article/7743" class='external text' title="http://www.linuxjournal.com/article/7743" rel="nofollow">encrypted root for Fedora Core 3</a>. This <a href="http://www.ubuntuforums.org/showthread.php?t=120097" class='external text' title="http://www.ubuntuforums.org/showthread.php?t=120097" rel="nofollow">Ubuntu Forum Post</a> describes the same process for Ubuntu.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=28" title="Intrusive Surveillance">edit</a>]</div><a name="Mac_OS"></a><h3> Mac OS </h3>
<p>In MacOS you have two options. If you trust Apple (and your sysadmin, where applicable), and really believe there is no master password set, you can use the built-in <a href="http://www.apple.com/macosx/features/filevault/" class='external text' title="http://www.apple.com/macosx/features/filevault/" rel="nofollow">FileVault</a> feature to encrypt your entire home directory with 128 bit AES, or you can attempt to do it yourself. Given the amount of work involved in <a href="http://josh.tumaz.com/content/view/17/46/" class='external text' title="http://josh.tumaz.com/content/view/17/46/" rel="nofollow">doing it yourself</a>, I would suggest trusting Apple and going the FileVault route.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=29" title="Intrusive Surveillance">edit</a>]</div><a name="Windows_3"></a><h3> Windows </h3>
<p>In Windows, everything is easy. Unfortunately, everything also sucks. For some reason, Windows implements encryption at the filesystem layer, and you can enable it by right clicking on a file/folder and going to <b>Properties-&gt;Advanced</b>. Unfortunately, all of the file names in an encrypted directory are still viewable without the key. Worse still, the Administrator account has access to all these files through a special recovery key, and there seems to be no option to disable this.
</p><p>If you do choose to run Windows on your desktop, an alternative you might consider is building a Linux fileserver that houses all your sensitive documents on an encrypted Samba share, but be aware that Samba does not encrypt traffic. You can set up an OpenVPN tunnel between your Linux and Windows machine, however, if there is danger of someone monitoring your network.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=30" title="Intrusive Surveillance">edit</a>]</div><a name="FreeOTFE_.2F_TrueCrypt"></a><h4> FreeOTFE / TrueCrypt </h4>
<p>The best options for disk encryption under Windows are to use <a href="http://www.freeotfe.org/" class='external text' title="http://www.freeotfe.org/" rel="nofollow">FreeOTFE</a> or (to a lesser extent)  <a href="http://www.truecrypt.org/" class='external text' title="http://www.truecrypt.org/" rel="nofollow">TrueCrypt</a>, both of which provides the benefits of both crypto and steganography in that it has an <a href="http://www.freeotfe.org/docs/plausible_deniability.htm" class='external text' title="http://www.freeotfe.org/docs/plausible deniability.htm" rel="nofollow">emergency password that you can use</a> if ordered to reveal your filesystem password under threat of force. Both of these programs good, and more than makes up for the pile of suck that is NTFS encryption, and FreeOTFE also has a Windows Mobile version, and compatability with Linux (LUKS and dm-crypt). Creation of hidden volumes is pretty straight forward. There is online documentation doing this (<a href="http://www.freeotfe.org/docs/index.htm" class='external text' title="http://www.freeotfe.org/docs/index.htm" rel="nofollow">FreeOTFE docs</a>), but really you only need to be aware of a couple of things. First, it is best to create the (optional) hidden and the outer volumes at the same time. The outer volume is created first, and is populated (by you) with non-sensitive files and encrypted with the emergency password. Once the volumes are created, you can mount the same volume file/partition with either password to test it out.
</p><p>Additionally, they both have support keyfiles. FreeOTFE also supports PKCS#11 - which means you can store encryption keys on a smartcard or security token, which is a <i>lot</i> more secure than a keyfile.
</p><p>The only real drawback is they cannot encrypt the Windows Swap file. This means that it is possible for programs to write pieces of their memory to disk unencrypted. This obviously can leak sensitive information. However, the swap file can be disabled in Windows by navigating through <b>Start-&gt;Properties-&gt;Advanced tab-&gt;Performance section-&gt;Settings-&gt;Advanced tab-&gt;Virtual Memory section-&gt;Change-&gt;No Paging File-&gt;Set-&gt;OK</b>.
</p><p>On Linux, however, an encrypted volume can of course contain a <a href="http://www.netadmintools.com/part1.html" class='external text' title="http://www.netadmintools.com/part1.html" rel="nofollow">swapfile</a> as discussed above, and on PDAs swapfiles don't exist
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=31" title="Intrusive Surveillance">edit</a>]</div><a name="SeizeD"></a><h3> SeizeD </h3>
<p>For the extra paranoid, you can write a quick perl script to monitor network connectivity, and immediately unmount and remove the crypto device as soon as pings fail (or execute any other arbitrary command). I've done this already for you. My first cut was a simple script that pinged a series of hosts and executed your crypt-stop script from above. This script gave The Man one second to move your machine to a network that would also respond to all those pings while he transported it.
</p><p>This is problematic in that The Man could simply throw in a hub with a bunch of machines that would also respond to those IPs and turn it on as soon as they disconnected your box from the network (assuming they figured out what to do about power). So after thinking about it for a bit, I decided I didn't even want to make it that easy for that bastard. So I wrote a pair of scripts you can run on various machines on your LAN (or across the Internet) to ensure network connectivity.
</p><p>The way this works is there is a client script and a server script. The client script is the one you run on your secure machine, and the server script you run on any host on the Internet. The scripts are written in standard perl, and depends upon the Unix utility md5sum, which is available on Linux, Mac OS, and <a href="http://www.cygwin.com/" class='external text' title="http://www.cygwin.com/" rel="nofollow">cygwin</a>. You should be able to replace md5sum with any command line hashing program, such as <a href="http://www.slavasoft.com/fsum/" class='external text' title="http://www.slavasoft.com/fsum/" rel="nofollow">FSUM</a> if you do not want to install all of cygwin.
</p><p>When you start the pair (start the server first), they ask you for a password to be used for that session. The client script then periodically (every 0.25 seconds by default) sends the MD5 (or SHA1) hash of a random number (from /dev/urandom) to the server script, and the server script appends this random number to your password. It then hashes this combined value, and sends the result back to the client. The client compares this value to one it generates locally via the same manner. If they match, the process is repeated with a new random hash, if they do not match, a script you specify (such as crypt-stop to unmount your drives) is run. The script is also run after a timeout period (1 second) or if the TCP connection otherwise dies.
</p><p>This is a common cryptographically secure authentication technique that is used to prove two people know a password without revealing it to a third party (The Man).
</p><p>Note that there is nothing stopping you from running multiple copies of this program on a given machine to connect to multiple servers with different passwords, in case there is concern a password could be recovered by attacking a particular server. It won't hurt your volume to attempt to unmount it twice.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=32" title="Intrusive Surveillance">edit</a>]</div><a name="Secure_Deletion"></a><h2> Secure Deletion </h2>
<p>Oftentimes you will have old or temporary copies of data left on your hard disk after you finish making your encrypted filesystem. Sometimes applications will save data to unencrypted locations by default before you realize what they are doing. In these cases you need to have a mechanism to wipe traces of this data clean. Simply deleting files is not enough, since deletion only removes files from the directory listing and does nothing to actually remove their contents until they are overwritten by some new file.
</p><p>Whenever the topic of secure deletion comes up, an argument will inevitably be raised as to how many times a file must be overwritten and what must it be overwritten with in order for it to be truly gone. The tinfoil hat crowd will tell you all sorts of horror stories about this or that government agency that has the power to read through N+X layers of random overwritten data, where N was the number you asserted was secure and X is some arbitrary additional amount they made up to make you feel bad.
</p><p>My personal opinion is that somewhere between 2 and 5 really is all you need. As drives become larger, the cost factor involving finding data below an arbitrary number of writes over the span of the entire disk grows tremendously. And then who's to say that the data wasn't there from a previous owner, possibly even someone who returned a drive back to the manufacturer because of some defect that was corrected and the drive resold. The other factor is that if secure deletion takes forever, you will find yourself doing it less and less, and postponing it more and more because it will interfere with your real work. This is obviously much worse than minimally wiping something quickly right away and getting it over with.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=33" title="Intrusive Surveillance">edit</a>]</div><a name="Linux_4"></a><h3> Linux </h3>
<p>On Linux, the relevant utility is called wipe. There are two versions of this utility. The more popular one is <a href="http://wipe.sourceforge.net/" class='external text' title="http://wipe.sourceforge.net/" rel="nofollow">hosted at sourceforge</a>, and the other is <a href="http://abaababa.ouvaton.org/wipe/" class='external text' title="http://abaababa.ouvaton.org/wipe/" rel="nofollow">available here</a>.
</p><p>For most uses, I would just accept the defaults. To wipe a file, <b>wipe filename</b> should be fine. <b>wipe -r directory</b> will get an entire directory recursively. To wipe all free space on a drive, <b>wipe -a some_file</b> should do the trick.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=34" title="Intrusive Surveillance">edit</a>]</div><a name="Mac_OS_2"></a><h3> Mac OS </h3>
<p>On Mac OS, secure file deletion is built right in to the trash bin. You need to ensure that you <a href="http://docs.info.apple.com/article.html?artnum=301416" class='external text' title="http://docs.info.apple.com/article.html?artnum=301416" rel="nofollow">do not interrupt</a> this process, however, or you may loose access to any FileVault volumes you may have. Keep the power plugged in.
</p><p>It is also possible to erase free space on your Mac if you emptied the trash bin without using the secure file deletion option. For instructions on how to do this, go to <b>Applications/Utilities</b> and select <b>Disk Utility</b> and search the help for information on erasing free space. FIXME: Better description. Can it do free space?
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit&amp;section=35" title="Intrusive Surveillance">edit</a>]</div><a name="Windows_4"></a><h3> Windows </h3>
<p>On Windows, far and away the best option is <a href="http://www.heidi.ie/eraser/" class='external text' title="http://www.heidi.ie/eraser/" rel="nofollow">Eraser</a>, since it adds right-click context menus to wipe a file or directory, and allows you to schedule tasks to wipe all free space as well. Very nice piece of software.
</p>
<hr />
<p>"Intrusive Surveillance" is part of the series "<a href="/en/How_to_Exit_the_Matrix" title="How to Exit the Matrix">How to Exit the Matrix</a>" by <a href="mailto:aceevader-a-t-mailvault.com" class='external text' title="mailto:aceevader-a-t-mailvault.com" rel="nofollow">Ace Evader</a> and has been modified and <a href="/en/Wikified" title="Wikified">wikified</a> from it's <a href="http://n4ez7vf37i2yvz5g.onion/howtos/ExitTheMatrix/" class='external text' title="http://n4ez7vf37i2yvz5g.onion/howtos/ExitTheMatrix/" rel="nofollow">original form</a> (this link requires <a href="/en/TOR" title="TOR">The Onion Router</a>). Other mirrors are <a href="http://jdoe.freeshell.org/howtos/ExitTheMatrix/" class='external text' title="http://jdoe.freeshell.org/howtos/ExitTheMatrix/" rel="nofollow">here</a>, <a href="http://exitthematrix.dod.net/matrixmirror/" class='external text' title="http://exitthematrix.dod.net/matrixmirror/" rel="nofollow">here</a>, and <a href="http://anonymity-portal.us/matrixmirror/" class='external text' title="http://anonymity-portal.us/matrixmirror/" rel="nofollow">here</a>.
</p>
<hr />
<p>This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc-sa/2.5/" class='external text' title="http://creativecommons.org/licenses/by-nc-sa/2.5/" rel="nofollow">Creative Commons Share Alike v2.5 license</a>. <img src="http://creativecommons.org/images/public/somerights20.png" alt="somerights20.png" />
</p>
<!-- Saved in parser cache with key iawiki:pcache:idhash:6437-0!1!0!0!!en!2 and timestamp 20140723004821 -->
<div class="printfooter">
Retrieved from "<a href="http://www.infoanarchy.org/en/Intrusive_Surveillance">http://www.infoanarchy.org/en/Intrusive_Surveillance</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="/en/index.php?title=Special:Categories&amp;article=Intrusive_Surveillance" title="Special:Categories">Categories</a>: <a href="/en/Category:How_to_Exit_the_Matrix" title="Category:How to Exit the Matrix">How to Exit the Matrix</a></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="/en/Intrusive_Surveillance">Article</a></li><li id="ca-talk"
	       class="new"	       ><a href="/en/index.php?title=Talk:Intrusive_Surveillance&amp;action=edit">Discussion</a></li><li id="ca-edit"
	       	       ><a href="/en/index.php?title=Intrusive_Surveillance&amp;action=edit">Edit</a></li><li id="ca-history"
	       	       ><a href="/en/index.php?title=Intrusive_Surveillance&amp;action=history">History</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-personal">
	  <h5>Personal tools</h5>
	  <div class="pBody">
	    <ul>
	    <li id="pt-login"><a href="/en/index.php?title=Special:Userlogin&amp;returnto=Intrusive_Surveillance">Create an account or log in</a></li>	    </ul>
	  </div>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(/en/upload/wiki.png);"
	    href="/en/Main_Page"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="/en/Main_Page">Main Page</a></li>
	     	      <li id="n-recentchanges"><a href="/en/Special:Recentchanges">Recent changes</a></li>
	     	      <li id="n-randompage"><a href="/en/Special:Random">Random page</a></li>
	     	      <li id="n-help"><a href="/en/Help:Contents">Help</a></li>
	     	      <li id="n-Wiki-board"><a href="/en/Wiki_board">Wiki board</a></li>
	     	      <li id="n-Boinc"><a href="/en/Boinc">Boinc</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div class="pBody">
	    <form name="searchform" action="/en/Special:Search" id="searchform">
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go"
	        />&nbsp;<input type='submit' name="fulltext"
	        class="searchButton"
	        value="Search" />
	    </form>
	  </div>
	</div>
	<div class="portlet" id="p-tb">
	  <h5>Toolbox</h5>
	  <div class="pBody">
	    <ul>
		  		  <li id="t-whatlinkshere"><a href="/en/Special:Whatlinkshere/Intrusive_Surveillance">What links here</a></li>
		  		  <li id="t-recentchangeslinked"><a href="/en/Special:Recentchangeslinked/Intrusive_Surveillance">Related changes</a></li>
		                	      	      	      	      	      	      	      <li id="t-upload"><a href="/en/Special:Upload">Upload file</a></li>	      	      <li id="t-specialpages"><a href="/en/Special:Specialpages">Special pages</a></li>	      	      	      <li id="t-print"><a href="/en/index.php?title=Intrusive_Surveillance&amp;printable=yes">Printable version</a></li>
	      	    </ul>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/en/skins/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://creativecommons.org/licenses/publicdomain/"><img src="http://creativecommons.org/images/public/norights.png" alt='Public Domain' /></a></div>	<ul id="f-list">
	  <li id="f-lastmod"> This page was last modified 15:46, 15 August 2010.</li>	  	  	  	  <li id="f-copyright">Content is in the public domain where not otherwise noted.</li>	  <li id="f-about"><a href="/en/iA_wiki:About" title="iA wiki:About">About iA wiki</a></li>	  <li id="f-disclaimer"><a href="/en/iA_wiki:General_disclaimer" title="iA wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
    <!-- Served by epov.org in 0.17 secs. -->  </body>
</html>

